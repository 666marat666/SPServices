(function(f){var l=new Array();l.GetAlerts="Alerts";l.DeleteAlerts="Alerts";l.Mode="Authentication";l.Login="Authentication";l.GetForm="Forms";l.GetFormCollection="Forms";l.AddList="Lists";l.DeleteList="Lists";l.GetAttachmentCollection="Lists";l.GetList="Lists";l.GetListAndView="Lists";l.GetListCollection="Lists";l.GetListItems="Lists";l.UpdateListItems="Lists";l.GetPermissionCollection="Permissions";l.GetLinks="PublishedLinksService";l.GetPortalSearchInfo="Search";l.GetSearchMetadata="Search";l.Query="Search";l.Status="Search";l.AddGroup="usergroup";l.AddGroupToRole="usergroup";l.AddRole="usergroup";l.GetAllUserCollectionFromWeb="usergroup";l.GetGroupCollection="usergroup";l.GetGroupCollectionFromRole="usergroup";l.GetGroupCollectionFromSite="usergroup";l.GetGroupCollectionFromUser="usergroup";l.GetGroupCollectionFromWeb="usergroup";l.GetGroupInfo="usergroup";l.GetRoleCollection="usergroup";l.GetRoleCollectionFromGroup="usergroup";l.GetRoleCollectionFromUser="usergroup";l.GetRoleCollectionFromWeb="usergroup";l.GetRolesAndPermissionsForCurrentUser="usergroup";l.GetRolesAndPermissionsForSite="usergroup";l.GetUserCollection="usergroup";l.GetUserCollectionFromGroup="usergroup";l.GetUserCollectionFromRole="usergroup";l.GetUserCollectionFromSite="usergroup";l.GetUserCollectionFromWeb="usergroup";l.GetUserInfo="usergroup";l.GetUserLoginFromEmail="usergroup";l.RemoveGroup="usergroup";l.GetCommonMemberships="UserProfileService";l.GetUserColleagues="UserProfileService";l.GetUserLinks="UserProfileService";l.GetUserMemberships="UserProfileService";l.GetUserPinnedLinks="UserProfileService";l.GetUserProfileByName="UserProfileService";l.GetUserProfileCount="UserProfileService";l.GetUserProfileSchema="UserProfileService";l.GetViewCollection="Views";l.DeleteAllVersions="Versions";l.DeleteVersion="Versions";l.GetVersions="Versions";l.RestoreVersion="Versions";l.GetWebPart2="WebPartPages";l.GetWebPartPage="WebPartPages";l.GetWebPartProperties2="WebPartPages";l.GetListTemplates="Webs";l.GetWeb="Webs";l.GetWebCollection="Webs";l.GetAllSubWebCollection="Webs";l.WebUrlFromPageUrl="Webs";l.GetTemplatesForItem="Workflow";l.GetToDosForItem="Workflow";l.GetWorkflowDataForItem="Workflow";l.GetWorkflowTaskData="Workflow";l.StartWorkflow="Workflow";var d=new Object();d.header="<soap:Envelope xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body>";d.footer="</soap:Body></soap:Envelope>";d.payload="";f.fn.SPServices=function(m){var n=f.extend({},f.fn.SPServices.defaults,m);d.opheader="<"+n.operation+" ";switch(l[n.operation]){case"Alerts":d.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/2002/1/alerts/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/2002/1/alerts/";break;case"Permissions":d.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/directory/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/directory/";break;case"PublishedLinksService":d.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/' >";SOAPAction="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/";break;case"Search":d.opheader+="xmlns='urn:Microsoft.Search' >";SOAPAction="urn:Microsoft.Search/";break;case"usergroup":d.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/directory/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/directory/";break;case"UserProfileService":d.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/UserProfileService' >";SOAPAction="http://microsoft.com/webservices/SharePointPortalServer/UserProfileService/";break;case"WebPartPages":d.opheader+="xmlns='http://microsoft.com/sharepoint/webpartpages' >";SOAPAction="http://microsoft.com/sharepoint/webpartpages/";break;case"Workflow":d.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/workflow/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/workflow/";break;default:d.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/'>";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/";break}SOAPAction+=n.operation;d.opfooter="</"+n.operation+">";ajaxURL=((n.webURL!="")?n.webURL:f().SPServices.SPGetCurrentSite())+"/_vti_bin/"+l[n.operation]+".asmx";d.payload="";switch(n.operation){case"GetAlerts":break;case"DeleteAlerts":d.payload+="<IDs>";for(i=0;i<n.IDs.length;i++){d.payload+=c("string",n.IDs[i])}d.payload+="</IDs>";break;case"Mode":break;case"Login":d.payload+=c("username",n.username);d.payload+=c("password",n.password);break;case"GetForm":d.payload+=c("listName",n.listName);d.payload+=c("formUrl",n.formUrl);break;case"GetFormCollection":d.payload+=c("listName",n.listName);break;case"AddList":d.payload+=c("listName",n.listName);d.payload+=c("description",n.description);d.payload+=c("templateID",n.templateID);break;case"DeleteList":d.payload+=c("listName",n.listName);break;case"GetAttachmentCollection":d.payload+=c("listName",n.listName);d.payload+=c("listItemID",n.ID);break;case"GetList":d.payload+=c("listName",n.listName);break;case"GetListAndView":d.payload+=c("listName",n.listName);d.payload+=c("viewName",n.viewName);break;case"GetListCollection":break;case"GetListItems":d.payload+=c("listName",n.listName);d.payload+=c("viewFields",n.CAMLViewFields);d.payload+=c("query",n.CAMLQuery);d.payload+=c("rowLimit",n.CAMLRowLimit);d.payload+=c("queryOptions",n.CAMLQueryOptions);break;case"UpdateListItems":d.payload+=c("listName",n.listName);if(n.updates.length>0){d.payload+=c("updates",n.updates)}else{d.payload+="<updates><Batch OnError='Continue'><Method ID='1' Cmd='Update'>";for(i=0;i<n.valuepairs.length;i++){d.payload+="<Field Name='"+n.valuepairs[i][0]+"'>"+n.valuepairs[i][1]+"</Field>"}d.payload+="<Field Name='ID'>"+n.ID+"</Field>";d.payload+="</Method></Batch></updates>"}break;case"GetPermissionCollection":d.payload+=c("objectName",n.objectName);d.payload+=c("objectType",n.objectType);break;case"GetLinks":break;case"GetPortalSearchInfo":SOAPAction="http://microsoft.com/webservices/OfficeServer/QueryService/"+n.operation;d.opheader="<"+n.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'/>";break;case"GetSearchMetadata":SOAPAction="http://microsoft.com/webservices/OfficeServer/QueryService/"+n.operation;d.opheader="<"+n.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'/>";break;case"Query":d.payload+=c("queryXml",k(n.queryXml));break;case"Status":break;case"AddGroup":d.payload+=c("groupName",n.groupName);d.payload+=c("ownerIdentifier",n.ownerIdentifier);d.payload+=c("ownerType",n.ownerType);d.payload+=c("defaultUserLoginName",n.defaultUserLoginName);d.payload+=c("groupName",n.groupName);d.payload+=c("description",n.description);break;case"AddGroupToRole":d.payload+=c("groupName",n.groupName);d.payload+=c("roleName",n.roleName);break;case"AddRole":d.payload+=c("roleName",n.roleName);d.payload+=c("description",n.description);d.payload+=c("permissionMask",n.permissionMask);break;case"GetAllUserCollectionFromWeb":break;case"GetGroupCollectionFromRole":d.payload+=c("roleName",n.roleName);break;case"GetGroupCollection":d.payload+=c("groupNamesXml",n.groupNamesXml);break;case"GetGroupCollectionFromSite":break;case"GetGroupCollectionFromUser":d.payload+=c("userLoginName",n.userLoginName);break;case"GetGroupCollectionFromWeb":break;case"GetGroupInfo":d.payload+=c("groupName",n.groupName);break;case"GetRoleCollection":d.payload+=c("roleNamesXml",n.roleNamesXml);break;case"GetRoleCollectionFromGroup":d.payload+=c("groupName",n.groupName);break;case"GetRoleCollectionFromUser":d.payload+=c("userLoginName",n.userLoginName);break;case"GetRoleCollectionFromWeb":break;case"GetRoleInfo":d.payload+=c("roleName",n.roleName);break;case"GetRolesAndPermissionsForCurrentUser":break;case"GetRolesAndPermissionsForSite":break;case"GetUserCollection":d.payload+=c("userLoginNamesXml",n.userLoginNamesXml);break;case"GetUserCollectionFromGroup":d.payload+=c("groupName",n.groupName);break;case"GetUserCollectionFromRole":d.payload+=c("roleName",n.roleName);break;case"GetUserCollectionFromSite":break;case"GetUserCollectionFromWeb":break;case"GetUserInfo":d.payload+=c("userLoginName",n.userLoginName);break;case"GetUserLoginFromEmail":d.payload+=c("emailXml",n.emailXml);break;case"RemoveGroup":d.payload+=c("groupName",n.groupName);break;case"GetCommonMemberships":d.payload+=c("accountName",n.accountName);break;case"GetUserColleagues":d.payload+=c("accountName",n.accountName);break;case"GetUserLinks":d.payload+=c("accountName",n.accountName);break;case"GetUserMemberships":d.payload+=c("accountName",n.accountName);break;case"GetUserPinnedLinks":d.payload+=c("accountName",n.accountName);break;case"GetUserProfileByName":d.payload+=c("accountName",n.accountName);break;case"GetUserProfileCount":break;case"GetUserProfileSchema":break;case"GetViewCollection":d.payload+=c("listName",n.listName);break;case"DeleteAllVersions":d.payload+=c("fileName",n.fileName);break;case"DeleteVersion":d.payload+=c("fileName",n.fileName);d.payload+=c("fileVersion",n.fileVersion);break;case"GetVersions":d.payload+=c("fileName",n.fileName);break;case"RestoreVersion":d.payload+=c("fileName",n.fileName);d.payload+=c("fileVersion",n.fileVersion);break;case"GetWebPart2":d.payload+=c("pageUrl",n.pageUrl);d.payload+=c("storageKey",n.storageKey);d.payload+=c("storage",n.storage);d.payload+=c("behavior",n.behavior);break;case"GetWebPartPage":d.payload+=c("documentName",n.documentName);d.payload+=c("behavior",n.behavior);break;case"GetWebPartProperties2":d.payload+=c("pageUrl",n.pageUrl);d.payload+=c("storage",n.storage);d.payload+=c("behavior",n.behavior);break;case"GetWeb":d.payload+=c("webUrl",n.webURL);break;case"GetListTemplates":break;case"GetWebCollection":break;case"GetAllSubWebCollection":break;case"WebUrlFromPageUrl":d.payload+=c("pageUrl",n.pageURL);break;case"GetTemplatesForItem":d.payload+=c("item",n.item);break;case"GetToDosForItem":d.payload+=c("item",n.item);break;case"GetWorkflowDataForItem":d.payload+=c("item",n.item);break;case"GetWorkflowTaskData":d.payload+=c("item",n.item);d.payload+=c("listId",n.listId);d.payload+=c("taskId",n.taskId);break;case"StartWorkflow":d.payload+=c("item",n.item);d.payload+=c("templateId",n.templateId);d.payload+=c("workflowParameters",n.workflowParameters);break;default:break}var o=d.header+d.opheader+d.payload+d.opfooter+d.footer;f.ajax({url:ajaxURL,async:n.async,beforeSend:function(p){p.setRequestHeader("SOAPAction",SOAPAction)},type:"POST",data:o,dataType:"xml",contentType:"text/xml; charset='utf-8'",complete:n.completefunc})};f.fn.SPServices.defaults={operation:"",webURL:"",pageURL:"",listName:"",description:"",templateID:"",viewName:"",formUrl:"",fileName:"",fileVersion:"",ID:1,updates:"",CAMLViewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:"",CAMLQueryOptions:"<QueryOptions></QueryOptions>",valuepairs:[],username:"",password:"",accountName:"",userLoginName:"",groupNamesXml:"",groupName:"",ownerIdentifier:"",ownerType:"",defaultUserLoginName:"",roleNamesXml:"",roleName:"",permissionMask:"",userLoginNamesXml:"",emailXml:"",objectName:"",objectType:"List",IDs:null,documentName:"",behavior:"Version3",storageKey:"",storage:"Shared",item:"",listId:"",taskId:"",templateId:"",workflowParameters:"",fClaim:false,queryXml:"",async:true,completefunc:null};f.fn.SPServices.SPGetCurrentSite=function(){var m="";var n=d.header+"<WebUrlFromPageUrl xmlns='http://schemas.microsoft.com/sharepoint/soap/' ><pageUrl>"+((location.href.indexOf("?")>0)?location.href.substr(0,location.href.indexOf("?")):location.href)+"</pageUrl></WebUrlFromPageUrl>"+d.footer;f.ajax({async:false,url:"/_vti_bin/Webs.asmx",beforeSend:function(o){o.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/WebUrlFromPageUrl")},type:"POST",data:n,dataType:"xml",contentType:'text/xml; charset="utf-8"',complete:function(p,o){m=f(p.responseXML).find("WebUrlFromPageUrlResult").text()}});return m};f.fn.SPServices.SPCascadeDropdowns=function(n){var p=f.extend({},{relationshipWebURL:"",relationshipList:"",relationshipListParentColumn:"",relationshipListChildColumn:"",parentColumn:"",childColumn:""},n);var q=true;var m=f().find("select:[Title='"+p.childColumn+"']");if(m.html()==null){m=f().find("input:[Title='"+p.childColumn+"']");m.attr("readonly","readonly");q=false}var o=f().find("select:[Title='"+p.parentColumn+"']");if(o.html()==null){o=f().find("input:[Title='"+p.parentColumn+"']");o.attr("readonly","readonly");o.bind("focus",function(){var r=o.parent().find("#_Select");a(r,m,q,p);r.trigger("change")});o.parent().find("img").click();o.blur()}else{a(o,m,q,p);o.trigger("change")}};function a(o,q,p,n){var s;var m=false;var r="";o.bind("change",function(){var t=null;p?t=q.find("option:selected").val():t=q.attr("value");s=o.find("option:selected").text();f().SPServices({operation:"GetListItems",async:false,webURL:n.relationshipWebURL,listName:n.relationshipList,CAMLQuery:"<Query><Where><Eq><FieldRef Name='"+n.relationshipListParentColumn+"'/><Value Type='Text'>"+k(s)+"</Value></Eq></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='"+n.relationshipListParentColumn+"' /><FieldRef Name='"+n.relationshipListChildColumn+"' /></ViewFields>",CAMLRowLimit:"<RowLimit>0</RowLimit>",completefunc:function(v,u){if(p){q.attr({length:0}).append("<option value='0'>Choose "+n.childColumn+"...</option>")}else{r="(None)|0";q.attr("value","")}f(v.responseXML).find("z\\:row").each(function(){if(p){var w=(f(this).attr("ows_ID")==t)?" selected='selected'":"";q.append("<option"+w+" value='"+f(this).attr("ows_ID")+"'>"+f(this).attr("ows_"+n.relationshipListChildColumn)+"</option>")}else{if(f(this).attr("ows_"+n.relationshipListChildColumn)==t){q.attr("value",t)}r=r+"|"+f(this).attr("ows_"+n.relationshipListChildColumn)+"|"+f(this).attr("ows_ID")}});q.attr("choices",r)}});if(p){q.trigger("change")}else{if(m){o.blur();q.parent().find("img").click();q.blur()}}if(o.css("display")!="none"){m=true}})}f.fn.SPServices.SPDisplayRelatedInfo=function(m){var n=f.extend({},{columnName:"",relatedWebURL:"",relatedList:"",relatedListColumn:"",relatedColumns:[],displayFormat:"table",headerCSSClass:"ms-vh2",rowCSSClass:"ms-vb"},m);var o=f().find("select:[Title='"+n.columnName+"']");if(o.html()==null){o=f().find("input:[Title='"+n.columnName+"']");o.attr("readonly","readonly");o.bind("focus",function(){var p=o.parent().find("#_Select");j(p,n)});o.parent().find("img").click();o.blur()}else{j(o,n);o.trigger("change")}};function j(o,n){var m;o.parent().append("<div id=showRelated_"+h(n.columnName)+"></div>");o.bind("change",function(){m=o.find("option:selected").text();var q=[];f().SPServices({operation:"GetList",async:false,webURL:n.relatedWebURL,listName:n.relatedList,completefunc:function(s,r){f(s.responseXML).find("Fields").each(function(){f(s.responseXML).find("Field").each(function(){for(i=0;i<n.relatedColumns.length;i++){if(f(this).attr("Name")==n.relatedColumns[i]){q[i]=f(this)}}})})}});var p=" ";for(i=0;i<n.relatedColumns.length;i++){p+="<FieldRef Name='"+n.relatedColumns[i]+"' />"}f().SPServices({operation:"GetListItems",async:false,webURL:n.relatedWebURL,listName:n.relatedList,CAMLQuery:"<Query><Where><Eq><FieldRef Name='"+n.relatedListColumn+"'/><Value Type='Text'>"+k(m)+"</Value></Eq></Where></Query>",CAMLViewFields:"<ViewFields>"+p+"</ViewFields>",CAMLRowLimit:"<RowLimit>0</RowLimit>",completefunc:function(t,s){switch(n.displayFormat){case"table":var r="<table>";r+="<tr>";for(i=0;i<n.relatedColumns.length;i++){r+="<th class='"+n.headerCSSClass+"'>"+q[i].attr("DisplayName")+"</th>"}r+="</tr>";f(t.responseXML).find("z\\:row").each(function(){r+="<tr>";for(i=0;i<n.relatedColumns.length;i++){r+="<td class='"+n.rowCSSClass+"'>"+e(q[i],f(this).attr("ows_"+n.relatedColumns[i]),n)+"</td>"}r+="</tr>"});r+="</table>";f("#showRelated_"+h(n.columnName)).html("").append(r);break;default:break}}})})}f.fn.SPServices.SPDebugXMLHttpResult=function(n){var p=f.extend({},{node:null,outputId:"",indent:0},n);var r=3;var q=4;var m="";m+="<table class='ms-vb' style='margin-left:"+p.indent*3+"px;' width='100%'>";if(p.node.nodeName=="DisplayPattern"){m+="<tr><td width='100px' style='font-weight:bold;'>"+p.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+p.node.xml+"</textarea></td></tr>"}else{if(!p.node.hasChildNodes()){m+="<tr><td width='100px' style='font-weight:bold;'>"+p.node.nodeName+"</td><td>"+((p.node.nodeValue!=null)?b(p.node.nodeValue):"&nbsp;")+"</td></tr>";if(p.node.attributes){m+="<tr><td colspan='99'>";m+=g(p.node,p);m+="</td></tr>"}}else{if(p.node.hasChildNodes()&&p.node.firstChild.nodeType==q){m+="<tr><td width='100px' style='font-weight:bold;'>"+p.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+p.node.parentNode.text+"</textarea></td></tr>"}else{if(p.node.hasChildNodes()&&p.node.firstChild.nodeType==r){m+="<tr><td width='100px' style='font-weight:bold;'>"+p.node.nodeName+"</td><td>"+b(p.node.firstChild.nodeValue)+"</td></tr>"}else{m+="<tr><td width='100px' style='font-weight:bold;' colspan='99'>"+p.node.nodeName+"</td></tr>";if(p.node.attributes){m+="<tr><td colspan='99'>";m+=g(p.node,p);m+="</td></tr>"}m+="<tr><td>";for(var o=0;o<p.node.childNodes.length;o++){m+=f().SPServices.SPDebugXMLHttpResult({node:p.node.childNodes.item(o),outputId:p.outputId,indent:p.indent+1})}m+="</td></tr>"}}}}m+="</table>";return m};f.fn.SPServices.SPGetCurrentUser=function(){var m="";f.ajax({async:false,url:"/_layouts/userdisp.aspx?Force=True",complete:function(o,n){f(o.responseText).find("table.ms-formtable td#SPFieldText").each(function(){if(/FieldInternalName=\"Name\"/.test(f(this).html())){m=f(this).text()}})}});return m.replace(/(^[\s\xA0]+|[\s\xA0]+$)/g,"")};function e(q,p,o){if(p==undefined){return""}var m=p;switch(q.attr("Type")){case"Text":m=p;break;case"URL":m="<img alt='"+p.substring(p.search(",")+1)+"' src='"+p.substring(0,p.search(","))+"'/>";break;case"Number":m=parseFloat(p).toFixed(q.attr("Decimals")).toString();break;case"Lookup":var n;f().SPServices({operation:"GetFormCollection",async:false,listName:q.attr("List"),completefunc:function(s,r){f(s.responseXML).find("Form").each(function(){if(f(this).attr("Type")=="DisplayForm"){n=f(this).attr("Url")}})}});m="<a href='"+o.relatedWebURL+"/"+n+"?ID="+p.substring(0,p.search(";#"))+"&RootFolder=*'>"+p.substring(p.search(";#")+2)+"</a>";break;case"Counter":m=p;break;default:break}return m}function g(p,o){var m="<table class='ms-vb' width='100%'>";for(var n=0;n<p.attributes.length;n++){m+="<tr><td width='10px' style='font-weight:bold;'>"+n+"</td><td width='100px'>"+p.attributes.item(n).nodeName+"</td><td>"+b(p.attributes.item(n).nodeValue)+"</td></tr>"}m+="</table>";return m}function b(m){return((m.indexOf("http")==0)||(m.indexOf("/")==0))?"<a href='"+m+"'>"+m+"</a>":m}function k(m){return m.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function h(m){return m.replace(/ /g,"_x0020_")}function c(o,m){return"<"+o+">"+m+"</"+o+">"}})(jQuery);