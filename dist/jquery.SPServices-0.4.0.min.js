(function(g){var m=new Array();m.GetAlerts="Alerts";m.DeleteAlerts="Alerts";m.Mode="Authentication";m.Login="Authentication";m.GetForm="Forms";m.GetFormCollection="Forms";m.AddList="Lists";m.CheckInFile="Lists";m.CheckOutFile="Lists";m.DeleteList="Lists";m.GetAttachmentCollection="Lists";m.GetList="Lists";m.GetListAndView="Lists";m.GetListCollection="Lists";m.GetListItems="Lists";m.UpdateListItems="Lists";m.GetPermissionCollection="Permissions";m.GetLinks="PublishedLinksService";m.GetPortalSearchInfo="Search";m.GetSearchMetadata="Search";m.Query="Search";m.Status="Search";m.AddGroup="usergroup";m.AddGroupToRole="usergroup";m.AddRole="usergroup";m.GetAllUserCollectionFromWeb="usergroup";m.GetGroupCollection="usergroup";m.GetGroupCollectionFromRole="usergroup";m.GetGroupCollectionFromSite="usergroup";m.GetGroupCollectionFromUser="usergroup";m.GetGroupCollectionFromWeb="usergroup";m.GetGroupInfo="usergroup";m.GetRoleCollection="usergroup";m.GetRoleCollectionFromGroup="usergroup";m.GetRoleCollectionFromUser="usergroup";m.GetRoleCollectionFromWeb="usergroup";m.GetRolesAndPermissionsForCurrentUser="usergroup";m.GetRolesAndPermissionsForSite="usergroup";m.GetUserCollection="usergroup";m.GetUserCollectionFromGroup="usergroup";m.GetUserCollectionFromRole="usergroup";m.GetUserCollectionFromSite="usergroup";m.GetUserCollectionFromWeb="usergroup";m.GetUserInfo="usergroup";m.GetUserLoginFromEmail="usergroup";m.RemoveGroup="usergroup";m.GetCommonMemberships="UserProfileService";m.GetUserColleagues="UserProfileService";m.GetUserLinks="UserProfileService";m.GetUserMemberships="UserProfileService";m.GetUserPinnedLinks="UserProfileService";m.GetUserProfileByName="UserProfileService";m.GetUserProfileCount="UserProfileService";m.GetUserProfileSchema="UserProfileService";m.GetViewCollection="Views";m.DeleteAllVersions="Versions";m.DeleteVersion="Versions";m.GetVersions="Versions";m.RestoreVersion="Versions";m.GetWebPart2="WebPartPages";m.GetWebPartPage="WebPartPages";m.GetWebPartProperties2="WebPartPages";m.GetListTemplates="Webs";m.GetWeb="Webs";m.GetWebCollection="Webs";m.GetAllSubWebCollection="Webs";m.WebUrlFromPageUrl="Webs";m.GetTemplatesForItem="Workflow";m.GetToDosForItem="Workflow";m.GetWorkflowDataForItem="Workflow";m.GetWorkflowTaskData="Workflow";m.StartWorkflow="Workflow";var e=new Object();e.header="<soap:Envelope xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body>";e.footer="</soap:Body></soap:Envelope>";e.payload="";g.fn.SPServices=function(n){var o=g.extend({},g.fn.SPServices.defaults,n);e.opheader="<"+o.operation+" ";switch(m[o.operation]){case"Alerts":e.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/2002/1/alerts/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/2002/1/alerts/";break;case"Permissions":e.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/directory/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/directory/";break;case"PublishedLinksService":e.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/' >";SOAPAction="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/";break;case"Search":e.opheader+="xmlns='urn:Microsoft.Search' >";SOAPAction="urn:Microsoft.Search/";break;case"usergroup":e.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/directory/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/directory/";break;case"UserProfileService":e.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/UserProfileService' >";SOAPAction="http://microsoft.com/webservices/SharePointPortalServer/UserProfileService/";break;case"WebPartPages":e.opheader+="xmlns='http://microsoft.com/sharepoint/webpartpages' >";SOAPAction="http://microsoft.com/sharepoint/webpartpages/";break;case"Workflow":e.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/workflow/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/workflow/";break;default:e.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/'>";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/";break}SOAPAction+=o.operation;e.opfooter="</"+o.operation+">";var p=((o.webURL!="")?o.webURL:g().SPServices.SPGetCurrentSite())+"/_vti_bin/"+m[o.operation]+".asmx";e.payload="";switch(o.operation){case"GetAlerts":break;case"DeleteAlerts":e.payload+="<IDs>";for(i=0;i<o.IDs.length;i++){e.payload+=c("string",o.IDs[i])}e.payload+="</IDs>";break;case"Mode":break;case"Login":e.payload+=c("username",o.username);e.payload+=c("password",o.password);break;case"GetForm":e.payload+=c("listName",o.listName);e.payload+=c("formUrl",o.formUrl);break;case"GetFormCollection":e.payload+=c("listName",o.listName);break;case"AddList":e.payload+=c("listName",o.listName);e.payload+=c("description",o.description);e.payload+=c("templateID",o.templateID);break;case"CheckInFile":e.payload+=c("pageUrl",o.pageUrl);e.payload+=c("comment",o.comment);e.payload+=c("CheckinType",o.CheckinType);break;case"CheckOutFile":e.payload+=c("pageUrl",o.pageUrl);e.payload+=c("checkoutToLocal",o.checkoutToLocal);e.payload+=c("lastmodified",o.lastmodified);break;case"DeleteList":e.payload+=c("listName",o.listName);break;case"GetAttachmentCollection":e.payload+=c("listName",o.listName);e.payload+=c("listItemID",o.ID);break;case"GetList":e.payload+=c("listName",o.listName);break;case"GetListAndView":e.payload+=c("listName",o.listName);e.payload+=c("viewName",o.viewName);break;case"GetListCollection":break;case"GetListItems":e.payload+=c("listName",o.listName);e.payload+=c("viewFields",o.CAMLViewFields);e.payload+=c("query",o.CAMLQuery);e.payload+=c("rowLimit",o.CAMLRowLimit);e.payload+=c("queryOptions",o.CAMLQueryOptions);break;case"UpdateListItems":e.payload+=c("listName",o.listName);if(o.updates.length>0){e.payload+=c("updates",o.updates)}else{e.payload+="<updates><Batch OnError='Continue'><Method ID='1' Cmd='Update'>";for(i=0;i<o.valuepairs.length;i++){e.payload+="<Field Name='"+o.valuepairs[i][0]+"'>"+o.valuepairs[i][1]+"</Field>"}e.payload+="<Field Name='ID'>"+o.ID+"</Field>";e.payload+="</Method></Batch></updates>"}break;case"GetPermissionCollection":e.payload+=c("objectName",o.objectName);e.payload+=c("objectType",o.objectType);break;case"GetLinks":break;case"GetPortalSearchInfo":SOAPAction="http://microsoft.com/webservices/OfficeServer/QueryService/"+o.operation;e.opheader="<"+o.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'/>";break;case"GetSearchMetadata":SOAPAction="http://microsoft.com/webservices/OfficeServer/QueryService/"+o.operation;e.opheader="<"+o.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'/>";break;case"Query":e.payload+=c("queryXml",l(o.queryXml));break;case"Status":break;case"AddGroup":e.payload+=c("groupName",o.groupName);e.payload+=c("ownerIdentifier",o.ownerIdentifier);e.payload+=c("ownerType",o.ownerType);e.payload+=c("defaultUserLoginName",o.defaultUserLoginName);e.payload+=c("groupName",o.groupName);e.payload+=c("description",o.description);break;case"AddGroupToRole":e.payload+=c("groupName",o.groupName);e.payload+=c("roleName",o.roleName);break;case"AddRole":e.payload+=c("roleName",o.roleName);e.payload+=c("description",o.description);e.payload+=c("permissionMask",o.permissionMask);break;case"GetAllUserCollectionFromWeb":break;case"GetGroupCollectionFromRole":e.payload+=c("roleName",o.roleName);break;case"GetGroupCollection":e.payload+=c("groupNamesXml",o.groupNamesXml);break;case"GetGroupCollectionFromSite":break;case"GetGroupCollectionFromUser":e.payload+=c("userLoginName",o.userLoginName);break;case"GetGroupCollectionFromWeb":break;case"GetGroupInfo":e.payload+=c("groupName",o.groupName);break;case"GetRoleCollection":e.payload+=c("roleNamesXml",o.roleNamesXml);break;case"GetRoleCollectionFromGroup":e.payload+=c("groupName",o.groupName);break;case"GetRoleCollectionFromUser":e.payload+=c("userLoginName",o.userLoginName);break;case"GetRoleCollectionFromWeb":break;case"GetRoleInfo":e.payload+=c("roleName",o.roleName);break;case"GetRolesAndPermissionsForCurrentUser":break;case"GetRolesAndPermissionsForSite":break;case"GetUserCollection":e.payload+=c("userLoginNamesXml",o.userLoginNamesXml);break;case"GetUserCollectionFromGroup":e.payload+=c("groupName",o.groupName);break;case"GetUserCollectionFromRole":e.payload+=c("roleName",o.roleName);break;case"GetUserCollectionFromSite":break;case"GetUserCollectionFromWeb":break;case"GetUserInfo":e.payload+=c("userLoginName",o.userLoginName);break;case"GetUserLoginFromEmail":e.payload+=c("emailXml",o.emailXml);break;case"RemoveGroup":e.payload+=c("groupName",o.groupName);break;case"GetCommonMemberships":e.payload+=c("accountName",o.accountName);break;case"GetUserColleagues":e.payload+=c("accountName",o.accountName);break;case"GetUserLinks":e.payload+=c("accountName",o.accountName);break;case"GetUserMemberships":e.payload+=c("accountName",o.accountName);break;case"GetUserPinnedLinks":e.payload+=c("accountName",o.accountName);break;case"GetUserProfileByName":e.payload+=c("accountName",o.accountName);break;case"GetUserProfileCount":break;case"GetUserProfileSchema":break;case"GetViewCollection":e.payload+=c("listName",o.listName);break;case"DeleteAllVersions":e.payload+=c("fileName",o.fileName);break;case"DeleteVersion":e.payload+=c("fileName",o.fileName);e.payload+=c("fileVersion",o.fileVersion);break;case"GetVersions":e.payload+=c("fileName",o.fileName);break;case"RestoreVersion":e.payload+=c("fileName",o.fileName);e.payload+=c("fileVersion",o.fileVersion);break;case"GetWebPart2":e.payload+=c("pageUrl",o.pageUrl);e.payload+=c("storageKey",o.storageKey);e.payload+=c("storage",o.storage);e.payload+=c("behavior",o.behavior);break;case"GetWebPartPage":e.payload+=c("documentName",o.documentName);e.payload+=c("behavior",o.behavior);break;case"GetWebPartProperties2":e.payload+=c("pageUrl",o.pageUrl);e.payload+=c("storage",o.storage);e.payload+=c("behavior",o.behavior);break;case"GetWeb":e.payload+=c("webUrl",o.webURL);break;case"GetListTemplates":break;case"GetWebCollection":break;case"GetAllSubWebCollection":break;case"WebUrlFromPageUrl":e.payload+=c("pageUrl",o.pageURL);break;case"GetTemplatesForItem":e.payload+=c("item",o.item);break;case"GetToDosForItem":e.payload+=c("item",o.item);break;case"GetWorkflowDataForItem":e.payload+=c("item",o.item);break;case"GetWorkflowTaskData":e.payload+=c("item",o.item);e.payload+=c("listId",o.listId);e.payload+=c("taskId",o.taskId);break;case"StartWorkflow":e.payload+=c("item",o.item);e.payload+=c("templateId",o.templateId);e.payload+=c("workflowParameters",o.workflowParameters);break;default:break}var q=e.header+e.opheader+e.payload+e.opfooter+e.footer;g.ajax({url:p,async:o.async,beforeSend:function(r){r.setRequestHeader("SOAPAction",SOAPAction)},type:"POST",data:q,dataType:"xml",contentType:"text/xml; charset='utf-8'",complete:o.completefunc})};g.fn.SPServices.defaults={operation:"",webURL:"",pageURL:"",listName:"",description:"",templateID:"",viewName:"",formUrl:"",fileName:"",fileVersion:"",ID:1,updates:"",comment:"",CheckinType:"",checkoutToLocal:"",lastmodified:"",CAMLViewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:"",CAMLQueryOptions:"<QueryOptions></QueryOptions>",valuepairs:[],username:"",password:"",accountName:"",userLoginName:"",groupNamesXml:"",groupName:"",ownerIdentifier:"",ownerType:"",defaultUserLoginName:"",roleNamesXml:"",roleName:"",permissionMask:"",userLoginNamesXml:"",emailXml:"",objectName:"",objectType:"List",IDs:null,documentName:"",behavior:"Version3",storageKey:"",storage:"Shared",item:"",listId:"",taskId:"",templateId:"",workflowParameters:"",fClaim:false,queryXml:"",async:true,completefunc:null};g.fn.SPServices.SPGetCurrentSite=function(){var n="";var o=e.header+"<WebUrlFromPageUrl xmlns='http://schemas.microsoft.com/sharepoint/soap/' ><pageUrl>"+((location.href.indexOf("?")>0)?location.href.substr(0,location.href.indexOf("?")):location.href)+"</pageUrl></WebUrlFromPageUrl>"+e.footer;g.ajax({async:false,url:"/_vti_bin/Webs.asmx",beforeSend:function(p){p.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/WebUrlFromPageUrl")},type:"POST",data:o,dataType:"xml",contentType:'text/xml; charset="utf-8"',complete:function(q,p){n=g(q.responseXML).find("WebUrlFromPageUrlResult").text()}});return n};g.fn.SPServices.SPCascadeDropdowns=function(o){var q=g.extend({},{relationshipWebURL:"",relationshipList:"",relationshipListParentColumn:"",relationshipListChildColumn:"",parentColumn:"",childColumn:""},o);var r=true;var n=g().find("select:[Title='"+q.childColumn+"']");if(n.html()==null){n=g().find("input:[Title='"+q.childColumn+"']");n.attr("readonly","readonly");r=false}var p=g().find("select:[Title='"+q.parentColumn+"']");if(p.html()==null){p=g().find("input:[Title='"+q.parentColumn+"']");p.attr("readonly","readonly");p.bind("focus",function(){var s=p.parent().find("#_Select");a(s,n,r,q);s.trigger("change")});p.parent().find("img").click();p.blur()}else{a(p,n,r,q);p.trigger("change")}};function a(p,r,q,o){var t;var n=false;var s="";p.bind("change",function(){var u=null;q?u=r.find("option:selected").val():u=r.attr("value");t=p.find("option:selected").text();g().SPServices({operation:"GetListItems",async:false,webURL:o.relationshipWebURL,listName:o.relationshipList,CAMLQuery:"<Query><Where><Eq><FieldRef Name='"+o.relationshipListParentColumn+"'/><Value Type='Text'>"+t+"</Value></Eq></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='"+o.relationshipListParentColumn+"' /><FieldRef Name='"+o.relationshipListChildColumn+"' /></ViewFields>",CAMLRowLimit:"<RowLimit>0</RowLimit>",completefunc:function(w,v){if(q){r.attr({length:0}).append("<option value='0'>Choose "+o.childColumn+"...</option>")}else{s="(None)|0";r.attr("value","")}g(w.responseXML).find("z\\:row").each(function(){if(q){var x=(g(this).attr("ows_ID")==u)?" selected='selected'":"";r.append("<option"+x+" value='"+g(this).attr("ows_ID")+"'>"+g(this).attr("ows_"+o.relationshipListChildColumn)+"</option>")}else{if(g(this).attr("ows_"+o.relationshipListChildColumn)==u){r.attr("value",u)}s=s+"|"+g(this).attr("ows_"+o.relationshipListChildColumn)+"|"+g(this).attr("ows_ID")}});r.attr("choices",s)}});if(q){r.trigger("change")}else{if(n){p.blur();r.parent().find("img").click();r.blur()}}if(p.css("display")!="none"){n=true}})}g.fn.SPServices.SPDisplayRelatedInfo=function(n){var o=g.extend({},{columnName:"",relatedWebURL:"",relatedList:"",relatedListColumn:"",relatedColumns:[],displayFormat:"table",headerCSSClass:"ms-vh2",rowCSSClass:"ms-vb"},n);var p=g().find("select:[Title='"+o.columnName+"']");if(p.html()==null){p=g().find("input:[Title='"+o.columnName+"']");p.attr("readonly","readonly");p.bind("focus",function(){var q=p.parent().find("#_Select");k(q,o)});p.parent().find("img").click();p.blur()}else{k(p,o);p.trigger("change")}};function k(p,o){var n;p.parent().append("<div id=showRelated_"+j(o.columnName)+"></div>");p.bind("change",function(){n=p.find("option:selected").text();var r=[];g().SPServices({operation:"GetList",async:false,webURL:o.relatedWebURL,listName:o.relatedList,completefunc:function(t,s){g(t.responseXML).find("Fields").each(function(){g(t.responseXML).find("Field").each(function(){for(i=0;i<o.relatedColumns.length;i++){if(g(this).attr("Name")==o.relatedColumns[i]){r[i]=g(this)}}})})}});var q=" ";for(i=0;i<o.relatedColumns.length;i++){q+="<FieldRef Name='"+o.relatedColumns[i]+"' />"}g().SPServices({operation:"GetListItems",async:false,webURL:o.relatedWebURL,listName:o.relatedList,CAMLQuery:"<Query><Where><Eq><FieldRef Name='"+o.relatedListColumn+"'/><Value Type='Text'>"+n+"</Value></Eq></Where></Query>",CAMLViewFields:"<ViewFields>"+q+"</ViewFields>",CAMLRowLimit:"<RowLimit>0</RowLimit>",completefunc:function(u,t){switch(o.displayFormat){case"table":var s="<table>";s+="<tr>";for(i=0;i<o.relatedColumns.length;i++){s+="<th class='"+o.headerCSSClass+"'>"+r[i].attr("DisplayName")+"</th>"}s+="</tr>";g(u.responseXML).find("z\\:row").each(function(){s+="<tr>";for(i=0;i<o.relatedColumns.length;i++){s+="<td class='"+o.rowCSSClass+"'>"+f(r[i],g(this).attr("ows_"+o.relatedColumns[i]),o)+"</td>"}s+="</tr>"});s+="</table>";g("#showRelated_"+j(o.columnName)).html("").append(s);break;default:break}}})})}g.fn.SPServices.SPDebugXMLHttpResult=function(o){var q=g.extend({},{node:null,outputId:"",indent:0},o);var s=3;var r=4;var n="";n+="<table class='ms-vb' style='margin-left:"+q.indent*3+"px;' width='100%'>";if(q.node.nodeName=="DisplayPattern"){n+="<tr><td width='100px' style='font-weight:bold;'>"+q.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+q.node.xml+"</textarea></td></tr>"}else{if(!q.node.hasChildNodes()){n+="<tr><td width='100px' style='font-weight:bold;'>"+q.node.nodeName+"</td><td>"+((q.node.nodeValue!=null)?b(q.node.nodeValue):"&nbsp;")+"</td></tr>";if(q.node.attributes){n+="<tr><td colspan='99'>";n+=h(q.node,q);n+="</td></tr>"}}else{if(q.node.hasChildNodes()&&q.node.firstChild.nodeType==r){n+="<tr><td width='100px' style='font-weight:bold;'>"+q.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+q.node.parentNode.text+"</textarea></td></tr>"}else{if(q.node.hasChildNodes()&&q.node.firstChild.nodeType==s){n+="<tr><td width='100px' style='font-weight:bold;'>"+q.node.nodeName+"</td><td>"+b(q.node.firstChild.nodeValue)+"</td></tr>"}else{n+="<tr><td width='100px' style='font-weight:bold;' colspan='99'>"+q.node.nodeName+"</td></tr>";if(q.node.attributes){n+="<tr><td colspan='99'>";n+=h(q.node,q);n+="</td></tr>"}n+="<tr><td>";for(var p=0;p<q.node.childNodes.length;p++){n+=g().SPServices.SPDebugXMLHttpResult({node:q.node.childNodes.item(p),outputId:q.outputId,indent:q.indent+1})}n+="</td></tr>"}}}}n+="</table>";return n};g.fn.SPServices.SPGetCurrentUser=function(){var n="";g.ajax({async:false,url:"/_layouts/userdisp.aspx?Force=True",complete:function(p,o){g(p.responseText).find("table.ms-formtable td#SPFieldText").each(function(){if(/FieldInternalName=\"Name\"/.test(g(this).html())){n=g(this).text()}})}});return n.replace(/(^[\s\xA0]+|[\s\xA0]+$)/g,"")};g.fn.SPServices.SPLookupAddNew=function(o){var p=g.extend({},{lookupColumn:"",promptText:"Add new {0}"},o);var q="";var n="";g().SPServices({operation:"GetList",async:false,listName:d(),completefunc:function(s,r){g(s.responseXML).find("Field").each(function(){if(g(this).attr("DisplayName")==p.lookupColumn){g().SPServices({operation:"GetList",async:false,listName:g(this).attr("List"),completefunc:function(u,t){g(u.responseXML).find("List").each(function(){n=g(this).attr("WebFullUrl")})}});g().SPServices({operation:"GetFormCollection",async:false,listName:g(this).attr("List"),completefunc:function(u,t){g(u.responseXML).find("Form").each(function(){if(g(this).attr("Type")=="NewForm"){q=g(this).attr("Url")}})}})}})}});if(q.length>0){newLink="<a href='"+n+"/"+q+"?Source="+location.href+"'>"+p.promptText.replace(/\{0\}/g,p.lookupColumn)+"</a>";g("select[title="+p.lookupColumn+"]").parents("td.ms-formbody").append(newLink)}};g.fn.SPServices.SPGetLastItemId=function(n){var p=g.extend({},{webURL:"",listName:"",userAccount:""},n);var o;var q=0;g().SPServices({operation:"GetUserInfo",async:false,userLoginName:(p.userAccount!="")?p.userAccount:g().SPServices.SPGetCurrentUser(),completefunc:function(s,r){g(s.responseXML).find("User").each(function(){o=g(this).attr("ID")})}});g().SPServices({operation:"GetListItems",async:false,webURL:p.webURL,listName:p.listName,CAMLQuery:"<Query><Where><Eq><FieldRef Name='Author' LookupId='TRUE'/><Value Type='Integer'>"+o+"</Value></Eq></Where><OrderBy><FieldRef Name='Created_x0020_Date' Ascending='FALSE'/></OrderBy></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='ID'/></ViewFields>",CAMLRowLimit:"<RowLimit>1</RowLimit>",completefunc:function(s,r){g(s.responseXML).find("z\\:row").each(function(){q=g(this).attr("ows_ID")})}});return q};g.fn.SPServices.SPRequireUnique=function(p){var q=g.extend({},{columnStaticName:"Title",duplicateAction:0,ignoreCase:"false",initMsg:"This value must be unique.",initMsgCSSClass:"ms-vb",errMsg:"This value is not unique.",errMsgCSSClass:"ms-formvalidation"},p);var u="<span id='SPRequireUnique' class='{0}'>{1}<br/></span>";var n=u.replace(/\{0\}/g,q.initMsgCSSClass).replace(/\{1\}/g,q.initMsg);var t=u.replace(/\{0\}/g,q.errMsgCSSClass).replace(/\{1\}/g,q.errMsg);var s=d();var r=g().SPServices.SPGetDisplayFromStatic({listName:s,columnStaticName:q.columnStaticName});var o=g("input:[Title='"+r+"']");g(o).parent().append(n);g(o).change(function(){var w=0;var y=g(this).attr("value");g().SPServices({operation:"GetListItems",async:false,listName:d(),CAMLViewFields:"<ViewFields><FieldRef Name='"+r+"' /></ViewFields>",completefunc:function(B,z){var A=q.ignoreCase?y.toUpperCase():y;g(B.responseXML).find("z\\:row").each(function(){var C=q.ignoreCase?g(this).attr("ows_"+q.columnStaticName).toUpperCase():g(this).attr("ows_"+q.columnStaticName);if(A==C){w++}})}});var v=n;var x="";if(w>0){v=t;x="disabled";if(q.duplicateAction==1){g("input:[Title='"+r+"']").focus()}}g("span#SPRequireUnique").html(v);g("input:[value='OK']").attr("disabled",x)})};g.fn.SPServices.SPGetDisplayFromStatic=function(n){var p=g.extend({},{webURL:"",listName:"",columnStaticName:""},n);var o="";g().SPServices({operation:"GetList",async:false,webURL:p.webURL,listName:p.listName,completefunc:function(r,q){g(r.responseXML).find("Field").each(function(){if(g(this).attr("StaticName")==p.columnStaticName){displayName=g(this).attr("DisplayName")}})}});return displayName};g.fn.SPServices.SPRedirectWithID=function(x){var n=g.extend({},{redirectUrl:""},x);var u=d();var t=new Object();var s=location.search.substring(1,location.search.length);var r=s.split("&");for(var p=0;p<r.length;p++){var v=r[p].split("=");var w=unescape(v[1]).split("+");v[1]=w.join(" ");t[v[0]]=v[1]}var q=t.ID;if(t.ID==undefined){q=g().SPServices.SPGetLastItemId({listName:u});g().find("form[name='aspnetForm']").each(function(){var z="Source="+t.Source.replace(/\//g,"%2f").replace(/:/g,"%3a");var y=location.href.substring(0,location.href.indexOf("?"));var A=y+"?Source="+y+"?ID="+q+"%26RealSource="+t.Source+((t.RedirectURL!=undefined)?("%26RedirectURL="+t.RedirectURL):"");g(this).attr("action",A)})}else{while(t.ID==q){q=g().SPServices.SPGetLastItemId({listName:u})}var o=(t.RedirectURL==undefined)?n.redirectUrl:t.RedirectURL;location.href=o+"?ID="+q+"&Source="+t.RealSource}};function f(r,q,p){if(q==undefined){return""}var n=q;switch(r.attr("Type")){case"Text":n=q;break;case"URL":n="<img alt='"+q.substring(q.search(",")+1)+"' src='"+q.substring(0,q.search(","))+"'/>";break;case"Number":n=parseFloat(q).toFixed(r.attr("Decimals")).toString();break;case"Lookup":var o;g().SPServices({operation:"GetFormCollection",async:false,listName:r.attr("List"),completefunc:function(t,s){g(t.responseXML).find("Form").each(function(){if(g(this).attr("Type")=="DisplayForm"){o=g(this).attr("Url")}})}});n="<a href='"+p.relatedWebURL+"/"+o+"?ID="+q.substring(0,q.search(";#"))+"&RootFolder=*'>"+q.substring(q.search(";#")+2)+"</a>";break;case"Counter":n=q;break;default:break}return n}function h(q,p){var n="<table class='ms-vb' width='100%'>";for(var o=0;o<q.attributes.length;o++){n+="<tr><td width='10px' style='font-weight:bold;'>"+o+"</td><td width='100px'>"+q.attributes.item(o).nodeName+"</td><td>"+b(q.attributes.item(o).nodeValue)+"</td></tr>"}n+="</table>";return n}function d(){var n=g().SPServices.SPGetCurrentSite();var p=location.href.replace(n,"").replace("/Lists/","");var o=p.substr(0,p.search("/"));return o}function b(n){return((n.indexOf("http")==0)||(n.indexOf("/")==0))?"<a href='"+n+"'>"+n+"</a>":n}function l(n){return n.replace(/"/g,"&quot;").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function j(n){return n.replace(/ /g,"_x0020_")}function c(p,o){return"<"+p+">"+o+"</"+p+">"}})(jQuery);