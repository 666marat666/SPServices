/*
 * SPServices - Work with SharePoint's Web Services using jQuery
 * Version 0.4.8
 * @requires jQuery v1.3.2
 *
 * Copyright (c) 2009 Sympraxis Consulting LLC
 * Examples and docs at:
 * http://spservices.codeplex.com
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/mit-license.php
 */
/**
 * @description Work with SharePoint's Web Services using jQuery
 * @type jQuery
 * @name SPServices
 * @category Plugins/SPServices
 * @author Sympraxis Consulting LLC/marc.anderson@sympraxisconsulting.com
 */
(function(e){var f="";var u=new Array();u.Alerts="Alerts";u.Authentication="Authentication";u.Copy="Copy";u.Forms="Forms";u.Lists="Lists";u.Meetings="Meetings";u.Permissions="Permissions";u.PublishedLinksService="PublishedLinksService";u.Search="Search";u.usergroup="usergroup";u.UserProfileService="UserProfileService";u.Views="Views";u.Versions="Versions";u.WebPartPages="WebPartPages";u.Webs="Webs";u.Workflow="Workflow";var b=new Array();b.GetAlerts=u.Alerts;b.DeleteAlerts=u.Alerts;b.Mode=u.Authentication;b.Login=u.Authentication;b.CopyIntoItemsLocal=u.Copy;b.GetForm=u.Forms;b.GetFormCollection=u.Forms;b.AddList=u.Lists;b.CheckInFile=u.Lists;b.CheckOutFile=u.Lists;b.DeleteList=u.Lists;b.GetAttachmentCollection=u.Lists;b.GetList=u.Lists;b.GetListAndView=u.Lists;b.GetListCollection=u.Lists;b.GetListContentType=u.Lists;b.GetListContentTypes=u.Lists;b.GetListItems=u.Lists;b.UpdateList=u.Lists;b.UpdateListItems=u.Lists;b.AddMeeting=u.Meetings;b.CreateWorkspace=u.Meetings;b.RemoveMeeting=u.Meetings;b.SetWorkSpaceTitle=u.Meetings;b.GetPermissionCollection=u.Permissions;b.GetLinks=u.PublishedLinksService;b.GetPortalSearchInfo=u.Search;b.GetSearchMetadata=u.Search;b.Query=u.Search;b.Status=u.Search;b.AddGroup=u.usergroup;b.AddGroupToRole=u.usergroup;b.AddRole=u.usergroup;b.GetAllUserCollectionFromWeb=u.usergroup;b.GetGroupCollection=u.usergroup;b.GetGroupCollectionFromRole=u.usergroup;b.GetGroupCollectionFromSite=u.usergroup;b.GetGroupCollectionFromUser=u.usergroup;b.GetGroupCollectionFromWeb=u.usergroup;b.GetGroupInfo=u.usergroup;b.GetRoleCollection=u.usergroup;b.GetRoleCollectionFromGroup=u.usergroup;b.GetRoleCollectionFromUser=u.usergroup;b.GetRoleCollectionFromWeb=u.usergroup;b.GetRolesAndPermissionsForCurrentUser=u.usergroup;b.GetRolesAndPermissionsForSite=u.usergroup;b.GetUserCollection=u.usergroup;b.GetUserCollectionFromGroup=u.usergroup;b.GetUserCollectionFromRole=u.usergroup;b.GetUserCollectionFromSite=u.usergroup;b.GetUserCollectionFromWeb=u.usergroup;b.GetUserInfo=u.usergroup;b.GetUserLoginFromEmail=u.usergroup;b.RemoveGroup=u.usergroup;b.GetCommonMemberships=u.UserProfileService;b.GetUserColleagues=u.UserProfileService;b.GetUserLinks=u.UserProfileService;b.GetUserMemberships=u.UserProfileService;b.GetUserPinnedLinks=u.UserProfileService;b.GetUserProfileByName=u.UserProfileService;b.GetUserProfileCount=u.UserProfileService;b.GetUserProfileSchema=u.UserProfileService;b.GetViewCollection=u.Views;b.DeleteAllVersions=u.Versions;b.DeleteVersion=u.Versions;b.GetVersions=u.Versions;b.RestoreVersion=u.Versions;b.GetWebPart2=u.WebPartPages;b.GetWebPartPage=u.WebPartPages;b.GetWebPartProperties=u.WebPartPages;b.GetWebPartProperties2=u.WebPartPages;b.GetListTemplates=u.Webs;b.GetWeb=u.Webs;b.GetWebCollection=u.Webs;b.GetAllSubWebCollection=u.Webs;b.WebUrlFromPageUrl=u.Webs;b.GetTemplatesForItem=u.Workflow;b.GetToDosForItem=u.Workflow;b.GetWorkflowDataForItem=u.Workflow;b.GetWorkflowTaskData=u.Workflow;b.StartWorkflow=u.Workflow;var l=new Object();l.header="<soap:Envelope xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body>";l.footer="</soap:Body></soap:Envelope>";l.payload="";e.fn.SPServices=function(A){var B=e.extend({},e.fn.SPServices.defaults,A);l.opheader="<"+B.operation+" ";switch(b[B.operation]){case u.Alerts:l.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/2002/1/alerts/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/2002/1/alerts/";break;case u.Meetings:l.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/meetings/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/meetings/";break;case u.Permissions:l.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/directory/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/directory/";break;case u.PublishedLinksService:l.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/' >";SOAPAction="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/";break;case u.Search:l.opheader+="xmlns='urn:Microsoft.Search' >";SOAPAction="urn:Microsoft.Search/";break;case u.usergroup:l.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/directory/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/directory/";break;case u.UserProfileService:l.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/UserProfileService' >";SOAPAction="http://microsoft.com/webservices/SharePointPortalServer/UserProfileService/";break;case u.WebPartPages:l.opheader+="xmlns='http://microsoft.com/sharepoint/webpartpages' >";SOAPAction="http://microsoft.com/sharepoint/webpartpages/";break;case u.Workflow:l.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/workflow/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/workflow/";break;default:l.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/'>";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/";break}SOAPAction+=B.operation;l.opfooter="</"+B.operation+">";var C=((B.webURL.length>0)?B.webURL:e().SPServices.SPGetCurrentSite())+"/_vti_bin/"+b[B.operation]+".asmx";l.payload="";switch(B.operation){case"GetAlerts":break;case"DeleteAlerts":l.payload+="<IDs>";for(i=0;i<B.IDs.length;i++){l.payload+=g("string",B.IDs[i])}l.payload+="</IDs>";break;case"Mode":break;case"Login":l.payload+=g("username",B.username);l.payload+=g("password",B.password);break;case"CopyIntoItemsLocal":l.payload+=g("SourceUrl",B.SourceUrl);l.payload+="<DestinationUrls>";for(i=0;i<B.DestinationUrls.length;i++){l.payload+=g("string",B.DestinationUrls[i])}l.payload+="</DestinationUrls>";break;case"GetForm":l.payload+=g("listName",B.listName);l.payload+=g("formUrl",B.formUrl);break;case"GetFormCollection":l.payload+=g("listName",B.listName);break;case"AddList":l.payload+=g("listName",B.listName);l.payload+=g("description",B.description);l.payload+=g("templateID",B.templateID);break;case"CheckInFile":l.payload+=g("pageUrl",B.pageUrl);l.payload+=g("comment",B.comment);l.payload+=g("CheckinType",B.CheckinType);break;case"CheckOutFile":l.payload+=g("pageUrl",B.pageUrl);l.payload+=g("checkoutToLocal",B.checkoutToLocal);l.payload+=g("lastmodified",B.lastmodified);break;case"DeleteList":l.payload+=g("listName",B.listName);break;case"GetAttachmentCollection":l.payload+=g("listName",B.listName);l.payload+=g("listItemID",B.ID);break;case"GetList":l.payload+=g("listName",B.listName);break;case"GetListAndView":l.payload+=g("listName",B.listName);l.payload+=g("viewName",B.viewName);break;case"GetListCollection":break;case"GetListContentType":l.payload+=g("listName",B.listName);l.payload+=g("contentTypeId",B.contentTypeId);break;case"GetListContentTypes":l.payload+=g("listName",B.listName);break;case"GetListItems":l.payload+=g("listName",B.listName);l.payload+=g("viewFields",B.CAMLViewFields);l.payload+=g("query",B.CAMLQuery);l.payload+=g("rowLimit",B.CAMLRowLimit);l.payload+=g("queryOptions",B.CAMLQueryOptions);break;case"UpdateList":l.payload+=g("listName",B.listName);l.payload+=g("listProperties",B.listProperties);l.payload+=g("newFields",B.newFields);l.payload+=g("updateFields",B.updateFields);l.payload+=g("deleteFields",B.deleteFields);l.payload+=g("listVersion",B.listVersion);break;case"UpdateListItems":l.payload+=g("listName",B.listName);if(B.updates.length>0){l.payload+=g("updates",B.updates)}else{l.payload+="<updates><Batch OnError='Continue'><Method ID='1' Cmd='"+B.batchCmd+"'>";for(i=0;i<B.valuepairs.length;i++){l.payload+="<Field Name='"+B.valuepairs[i][0]+"'>"+B.valuepairs[i][1]+"</Field>"}l.payload+="<Field Name='ID'>"+B.ID+"</Field>";l.payload+="</Method></Batch></updates>"}break;case"AddMeeting":l.payload+=g("organizerEmail",B.organizerEmail);l.payload+=g("uid",B.uid);l.payload+=g("sequence",B.sequence);l.payload+=g("utcDateStamp",B.utcDateStamp);l.payload+=g("title",B.title);l.payload+=g("location",B.location);l.payload+=g("utcDateStart",B.utcDateStart);l.payload+=g("utcDateEnd",B.utcDateEnd);l.payload+=g("nonGregorian",B.nonGregorian);break;case"CreateWorkspace":l.payload+=g("title",B.title);l.payload+=g("templateName",B.templateName);l.payload+=g("lcid",B.lcid);l.payload+=g("timeZoneInformation",B.timeZoneInformation);case"RemoveMeeting":l.payload+=g("recurrenceId",B.recurrenceId);l.payload+=g("uid",B.uid);l.payload+=g("sequence",B.sequence);l.payload+=g("utcDateStamp",B.utcDateStamp);l.payload+=g("cancelMeeting",B.cancelMeeting);case"SetWorkspaceTitle":l.payload+=g("title",B.title);case"GetPermissionCollection":l.payload+=g("objectName",B.objectName);l.payload+=g("objectType",B.objectType);break;case"GetLinks":break;case"GetPortalSearchInfo":SOAPAction="http://microsoft.com/webservices/OfficeServer/QueryService/"+B.operation;l.opheader="<"+B.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'/>";break;case"GetSearchMetadata":SOAPAction="http://microsoft.com/webservices/OfficeServer/QueryService/"+B.operation;l.opheader="<"+B.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'/>";break;case"Query":l.payload+=g("queryXml",p(B.queryXml));break;case"Status":break;case"AddGroup":l.payload+=g("groupName",B.groupName);l.payload+=g("ownerIdentifier",B.ownerIdentifier);l.payload+=g("ownerType",B.ownerType);l.payload+=g("defaultUserLoginName",B.defaultUserLoginName);l.payload+=g("groupName",B.groupName);l.payload+=g("description",B.description);break;case"AddGroupToRole":l.payload+=g("groupName",B.groupName);l.payload+=g("roleName",B.roleName);break;case"AddRole":l.payload+=g("roleName",B.roleName);l.payload+=g("description",B.description);l.payload+=g("permissionMask",B.permissionMask);break;case"GetAllUserCollectionFromWeb":break;case"GetGroupCollectionFromRole":l.payload+=g("roleName",B.roleName);break;case"GetGroupCollection":l.payload+=g("groupNamesXml",B.groupNamesXml);break;case"GetGroupCollectionFromSite":break;case"GetGroupCollectionFromUser":l.payload+=g("userLoginName",B.userLoginName);break;case"GetGroupCollectionFromWeb":break;case"GetGroupInfo":l.payload+=g("groupName",B.groupName);break;case"GetRoleCollection":l.payload+=g("roleNamesXml",B.roleNamesXml);break;case"GetRoleCollectionFromGroup":l.payload+=g("groupName",B.groupName);break;case"GetRoleCollectionFromUser":l.payload+=g("userLoginName",B.userLoginName);break;case"GetRoleCollectionFromWeb":break;case"GetRoleInfo":l.payload+=g("roleName",B.roleName);break;case"GetRolesAndPermissionsForCurrentUser":break;case"GetRolesAndPermissionsForSite":break;case"GetUserCollection":l.payload+=g("userLoginNamesXml",B.userLoginNamesXml);break;case"GetUserCollectionFromGroup":l.payload+=g("groupName",B.groupName);break;case"GetUserCollectionFromRole":l.payload+=g("roleName",B.roleName);break;case"GetUserCollectionFromSite":break;case"GetUserCollectionFromWeb":break;case"GetUserInfo":l.payload+=g("userLoginName",B.userLoginName);break;case"GetUserLoginFromEmail":l.payload+=g("emailXml",B.emailXml);break;case"RemoveGroup":l.payload+=g("groupName",B.groupName);break;case"GetCommonMemberships":l.payload+=g("accountName",B.accountName);break;case"GetUserColleagues":l.payload+=g("accountName",B.accountName);break;case"GetUserLinks":l.payload+=g("accountName",B.accountName);break;case"GetUserMemberships":l.payload+=g("accountName",B.accountName);break;case"GetUserPinnedLinks":l.payload+=g("accountName",B.accountName);break;case"GetUserProfileByName":if(B.accountName.length>0){l.payload+=g("AccountName",B.accountName)}else{l.payload+=g("AccountName",B.AccountName)}break;case"GetUserProfileCount":break;case"GetUserProfileSchema":break;case"GetViewCollection":l.payload+=g("listName",B.listName);break;case"DeleteAllVersions":l.payload+=g("fileName",B.fileName);break;case"DeleteVersion":l.payload+=g("fileName",B.fileName);l.payload+=g("fileVersion",B.fileVersion);break;case"GetVersions":l.payload+=g("fileName",B.fileName);break;case"RestoreVersion":l.payload+=g("fileName",B.fileName);l.payload+=g("fileVersion",B.fileVersion);break;case"GetWebPart2":l.payload+=g("pageUrl",B.pageUrl);l.payload+=g("storageKey",B.storageKey);l.payload+=g("storage",B.storage);l.payload+=g("behavior",B.behavior);break;case"GetWebPartPage":l.payload+=g("documentName",B.documentName);l.payload+=g("behavior",B.behavior);break;case"GetWebPartProperties":l.payload+=g("pageUrl",B.pageUrl);l.payload+=g("storage",B.storage);break;case"GetWebPartProperties2":l.payload+=g("pageUrl",B.pageUrl);l.payload+=g("storage",B.storage);l.payload+=g("behavior",B.behavior);break;case"GetWeb":l.payload+=g("webUrl",B.webURL);break;case"GetListTemplates":break;case"GetWebCollection":break;case"GetAllSubWebCollection":break;case"WebUrlFromPageUrl":l.payload+=g("pageUrl",B.pageURL);break;case"GetTemplatesForItem":l.payload+=g("item",B.item);break;case"GetToDosForItem":l.payload+=g("item",B.item);break;case"GetWorkflowDataForItem":l.payload+=g("item",B.item);break;case"GetWorkflowTaskData":l.payload+=g("item",B.item);l.payload+=g("listId",B.listId);l.payload+=g("taskId",B.taskId);break;case"StartWorkflow":l.payload+=g("item",B.item);l.payload+=g("templateId",B.templateId);l.payload+=g("workflowParameters",B.workflowParameters);break;default:break}var D=l.header+l.opheader+l.payload+l.opfooter+l.footer;e.ajax({url:C,async:B.async,beforeSend:function(E){E.setRequestHeader("SOAPAction",SOAPAction)},type:"POST",data:D,dataType:"xml",contentType:"text/xml; charset='utf-8'",complete:B.completefunc})};e.fn.SPServices.defaults={operation:"",webURL:"",pageURL:"",listName:"",description:"",templateID:"",viewName:"",formUrl:"",fileName:"",fileVersion:"",ID:1,updates:"",comment:"",CheckinType:"",checkoutToLocal:"",lastmodified:"",CAMLViewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:0,CAMLQueryOptions:"<QueryOptions></QueryOptions>",batchCmd:"Update",valuepairs:[],listProperties:"",newFields:"",updateFields:"",deleteFields:"",listVersion:"",contentTypeId:"",username:"",password:"",accountName:"",AccountName:"",userLoginName:"",groupNamesXml:"",groupName:"",ownerIdentifier:"",ownerType:"",defaultUserLoginName:"",roleNamesXml:"",roleName:"",permissionMask:"",userLoginNamesXml:"",emailXml:"",objectName:"",objectType:"List",IDs:null,SourceUrl:"",DestinationUrls:[],documentName:"",behavior:"Version3",storageKey:"",storage:"Shared",item:"",listId:"",taskId:"",templateId:"",workflowParameters:"",fClaim:false,queryXml:"",cancelMeeting:true,lcid:"",location:"",nonGregorian:false,organizerEmail:"",recurrenceId:0,sequence:0,templateName:"",timeZoneInformation:"",title:"",uid:"",utcDateStamp:"",utcDateStart:"",utcDateEnd:"",async:true,completefunc:null};e.fn.SPServices.SPGetCurrentSite=function(){if(f.length>0){return f}var A=l.header+"<WebUrlFromPageUrl xmlns='http://schemas.microsoft.com/sharepoint/soap/' ><pageUrl>"+((location.href.indexOf("?")>0)?location.href.substr(0,location.href.indexOf("?")):location.href)+"</pageUrl></WebUrlFromPageUrl>"+l.footer;e.ajax({async:false,url:"/_vti_bin/Webs.asmx",beforeSend:function(B){B.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/WebUrlFromPageUrl")},type:"POST",data:A,dataType:"xml",contentType:'text/xml; charset="utf-8"',complete:function(C,B){f=e(C.responseXML).find("WebUrlFromPageUrlResult").text()}});return f};e.fn.SPServices.SPCascadeDropdowns=function(A){var C=e.extend({},{relationshipWebURL:"",relationshipList:"",relationshipListParentColumn:"",relationshipListChildColumn:"",relationshipListSortColumn:"",parentColumn:"",childColumn:"",CAMLQuery:"",promptText:"Choose {0}...",completefunc:null,debug:false},A);var B=new j(C.parentColumn);if(B.Obj.html()==null&&C.debug){h("SPServices.SPCascadeDropdowns","parentColumn: "+C.parentColumn,"Column not found on page");return}switch(B.Type){case"S":B.Obj.bind("change",function(){x(C)});B.Obj.change();break;case"C":B.Obj.bind("propertychange",function(){x(C)});B.Obj.trigger("propertychange");break;case"M":B.Obj.bind("dblclick",function(){x(C)});parentSelections=B.Obj.closest("span").find("select:[Title='"+C.parentColumn+" selected values']");parentSelections.bind("dblclick",function(){x(C)});B.Obj.closest("span").find("button").each(function(){e(this).bind("click",function(){x(C)})});x(C);break;default:break}};function x(D){var M="";var H=null;var G=[];var C;var I;var J;var K;var F=new j(D.parentColumn);switch(F.Type){case"S":G.push(F.Obj.find("option:selected").text());break;case"C":G.push(F.Obj.attr("value"));break;case"M":parentSelections=F.Obj.closest("span").find("select:[Title='"+D.parentColumn+" selected values']");e(parentSelections).find("option").each(function(){G.push(e(this).html())});break;default:break}if(F.Obj.attr("cascadeDropdownSelected_"+D.childColumn)==G.join(";#")){return}F.Obj.attr("cascadeDropdownSelected_"+D.childColumn,G.join(";#"));var B=new j(D.childColumn);if(B.Obj.html()==null&&D.debug){h("SPServices.SPCascadeDropdowns","childColumn: "+D.childColumn,"Column not found on page");return}switch(B.Type){case"S":H=B.Obj.find("option:selected").val();break;case"C":H=B.Obj.attr("value");break;case"M":I=B.Obj.closest("span").find("input:[name$='MultiLookupPicker$data']");C=window[B.Obj.closest("tr").find("button:[id$='AddButton']").attr("id").replace(/AddButton/,"MultiLookupPicker_m")];currentSelection=B.Obj.closest("span").find("select:[Title='"+D.childColumn+" selected values']");C.data="";break;default:break}var E=(D.relationshipListSortColumn.length>0)?D.relationshipListSortColumn:D.relationshipListChildColumn;var A="<Query><OrderBy><FieldRef Name='"+E+"'/></OrderBy><Where>";if(D.CAMLQuery.length>0){A+="<And>"}if(G.length==0){A+="<Eq><FieldRef Name='"+D.relationshipListParentColumn+"'/><Value Type='Text'></Value></Eq>"}else{if(G.length==1){A+="<Eq><FieldRef Name='"+D.relationshipListParentColumn+"'/><Value Type='Text'>"+m(G[0])+"</Value></Eq>"}else{var L=(G.length>2)?true:false;for(i=0;i<(G.length-1);i++){A+="<Or>"}for(i=0;i<G.length;i++){A+="<Eq><FieldRef Name='"+D.relationshipListParentColumn+"'/><Value Type='Text'>"+m(G[i])+"</Value></Eq>";if(i>0&&(i<(G.length-1))&&L){A+="</Or>"}}A+="</Or>"}}if(D.CAMLQuery.length>0){A+=D.CAMLQuery+"</And>"}A+="</Where></Query>";e().SPServices({operation:"GetList",async:false,listName:t(),completefunc:function(O,N){e(O.responseXML).find("Fields").each(function(){e(O.responseXML).find("Field").each(function(){if(e(this).attr("Name")==D.childColumn){K=(e(this).attr("Required")=="TRUE")?true:false}})})}});e().SPServices({operation:"GetListItems",async:false,webURL:D.relationshipWebURL,listName:D.relationshipList,CAMLQuery:A,CAMLViewFields:"<ViewFields><FieldRef Name='"+D.relationshipListParentColumn+"' /><FieldRef Name='"+D.relationshipListChildColumn+"' /></ViewFields>",CAMLRowLimit:0,completefunc:function(O,N){e(O.responseXML).find("faultcode").each(function(){if(D.debug){h("SPServices.SPCascadeDropdowns","relationshipListParentColumn: "+D.relationshipListParentColumn+" or relationshipListChildColumn: "+D.relationshipListChildColumn,"Not found in relationshipList "+D.relationshipList)}return});switch(B.Type){case"S":B.Obj.attr({length:0});if(!K&&D.promptText.length>0){B.Obj.append("<option value='0'>"+D.promptText.replace(/\{0\}/g,D.childColumn)+"</option>")}break;case"C":M=K?"":"(None)|0";B.Obj.attr("value","");break;case"M":B.Obj.attr({length:0});J="";break;default:break}e(O.responseXML).find("[nodeName=z:row]").each(function(){var Q=(e(this).attr("ows_"+D.relationshipListChildColumn).indexOf(";#")>0)?e(this).attr("ows_"+D.relationshipListChildColumn).split(";#")[0]:e(this).attr("ows_ID");var P=(e(this).attr("ows_"+D.relationshipListChildColumn).indexOf(";#")>0)?e(this).attr("ows_"+D.relationshipListChildColumn).split(";#")[1]:e(this).attr("ows_"+D.relationshipListChildColumn);switch(B.Type){case"S":var R=(e(this).attr("ows_ID")==H)?" selected='selected'":"";B.Obj.append("<option"+R+" value='"+Q+"'>"+P+"</option>");break;case"C":if(P==H){B.Obj.attr("value",H)}M=M+((M.length>0)?"|":"")+P+"|"+Q;break;case"M":B.Obj.append("<option value='"+Q+"'>"+P+"</option>");J+=Q+"|t"+P+"|t |t |t";break;default:break}});switch(B.Type){case"S":B.Obj.trigger("change");break;case"C":B.Obj.attr("choices",M);B.Obj.trigger("propertychange");break;case"M":I.attr("value",J);e(currentSelection).find("option").each(function(){var P=e(this);e(this).attr("selected","selected");e(B.Obj).find("option").each(function(){if(e(this).html()==P.html()){P.attr("selected","")}})});GipRemoveSelectedItems(C);e(B.Obj).find("option").each(function(){var P=e(this);e(currentSelection).find("option").each(function(){if(e(this).html()==P.html()){P.remove()}})});GipAddSelectedItems(C);C.data=GipGetGroupData(J);break;default:break}}});if(D.completefunc!=null){D.completefunc()}}e.fn.SPServices.SPDisplayRelatedInfo=function(A){var B=e.extend({},{columnName:"",relatedWebURL:"",relatedList:"",relatedListColumn:"",relatedColumns:[],displayFormat:"table",headerCSSClass:"ms-vh2",rowCSSClass:"ms-vb",CAMLQuery:"",numChars:0,matchType:"Eq",completefunc:null,debug:false},A);var C=new j(B.columnName);if(C.Obj.html()==null&&B.debug){h("SPServices.SPDisplayRelatedInfo","columnName: "+B.columnName,"Column not found on page");return}switch(C.Type){case"S":C.Obj.bind("change",function(){z(B)});C.Obj.change();break;case"C":C.Obj.bind("propertychange",function(){z(B)});C.Obj.trigger("propertychange");break;case"M":if(B.debug){h("SPServices.SPDisplayRelatedInfo","columnName: "+B.columnName,"Multi-select columns not supported by this function")}break;default:break}};function z(F){var B=null;var G=new j(F.columnName);switch(G.Type){case"S":B=G.Obj.find("option:selected").text();break;case"C":B=G.Obj.attr("value");if(F.numChars>0&&B.length<F.numChars){return}break;case"M":break;default:break}if(G.Obj.attr("showRelatedSelected")==B){return}G.Obj.attr("showRelatedSelected",B);var D="showRelated_"+v(F.columnName);e("#"+D).remove();G.Obj.parent().append("<div id="+D+"></div>");var E=[];e().SPServices({operation:"GetList",async:false,webURL:F.relatedWebURL,listName:F.relatedList,completefunc:function(I,H){e(I.responseXML).find("faultcode").each(function(){if(F.debug){h("SPServices.SPDisplayRelatedInfo","relatedList: "+F.relatedList,"List not found")}return});e(I.responseXML).find("Fields").each(function(){e(I.responseXML).find("Field").each(function(){for(i=0;i<F.relatedColumns.length;i++){if(e(this).attr("Name")==F.relatedColumns[i]){E[i]=e(this)}}})})}});var A="<Query><Where>";if(F.CAMLQuery.length>0){A+="<And>"}A+="<"+F.matchType+"><FieldRef Name='"+F.relatedListColumn+"'/><Value Type='Text'>"+m(B)+"</Value></"+F.matchType+">";if(F.CAMLQuery.length>0){A+=F.CAMLQuery+"</And>"}A+="</Where></Query>";var C=" ";for(i=0;i<F.relatedColumns.length;i++){C+="<FieldRef Name='"+F.relatedColumns[i]+"' />"}e().SPServices({operation:"GetListItems",async:false,webURL:F.relatedWebURL,listName:F.relatedList,CAMLQuery:A,CAMLViewFields:"<ViewFields>"+C+"</ViewFields>",CAMLRowLimit:0,completefunc:function(J,I){e(J.responseXML).find("faultcode").each(function(){if(F.debug){h("SPServices.SPDisplayRelatedInfo","relatedListColumn: "+F.relatedListColumn,"Column not found in relatedList "+F.relatedList)}return});switch(F.displayFormat){case"table":var H="<table>";H+="<tr>";for(i=0;i<F.relatedColumns.length;i++){if(E[i]==undefined&&F.debug){h("SPServices.SPDisplayRelatedInfo","columnName: "+F.relatedColumns[i],"Column not found in relatedList");return}H+="<th class='"+F.headerCSSClass+"'>"+E[i].attr("DisplayName")+"</th>"}H+="</tr>";e(J.responseXML).find("[nodeName=z:row]").each(function(){H+="<tr>";for(i=0;i<F.relatedColumns.length;i++){H+="<td class='"+F.rowCSSClass+"'>"+w(E[i],e(this).attr("ows_"+F.relatedColumns[i]),F)+"</td>"}H+="</tr>"});H+="</table>";e("#showRelated_"+v(F.columnName)).html("").append(H);break;case"list":var H="<table>";for(i=0;i<F.relatedColumns.length;i++){e(J.responseXML).find("[nodeName=z:row]").each(function(){H+="<tr>";H+="<th class='"+F.headerCSSClass+"'>"+E[i].attr("DisplayName")+"</th>";H+="<td class='"+F.rowCSSClass+"'>"+w(E[i],e(this).attr("ows_"+F.relatedColumns[i]),F)+"</td>";H+="</tr>"})}H+="</table>";e("#showRelated_"+v(F.columnName)).html("").append(H);break;default:break}}});if(F.completefunc!=null){F.completefunc()}}e.fn.SPServices.SPDebugXMLHttpResult=function(B){var D=e.extend({},{node:null,indent:0},B);var F=3;var E=4;var A="";A+="<table class='ms-vb' style='margin-left:"+D.indent*3+"px;' width='100%'>";if(D.node.nodeName=="DisplayPattern"){A+="<tr><td width='100px' style='font-weight:bold;'>"+D.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+D.node.xml+"</textarea></td></tr>"}else{if(!D.node.hasChildNodes()){A+="<tr><td width='100px' style='font-weight:bold;'>"+D.node.nodeName+"</td><td>"+((D.node.nodeValue!=null)?r(D.node.nodeValue):"&nbsp;")+"</td></tr>";if(D.node.attributes){A+="<tr><td colspan='99'>";A+=a(D.node,D);A+="</td></tr>"}}else{if(D.node.hasChildNodes()&&D.node.firstChild.nodeType==E){A+="<tr><td width='100px' style='font-weight:bold;'>"+D.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+D.node.parentNode.text+"</textarea></td></tr>"}else{if(D.node.hasChildNodes()&&D.node.firstChild.nodeType==F){A+="<tr><td width='100px' style='font-weight:bold;'>"+D.node.nodeName+"</td><td>"+r(D.node.firstChild.nodeValue)+"</td></tr>"}else{A+="<tr><td width='100px' style='font-weight:bold;' colspan='99'>"+D.node.nodeName+"</td></tr>";if(D.node.attributes){A+="<tr><td colspan='99'>";A+=a(D.node,D);A+="</td></tr>"}A+="<tr><td>";for(var C=0;C<D.node.childNodes.length;C++){A+=e().SPServices.SPDebugXMLHttpResult({node:D.node.childNodes.item(C),indent:D.indent+1})}A+="</td></tr>"}}}}A+="</table>";return A};e.fn.SPServices.SPGetCurrentUser=function(){var A="";e.ajax({async:false,url:"/_layouts/userdisp.aspx?Force=True",complete:function(C,B){e(C.responseText).find("table.ms-formtable td#SPFieldText").each(function(){if(/FieldInternalName=\"Name\"/.test(e(this).html())){A=e(this).text()}})}});return A.replace(/(^[\s\xA0]+|[\s\xA0]+$)/g,"")};e.fn.SPServices.SPLookupAddNew=function(C){var D=e.extend({},{lookupColumn:"",promptText:"Add new {0}",completefunc:null,debug:false},C);var B=new j(D.lookupColumn);if(B.Obj.html()==null&&D.debug){h("SPServices.SPLookupAddNew","lookupColumn: "+D.lookupColumn,"Column not found on page");return}var E="";var A="";e().SPServices({operation:"GetList",async:false,listName:t(),completefunc:function(G,F){e(G.responseXML).find("Field").each(function(){if(e(this).attr("DisplayName")==D.lookupColumn){e().SPServices({operation:"GetList",async:false,listName:e(this).attr("List"),completefunc:function(I,H){e(I.responseXML).find("List").each(function(){A=e(this).attr("WebFullUrl")})}});e().SPServices({operation:"GetFormCollection",async:false,listName:e(this).attr("List"),completefunc:function(I,H){e(I.responseXML).find("Form").each(function(){if(e(this).attr("Type")=="NewForm"){E=e(this).attr("Url")}})}})}})}});if(A.length==0&&D.debug){h("SPServices.SPLookupAddNew","lookupColumn: "+D.lookupColumn,"This column does not appear to be a lookup column");return}if(E.length>0){newLink="<a href='"+A+"/"+E+"?Source="+o(location.href)+"'>"+D.promptText.replace(/\{0\}/g,D.lookupColumn)+"</a>";e(B.Obj).parents("td.ms-formbody").append(newLink)}else{if(D.debug){h("SPServices.SPLookupAddNew","lookupColumn: "+D.lookupColumn,"NewForm cannot be found");return}}if(D.completefunc!=null){D.completefunc()}};e.fn.SPServices.SPGetLastItemId=function(B){var D=e.extend({},{webURL:"",listName:"",userAccount:"",CAMLQuery:""},B);var C;var E=0;e().SPServices({operation:"GetUserInfo",async:false,userLoginName:(D.userAccount!="")?D.userAccount:e().SPServices.SPGetCurrentUser(),completefunc:function(G,F){e(G.responseXML).find("User").each(function(){C=e(this).attr("ID")})}});var A="<Query><Where>";if(D.CAMLQuery.length>0){A+="<And>"}A+="<Eq><FieldRef Name='Author' LookupId='TRUE'/><Value Type='Integer'>"+C+"</Value></Eq>";if(D.CAMLQuery.length>0){A+=D.CAMLQuery+"</And>"}A+="</Where><OrderBy><FieldRef Name='Created_x0020_Date' Ascending='FALSE'/></OrderBy></Query>";e().SPServices({operation:"GetListItems",async:false,webURL:D.webURL,listName:D.listName,CAMLQuery:A,CAMLViewFields:"<ViewFields><FieldRef Name='ID'/></ViewFields>",CAMLRowLimit:1,completefunc:function(G,F){e(G.responseXML).find("[nodeName=z:row]").each(function(){E=e(this).attr("ows_ID")})}});return E};e.fn.SPServices.SPRequireUnique=function(C){var D=e.extend({},{columnStaticName:"Title",duplicateAction:0,ignoreCase:"false",initMsg:"This value must be unique.",initMsgCSSClass:"ms-vb",errMsg:"This value is not unique.",errMsgCSSClass:"ms-formvalidation",completefunc:null},C);var H="<span id='SPRequireUnique"+D.columnStaticName+"' class='{0}'>{1}<br/></span>";var A=H.replace(/\{0\}/g,D.initMsgCSSClass).replace(/\{1\}/g,D.initMsg);var G=H.replace(/\{0\}/g,D.errMsgCSSClass).replace(/\{1\}/g,D.errMsg);var F=t();var E=e().SPServices.SPGetDisplayFromStatic({listName:F,columnStaticName:D.columnStaticName});var B=e("input:[Title='"+E+"']");e(B).parent().append(A);e(B).change(function(){var J=0;var K=e(this).attr("value");e().SPServices({operation:"GetListItems",async:false,listName:t(),CAMLViewFields:"<ViewFields><FieldRef Name='"+E+"' /></ViewFields>",CAMLRowLimit:0,completefunc:function(N,L){var M=D.ignoreCase?K.toUpperCase():K;e(N.responseXML).find("[nodeName=z:row]").each(function(){var O=D.ignoreCase?e(this).attr("ows_"+D.columnStaticName).toUpperCase():e(this).attr("ows_"+D.columnStaticName);if(M==O){J++}})}});var I=A;e("input:[value='OK']").attr("disabled","");if(J>0){I=G;if(D.duplicateAction==1){e("input:[Title='"+D.columnDisplayName+"']").focus();e("input:[value='OK']").attr("disabled","disabled")}}e("span#SPRequireUnique"+D.columnStaticName).html(I)});if(D.completefunc!=null){D.completefunc()}};e.fn.SPServices.SPGetDisplayFromStatic=function(A){var C=e.extend({},{webURL:"",listName:"",columnStaticName:""},A);var B="";e().SPServices({operation:"GetList",async:false,webURL:C.webURL,listName:C.listName,completefunc:function(E,D){e(E.responseXML).find("Field").each(function(){if(e(this).attr("StaticName")==C.columnStaticName){displayName=e(this).attr("DisplayName")}})}});return displayName};e.fn.SPServices.SPRedirectWithID=function(B){var C=e.extend({},{redirectUrl:""},B);var D=t();var E=n();var F=E.ID;if(E.ID==undefined){F=e().SPServices.SPGetLastItemId({listName:D});e().find("form[name='aspnetForm']").each(function(){var G=(location.href.indexOf("?")>0)?location.href.substring(0,location.href.indexOf("?")):location.href;var H=(typeof E.Source=="string")?"Source="+E.Source.replace(/\//g,"%2f").replace(/:/g,"%3a"):"";var I=G+"?Source="+G+"?ID="+F+((H.length>0)?("%26RealSource="+E.Source):"")+((typeof E.RedirectURL=="string")?("%26RedirectURL="+E.RedirectURL):"");e(this).attr("action",I)})}else{while(E.ID==F){F=e().SPServices.SPGetLastItemId({listName:D})}var A=(typeof E.RedirectURL=="string")?E.RedirectURL:C.redirectUrl;location.href=A+"?ID="+F+((typeof E.RealSource=="string")?("&Source="+E.RealSource):"")}};e.fn.SPServices.SPSetMultiSelectSizes=function(E){var F=e.extend({},{multiSelectColumn:""},E);var H=e().find("select:[Title='"+F.multiSelectColumn+" possible values']");var B=H.closest("span").find("select:[Title*=' selected values']");var G="SPSetMultiSelectSizes_"+v(F.multiSelectColumn);H.clone().appendTo(H.closest("span")).css({width:"auto",height:0,visibility:"hidden"}).attr({id:G,length:0});var D=e("#"+G);H.find("option").each(function(){D.append("<option value='"+e(this).html()+"'>"+e(this).html()+"</option>")});B.find("option").each(function(){D.append("<option value='"+e(this).html()+"'>"+e(this).html()+"</option>")});var A=e("#"+G).width()+5;var C=A-17;H.css("width",C+"px").parent().css("width",A+"px");B.css("width",C+"px").parent().css("width",A+"px");e("#"+G).remove()};e.fn.SPServices.SPScriptAudit=function(B){var C=e.extend({},{webURL:"",listName:"",outputId:"",auditForms:true,auditViews:true,auditPages:true,auditPagesListName:"Pages",showHiddenLists:false,showNoScript:false,showSrc:true},B);var A=["Display","Edit","New"];var D;e("#"+C.outputId).append("<table id='SPScriptAudit' width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1><tr><th></th><th>List</th><th>Page Class</th><th>Page Type</th><th>Page</th>"+(C.showSrc?"<th>Script in the Page</th><th>Script in a Web Part</th>":"")+"<th>jQuery</th></tr></table>");e("#SPScriptAudit th").attr("class","ms-vh2-nofilter");if(C.auditForms||C.auditViews){e().SPServices({operation:"GetListCollection",webURL:C.webURL,async:false,completefunc:function(F,E){e(F.responseXML).find("Lists").each(function(){e(this).find("List").each(function(){D=e(this);if((C.showHiddenLists&&D.attr("Hidden")=="False")||!C.showHiddenLists){if(C.auditForms){e().SPServices({operation:"GetListContentTypes",webURL:C.webURL,listName:D.attr("ID"),async:false,completefunc:function(H,G){e(H.responseXML).find("ContentType").each(function(){if(e(this).attr("ID").substring(0,6)!="0x0120"){e(this).find("FormUrls").each(function(){for(var I=0;I<A.length;I++){e(this).find(A[I]).each(function(){s(C,D,"Form",A[I],((C.webURL.length>0)?C.webURL:e().SPServices.SPGetCurrentSite())+"/"+e(this).text())})}})}})}})}if(C.auditViews){e().SPServices({operation:"GetViewCollection",webURL:C.webURL,listName:D.attr("ID"),async:false,completefunc:function(H,G){e(H.responseXML).find("View").each(function(){s(C,D,"View",e(this).attr("DisplayName"),e(this).attr("Url"))})}})}}})})}})}if(C.auditPages){e().SPServices({operation:"GetList",async:false,webURL:C.webURL,listName:C.auditPagesListName,completefunc:function(F,E){e(F.responseXML).find("List").each(function(){D=e(this)})}});e().SPServices({operation:"GetListItems",async:false,webURL:C.webURL,listName:C.auditPagesListName,CAMLQuery:"<Query><Where><Neq><FieldRef Name='ContentType'/><Value Type='Text'>Folder</Value></Neq></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='Title'/><FieldRef Name='FileRef'/></ViewFields>",CAMLRowLimit:0,completefunc:function(F,E){e(F.responseXML).find("[nodeName=z:row]").each(function(){var H=e(this).attr("ows_FileRef").split(";#")[1];var G=(e(this).attr("ows_Title")!=undefined)?e(this).attr("ows_Title"):"";if(H.indexOf(".aspx")>0){s(C,D,"Page",G,"/"+H)}})}})}e("#SPScriptAudit tr[class='ms-alternating']:even").attr("class","")};function s(A,C,M,G,E){var K=0;var L=0;var D=new Object();D.type=[];D.src=[];D.script=[];var F=new Object();F.type=[];F.src=[];F.script=[];var B="$(";var H=RegExp("<head[\\s\\S]*?/head>","gi");var J=RegExp("<script[\\s\\S]*?/script>","gi");var I;e.ajax({type:"GET",url:E,dataType:"text",success:function(O){headHtml=H.exec(O);while(scriptMatch=J.exec(headHtml)){var R=c(scriptMatch,"language");var T=c(scriptMatch,"type");var N=c(scriptMatch,"src");if(N!=null&&N.length>0&&!d(N)){F.type.push((R!=null&&R.length>0)?R:T);F.src.push(N)}var V=scriptMatch.innerHTML;if(V!=undefined&&V.indexOf(B)>-1){F.script.push(scriptMatch.innerHTML);K++}}e(O).find("script").each(function(){if(e(this).closest("td[id^='MSOZoneCell_WebPartWP']").html()==null){if((e(this).attr("src")!=undefined)&&(e(this).attr("src").length>0)&&!d(e(this).attr("src"))){F.type.push(e(this).attr("language").length>0?e(this).attr("language"):e(this).attr("type"));F.src.push(e(this).attr("src"))}if(e(this).html().indexOf(B)>-1){F.script.push(e(this).html());K++}}else{if(e(this).attr("src")!=undefined&&e(this).attr("src").length>0){D.type.push(e(this).attr("language").length>0?e(this).attr("language"):e(this).attr("type"));D.src.push(e(this).attr("src"))}if(e(this).html().indexOf(B)>-1){D.script.push(e(this).html());L++}}});if((!A.showNoScript&&(D.type.length>0||F.type.length>0))||A.showNoScript){var S=E.substring(0,E.lastIndexOf("/")+1);var P="<tr class=ms-alternating><td class=ms-vb-icon><a href='"+C.attr("DefaultViewUrl")+"'><IMG border=0 src='"+C.attr("ImageUrl")+"'width=16 height=16></A></TD><td class=ms-vb2><a href='"+C.attr("DefaultViewUrl")+"'>"+C.attr("Title")+((C.attr("Hidden")=="True")?"(Hidden)":"")+"</td><td class=ms-vb2>"+M+"</td><td class=ms-vb2>"+G+"</td><td class=ms-vb2><a href='"+E+"'>"+y(E)+"</td>";if(A.showSrc){P+="<td valign='top'><table width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1>";for(var Q=0;Q<F.type.length;Q++){var U=(F.src[Q].substr(0,1)!="/")?S+F.src[Q]:F.src[Q];P+="<tr><td class=ms-vb2 width='30%'>"+F.type[Q]+"</td>";P+="<td class=ms-vb2 width='70%'><a href='"+U+"'>"+y(F.src[Q])+"</td></tr>"}if(K>0){for(var Q=0;Q<F.script.length;Q++){P+="<tr><td class=ms-vb2 colspan=99><textarea class=ms-vb2 readonly='readonly' rows='5' cols='50'>"+F.script[Q]+"</textarea></td></tr>"}}P+="</table></td>";P+="<td valign='top'><table width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1>";for(var Q=0;Q<D.type.length;Q++){var U=(D.src[Q].substr(0,1)!="/")?S+D.src[Q]:D.src[Q];P+="<tr><td class=ms-vb2 width='30%'>"+D.type[Q]+"</td>";P+="<td class=ms-vb2 width='70%'><a href='"+U+"'>"+y(D.src[Q])+"</td></tr>"}if(L>0){for(var Q=0;Q<D.script.length;Q++){P+="<tr><td class=ms-vb2 colspan=99><textarea class=ms-vb2 readonly='readonly' rows='5' cols='50'>"+D.script[Q]+"</textarea></td></tr>"}}P+="</table></td>"}P+="<td class=ms-vb2>"+(((K+L)>0)?"Yes":"No")+"</td></tr>";e("#SPScriptAudit").append(P)}}})}function c(C,B){var A=RegExp(B+"=(\"([^\"]*)\")|('([^']*)')","gi");if(matches=A.exec(C)){return matches[2]}return null}function d(C){var B=["WebResource.axd","_layouts"];for(var A=0;A<B.length;A++){if(C.indexOf(B[A])>-1){return true}}return false}function w(F,E,D){if(E==undefined){return""}var A;switch(F.attr("Type")){case"Text":A=E;break;case"URL":switch(F.attr("Format")){case"Hyperlink":A="<a href='"+E.substring(0,E.search(","))+"'>"+E.substring(E.search(",")+1)+"</a>";break;case"Image":A="<img alt='"+E.substring(E.search(",")+1)+"' src='"+E.substring(0,E.search(","))+"'/>";break;default:A=E;break}break;case"User":A="<a href='/_layouts/userdisp.aspx?ID="+E.substring(0,E.search(";#"))+"&Source="+o(location.href)+"'>"+E.substring(E.search(";#")+2)+"</a>";break;case"Calculated":var B=E.split(";#");A=B[1];break;case"Number":A=parseFloat(E).toFixed(F.attr("Decimals")).toString();break;case"Lookup":var C;e().SPServices({operation:"GetFormCollection",async:false,listName:F.attr("List"),completefunc:function(H,G){e(H.responseXML).find("Form").each(function(){if(e(this).attr("Type")=="DisplayForm"){C=e(this).attr("Url")}})}});A="<a href='"+D.relatedWebURL+"/"+C+"?ID="+E.substring(0,E.search(";#"))+"&RootFolder=*'>"+E.substring(E.search(";#")+2)+"</a>";break;case"Counter":A=E;break;default:A=E;break}return A}function a(D,C){var A="<table class='ms-vb' width='100%'>";for(var B=0;B<D.attributes.length;B++){A+="<tr><td width='10px' style='font-weight:bold;'>"+B+"</td><td width='100px'>"+D.attributes.item(B).nodeName+"</td><td>"+r(D.attributes.item(B).nodeValue)+"</td></tr>"}A+="</table>";return A}function t(){var C=location.href;var B=C.substring(0,C.indexOf(".aspx"));var D=k(B.substring(0,B.lastIndexOf("/")));var A="";e().SPServices({operation:"GetListCollection",async:false,completefunc:function(F,E){e(F.responseXML).find("List").each(function(){var G=e(this).attr("DefaultViewUrl");var H=G.substring(0,G.lastIndexOf("/"));if(D.indexOf(H)>0){A=e(this).attr("ID")}})}});return A}function j(A){if((this.Obj=e().find("select:[Title='"+A+"']")).html()!=null){this.Type="S"}else{if((this.Obj=e().find("input:[Title='"+A+"']")).html()!=null){this.Type="C"}else{if((this.Obj=e().find("select:[Title='"+A+" possible values']")).html()!=null){this.Type="M"}else{this.Type=null}}}}function h(B,D,C){var A="<b>Error in function</b><br/>"+B+"<br/><b>Parameter</b><br/>"+D+"<br/><b>Message</b><br/>"+C+"<br/><br/><span style='width=100%;text-align:right;'>Click to continue</span></div>";q(A)}function q(F){var C="position:absolute;width:300px;height:150px;padding:10px;background-color:#000000;color:#ffffff;z-index:30;font-family:'Arial';font-size:12px;display:none;";e().find("#aspnetForm").parent().append("<div id='SPServices_msgBox' style="+C+">"+F);var A=e("#SPServices_msgBox").height();var E=e("#SPServices_msgBox").width();var D=(e(window).width()/2)-(E/2)+"px";var B=(e(window).height()/2)-(A/2)-100+"px";e("#SPServices_msgBox").css({border:"5px #C02000 solid",left:D,top:B}).show().fadeTo("slow",0.75).click(function(){e(this).fadeOut("3000",function(){e(this).remove()})})}function n(){var E=new Object();var A=location.search.substring(1,location.search.length);var C=A.split("&");for(var D=0;D<C.length;D++){var F=C[D].split("=");var B=unescape(F[1]).split("+");F[1]=B.join(" ");E[F[0]]=F[1]}return E}function r(A){return((A.indexOf("http")==0)||(A.indexOf("/")==0))?"<a href='"+A+"'>"+A+"</a>":A}function y(A){return A.substring(A.lastIndexOf("/")+1,A.length)}function p(A){return A.replace(/"/g,"&quot;").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function m(A){return A.replace(/&/g,"&amp;")}function k(A){return A.replace(/%20/g," ")}function o(A){return A.replace(/&/g,"%26")}function v(A){return A.replace(/ /g,"_x0020_")}function g(B,A){return"<"+B+">"+A+"</"+B+">"}})(jQuery);