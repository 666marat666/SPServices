(function(d){var c=new Array();c["GetAlerts"]="Alerts";c["DeleteAlerts"]="Alerts";c["Mode"]="Authentication";c["Login"]="Authentication";c["GetForm"]="Forms";c["GetFormCollection"]="Forms";c["GetAttachmentCollection"]="Lists";c["GetList"]="Lists";c["GetListCollection"]="Lists";c["GetListItems"]="Lists";c["UpdateListItems"]="Lists";c["GetPermissionCollection"]="Permissions";c["GetUserInfo"]="usergroup";c["GetViewCollection"]="Views";c["DeleteAllVersions"]="Versions";c["DeleteVersion"]="Versions";c["GetVersions"]="Versions";c["RestoreVersion"]="Versions";c["GetWebPart2"]="WebPartPages";c["GetWebPartPage"]="WebPartPages";c["GetWebPartProperties2"]="WebPartPages";c["GetWeb"]="Webs";c["GetWebCollection"]="Webs";c["GetAllSubWebCollection"]="Webs";c["WebUrlFromPageUrl"]="Webs";var b=new Object();b.header="<soap:Envelope xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body>";b.footer="</soap:Body></soap:Envelope>";b.payload="";d.fn.SPServices=function(k){var a=d.extend({},d.fn.SPServices.defaults,k);switch(c[a.operation]){case"Alerts":b.opheader="<"+a.operation+" xmlns='http://schemas.microsoft.com/sharepoint/soap/2002/1/alerts/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/2002/1/alerts/"+a.operation;break;case"Permissions":b.opheader="<"+a.operation+" xmlns='http://schemas.microsoft.com/sharepoint/soap/directory/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/directory/"+a.operation;break;case"usergroup":b.opheader="<"+a.operation+" xmlns='http://schemas.microsoft.com/sharepoint/soap/directory/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/directory/"+a.operation;break;case"WebPartPages":b.opheader="<"+a.operation+" xmlns='http://microsoft.com/sharepoint/webpartpages' >";SOAPAction="http://microsoft.com/sharepoint/webpartpages/"+a.operation;break;default:b.opheader="<"+a.operation+" xmlns='http://schemas.microsoft.com/sharepoint/soap/'>";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/"+a.operation;break}b.opfooter="</"+a.operation+">";ajaxURL=((a.webURL!="")?a.webURL:d().SPServices.SPGetCurrentSite())+"/_0/"+c[a.operation]+".asmx";b.payload="";switch(a.operation){case"GetAlerts":break;case"DeleteAlerts":b.payload+="<IDs>";for(i=0;i<a.IDs.length;i++){b.payload+="<string>"+a.IDs[i]+"</string>"}b.payload+="</IDs>";break;case"Mode":break;case"Login":b.payload+="<username>"+a.username+"</username>";b.payload+="<password>"+a.password+"</password>";break;case"GetForm":b.payload+="<listName>"+a.listName+"</listName>";b.payload+="<formUrl>"+a.formUrl+"</formUrl>";break;case"GetFormCollection":b.payload+="<listName>"+a.listName+"</listName>";break;case"GetAttachmentCollection":b.payload+="<listName>"+a.listName+"</listName>";b.payload+="<listItemID>"+a.ID+"</listItemID>";break;case"GetList":b.payload+="<listName>"+a.listName+"</listName>";break;case"GetListCollection":break;case"GetListItems":b.payload+="<listName>"+a.listName+"</listName>";b.payload+="<viewFields>"+a.CAMLViewFields+"</viewFields>";b.payload+="<query>"+a.CAMLQuery+"</query>";b.payload+="<rowLimit>"+a.CAMLRowLimit+"</rowLimit>";b.payload+="<queryOptions>"+a.CAMLQueryOptions+"</queryOptions>";break;case"UpdateListItems":b.payload+="<listName>"+a.listName+"</listName>";b.payload+="<updates><Batch OnError='Continue'><Method ID='1' Cmd='Update'>";for(i=0;i<a.valuepairs.length;i++){b.payload+="<Field Name='"+a.valuepairs[i][0]+"'>"+a.valuepairs[i][1]+"</Field>"}b.payload+="<Field Name='ID'>"+a.ID+"</Field>";b.payload+="</Method></Batch></updates>";break;case"GetPermissionCollection":b.payload+="<objectName>"+a.objectName+"</objectName>";b.payload+="<objectType>"+a.objectType+"</objectType>";break;case"GetUserInfo":b.payload+="<userLoginName>"+a.userLoginName+"</userLoginName>";break;case"GetViewCollection":b.payload+="<listName>"+a.listName+"</listName>";break;case"DeleteAllVersions":b.payload+="<fileName>"+a.fileName+"</fileName>";break;case"DeleteVersion":b.payload+="<fileName>"+a.fileName+"</fileName>";b.payload+="<fileVersion>"+a.fileVersion+"</fileVersion>";break;case"GetVersions":b.payload+="<fileName>"+a.fileName+"</fileName>";break;case"RestoreVersion":b.payload+="<fileName>"+a.fileName+"</fileName>";b.payload+="<fileVersion>"+a.fileVersion+"</fileVersion>";break;case"GetWebPart2":b.payload+="<pageUrl>"+a.pageUrl+"</pageUrl>";b.payload+="<storageKey>"+a.storageKey+"</storageKey>";b.payload+="<storage>"+a.storage+"</storage>";b.payload+="<behavior>"+a.behavior+"</behavior>";break;case"GetWebPartPage":b.payload+="<documentName>"+a.documentName+"</documentName>";b.payload+="<behavior>"+a.behavior+"</behavior>";break;case"GetWebPartProperties2":b.payload+="<pageUrl>"+a.pageUrl+"</pageUrl>";b.payload+="<storage>"+a.storage+"</storage>";b.payload+="<behavior>"+a.behavior+"</behavior>";break;case"GetWeb":b.payload+="<webUrl>"+a.webURL+"</webUrl>";break;case"GetWebCollection":break;case"GetAllSubWebCollection":break;case"WebUrlFromPageUrl":b.payload+="<pageUrl>"+a.pageURL+"</pageUrl>";break;default:break}var f=b.header+b.opheader+b.payload+b.opfooter+b.footer;d.ajax({url:ajaxURL,async:a.async,beforeSend:function(g){g.setRequestHeader("SOAPAction",SOAPAction)},type:"POST",data:f,dataType:"xml",contentType:"text/xml; charset='utf-8'",complete:a.completefunc})};d.fn.SPServices.defaults={operation:"",webURL:"",pageURL:"",listName:"",formUrl:"",fileName:"",fileVersion:"",ID:1,CAMLViewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:"",CAMLQueryOptions:"<QueryOptions></QueryOptions>",valuepairs:[],username:"",password:"",userLoginName:"",objectName:"",objectType:"List",IDs:null,documentName:"",behavior:"Version3",storageKey:"",storage:"Shared",async:true,completefunc:null}d.fn.SPServices.SPGetCurrentSite=function(){var a="";var f=b.header+"<WebUrlFromPageUrl xmlns='http://schemas.microsoft.com/sharepoint/soap/' ><pageUrl>"+((location.href.indexOf("?")>0)?location.href.substr(0,location.href.indexOf("?")):location.href)+"</pageUrl></WebUrlFromPageUrl>"+b.footer;d.ajax({async:false,url:"/_0/Webs.asmx",beforeSend:function(g){g.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/WebUrlFromPageUrl")},type:"POST",data:f,dataType:"xml",contentType:"text/xml; charset=\"utf-8\"",complete:function(g,k){a=d(g.responseXML).find("WebUrlFromPageUrlResult").text()}});return a};d.fn.SPServices.SPCascadeDropdowns=function(k){var a=d.extend({},{relationshipWebURL:"",relationshipList:"",relationshipListParentColumn:"",relationshipListChildColumn:"",parentColumn:"",childColumn:""},k);var f=true;var h=d().find("select:[Title='"+a.childColumn+"']");if(h.html()==null){h=d().find("input:[Title='"+a.childColumn+"']");h.attr("readonly","readonly");f=false}var e=d().find("select:[Title='"+a.parentColumn+"']");if(e.html()==null){e=d().find("input:[Title='"+a.parentColumn+"']");e.attr("readonly","readonly");e.bind("focus",function(){var g=e.parent().find("#_1");n(g,h,f,a);g.trigger("change")});e.parent().find("img").click();e.blur()}else{n(e,h,f,a);e.trigger("change")}};function n(h,e,l,j){var o;var p=false;var m="";h.bind("change",function(){var f=null;l?f=e.find("option:selected").val():f=e.attr("value");o=h.find("option:selected").text();d().SPServices({operation:"GetListItems",async:false,webURL:j.relationshipWebURL,listName:j.relationshipList,CAMLQuery:"<Query><Where><Eq><FieldRef Name='"+j.relationshipListParentColumn+"'/><Value Type='Text'>"+o+"</Value></Eq></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='"+j.relationshipListParentColumn+"' /><FieldRef Name='"+j.relationshipListChildColumn+"' /></ViewFields>",CAMLRowLimit:"<RowLimit>0</RowLimit>",completefunc:function(k,a){if(l){e.attr({length:0}).append("<option value='0'>Choose "+j.childColumn+"...</option>")}else{m="(None)|0";e.attr("value","")}d(k.responseXML).find("z\\:row").each(function(){if(l){var g=(d(this).attr("ows_ID")==f)?" selected='selected'":"";e.append("<option"+g+" value='"+d(this).attr("ows_ID")+"'>"+d(this).attr("ows_"+j.relationshipListChildColumn)+"</option>")}else{if(d(this).attr("ows_"+j.relationshipListChildColumn)==f)e.attr("value",f);m=m+"|"+d(this).attr("ows_"+j.relationshipListChildColumn)+"|"+d(this).attr("ows_ID")}});e.attr("choices",m)}});if(l)e.trigger("change");else if(p){h.blur();e.parent().find("img").click();e.blur()}if(h.css("display")!="none")p=true})}})(jQuery);