/*
 * SPServices - Work with SharePoint's Web Services using jQuery
 * Version 0.5.2
 * @requires jQuery v1.3.2 or greater
 *
 * Copyright (c) 2009 Sympraxis Consulting LLC
 * Examples and docs at:
 * http://spservices.codeplex.com
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/mit-license.php
 */
/**
 * @description Work with SharePoint's Web Services using jQuery
 * @type jQuery
 * @name SPServices
 * @category Plugins/SPServices
 * @author Sympraxis Consulting LLC/marc.anderson@sympraxisconsulting.com
 */
(function(C){var g="/";var l="Alerts";var k="Authentication";var o="Copy";var J="Forms";var m="Lists";var H="Meetings";var d="People";var b="Permissions";var p="PublishedLinksService";var w="Search";var I="usergroup";var F="UserProfileService";var Q="Versions";var h="Views";var B="WebPartPages";var n="Webs";var c="Workflow";var e="";var G=new Array();G.GetAlerts=l;G.DeleteAlerts=l;G.Mode=k;G.Login=k;G.CopyIntoItems=o;G.CopyIntoItemsLocal=o;G.GetItem=o;G.GetForm=J;G.GetFormCollection=J;G.AddList=m;G.CheckInFile=m;G.CheckOutFile=m;G.DeleteList=m;G.GetAttachmentCollection=m;G.GetList=m;G.GetListAndView=m;G.GetListCollection=m;G.GetListContentType=m;G.GetListContentTypes=m;G.GetListItems=m;G.UpdateList=m;G.UpdateListItems=m;G.AddMeeting=H;G.CreateWorkspace=H;G.RemoveMeeting=H;G.SetWorkSpaceTitle=H;G.SearchPrincipals=d;G.AddPermission=b;G.AddPermissionCollection=b;G.GetPermissionCollection=b;G.RemovePermission=b;G.RemovePermissionCollection=b;G.UpdatePermission=b;G.GetLinks=p;G.GetPortalSearchInfo=w;G.GetSearchMetadata=w;G.Query=w;G.Status=w;G.AddGroup=I;G.AddGroupToRole=I;G.AddRole=I;G.GetAllUserCollectionFromWeb=I;G.GetGroupCollection=I;G.GetGroupCollectionFromRole=I;G.GetGroupCollectionFromSite=I;G.GetGroupCollectionFromUser=I;G.GetGroupCollectionFromWeb=I;G.GetGroupInfo=I;G.GetRoleCollection=I;G.GetRoleCollectionFromGroup=I;G.GetRoleCollectionFromUser=I;G.GetRoleCollectionFromWeb=I;G.GetRolesAndPermissionsForCurrentUser=I;G.GetRolesAndPermissionsForSite=I;G.GetUserCollection=I;G.GetUserCollectionFromGroup=I;G.GetUserCollectionFromRole=I;G.GetUserCollectionFromSite=I;G.GetUserCollectionFromWeb=I;G.GetUserInfo=I;G.GetUserLoginFromEmail=I;G.RemoveGroup=I;G.GetCommonMemberships=F;G.GetUserColleagues=F;G.GetUserLinks=F;G.GetUserMemberships=F;G.GetUserPinnedLinks=F;G.GetUserProfileByName=F;G.GetUserProfileCount=F;G.GetUserProfileSchema=F;G.ModifyUserPropertyByAccountName=F;G.DeleteAllVersions=Q;G.DeleteVersion=Q;G.GetVersions=Q;G.RestoreVersion=Q;G.GetViewCollection=h;G.AddWebPart=B;G.GetWebPart2=B;G.GetWebPartPage=B;G.GetWebPartProperties=B;G.GetWebPartProperties2=B;G.GetListTemplates=n;G.GetWeb=n;G.GetWebCollection=n;G.GetAllSubWebCollection=n;G.WebUrlFromPageUrl=n;G.GetTemplatesForItem=c;G.GetToDosForItem=c;G.GetWorkflowDataForItem=c;G.GetWorkflowTaskData=c;G.StartWorkflow=c;var z=new Object();z.header="<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body>";z.footer="</soap:Body></soap:Envelope>";z.payload="";C.fn.SPServices=function(R){var S=C.extend({},C.fn.SPServices.defaults,R);z.opheader="<"+S.operation+" ";switch(G[S.operation]){case l:z.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/2002/1/alerts/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/2002/1/alerts/";break;case H:z.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/meetings/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/meetings/";break;case b:z.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/directory/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/directory/";break;case p:z.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/' >";SOAPAction="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/";break;case w:z.opheader+="xmlns='urn:Microsoft.Search' >";SOAPAction="urn:Microsoft.Search/";break;case I:z.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/directory/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/directory/";break;case F:z.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/UserProfileService' >";SOAPAction="http://microsoft.com/webservices/SharePointPortalServer/UserProfileService/";break;case B:z.opheader+="xmlns='http://microsoft.com/sharepoint/webpartpages' >";SOAPAction="http://microsoft.com/sharepoint/webpartpages/";break;case c:z.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/workflow/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/workflow/";break;default:z.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/'>";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/";break}SOAPAction+=S.operation;z.opfooter="</"+S.operation+">";var T=((S.webURL.length>0)?S.webURL:C().SPServices.SPGetCurrentSite())+"/_vti_bin/"+G[S.operation]+".asmx";z.payload="";switch(S.operation){case"GetAlerts":break;case"DeleteAlerts":z.payload+="<IDs>";for(i=0;i<S.IDs.length;i++){z.payload+=u("string",S.IDs[i])}z.payload+="</IDs>";break;case"Mode":break;case"Login":z.payload+=u("username",S.username);z.payload+=u("password",S.password);break;case"CopyIntoItems":z.payload+=u("SourceUrl",S.SourceUrl);z.payload+="<DestinationUrls>";for(i=0;i<S.DestinationUrls.length;i++){z.payload+=u("string",S.DestinationUrls[i])}z.payload+="</DestinationUrls>";z.payload+=u("Fields",S.Fields);z.payload+=u("Stream",S.Stream);z.payload+=u("Results",S.Results);break;case"CopyIntoItemsLocal":z.payload+=u("SourceUrl",S.SourceUrl);z.payload+="<DestinationUrls>";for(i=0;i<S.DestinationUrls.length;i++){z.payload+=u("string",S.DestinationUrls[i])}z.payload+="</DestinationUrls>";break;case"GetItem":z.payload+=u("Url",S.Url);z.payload+=u("Fields",S.Fields);z.payload+=u("Stream",S.Stream);break;case"GetForm":z.payload+=u("listName",S.listName);z.payload+=u("formUrl",S.formUrl);break;case"GetFormCollection":z.payload+=u("listName",S.listName);break;case"AddList":z.payload+=u("listName",S.listName);z.payload+=u("description",S.description);z.payload+=u("templateID",S.templateID);break;case"CheckInFile":z.payload+=u("pageUrl",S.pageUrl);z.payload+=u("comment",S.comment);z.payload+=u("CheckinType",S.CheckinType);break;case"CheckOutFile":z.payload+=u("pageUrl",S.pageUrl);z.payload+=u("checkoutToLocal",S.checkoutToLocal);z.payload+=u("lastmodified",S.lastmodified);break;case"DeleteList":z.payload+=u("listName",S.listName);break;case"GetAttachmentCollection":z.payload+=u("listName",S.listName);z.payload+=u("listItemID",S.ID);break;case"GetList":z.payload+=u("listName",S.listName);break;case"GetListAndView":z.payload+=u("listName",S.listName);z.payload+=u("viewName",S.viewName);break;case"GetListCollection":break;case"GetListContentType":z.payload+=u("listName",S.listName);z.payload+=u("contentTypeId",S.contentTypeId);break;case"GetListContentTypes":z.payload+=u("listName",S.listName);break;case"GetListItems":z.payload+=u("listName",S.listName);z.payload+=u("viewName",S.viewName);z.payload+=u("query",S.CAMLQuery);z.payload+=u("viewFields",S.CAMLViewFields);z.payload+=u("rowLimit",S.CAMLRowLimit);z.payload+=u("queryOptions",S.CAMLQueryOptions);break;case"UpdateList":z.payload+=u("listName",S.listName);z.payload+=u("listProperties",S.listProperties);z.payload+=u("newFields",S.newFields);z.payload+=u("updateFields",S.updateFields);z.payload+=u("deleteFields",S.deleteFields);z.payload+=u("listVersion",S.listVersion);break;case"UpdateListItems":z.payload+=u("listName",S.listName);if(S.updates.length>0){z.payload+=u("updates",S.updates)}else{z.payload+="<updates><Batch OnError='Continue'><Method ID='1' Cmd='"+S.batchCmd+"'>";for(i=0;i<S.valuepairs.length;i++){z.payload+="<Field Name='"+S.valuepairs[i][0]+"'>"+S.valuepairs[i][1]+"</Field>"}z.payload+="<Field Name='ID'>"+S.ID+"</Field>";z.payload+="</Method></Batch></updates>"}break;case"AddMeeting":z.payload+=u("organizerEmail",S.organizerEmail);z.payload+=u("uid",S.uid);z.payload+=u("sequence",S.sequence);z.payload+=u("utcDateStamp",S.utcDateStamp);z.payload+=u("title",S.title);z.payload+=u("location",S.location);z.payload+=u("utcDateStart",S.utcDateStart);z.payload+=u("utcDateEnd",S.utcDateEnd);z.payload+=u("nonGregorian",S.nonGregorian);break;case"CreateWorkspace":z.payload+=u("title",S.title);z.payload+=u("templateName",S.templateName);z.payload+=u("lcid",S.lcid);z.payload+=u("timeZoneInformation",S.timeZoneInformation);case"RemoveMeeting":z.payload+=u("recurrenceId",S.recurrenceId);z.payload+=u("uid",S.uid);z.payload+=u("sequence",S.sequence);z.payload+=u("utcDateStamp",S.utcDateStamp);z.payload+=u("cancelMeeting",S.cancelMeeting);case"SetWorkspaceTitle":z.payload+=u("title",S.title);case"SearchPrincipals":z.payload+=u("searchText",S.searchText);z.payload+=u("maxResults",S.maxResults);z.payload+=u("principalType",S.principalType);break;case"AddPermission":z.payload+=u("objectName",S.objectName);z.payload+=u("objectType",S.objectType);z.payload+=u("permissionIdentifier",S.permissionIdentifier);z.payload+=u("permissionType",S.permissionType);z.payload+=u("permissionMask",S.permissionMask);break;case"AddPermissionCollection":z.payload+=u("objectName",S.objectName);z.payload+=u("objectType",S.objectType);z.payload+=u("permissionsInfoXml",S.permissionsInfoXml);break;case"GetPermissionCollection":z.payload+=u("objectName",S.objectName);z.payload+=u("objectType",S.objectType);break;case"RemovePermission":z.payload+=u("objectName",S.objectName);z.payload+=u("objectType",S.objectType);z.payload+=u("permissionIdentifier",S.permissionIdentifier);z.payload+=u("permissionType",S.permissionType);break;case"RemovePermissionCollection":z.payload+=u("objectName",S.objectName);z.payload+=u("objectType",S.objectType);z.payload+=u("memberIdsXml",S.memberIdsXml);break;case"UpdatePermission":z.payload+=u("objectName",S.objectName);z.payload+=u("objectType",S.objectType);z.payload+=u("permissionIdentifier",S.permissionIdentifier);z.payload+=u("permissionType",S.permissionType);z.payload+=u("permissionMask",S.permissionMask);break;case"GetLinks":break;case"GetPortalSearchInfo":SOAPAction="http://microsoft.com/webservices/OfficeServer/QueryService/"+S.operation;z.opheader="<"+S.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'/>";break;case"GetSearchMetadata":SOAPAction="http://microsoft.com/webservices/OfficeServer/QueryService/"+S.operation;z.opheader="<"+S.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'/>";break;case"Query":z.payload+=u("queryXml",a(S.queryXml));break;case"Status":break;case"AddGroup":z.payload+=u("groupName",S.groupName);z.payload+=u("ownerIdentifier",S.ownerIdentifier);z.payload+=u("ownerType",S.ownerType);z.payload+=u("defaultUserLoginName",S.defaultUserLoginName);z.payload+=u("groupName",S.groupName);z.payload+=u("description",S.description);break;case"AddGroupToRole":z.payload+=u("groupName",S.groupName);z.payload+=u("roleName",S.roleName);break;case"AddRole":z.payload+=u("roleName",S.roleName);z.payload+=u("description",S.description);z.payload+=u("permissionMask",S.permissionMask);break;case"GetAllUserCollectionFromWeb":break;case"GetGroupCollectionFromRole":z.payload+=u("roleName",S.roleName);break;case"GetGroupCollection":z.payload+=u("groupNamesXml",S.groupNamesXml);break;case"GetGroupCollectionFromSite":break;case"GetGroupCollectionFromUser":z.payload+=u("userLoginName",S.userLoginName);break;case"GetGroupCollectionFromWeb":break;case"GetGroupInfo":z.payload+=u("groupName",S.groupName);break;case"GetRoleCollection":z.payload+=u("roleNamesXml",S.roleNamesXml);break;case"GetRoleCollectionFromGroup":z.payload+=u("groupName",S.groupName);break;case"GetRoleCollectionFromUser":z.payload+=u("userLoginName",S.userLoginName);break;case"GetRoleCollectionFromWeb":break;case"GetRoleInfo":z.payload+=u("roleName",S.roleName);break;case"GetRolesAndPermissionsForCurrentUser":break;case"GetRolesAndPermissionsForSite":break;case"GetUserCollection":z.payload+=u("userLoginNamesXml",S.userLoginNamesXml);break;case"GetUserCollectionFromGroup":z.payload+=u("groupName",S.groupName);break;case"GetUserCollectionFromRole":z.payload+=u("roleName",S.roleName);break;case"GetUserCollectionFromSite":break;case"GetUserCollectionFromWeb":break;case"GetUserInfo":z.payload+=u("userLoginName",S.userLoginName);break;case"GetUserLoginFromEmail":z.payload+=u("emailXml",S.emailXml);break;case"RemoveGroup":z.payload+=u("groupName",S.groupName);break;case"GetCommonMemberships":z.payload+=u("accountName",S.accountName);break;case"GetUserColleagues":z.payload+=u("accountName",S.accountName);break;case"GetUserLinks":z.payload+=u("accountName",S.accountName);break;case"GetUserMemberships":z.payload+=u("accountName",S.accountName);break;case"GetUserPinnedLinks":z.payload+=u("accountName",S.accountName);break;case"GetUserProfileByName":if(S.accountName.length>0){z.payload+=u("AccountName",S.accountName)}else{z.payload+=u("AccountName",S.AccountName)}break;case"GetUserProfileCount":break;case"GetUserProfileSchema":break;case"ModifyUserPropertyByAccountName":z.payload+=u("accountName",S.accountName);z.payload+=u("newData",S.newData);break;case"GetViewCollection":z.payload+=u("listName",S.listName);break;case"DeleteAllVersions":z.payload+=u("fileName",S.fileName);break;case"DeleteVersion":z.payload+=u("fileName",S.fileName);z.payload+=u("fileVersion",S.fileVersion);break;case"GetVersions":z.payload+=u("fileName",S.fileName);break;case"RestoreVersion":z.payload+=u("fileName",S.fileName);z.payload+=u("fileVersion",S.fileVersion);break;case"AddWebPart":z.payload+=u("pageUrl",S.pageUrl);z.payload+=u("webPartXml",S.webPartXml);z.payload+=u("storage",S.storage);break;case"GetWebPart2":z.payload+=u("pageUrl",S.pageUrl);z.payload+=u("storageKey",S.storageKey);z.payload+=u("storage",S.storage);z.payload+=u("behavior",S.behavior);break;case"GetWebPartPage":z.payload+=u("documentName",S.documentName);z.payload+=u("behavior",S.behavior);break;case"GetWebPartProperties":z.payload+=u("pageUrl",S.pageUrl);z.payload+=u("storage",S.storage);break;case"GetWebPartProperties2":z.payload+=u("pageUrl",S.pageUrl);z.payload+=u("storage",S.storage);z.payload+=u("behavior",S.behavior);break;case"GetWeb":z.payload+=u("webUrl",S.webURL);break;case"GetListTemplates":break;case"GetWebCollection":break;case"GetAllSubWebCollection":break;case"WebUrlFromPageUrl":z.payload+=u("pageUrl",S.pageURL);break;case"GetTemplatesForItem":z.payload+=u("item",S.item);break;case"GetToDosForItem":z.payload+=u("item",S.item);break;case"GetWorkflowDataForItem":z.payload+=u("item",S.item);break;case"GetWorkflowTaskData":z.payload+=u("item",S.item);z.payload+=u("listId",S.listId);z.payload+=u("taskId",S.taskId);break;case"StartWorkflow":z.payload+=u("item",S.item);z.payload+=u("templateId",S.templateId);z.payload+=u("workflowParameters",S.workflowParameters);break;default:break}var U=z.header+z.opheader+z.payload+z.opfooter+z.footer;C.ajax({url:T,async:S.async,beforeSend:function(V){V.setRequestHeader("SOAPAction",SOAPAction)},type:"POST",data:U,dataType:"xml",contentType:"text/xml; charset='utf-8'",complete:S.completefunc})};C.fn.SPServices.defaults={operation:"",webURL:"",pageURL:"",listName:"",description:"",templateID:"",viewName:"",formUrl:"",fileName:"",fileVersion:"",ID:1,updates:"",comment:"",CheckinType:"",checkoutToLocal:"",lastmodified:"",CAMLViewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:0,CAMLQueryOptions:"<QueryOptions></QueryOptions>",batchCmd:"Update",valuepairs:[],listProperties:"",newFields:"",updateFields:"",deleteFields:"",listVersion:"",contentTypeId:"",username:"",password:"",accountName:"",newData:"",AccountName:"",userLoginName:"",groupNamesXml:"",groupName:"",ownerIdentifier:"",ownerType:"",defaultUserLoginName:"",roleNamesXml:"",roleName:"",permissionIdentifier:"",permissionType:"",permissionMask:"",permissionsInfoXml:"",memberIdsXml:"",userLoginNamesXml:"",emailXml:"",objectName:"",objectType:"List",IDs:null,SourceUrl:"",Url:"",DestinationUrls:[],Fields:"",Stream:"",Results:"",documentName:"",behavior:"Version3",storageKey:"",storage:"Shared",webPartXml:"",item:"",listId:"",taskId:"",templateId:"",workflowParameters:"",fClaim:false,queryXml:"",cancelMeeting:true,lcid:"",location:"",nonGregorian:false,organizerEmail:"",recurrenceId:0,sequence:0,templateName:"",timeZoneInformation:"",title:"",uid:"",utcDateStamp:"",utcDateStart:"",utcDateEnd:"",searchText:"",maxResults:10,principalType:"User",async:true,completefunc:null};C.fn.SPServices.SPGetCurrentSite=function(){if(e.length>0){return e}var R=z.header+"<WebUrlFromPageUrl xmlns='http://schemas.microsoft.com/sharepoint/soap/' ><pageUrl>"+((location.href.indexOf("?")>0)?location.href.substr(0,location.href.indexOf("?")):location.href)+"</pageUrl></WebUrlFromPageUrl>"+z.footer;C.ajax({async:false,url:"/_vti_bin/Webs.asmx",beforeSend:function(S){S.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/WebUrlFromPageUrl")},type:"POST",data:R,dataType:"xml",contentType:'text/xml; charset="utf-8"',complete:function(T,S){e=C(T.responseXML).find("WebUrlFromPageUrlResult").text()}});return e};C.fn.SPServices.SPCascadeDropdowns=function(R){var T=C.extend({},{relationshipWebURL:"",relationshipList:"",relationshipListParentColumn:"",relationshipListChildColumn:"",relationshipListSortColumn:"",parentColumn:"",childColumn:"",CAMLQuery:"",promptText:"Choose {0}...",completefunc:null,debug:false},R);var S=new K(T.parentColumn);if(S.Obj.html()==null&&T.debug){A("SPServices.SPCascadeDropdowns","parentColumn: "+T.parentColumn,"Column not found on page");return}switch(S.Type){case"S":S.Obj.bind("change",function(){M(T)});S.Obj.change();break;case"C":S.Obj.bind("propertychange",function(){M(T)});S.Obj.trigger("propertychange");break;case"M":S.Obj.bind("dblclick",function(){M(T)});parentSelections=S.Obj.closest("span").find("select[ID$='SelectResult'][Title^='"+T.parentColumn+" ']");parentSelections.bind("dblclick",function(){M(T)});S.Obj.closest("span").find("button").each(function(){C(this).bind("click",function(){M(T)})});M(T);break;default:break}};function M(U){var ad="";var Y=null;var X=[];var T;var Z;var aa;var ab;var W=new K(U.parentColumn);switch(W.Type){case"S":X.push(W.Obj.find("option:selected").text());break;case"C":X.push(W.Obj.attr("value"));break;case"M":parentSelections=W.Obj.closest("span").find("select[ID$='SelectResult'][Title^='"+U.parentColumn+" ']");C(parentSelections).find("option").each(function(){X.push(C(this).html())});break;default:break}if(W.Obj.attr("cascadeDropdownSelected_"+U.childColumn)==X.join(";#")){return}W.Obj.attr("cascadeDropdownSelected_"+U.childColumn,X.join(";#"));var S=new K(U.childColumn);if(S.Obj.html()==null&&U.debug){A("SPServices.SPCascadeDropdowns","childColumn: "+U.childColumn,"Column not found on page");return}switch(S.Type){case"S":Y=S.Obj.find("option:selected").val();break;case"C":Y=S.Obj.attr("value");break;case"M":Z=S.Obj.closest("span").find("input:[name$='MultiLookupPicker$data']");T=window[S.Obj.closest("tr").find("button:[id$='AddButton']").attr("id").replace(/AddButton/,"MultiLookupPicker_m")];currentSelection=S.Obj.closest("span").find("select[ID$='SelectResult'][Title^='"+U.childColumn+" ']");T.data="";break;default:break}var V=(U.relationshipListSortColumn.length>0)?U.relationshipListSortColumn:U.relationshipListChildColumn;var R="<Query><OrderBy><FieldRef Name='"+V+"'/></OrderBy><Where>";if(U.CAMLQuery.length>0){R+="<And>"}if(X.length==0){R+="<Eq><FieldRef Name='"+U.relationshipListParentColumn+"'/><Value Type='Text'></Value></Eq>"}else{if(X.length==1){R+="<Eq><FieldRef Name='"+U.relationshipListParentColumn+"'/><Value Type='Text'>"+r(X[0])+"</Value></Eq>"}else{var ac=(X.length>2)?true:false;for(i=0;i<(X.length-1);i++){R+="<Or>"}for(i=0;i<X.length;i++){R+="<Eq><FieldRef Name='"+U.relationshipListParentColumn+"'/><Value Type='Text'>"+r(X[i])+"</Value></Eq>";if(i>0&&(i<(X.length-1))&&ac){R+="</Or>"}}R+="</Or>"}}if(U.CAMLQuery.length>0){R+=U.CAMLQuery+"</And>"}R+="</Where></Query>";C().SPServices({operation:"GetList",async:false,listName:t(),completefunc:function(af,ae){C(af.responseXML).find("Fields").each(function(){C(af.responseXML).find("Field").each(function(){if(C(this).attr("DisplayName")==U.childColumn){ab=(C(this).attr("Required")=="TRUE")?true:false}})})}});C().SPServices({operation:"GetListItems",async:false,webURL:U.relationshipWebURL,listName:U.relationshipList,CAMLQuery:R,CAMLViewFields:"<ViewFields><FieldRef Name='"+U.relationshipListParentColumn+"' /><FieldRef Name='"+U.relationshipListChildColumn+"' /></ViewFields>",CAMLRowLimit:0,completefunc:function(af,ae){C(af.responseXML).find("faultcode").each(function(){if(U.debug){A("SPServices.SPCascadeDropdowns","relationshipListParentColumn: "+U.relationshipListParentColumn+" or relationshipListChildColumn: "+U.relationshipListChildColumn,"Not found in relationshipList "+U.relationshipList)}return});switch(S.Type){case"S":S.Obj.attr({length:0});if(!ab&&(U.promptText.length>0)){S.Obj.append("<option value='0'>"+U.promptText.replace(/\{0\}/g,U.childColumn)+"</option>")}break;case"C":ad=ab?"":"(None)|0";S.Obj.attr("value","");break;case"M":S.Obj.attr({length:0});aa="";break;default:break}C(af.responseXML).find("[nodeName=z:row]").each(function(){var ah=(C(this).attr("ows_"+U.relationshipListChildColumn).indexOf(";#")>0)?C(this).attr("ows_"+U.relationshipListChildColumn).split(";#")[0]:C(this).attr("ows_ID");if(isNaN(ah)){ah=C(this).attr("ows_ID")}var ag=(C(this).attr("ows_"+U.relationshipListChildColumn).indexOf(";#")>0)?C(this).attr("ows_"+U.relationshipListChildColumn).split(";#")[1]:C(this).attr("ows_"+U.relationshipListChildColumn);switch(S.Type){case"S":var ai=(C(this).attr("ows_ID")==Y)?" selected='selected'":"";S.Obj.append("<option"+ai+" value='"+ah+"'>"+ag+"</option>");break;case"C":if(ag==Y){S.Obj.attr("value",Y)}ad=ad+((ad.length>0)?"|":"")+ag+"|"+ah;break;case"M":S.Obj.append("<option value='"+ah+"'>"+ag+"</option>");aa+=ah+"|t"+ag+"|t |t |t";break;default:break}});switch(S.Type){case"S":S.Obj.trigger("change");break;case"C":S.Obj.attr("choices",ad);S.Obj.trigger("propertychange");break;case"M":Z.attr("value",aa);C(currentSelection).find("option").each(function(){var ag=C(this);C(this).attr("selected","selected");C(S.Obj).find("option").each(function(){if(C(this).html()==ag.html()){ag.attr("selected","")}})});GipRemoveSelectedItems(T);C(S.Obj).find("option").each(function(){var ag=C(this);C(currentSelection).find("option").each(function(){if(C(this).html()==ag.html()){ag.remove()}})});GipAddSelectedItems(T);T.data=GipGetGroupData(aa);break;default:break}}});if(U.completefunc!=null){U.completefunc()}}C.fn.SPServices.SPDisplayRelatedInfo=function(R){var S=C.extend({},{columnName:"",relatedWebURL:"",relatedList:"",relatedListColumn:"",relatedColumns:[],displayFormat:"table",headerCSSClass:"ms-vh2",rowCSSClass:"ms-vb",CAMLQuery:"",numChars:0,matchType:"Eq",completefunc:null,debug:false},R);var T=new K(S.columnName);if(T.Obj.html()==null&&S.debug){A("SPServices.SPDisplayRelatedInfo","columnName: "+S.columnName,"Column not found on page");return}switch(T.Type){case"S":T.Obj.bind("change",function(){x(S)});T.Obj.change();break;case"C":T.Obj.bind("propertychange",function(){x(S)});T.Obj.trigger("propertychange");break;case"M":if(S.debug){A("SPServices.SPDisplayRelatedInfo","columnName: "+S.columnName,"Multi-select columns not supported by this function")}break;default:break}};function x(W){var S=null;var X=new K(W.columnName);switch(X.Type){case"S":S=X.Obj.find("option:selected").text();break;case"C":S=X.Obj.attr("value");if(W.numChars>0&&S.length<W.numChars){return}break;case"M":break;default:break}if(X.Obj.attr("showRelatedSelected")==S){return}X.Obj.attr("showRelatedSelected",S);var U="showRelated_"+E(W.columnName);C("#"+U).remove();X.Obj.parent().append("<div id="+U+"></div>");var V=[];C().SPServices({operation:"GetList",async:false,webURL:W.relatedWebURL,listName:W.relatedList,completefunc:function(Z,Y){C(Z.responseXML).find("faultcode").each(function(){if(W.debug){A("SPServices.SPDisplayRelatedInfo","relatedList: "+W.relatedList,"List not found")}return});C(Z.responseXML).find("Fields").each(function(){C(Z.responseXML).find("Field").each(function(){for(i=0;i<W.relatedColumns.length;i++){if(C(this).attr("Name")==W.relatedColumns[i]){V[i]=C(this)}}})})}});var R="<Query><Where>";if(W.CAMLQuery.length>0){R+="<And>"}R+="<"+W.matchType+"><FieldRef Name='"+W.relatedListColumn+"'/><Value Type='Text'>"+r(S)+"</Value></"+W.matchType+">";if(W.CAMLQuery.length>0){R+=W.CAMLQuery+"</And>"}R+="</Where></Query>";var T=" ";for(i=0;i<W.relatedColumns.length;i++){T+="<FieldRef Name='"+W.relatedColumns[i]+"' />"}C().SPServices({operation:"GetListItems",async:false,webURL:W.relatedWebURL,listName:W.relatedList,CAMLQuery:R,CAMLViewFields:"<ViewFields>"+T+"</ViewFields>",CAMLRowLimit:0,completefunc:function(aa,Z){C(aa.responseXML).find("faultcode").each(function(){if(W.debug){A("SPServices.SPDisplayRelatedInfo","relatedListColumn: "+W.relatedListColumn,"Column not found in relatedList "+W.relatedList)}return});switch(W.displayFormat){case"table":var Y="<table>";Y+="<tr>";for(i=0;i<W.relatedColumns.length;i++){if(V[i]==undefined&&W.debug){A("SPServices.SPDisplayRelatedInfo","columnName: "+W.relatedColumns[i],"Column not found in relatedList");return}Y+="<th class='"+W.headerCSSClass+"'>"+V[i].attr("DisplayName")+"</th>"}Y+="</tr>";C(aa.responseXML).find("[nodeName=z:row]").each(function(){Y+="<tr>";for(i=0;i<W.relatedColumns.length;i++){Y+="<td class='"+W.rowCSSClass+"'>"+s(V[i],C(this).attr("ows_"+W.relatedColumns[i]),W)+"</td>"}Y+="</tr>"});Y+="</table>";C("#showRelated_"+E(W.columnName)).html("").append(Y);break;case"list":var Y="<table>";for(i=0;i<W.relatedColumns.length;i++){C(aa.responseXML).find("[nodeName=z:row]").each(function(){Y+="<tr>";Y+="<th class='"+W.headerCSSClass+"'>"+V[i].attr("DisplayName")+"</th>";Y+="<td class='"+W.rowCSSClass+"'>"+s(V[i],C(this).attr("ows_"+W.relatedColumns[i]),W)+"</td>";Y+="</tr>"})}Y+="</table>";C("#showRelated_"+E(W.columnName)).html("").append(Y);break;default:break}}});if(W.completefunc!=null){W.completefunc()}}C.fn.SPServices.SPDebugXMLHttpResult=function(S){var U=C.extend({},{node:null,indent:0},S);var W=3;var V=4;var R="";R+="<table class='ms-vb' style='margin-left:"+U.indent*3+"px;' width='100%'>";if(U.node.nodeName=="DisplayPattern"){R+="<tr><td width='100px' style='font-weight:bold;'>"+U.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+U.node.xml+"</textarea></td></tr>"}else{if(!U.node.hasChildNodes()){R+="<tr><td width='100px' style='font-weight:bold;'>"+U.node.nodeName+"</td><td>"+((U.node.nodeValue!=null)?q(U.node.nodeValue):"&nbsp;")+"</td></tr>";if(U.node.attributes){R+="<tr><td colspan='99'>";R+=L(U.node,U);R+="</td></tr>"}}else{if(U.node.hasChildNodes()&&U.node.firstChild.nodeType==V){R+="<tr><td width='100px' style='font-weight:bold;'>"+U.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+U.node.parentNode.text+"</textarea></td></tr>"}else{if(U.node.hasChildNodes()&&U.node.firstChild.nodeType==W){R+="<tr><td width='100px' style='font-weight:bold;'>"+U.node.nodeName+"</td><td>"+q(U.node.firstChild.nodeValue)+"</td></tr>"}else{R+="<tr><td width='100px' style='font-weight:bold;' colspan='99'>"+U.node.nodeName+"</td></tr>";if(U.node.attributes){R+="<tr><td colspan='99'>";R+=L(U.node,U);R+="</td></tr>"}R+="<tr><td>";for(var T=0;T<U.node.childNodes.length;T++){R+=C().SPServices.SPDebugXMLHttpResult({node:U.node.childNodes.item(T),indent:U.indent+1})}R+="</td></tr>"}}}}R+="</table>";return R};C.fn.SPServices.SPGetCurrentUser=function(){var R="";C.ajax({async:false,url:C().SPServices.SPGetCurrentSite()+"/_layouts/userdisp.aspx?Force=True",complete:function(T,S){C(T.responseText).find("table.ms-formtable td#SPFieldText").each(function(){if(/FieldInternalName=\"Name\"/.test(C(this).html())){R=C(this).text()}})}});return R.replace(/(^[\s\xA0]+|[\s\xA0]+$)/g,"")};C.fn.SPServices.SPLookupAddNew=function(T){var U=C.extend({},{lookupColumn:"",promptText:"Add new {0}",completefunc:null,debug:false},T);var S=new K(U.lookupColumn);if(S.Obj.html()==null&&U.debug){A("SPServices.SPLookupAddNew","lookupColumn: "+U.lookupColumn,"Column not found on page");return}var V="";var R="";C().SPServices({operation:"GetList",async:false,listName:t(),completefunc:function(X,W){C(X.responseXML).find("Field").each(function(){if(C(this).attr("DisplayName")==U.lookupColumn){C().SPServices({operation:"GetList",async:false,listName:C(this).attr("List"),completefunc:function(Z,Y){C(Z.responseXML).find("List").each(function(){R=C(this).attr("WebFullUrl");R=R!=g?R+g:R})}});C().SPServices({operation:"GetFormCollection",async:false,listName:C(this).attr("List"),completefunc:function(Z,Y){C(Z.responseXML).find("Form").each(function(){if(C(this).attr("Type")=="NewForm"){V=C(this).attr("Url")}})}})}})}});if(R.length==0&&U.debug){A("SPServices.SPLookupAddNew","lookupColumn: "+U.lookupColumn,"This column does not appear to be a lookup column");return}if(V.length>0){newLink="<a href='"+R+V+"?Source="+P(location.href)+"'>"+U.promptText.replace(/\{0\}/g,U.lookupColumn)+"</a>";C(S.Obj).parents("td.ms-formbody").append(newLink)}else{if(U.debug){A("SPServices.SPLookupAddNew","lookupColumn: "+U.lookupColumn,"NewForm cannot be found");return}}if(U.completefunc!=null){U.completefunc()}};C.fn.SPServices.SPGetLastItemId=function(S){var U=C.extend({},{webURL:"",listName:"",userAccount:"",CAMLQuery:""},S);var T;var V=0;C().SPServices({operation:"GetUserInfo",async:false,userLoginName:(U.userAccount!="")?U.userAccount:C().SPServices.SPGetCurrentUser(),completefunc:function(X,W){C(X.responseXML).find("User").each(function(){T=C(this).attr("ID")})}});var R="<Query><Where>";if(U.CAMLQuery.length>0){R+="<And>"}R+="<Eq><FieldRef Name='Author' LookupId='TRUE'/><Value Type='Integer'>"+T+"</Value></Eq>";if(U.CAMLQuery.length>0){R+=U.CAMLQuery+"</And>"}R+="</Where><OrderBy><FieldRef Name='Created_x0020_Date' Ascending='FALSE'/></OrderBy></Query>";C().SPServices({operation:"GetListItems",async:false,webURL:U.webURL,listName:U.listName,CAMLQuery:R,CAMLViewFields:"<ViewFields><FieldRef Name='ID'/></ViewFields>",CAMLRowLimit:1,completefunc:function(X,W){C(X.responseXML).find("[nodeName=z:row]").each(function(){V=C(this).attr("ows_ID")})}});return V};C.fn.SPServices.SPRequireUnique=function(T){var U=C.extend({},{columnStaticName:"Title",duplicateAction:0,ignoreCase:"false",initMsg:"This value must be unique.",initMsgCSSClass:"ms-vb",errMsg:"This value is not unique.",errMsgCSSClass:"ms-formvalidation",completefunc:null},T);var Y="<span id='SPRequireUnique"+U.columnStaticName+"' class='{0}'>{1}<br/></span>";var R=Y.replace(/\{0\}/g,U.initMsgCSSClass).replace(/\{1\}/g,U.initMsg);var X=Y.replace(/\{0\}/g,U.errMsgCSSClass).replace(/\{1\}/g,U.errMsg);var W=t();var V=C().SPServices.SPGetDisplayFromStatic({listName:W,columnStaticName:U.columnStaticName});var S=C("input:[Title='"+V+"']");C(S).parent().append(R);C(S).change(function(){var aa=0;var ab=C(this).attr("value");C().SPServices({operation:"GetListItems",async:false,listName:t(),CAMLQuery:"<Query><Where><IsNotNull><FieldRef Name='"+U.columnStaticName+"'/></IsNotNull></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='"+U.columnStaticName+"' /></ViewFields>",CAMLRowLimit:0,completefunc:function(ae,ac){var ad=U.ignoreCase?ab.toUpperCase():ab;C(ae.responseXML).find("[nodeName=z:row]").each(function(){var af=U.ignoreCase?C(this).attr("ows_"+U.columnStaticName).toUpperCase():C(this).attr("ows_"+U.columnStaticName);if(ad==af){aa++}})}});var Z=R;C("input:[value='OK']").attr("disabled","");if(aa>0){Z=X;if(U.duplicateAction==1){C("input:[Title='"+U.columnDisplayName+"']").focus();C("input:[value='OK']").attr("disabled","disabled")}}C("span#SPRequireUnique"+U.columnStaticName).html(Z)});if(U.completefunc!=null){U.completefunc()}};C.fn.SPServices.SPGetDisplayFromStatic=function(R){var T=C.extend({},{webURL:"",listName:"",columnStaticName:""},R);var S="";C().SPServices({operation:"GetList",async:false,webURL:T.webURL,listName:T.listName,completefunc:function(V,U){C(V.responseXML).find("Field").each(function(){if(C(this).attr("StaticName")==T.columnStaticName){displayName=C(this).attr("DisplayName")}})}});return displayName};C.fn.SPServices.SPRedirectWithID=function(S){var T=C.extend({},{redirectUrl:""},S);var U=t();var W=C().SPServices.SPGetQueryString();var V=W.ID;if(W.ID==undefined){V=C().SPServices.SPGetLastItemId({listName:U});C("form[name='aspnetForm']").each(function(){var X=(location.href.indexOf("?")>0)?location.href.substring(0,location.href.indexOf("?")):location.href;var Y=(typeof W.Source=="string")?"Source="+W.Source.replace(/\//g,"%2f").replace(/:/g,"%3a"):"";var Z=X+"?Source="+X+"?ID="+V+((Y.length>0)?("%26RealSource="+W.Source):"")+((typeof W.RedirectURL=="string")?("%26RedirectURL="+W.RedirectURL):"");C(this).attr("action",Z)})}else{while(W.ID==V){V=C().SPServices.SPGetLastItemId({listName:U})}var R=(typeof W.RedirectURL=="string")?W.RedirectURL:T.redirectUrl;location.href=R+"?ID="+V+((typeof W.RealSource=="string")?("&Source="+W.RealSource):"")}};C.fn.SPServices.SPSetMultiSelectSizes=function(Z){var R=C.extend({},{multiSelectColumn:"",minWidth:0,maxWidth:0},Z);var V=C("select[ID$='SelectCandidate'][Title^='"+R.multiSelectColumn+" ']");var X=V.closest("span").find("select[ID$='SelectResult'][Title^='"+R.multiSelectColumn+" ']");var W="SPSetMultiSelectSizes_"+E(R.multiSelectColumn);V.clone().appendTo(V.closest("span")).css({width:"auto",height:0,visibility:"hidden"}).attr({id:W,length:0});var U=C("#"+W);V.find("option").each(function(){U.append("<option value='"+C(this).html()+"'>"+C(this).html()+"</option>")});X.find("option").each(function(){U.append("<option value='"+C(this).html()+"'>"+C(this).html()+"</option>")});var S=C("#"+W).width()+5;var Y=S;if(R.minWidth>0||R.maxWidth>0){if(S<R.minWidth){S=R.minWidth}if(Y<R.minWidth){Y=R.minWidth}if(Y>R.maxWidth){Y=R.maxWidth}}var T=S-17;V.css("width",T+"px").parent().css("width",Y+"px");X.css("width",T+"px").parent().css("width",Y+"px");C("#"+W).remove()};C.fn.SPServices.SPScriptAudit=function(S){var T=C.extend({},{webURL:"",listName:"",outputId:"",auditForms:true,auditViews:true,auditPages:true,auditPagesListName:"Pages",showHiddenLists:false,showNoScript:false,showSrc:true},S);var R=["Display","Edit","New"];var U;C("#"+T.outputId).append("<table id='SPScriptAudit' width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1><tr><th></th><th>List</th><th>Page Class</th><th>Page Type</th><th>Page</th>"+(T.showSrc?"<th>Script in the Page</th><th>Script in a Web Part</th>":"")+"<th>jQuery</th></tr></table>");C("#SPScriptAudit th").attr("class","ms-vh2-nofilter");if(T.auditForms||T.auditViews){C().SPServices({operation:"GetListCollection",webURL:T.webURL,async:false,completefunc:function(W,V){C(W.responseXML).find(m).each(function(){C(this).find("List").each(function(){U=C(this);if((T.showHiddenLists&&U.attr("Hidden")=="False")||!T.showHiddenLists){if(T.auditForms){C().SPServices({operation:"GetListContentTypes",webURL:T.webURL,listName:U.attr("ID"),async:false,completefunc:function(Y,X){C(Y.responseXML).find("ContentType").each(function(){if(C(this).attr("ID").substring(0,6)!="0x0120"){C(this).find("FormUrls").each(function(){for(var Z=0;Z<R.length;Z++){C(this).find(R[Z]).each(function(){j(T,U,"Form",R[Z],((T.webURL.length>0)?T.webURL:C().SPServices.SPGetCurrentSite())+g+C(this).text())})}})}})}})}if(T.auditViews){C().SPServices({operation:"GetViewCollection",webURL:T.webURL,listName:U.attr("ID"),async:false,completefunc:function(Y,X){C(Y.responseXML).find("View").each(function(){j(T,U,"View",C(this).attr("DisplayName"),C(this).attr("Url"))})}})}}})})}})}if(T.auditPages){C().SPServices({operation:"GetList",async:false,webURL:T.webURL,listName:T.auditPagesListName,completefunc:function(W,V){C(W.responseXML).find("List").each(function(){U=C(this)})}});C().SPServices({operation:"GetListItems",async:false,webURL:T.webURL,listName:T.auditPagesListName,CAMLQuery:"<Query><Where><Neq><FieldRef Name='ContentType'/><Value Type='Text'>Folder</Value></Neq></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='Title'/><FieldRef Name='FileRef'/></ViewFields>",CAMLRowLimit:0,completefunc:function(W,V){C(W.responseXML).find("[nodeName=z:row]").each(function(){var Y=C(this).attr("ows_FileRef").split(";#")[1];var X=(C(this).attr("ows_Title")!=undefined)?C(this).attr("ows_Title"):"";if(Y.indexOf(".aspx")>0){j(T,U,"Page",X,g+Y)}})}})}C("#SPScriptAudit tr[class='ms-alternating']:even").attr("class","")};function j(R,T,ad,X,V){var ab=0;var ac=0;var U=new Object();U.type=[];U.src=[];U.script=[];var W=new Object();W.type=[];W.src=[];W.script=[];var S="$(";var Y=RegExp("<head[\\s\\S]*?/head>","gi");var aa=RegExp("<script[\\s\\S]*?/script>","gi");var Z;C.ajax({type:"GET",url:V,dataType:"text",success:function(af){headHtml=Y.exec(af);while(scriptMatch=aa.exec(headHtml)){var ai=y(scriptMatch,"language");var ak=y(scriptMatch,"type");var ae=y(scriptMatch,"src");if(ae!=null&&ae.length>0&&!D(ae)){W.type.push((ai!=null&&ai.length>0)?ai:ak);W.src.push(ae)}var am=scriptMatch.innerHTML;if(am!=undefined&&am.indexOf(S)>-1){W.script.push(scriptMatch.innerHTML);ab++}}C(af).find("script").each(function(){if(C(this).closest("td[id^='MSOZoneCell_WebPartWP']").html()==null){if((C(this).attr("src")!=undefined)&&(C(this).attr("src").length>0)&&!D(C(this).attr("src"))){W.type.push(C(this).attr("language").length>0?C(this).attr("language"):C(this).attr("type"));W.src.push(C(this).attr("src"))}if(C(this).html().indexOf(S)>-1){W.script.push(C(this).html());ab++}}else{if(C(this).attr("src")!=undefined&&C(this).attr("src").length>0){U.type.push(C(this).attr("language").length>0?C(this).attr("language"):C(this).attr("type"));U.src.push(C(this).attr("src"))}if(C(this).html().indexOf(S)>-1){U.script.push(C(this).html());ac++}}});if((!R.showNoScript&&(U.type.length>0||W.type.length>0))||R.showNoScript){var aj=V.substring(0,V.lastIndexOf(g)+1);var ag="<tr class=ms-alternating><td class=ms-vb-icon><a href='"+T.attr("DefaultViewUrl")+"'><IMG border=0 src='"+T.attr("ImageUrl")+"'width=16 height=16></A></TD><td class=ms-vb2><a href='"+T.attr("DefaultViewUrl")+"'>"+T.attr("Title")+((T.attr("Hidden")=="True")?"(Hidden)":"")+"</td><td class=ms-vb2>"+ad+"</td><td class=ms-vb2>"+X+"</td><td class=ms-vb2><a href='"+V+"'>"+v(V)+"</td>";if(R.showSrc){ag+="<td valign='top'><table width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1>";for(var ah=0;ah<W.type.length;ah++){var al=(W.src[ah].substr(0,1)!=g)?aj+W.src[ah]:W.src[ah];ag+="<tr><td class=ms-vb2 width='30%'>"+W.type[ah]+"</td>";ag+="<td class=ms-vb2 width='70%'><a href='"+al+"'>"+v(W.src[ah])+"</td></tr>"}if(ab>0){for(var ah=0;ah<W.script.length;ah++){ag+="<tr><td class=ms-vb2 colspan=99><textarea class=ms-vb2 readonly='readonly' rows='5' cols='50'>"+W.script[ah]+"</textarea></td></tr>"}}ag+="</table></td>";ag+="<td valign='top'><table width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1>";for(var ah=0;ah<U.type.length;ah++){var al=(U.src[ah].substr(0,1)!=g)?aj+U.src[ah]:U.src[ah];ag+="<tr><td class=ms-vb2 width='30%'>"+U.type[ah]+"</td>";ag+="<td class=ms-vb2 width='70%'><a href='"+al+"'>"+v(U.src[ah])+"</td></tr>"}if(ac>0){for(var ah=0;ah<U.script.length;ah++){ag+="<tr><td class=ms-vb2 colspan=99><textarea class=ms-vb2 readonly='readonly' rows='5' cols='50'>"+U.script[ah]+"</textarea></td></tr>"}}ag+="</table></td>"}ag+="<td class=ms-vb2>"+(((ab+ac)>0)?"Yes":"No")+"</td></tr>";C("#SPScriptAudit").append(ag)}}})}function y(T,S){var R=RegExp(S+"=(\"([^\"]*)\")|('([^']*)')","gi");if(matches=R.exec(T)){return matches[2]}return null}function D(T){var S=["WebResource.axd","_layouts"];for(var R=0;R<S.length;R++){if(T.indexOf(S[R])>-1){return true}}return false}C.fn.SPServices.SPArrangeChoices=function(S){var T=C.extend({},{columnName:"",perRow:99,randomize:false},S);var S=new Array();var R;var U=RegExp('FieldName="'+T.columnName+'"',"gi");C("td.ms-formbody").each(function(){if(U.test(C(this).html())){C(this).find("tr").each(function(){S.push(C(this).html())});R="<TR>";if(T.randomize){S.sort(N)}for(i=0;i<S.length;i++){R+=S[i];if((i+1)%T.perRow==0){R+="</TR><TR>"}}R+="</TR>";C(this).find("tr").remove();C(this).find("table").append(R);return false}})};C.fn.SPServices.SPGetQueryString=function(){var V=new Object();var R=location.search.substring(1,location.search.length);var T=R.split("&");for(var U=0;U<T.length;U++){var W=T[U].split("=");var S=unescape(W[1]).split("+");W[1]=S.join(" ");V[W[0]]=W[1]}return V};function s(W,V,U){if(V==undefined){return""}var R;switch(W.attr("Type")){case"Text":R=V;break;case"URL":switch(W.attr("Format")){case"Hyperlink":R="<a href='"+V.substring(0,V.search(","))+"'>"+V.substring(V.search(",")+1)+"</a>";break;case"Image":R="<img alt='"+V.substring(V.search(",")+1)+"' src='"+V.substring(0,V.search(","))+"'/>";break;default:R=V;break}break;case"User":R="<a href='/_layouts/userdisp.aspx?ID="+V.substring(0,V.search(";#"))+"&Source="+P(location.href)+"'>"+V.substring(V.search(";#")+2)+"</a>";break;case"Calculated":var S=V.split(";#");R=S[1];break;case"Number":R=parseFloat(V).toFixed(W.attr("Decimals")).toString();break;case"Currency":R=parseFloat(V).toFixed(W.attr("Decimals")).toString();break;case"Lookup":var T;C().SPServices({operation:"GetFormCollection",async:false,listName:W.attr("List"),completefunc:function(Y,X){C(Y.responseXML).find("Form").each(function(){if(C(this).attr("Type")=="DisplayForm"){T=C(this).attr("Url")}})}});R="<a href='"+U.relatedWebURL+g+T+"?ID="+V.substring(0,V.search(";#"))+"&RootFolder=*'>"+V.substring(V.search(";#")+2)+"</a>";break;case"Counter":R=V;break;default:R=V;break}return R}function L(U,T){var R="<table class='ms-vb' width='100%'>";for(var S=0;S<U.attributes.length;S++){R+="<tr><td width='10px' style='font-weight:bold;'>"+S+"</td><td width='100px'>"+U.attributes.item(S).nodeName+"</td><td>"+q(U.attributes.item(S).nodeValue)+"</td></tr>"}R+="</table>";return R}function t(){var T=location.href;var S=T.substring(0,T.indexOf(".aspx"));var U=O(S.substring(0,S.lastIndexOf(g)));var R="";C().SPServices({operation:"GetListCollection",async:false,completefunc:function(W,V){C(W.responseXML).find("List").each(function(){var X=C(this).attr("DefaultViewUrl");var Y=X.substring(0,X.lastIndexOf(g));if(U.indexOf(Y)>0){R=C(this).attr("ID")}})}});return R}function K(R){if((this.Obj=C("select[Title='"+R+"']")).html()!=null){this.Type="S"}else{if((this.Obj=C("input[Title='"+R+"']")).html()!=null){this.Type="C"}else{if((this.Obj=C("select[ID$='SelectCandidate'][Title^='"+R+" ']")).html()!=null){this.Type="M"}else{this.Type=null}}}}function A(S,U,T){var R="<b>Error in function</b><br/>"+S+"<br/><b>Parameter</b><br/>"+U+"<br/><b>Message</b><br/>"+T+"<br/><br/><span style='width=100%;text-align:right;'>Click to continue</span></div>";f(R)}function f(W){var T="position:absolute;width:300px;height:150px;padding:10px;background-color:#000000;color:#ffffff;z-index:30;font-family:'Arial';font-size:12px;display:none;";C("#aspnetForm").parent().append("<div id='SPServices_msgBox' style="+T+">"+W);var R=C("#SPServices_msgBox").height();var V=C("#SPServices_msgBox").width();var U=(C(window).width()/2)-(V/2)+"px";var S=(C(window).height()/2)-(R/2)-100+"px";C("#SPServices_msgBox").css({border:"5px #C02000 solid",left:U,top:S}).show().fadeTo("slow",0.75).click(function(){C(this).fadeOut("3000",function(){C(this).remove()})})}function N(){return(Math.round(Math.random())-0.5)}function q(R){return((R.indexOf("http")==0)||(R.indexOf(g)==0))?"<a href='"+R+"'>"+R+"</a>":R}function v(R){return R.substring(R.lastIndexOf(g)+1,R.length)}function a(R){return R.replace(/"/g,"&quot;").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function r(R){return R.replace(/&/g,"&amp;")}function O(R){return R.replace(/%20/g," ")}function P(R){return R.replace(/&/g,"%26")}function E(R){return R.replace(/ /g,"_x0020_")}function u(S,R){return"<"+S+">"+R+"</"+S+">"}})(jQuery);