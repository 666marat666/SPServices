(function($){var f=location.href.substring(0,location.href.lastIndexOf('\/'));var g=new Array();g["GetList"]="Lists";g["GetListCollection"]="Lists";g["GetListItems"]="Lists";g["UpdateListItems"]="Lists";g["GetUserInfo"]="usergroup";g["GetWeb"]="Webs";g["GetWebCollection"]="Webs";g["GetAllSubWebCollection"]="Webs";var h=new Object();h.header="<?xml version='1.0' encoding='utf-8'?> 			<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'> 				<soap:Body>";h.footer="</soap:Body> 			</soap:Envelope>";h.payload="";$.fn.SPServices=function(a){var b=$.extend({},$.fn.SPServices.defaults,a);h.opheader="<"+b.operation+" xmlns='http://schemas.microsoft.com/sharepoint/soap/' >";h.opfooter="</"+b.operation+">";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/"+b.operation;$().SPServices.SPGetCurrentSite();ajaxURL=f+"/_vti_bin/"+g[b.operation]+".asmx";h.payload="";switch(b.operation){case"GetList":h.payload+="<listName>"+b.listname+"</listName>";break;case"GetListCollection":break;case"GetListItems":h.payload+="<listName>"+b.listname+"</listName>";h.payload+="<viewFields>"+b.CAMLViewFields+"</viewFields>";h.payload+="<query>"+b.CAMLQuery+"</query>";break;case"UpdateListItems":h.payload+="<listName>"+b.listname+"</listName>";h.payload+="<updates><Batch OnError='Continue'><Method ID='1' Cmd='Update'>";for(i=0;i<b.valuepairs.length;i++){h.payload+="<Field Name='"+b.valuepairs[i][0]+"'>"+b.valuepairs[i][1]+"</Field>"}h.payload+="<Field Name='ID'>"+b.ID+"</Field>";h.payload+="</Method></Batch></updates>";break;case"GetUserInfo":h.opheader="<"+b.operation+" xmlns='http://schemas.microsoft.com/sharepoint/soap/directory/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/directory/"+b.operation;h.payload+="<userLoginName>"+b.userLoginName+"</userLoginName>";break;case"GetWeb":h.payload+="<webUrl>"+b.webURL+"</webUrl>";break;case"GetWebCollection":break;case"GetCurrentSite":return f;break;case"GetAllSubWebCollection":break;default:return false}var c=h.header+h.opheader+h.payload+h.opfooter+h.footer;goAJAX(c,b.successfunc)};$.fn.SPServices.defaults={operation:null,webURL:".",listname:null,ID:1,CAMLViewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:"",CAMLQueryOptions:"",valuepairs:[],userLoginName:"",successfunc:null}$.fn.SPServices.SPGetCurrentSite=function(){var d=h.header+"<GetWeb xmlns='http://schemas.microsoft.com/sharepoint/soap/' >"+"<webUrl>.</webUrl>"+"</GetWeb>"+h.footer;$.ajax({async:false,url:"./_vti_bin/Webs.asmx",beforeSend:function(a){a.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/GetWeb")},type:"POST",data:d,dataType:"xml",contentType:"text/xml; charset=\"utf-8\"",success:function(a,b){$(a.xml).find("Web").each(function(){f=$(this).attr("Url")})},error:function(a,b,c){alert("SPServices.SPGetCurrentSite error.  Trimming thisSite:"+f);f=f.substring(0,f.lastIndexOf('\/'));alert("SPServices.SPGetCurrentSite error.  Trimming thisSite:"+f)}});return f};function goAJAX(d,e){$.ajax({url:ajaxURL,beforeSend:function(a){a.setRequestHeader("SOAPAction",SOAPAction)},type:"POST",data:d,dataType:"xml",contentType:"text/xml; charset=\"utf-8\"",error:function(a,b,c){alert("textStatus: "+b+" errorThrown: "+c)},success:e})}})(jQuery);