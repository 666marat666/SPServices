/*
 * SPServices - Work with SharePoint's Web Services using jQuery
 * Version 0.5.1
 * @requires jQuery v1.3.2 or greater
 *
 * Copyright (c) 2009 Sympraxis Consulting LLC
 * Examples and docs at:
 * http://spservices.codeplex.com
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/mit-license.php
 */
/**
 * @description Work with SharePoint's Web Services using jQuery
 * @type jQuery
 * @name SPServices
 * @category Plugins/SPServices
 * @author Sympraxis Consulting LLC/marc.anderson@sympraxisconsulting.com
 */

(function(B){var f="/";var k="Alerts";var j="Authentication";var n="Copy";var I="Forms";var l="Lists";var G="Meetings";var b="Permissions";var o="PublishedLinksService";var v="Search";var H="usergroup";var E="UserProfileService";var O="Versions";var g="Views";var A="WebPartPages";var m="Webs";var c="Workflow";var d="";var F=new Array();F.GetAlerts=k;F.DeleteAlerts=k;F.Mode=j;F.Login=j;F.CopyIntoItems=n;F.CopyIntoItemsLocal=n;F.GetItem=n;F.GetForm=I;F.GetFormCollection=I;F.AddList=l;F.CheckInFile=l;F.CheckOutFile=l;F.DeleteList=l;F.GetAttachmentCollection=l;F.GetList=l;F.GetListAndView=l;F.GetListCollection=l;F.GetListContentType=l;F.GetListContentTypes=l;F.GetListItems=l;F.UpdateList=l;F.UpdateListItems=l;F.AddMeeting=G;F.CreateWorkspace=G;F.RemoveMeeting=G;F.SetWorkSpaceTitle=G;F.GetPermissionCollection=b;F.GetLinks=o;F.GetPortalSearchInfo=v;F.GetSearchMetadata=v;F.Query=v;F.Status=v;F.AddGroup=H;F.AddGroupToRole=H;F.AddRole=H;F.GetAllUserCollectionFromWeb=H;F.GetGroupCollection=H;F.GetGroupCollectionFromRole=H;F.GetGroupCollectionFromSite=H;F.GetGroupCollectionFromUser=H;F.GetGroupCollectionFromWeb=H;F.GetGroupInfo=H;F.GetRoleCollection=H;F.GetRoleCollectionFromGroup=H;F.GetRoleCollectionFromUser=H;F.GetRoleCollectionFromWeb=H;F.GetRolesAndPermissionsForCurrentUser=H;F.GetRolesAndPermissionsForSite=H;F.GetUserCollection=H;F.GetUserCollectionFromGroup=H;F.GetUserCollectionFromRole=H;F.GetUserCollectionFromSite=H;F.GetUserCollectionFromWeb=H;F.GetUserInfo=H;F.GetUserLoginFromEmail=H;F.RemoveGroup=H;F.GetCommonMemberships=E;F.GetUserColleagues=E;F.GetUserLinks=E;F.GetUserMemberships=E;F.GetUserPinnedLinks=E;F.GetUserProfileByName=E;F.GetUserProfileCount=E;F.GetUserProfileSchema=E;F.ModifyUserPropertyByAccountName=E;F.DeleteAllVersions=O;F.DeleteVersion=O;F.GetVersions=O;F.RestoreVersion=O;F.GetViewCollection=g;F.AddWebPart=A;F.GetWebPart2=A;F.GetWebPartPage=A;F.GetWebPartProperties=A;F.GetWebPartProperties2=A;F.GetListTemplates=m;F.GetWeb=m;F.GetWebCollection=m;F.GetAllSubWebCollection=m;F.WebUrlFromPageUrl=m;F.GetTemplatesForItem=c;F.GetToDosForItem=c;F.GetWorkflowDataForItem=c;F.GetWorkflowTaskData=c;F.StartWorkflow=c;var y=new Object();y.header="<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body>";y.footer="</soap:Body></soap:Envelope>";y.payload="";B.fn.SPServices=function(P){var Q=B.extend({},B.fn.SPServices.defaults,P);y.opheader="<"+Q.operation+" ";switch(F[Q.operation]){case k:y.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/2002/1/alerts/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/2002/1/alerts/";break;case G:y.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/meetings/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/meetings/";break;case b:y.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/directory/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/directory/";break;case o:y.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/' >";SOAPAction="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/";break;case v:y.opheader+="xmlns='urn:Microsoft.Search' >";SOAPAction="urn:Microsoft.Search/";break;case H:y.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/directory/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/directory/";break;case E:y.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/UserProfileService' >";SOAPAction="http://microsoft.com/webservices/SharePointPortalServer/UserProfileService/";break;case A:y.opheader+="xmlns='http://microsoft.com/sharepoint/webpartpages' >";SOAPAction="http://microsoft.com/sharepoint/webpartpages/";break;case c:y.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/workflow/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/workflow/";break;default:y.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/'>";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/";break}SOAPAction+=Q.operation;y.opfooter="</"+Q.operation+">";var R=((Q.webURL.length>0)?Q.webURL:B().SPServices.SPGetCurrentSite())+"/_vti_bin/"+F[Q.operation]+".asmx";y.payload="";switch(Q.operation){case"GetAlerts":break;case"DeleteAlerts":y.payload+="<IDs>";for(i=0;i<Q.IDs.length;i++){y.payload+=t("string",Q.IDs[i])}y.payload+="</IDs>";break;case"Mode":break;case"Login":y.payload+=t("username",Q.username);y.payload+=t("password",Q.password);break;case"CopyIntoItems":y.payload+=t("SourceUrl",Q.SourceUrl);y.payload+="<DestinationUrls>";for(i=0;i<Q.DestinationUrls.length;i++){y.payload+=t("string",Q.DestinationUrls[i])}y.payload+="</DestinationUrls>";y.payload+=t("Fields",Q.Fields);y.payload+=t("Stream",Q.Stream);y.payload+=t("Results",Q.Results);break;case"CopyIntoItemsLocal":y.payload+=t("SourceUrl",Q.SourceUrl);y.payload+="<DestinationUrls>";for(i=0;i<Q.DestinationUrls.length;i++){y.payload+=t("string",Q.DestinationUrls[i])}y.payload+="</DestinationUrls>";break;case"GetItem":y.payload+=t("Url",Q.Url);y.payload+=t("Fields",Q.Fields);y.payload+=t("Stream",Q.Stream);break;case"GetForm":y.payload+=t("listName",Q.listName);y.payload+=t("formUrl",Q.formUrl);break;case"GetFormCollection":y.payload+=t("listName",Q.listName);break;case"AddList":y.payload+=t("listName",Q.listName);y.payload+=t("description",Q.description);y.payload+=t("templateID",Q.templateID);break;case"CheckInFile":y.payload+=t("pageUrl",Q.pageUrl);y.payload+=t("comment",Q.comment);y.payload+=t("CheckinType",Q.CheckinType);break;case"CheckOutFile":y.payload+=t("pageUrl",Q.pageUrl);y.payload+=t("checkoutToLocal",Q.checkoutToLocal);y.payload+=t("lastmodified",Q.lastmodified);break;case"DeleteList":y.payload+=t("listName",Q.listName);break;case"GetAttachmentCollection":y.payload+=t("listName",Q.listName);y.payload+=t("listItemID",Q.ID);break;case"GetList":y.payload+=t("listName",Q.listName);break;case"GetListAndView":y.payload+=t("listName",Q.listName);y.payload+=t("viewName",Q.viewName);break;case"GetListCollection":break;case"GetListContentType":y.payload+=t("listName",Q.listName);y.payload+=t("contentTypeId",Q.contentTypeId);break;case"GetListContentTypes":y.payload+=t("listName",Q.listName);break;case"GetListItems":y.payload+=t("listName",Q.listName);y.payload+=t("viewName",Q.viewName);y.payload+=t("query",Q.CAMLQuery);y.payload+=t("viewFields",Q.CAMLViewFields);y.payload+=t("rowLimit",Q.CAMLRowLimit);y.payload+=t("queryOptions",Q.CAMLQueryOptions);break;case"UpdateList":y.payload+=t("listName",Q.listName);y.payload+=t("listProperties",Q.listProperties);y.payload+=t("newFields",Q.newFields);y.payload+=t("updateFields",Q.updateFields);y.payload+=t("deleteFields",Q.deleteFields);y.payload+=t("listVersion",Q.listVersion);break;case"UpdateListItems":y.payload+=t("listName",Q.listName);if(Q.updates.length>0){y.payload+=t("updates",Q.updates)}else{y.payload+="<updates><Batch OnError='Continue'><Method ID='1' Cmd='"+Q.batchCmd+"'>";for(i=0;i<Q.valuepairs.length;i++){y.payload+="<Field Name='"+Q.valuepairs[i][0]+"'>"+Q.valuepairs[i][1]+"</Field>"}y.payload+="<Field Name='ID'>"+Q.ID+"</Field>";y.payload+="</Method></Batch></updates>"}break;case"AddMeeting":y.payload+=t("organizerEmail",Q.organizerEmail);y.payload+=t("uid",Q.uid);y.payload+=t("sequence",Q.sequence);y.payload+=t("utcDateStamp",Q.utcDateStamp);y.payload+=t("title",Q.title);y.payload+=t("location",Q.location);y.payload+=t("utcDateStart",Q.utcDateStart);y.payload+=t("utcDateEnd",Q.utcDateEnd);y.payload+=t("nonGregorian",Q.nonGregorian);break;case"CreateWorkspace":y.payload+=t("title",Q.title);y.payload+=t("templateName",Q.templateName);y.payload+=t("lcid",Q.lcid);y.payload+=t("timeZoneInformation",Q.timeZoneInformation);case"RemoveMeeting":y.payload+=t("recurrenceId",Q.recurrenceId);y.payload+=t("uid",Q.uid);y.payload+=t("sequence",Q.sequence);y.payload+=t("utcDateStamp",Q.utcDateStamp);y.payload+=t("cancelMeeting",Q.cancelMeeting);case"SetWorkspaceTitle":y.payload+=t("title",Q.title);case"GetPermissionCollection":y.payload+=t("objectName",Q.objectName);y.payload+=t("objectType",Q.objectType);break;case"GetLinks":break;case"GetPortalSearchInfo":SOAPAction="http://microsoft.com/webservices/OfficeServer/QueryService/"+Q.operation;y.opheader="<"+Q.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'/>";break;case"GetSearchMetadata":SOAPAction="http://microsoft.com/webservices/OfficeServer/QueryService/"+Q.operation;y.opheader="<"+Q.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'/>";break;case"Query":y.payload+=t("queryXml",a(Q.queryXml));break;case"Status":break;case"AddGroup":y.payload+=t("groupName",Q.groupName);y.payload+=t("ownerIdentifier",Q.ownerIdentifier);y.payload+=t("ownerType",Q.ownerType);y.payload+=t("defaultUserLoginName",Q.defaultUserLoginName);y.payload+=t("groupName",Q.groupName);y.payload+=t("description",Q.description);break;case"AddGroupToRole":y.payload+=t("groupName",Q.groupName);y.payload+=t("roleName",Q.roleName);break;case"AddRole":y.payload+=t("roleName",Q.roleName);y.payload+=t("description",Q.description);y.payload+=t("permissionMask",Q.permissionMask);break;case"GetAllUserCollectionFromWeb":break;case"GetGroupCollectionFromRole":y.payload+=t("roleName",Q.roleName);break;case"GetGroupCollection":y.payload+=t("groupNamesXml",Q.groupNamesXml);break;case"GetGroupCollectionFromSite":break;case"GetGroupCollectionFromUser":y.payload+=t("userLoginName",Q.userLoginName);break;case"GetGroupCollectionFromWeb":break;case"GetGroupInfo":y.payload+=t("groupName",Q.groupName);break;case"GetRoleCollection":y.payload+=t("roleNamesXml",Q.roleNamesXml);break;case"GetRoleCollectionFromGroup":y.payload+=t("groupName",Q.groupName);break;case"GetRoleCollectionFromUser":y.payload+=t("userLoginName",Q.userLoginName);break;case"GetRoleCollectionFromWeb":break;case"GetRoleInfo":y.payload+=t("roleName",Q.roleName);break;case"GetRolesAndPermissionsForCurrentUser":break;case"GetRolesAndPermissionsForSite":break;case"GetUserCollection":y.payload+=t("userLoginNamesXml",Q.userLoginNamesXml);break;case"GetUserCollectionFromGroup":y.payload+=t("groupName",Q.groupName);break;case"GetUserCollectionFromRole":y.payload+=t("roleName",Q.roleName);break;case"GetUserCollectionFromSite":break;case"GetUserCollectionFromWeb":break;case"GetUserInfo":y.payload+=t("userLoginName",Q.userLoginName);break;case"GetUserLoginFromEmail":y.payload+=t("emailXml",Q.emailXml);break;case"RemoveGroup":y.payload+=t("groupName",Q.groupName);break;case"GetCommonMemberships":y.payload+=t("accountName",Q.accountName);break;case"GetUserColleagues":y.payload+=t("accountName",Q.accountName);break;case"GetUserLinks":y.payload+=t("accountName",Q.accountName);break;case"GetUserMemberships":y.payload+=t("accountName",Q.accountName);break;case"GetUserPinnedLinks":y.payload+=t("accountName",Q.accountName);break;case"GetUserProfileByName":if(Q.accountName.length>0){y.payload+=t("AccountName",Q.accountName)}else{y.payload+=t("AccountName",Q.AccountName)}break;case"GetUserProfileCount":break;case"GetUserProfileSchema":break;case"ModifyUserPropertyByAccountName":y.payload+=t("accountName",Q.accountName);y.payload+=t("newData",Q.newData);break;case"GetViewCollection":y.payload+=t("listName",Q.listName);break;case"DeleteAllVersions":y.payload+=t("fileName",Q.fileName);break;case"DeleteVersion":y.payload+=t("fileName",Q.fileName);y.payload+=t("fileVersion",Q.fileVersion);break;case"GetVersions":y.payload+=t("fileName",Q.fileName);break;case"RestoreVersion":y.payload+=t("fileName",Q.fileName);y.payload+=t("fileVersion",Q.fileVersion);break;case"AddWebPart":y.payload+=t("pageUrl",Q.pageUrl);y.payload+=t("webPartXml",Q.webPartXml);y.payload+=t("storage",Q.storage);break;case"GetWebPart2":y.payload+=t("pageUrl",Q.pageUrl);y.payload+=t("storageKey",Q.storageKey);y.payload+=t("storage",Q.storage);y.payload+=t("behavior",Q.behavior);break;case"GetWebPartPage":y.payload+=t("documentName",Q.documentName);y.payload+=t("behavior",Q.behavior);break;case"GetWebPartProperties":y.payload+=t("pageUrl",Q.pageUrl);y.payload+=t("storage",Q.storage);break;case"GetWebPartProperties2":y.payload+=t("pageUrl",Q.pageUrl);y.payload+=t("storage",Q.storage);y.payload+=t("behavior",Q.behavior);break;case"GetWeb":y.payload+=t("webUrl",Q.webURL);break;case"GetListTemplates":break;case"GetWebCollection":break;case"GetAllSubWebCollection":break;case"WebUrlFromPageUrl":y.payload+=t("pageUrl",Q.pageURL);break;case"GetTemplatesForItem":y.payload+=t("item",Q.item);break;case"GetToDosForItem":y.payload+=t("item",Q.item);break;case"GetWorkflowDataForItem":y.payload+=t("item",Q.item);break;case"GetWorkflowTaskData":y.payload+=t("item",Q.item);y.payload+=t("listId",Q.listId);y.payload+=t("taskId",Q.taskId);break;case"StartWorkflow":y.payload+=t("item",Q.item);y.payload+=t("templateId",Q.templateId);y.payload+=t("workflowParameters",Q.workflowParameters);break;default:break}var S=y.header+y.opheader+y.payload+y.opfooter+y.footer;B.ajax({url:R,async:Q.async,beforeSend:function(T){T.setRequestHeader("SOAPAction",SOAPAction)},type:"POST",data:S,dataType:"xml",contentType:"text/xml; charset='utf-8'",complete:Q.completefunc})};B.fn.SPServices.defaults={operation:"",webURL:"",pageURL:"",listName:"",description:"",templateID:"",viewName:"",formUrl:"",fileName:"",fileVersion:"",ID:1,updates:"",comment:"",CheckinType:"",checkoutToLocal:"",lastmodified:"",CAMLViewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:0,CAMLQueryOptions:"<QueryOptions></QueryOptions>",batchCmd:"Update",valuepairs:[],listProperties:"",newFields:"",updateFields:"",deleteFields:"",listVersion:"",contentTypeId:"",username:"",password:"",accountName:"",newData:"",AccountName:"",userLoginName:"",groupNamesXml:"",groupName:"",ownerIdentifier:"",ownerType:"",defaultUserLoginName:"",roleNamesXml:"",roleName:"",permissionMask:"",userLoginNamesXml:"",emailXml:"",objectName:"",objectType:"List",IDs:null,SourceUrl:"",Url:"",DestinationUrls:[],Fields:"",Stream:"",Results:"",documentName:"",behavior:"Version3",storageKey:"",storage:"Shared",webPartXml:"",item:"",listId:"",taskId:"",templateId:"",workflowParameters:"",fClaim:false,queryXml:"",cancelMeeting:true,lcid:"",location:"",nonGregorian:false,organizerEmail:"",recurrenceId:0,sequence:0,templateName:"",timeZoneInformation:"",title:"",uid:"",utcDateStamp:"",utcDateStart:"",utcDateEnd:"",async:true,completefunc:null};B.fn.SPServices.SPGetCurrentSite=function(){if(d.length>0){return d}var P=y.header+"<WebUrlFromPageUrl xmlns='http://schemas.microsoft.com/sharepoint/soap/' ><pageUrl>"+((location.href.indexOf("?")>0)?location.href.substr(0,location.href.indexOf("?")):location.href)+"</pageUrl></WebUrlFromPageUrl>"+y.footer;B.ajax({async:false,url:"/_vti_bin/Webs.asmx",beforeSend:function(Q){Q.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/WebUrlFromPageUrl")},type:"POST",data:P,dataType:"xml",contentType:'text/xml; charset="utf-8"',complete:function(R,Q){d=B(R.responseXML).find("WebUrlFromPageUrlResult").text()}});return d};B.fn.SPServices.SPCascadeDropdowns=function(P){var R=B.extend({},{relationshipWebURL:"",relationshipList:"",relationshipListParentColumn:"",relationshipListChildColumn:"",relationshipListSortColumn:"",parentColumn:"",childColumn:"",CAMLQuery:"",promptText:"Choose {0}...",completefunc:null,debug:false},P);var Q=new J(R.parentColumn);if(Q.Obj.html()==null&&R.debug){z("SPServices.SPCascadeDropdowns","parentColumn: "+R.parentColumn,"Column not found on page");return}switch(Q.Type){case"S":Q.Obj.bind("change",function(){L(R)});Q.Obj.change();break;case"C":Q.Obj.bind("propertychange",function(){L(R)});Q.Obj.trigger("propertychange");break;case"M":Q.Obj.bind("dblclick",function(){L(R)});parentSelections=Q.Obj.closest("span").find("select:[Title='"+R.parentColumn+" selected values']");parentSelections.bind("dblclick",function(){L(R)});Q.Obj.closest("span").find("button").each(function(){B(this).bind("click",function(){L(R)})});L(R);break;default:break}};function L(S){var ab="";var W=null;var V=[];var R;var X;var Y;var Z;var U=new J(S.parentColumn);switch(U.Type){case"S":V.push(U.Obj.find("option:selected").text());break;case"C":V.push(U.Obj.attr("value"));break;case"M":parentSelections=U.Obj.closest("span").find("select:[Title='"+S.parentColumn+" selected values']");B(parentSelections).find("option").each(function(){V.push(B(this).html())});break;default:break}if(U.Obj.attr("cascadeDropdownSelected_"+S.childColumn)==V.join(";#")){return}U.Obj.attr("cascadeDropdownSelected_"+S.childColumn,V.join(";#"));var Q=new J(S.childColumn);if(Q.Obj.html()==null&&S.debug){z("SPServices.SPCascadeDropdowns","childColumn: "+S.childColumn,"Column not found on page");return}switch(Q.Type){case"S":W=Q.Obj.find("option:selected").val();break;case"C":W=Q.Obj.attr("value");break;case"M":X=Q.Obj.closest("span").find("input:[name$='MultiLookupPicker$data']");R=window[Q.Obj.closest("tr").find("button:[id$='AddButton']").attr("id").replace(/AddButton/,"MultiLookupPicker_m")];currentSelection=Q.Obj.closest("span").find("select:[Title='"+S.childColumn+" selected values']");R.data="";break;default:break}var T=(S.relationshipListSortColumn.length>0)?S.relationshipListSortColumn:S.relationshipListChildColumn;var P="<Query><OrderBy><FieldRef Name='"+T+"'/></OrderBy><Where>";if(S.CAMLQuery.length>0){P+="<And>"}if(V.length==0){P+="<Eq><FieldRef Name='"+S.relationshipListParentColumn+"'/><Value Type='Text'></Value></Eq>"}else{if(V.length==1){P+="<Eq><FieldRef Name='"+S.relationshipListParentColumn+"'/><Value Type='Text'>"+q(V[0])+"</Value></Eq>"}else{var aa=(V.length>2)?true:false;for(i=0;i<(V.length-1);i++){P+="<Or>"}for(i=0;i<V.length;i++){P+="<Eq><FieldRef Name='"+S.relationshipListParentColumn+"'/><Value Type='Text'>"+q(V[i])+"</Value></Eq>";if(i>0&&(i<(V.length-1))&&aa){P+="</Or>"}}P+="</Or>"}}if(S.CAMLQuery.length>0){P+=S.CAMLQuery+"</And>"}P+="</Where></Query>";B().SPServices({operation:"GetList",async:false,listName:s(),completefunc:function(ad,ac){B(ad.responseXML).find("Fields").each(function(){B(ad.responseXML).find("Field").each(function(){if(B(this).attr("DisplayName")==S.childColumn){Z=(B(this).attr("Required")=="TRUE")?true:false}})})}});B().SPServices({operation:"GetListItems",async:false,webURL:S.relationshipWebURL,listName:S.relationshipList,CAMLQuery:P,CAMLViewFields:"<ViewFields><FieldRef Name='"+S.relationshipListParentColumn+"' /><FieldRef Name='"+S.relationshipListChildColumn+"' /></ViewFields>",CAMLRowLimit:0,completefunc:function(ad,ac){B(ad.responseXML).find("faultcode").each(function(){if(S.debug){z("SPServices.SPCascadeDropdowns","relationshipListParentColumn: "+S.relationshipListParentColumn+" or relationshipListChildColumn: "+S.relationshipListChildColumn,"Not found in relationshipList "+S.relationshipList)}return});switch(Q.Type){case"S":Q.Obj.attr({length:0});if(!Z&&S.promptText.length>0){Q.Obj.append("<option value='0'>"+S.promptText.replace(/\{0\}/g,S.childColumn)+"</option>")}break;case"C":ab=Z?"":"(None)|0";Q.Obj.attr("value","");break;case"M":Q.Obj.attr({length:0});Y="";break;default:break}B(ad.responseXML).find("[nodeName=z:row]").each(function(){var af=(B(this).attr("ows_"+S.relationshipListChildColumn).indexOf(";#")>0)?B(this).attr("ows_"+S.relationshipListChildColumn).split(";#")[0]:B(this).attr("ows_ID");if(isNaN(af)){af=B(this).attr("ows_ID")}var ae=(B(this).attr("ows_"+S.relationshipListChildColumn).indexOf(";#")>0)?B(this).attr("ows_"+S.relationshipListChildColumn).split(";#")[1]:B(this).attr("ows_"+S.relationshipListChildColumn);switch(Q.Type){case"S":var ag=(B(this).attr("ows_ID")==W)?" selected='selected'":"";Q.Obj.append("<option"+ag+" value='"+af+"'>"+ae+"</option>");break;case"C":if(ae==W){Q.Obj.attr("value",W)}ab=ab+((ab.length>0)?"|":"")+ae+"|"+af;break;case"M":Q.Obj.append("<option value='"+af+"'>"+ae+"</option>");Y+=af+"|t"+ae+"|t |t |t";break;default:break}});switch(Q.Type){case"S":Q.Obj.trigger("change");break;case"C":Q.Obj.attr("choices",ab);Q.Obj.trigger("propertychange");break;case"M":X.attr("value",Y);B(currentSelection).find("option").each(function(){var ae=B(this);B(this).attr("selected","selected");B(Q.Obj).find("option").each(function(){if(B(this).html()==ae.html()){ae.attr("selected","")}})});GipRemoveSelectedItems(R);B(Q.Obj).find("option").each(function(){var ae=B(this);B(currentSelection).find("option").each(function(){if(B(this).html()==ae.html()){ae.remove()}})});GipAddSelectedItems(R);R.data=GipGetGroupData(Y);break;default:break}}});if(S.completefunc!=null){S.completefunc()}}B.fn.SPServices.SPDisplayRelatedInfo=function(P){var Q=B.extend({},{columnName:"",relatedWebURL:"",relatedList:"",relatedListColumn:"",relatedColumns:[],displayFormat:"table",headerCSSClass:"ms-vh2",rowCSSClass:"ms-vb",CAMLQuery:"",numChars:0,matchType:"Eq",completefunc:null,debug:false},P);var R=new J(Q.columnName);if(R.Obj.html()==null&&Q.debug){z("SPServices.SPDisplayRelatedInfo","columnName: "+Q.columnName,"Column not found on page");return}switch(R.Type){case"S":R.Obj.bind("change",function(){w(Q)});R.Obj.change();break;case"C":R.Obj.bind("propertychange",function(){w(Q)});R.Obj.trigger("propertychange");break;case"M":if(Q.debug){z("SPServices.SPDisplayRelatedInfo","columnName: "+Q.columnName,"Multi-select columns not supported by this function")}break;default:break}};function w(U){var Q=null;var V=new J(U.columnName);switch(V.Type){case"S":Q=V.Obj.find("option:selected").text();break;case"C":Q=V.Obj.attr("value");if(U.numChars>0&&Q.length<U.numChars){return}break;case"M":break;default:break}if(V.Obj.attr("showRelatedSelected")==Q){return}V.Obj.attr("showRelatedSelected",Q);var S="showRelated_"+D(U.columnName);B("#"+S).remove();V.Obj.parent().append("<div id="+S+"></div>");var T=[];B().SPServices({operation:"GetList",async:false,webURL:U.relatedWebURL,listName:U.relatedList,completefunc:function(X,W){B(X.responseXML).find("faultcode").each(function(){if(U.debug){z("SPServices.SPDisplayRelatedInfo","relatedList: "+U.relatedList,"List not found")}return});B(X.responseXML).find("Fields").each(function(){B(X.responseXML).find("Field").each(function(){for(i=0;i<U.relatedColumns.length;i++){if(B(this).attr("Name")==U.relatedColumns[i]){T[i]=B(this)}}})})}});var P="<Query><Where>";if(U.CAMLQuery.length>0){P+="<And>"}P+="<"+U.matchType+"><FieldRef Name='"+U.relatedListColumn+"'/><Value Type='Text'>"+q(Q)+"</Value></"+U.matchType+">";if(U.CAMLQuery.length>0){P+=U.CAMLQuery+"</And>"}P+="</Where></Query>";var R=" ";for(i=0;i<U.relatedColumns.length;i++){R+="<FieldRef Name='"+U.relatedColumns[i]+"' />"}B().SPServices({operation:"GetListItems",async:false,webURL:U.relatedWebURL,listName:U.relatedList,CAMLQuery:P,CAMLViewFields:"<ViewFields>"+R+"</ViewFields>",CAMLRowLimit:0,completefunc:function(Y,X){B(Y.responseXML).find("faultcode").each(function(){if(U.debug){z("SPServices.SPDisplayRelatedInfo","relatedListColumn: "+U.relatedListColumn,"Column not found in relatedList "+U.relatedList)}return});switch(U.displayFormat){case"table":var W="<table>";W+="<tr>";for(i=0;i<U.relatedColumns.length;i++){if(T[i]==undefined&&U.debug){z("SPServices.SPDisplayRelatedInfo","columnName: "+U.relatedColumns[i],"Column not found in relatedList");return}W+="<th class='"+U.headerCSSClass+"'>"+T[i].attr("DisplayName")+"</th>"}W+="</tr>";B(Y.responseXML).find("[nodeName=z:row]").each(function(){W+="<tr>";for(i=0;i<U.relatedColumns.length;i++){W+="<td class='"+U.rowCSSClass+"'>"+r(T[i],B(this).attr("ows_"+U.relatedColumns[i]),U)+"</td>"}W+="</tr>"});W+="</table>";B("#showRelated_"+D(U.columnName)).html("").append(W);break;case"list":var W="<table>";for(i=0;i<U.relatedColumns.length;i++){B(Y.responseXML).find("[nodeName=z:row]").each(function(){W+="<tr>";W+="<th class='"+U.headerCSSClass+"'>"+T[i].attr("DisplayName")+"</th>";W+="<td class='"+U.rowCSSClass+"'>"+r(T[i],B(this).attr("ows_"+U.relatedColumns[i]),U)+"</td>";W+="</tr>"})}W+="</table>";B("#showRelated_"+D(U.columnName)).html("").append(W);break;default:break}}});if(U.completefunc!=null){U.completefunc()}}B.fn.SPServices.SPDebugXMLHttpResult=function(Q){var S=B.extend({},{node:null,indent:0},Q);var U=3;var T=4;var P="";P+="<table class='ms-vb' style='margin-left:"+S.indent*3+"px;' width='100%'>";if(S.node.nodeName=="DisplayPattern"){P+="<tr><td width='100px' style='font-weight:bold;'>"+S.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+S.node.xml+"</textarea></td></tr>"}else{if(!S.node.hasChildNodes()){P+="<tr><td width='100px' style='font-weight:bold;'>"+S.node.nodeName+"</td><td>"+((S.node.nodeValue!=null)?p(S.node.nodeValue):"&nbsp;")+"</td></tr>";if(S.node.attributes){P+="<tr><td colspan='99'>";P+=K(S.node,S);P+="</td></tr>"}}else{if(S.node.hasChildNodes()&&S.node.firstChild.nodeType==T){P+="<tr><td width='100px' style='font-weight:bold;'>"+S.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+S.node.parentNode.text+"</textarea></td></tr>"}else{if(S.node.hasChildNodes()&&S.node.firstChild.nodeType==U){P+="<tr><td width='100px' style='font-weight:bold;'>"+S.node.nodeName+"</td><td>"+p(S.node.firstChild.nodeValue)+"</td></tr>"}else{P+="<tr><td width='100px' style='font-weight:bold;' colspan='99'>"+S.node.nodeName+"</td></tr>";if(S.node.attributes){P+="<tr><td colspan='99'>";P+=K(S.node,S);P+="</td></tr>"}P+="<tr><td>";for(var R=0;R<S.node.childNodes.length;R++){P+=B().SPServices.SPDebugXMLHttpResult({node:S.node.childNodes.item(R),indent:S.indent+1})}P+="</td></tr>"}}}}P+="</table>";return P};B.fn.SPServices.SPGetCurrentUser=function(){var P="";B.ajax({async:false,url:B().SPServices.SPGetCurrentSite()+"/_layouts/userdisp.aspx?Force=True",complete:function(R,Q){B(R.responseText).find("table.ms-formtable td#SPFieldText").each(function(){if(/FieldInternalName=\"Name\"/.test(B(this).html())){P=B(this).text()}})}});return P.replace(/(^[\s\xA0]+|[\s\xA0]+$)/g,"")};B.fn.SPServices.SPLookupAddNew=function(R){var S=B.extend({},{lookupColumn:"",promptText:"Add new {0}",completefunc:null,debug:false},R);var Q=new J(S.lookupColumn);if(Q.Obj.html()==null&&S.debug){z("SPServices.SPLookupAddNew","lookupColumn: "+S.lookupColumn,"Column not found on page");return}var T="";var P="";B().SPServices({operation:"GetList",async:false,listName:s(),completefunc:function(V,U){B(V.responseXML).find("Field").each(function(){if(B(this).attr("DisplayName")==S.lookupColumn){B().SPServices({operation:"GetList",async:false,listName:B(this).attr("List"),completefunc:function(X,W){B(X.responseXML).find("List").each(function(){P=B(this).attr("WebFullUrl");P=P!=f?P+f:P})}});B().SPServices({operation:"GetFormCollection",async:false,listName:B(this).attr("List"),completefunc:function(X,W){B(X.responseXML).find("Form").each(function(){if(B(this).attr("Type")=="NewForm"){T=B(this).attr("Url")}})}})}})}});if(P.length==0&&S.debug){z("SPServices.SPLookupAddNew","lookupColumn: "+S.lookupColumn,"This column does not appear to be a lookup column");return}if(T.length>0){newLink="<a href='"+P+T+"?Source="+N(location.href)+"'>"+S.promptText.replace(/\{0\}/g,S.lookupColumn)+"</a>";B(Q.Obj).parents("td.ms-formbody").append(newLink)}else{if(S.debug){z("SPServices.SPLookupAddNew","lookupColumn: "+S.lookupColumn,"NewForm cannot be found");return}}if(S.completefunc!=null){S.completefunc()}};B.fn.SPServices.SPGetLastItemId=function(Q){var S=B.extend({},{webURL:"",listName:"",userAccount:"",CAMLQuery:""},Q);var R;var T=0;B().SPServices({operation:"GetUserInfo",async:false,userLoginName:(S.userAccount!="")?S.userAccount:B().SPServices.SPGetCurrentUser(),completefunc:function(V,U){B(V.responseXML).find("User").each(function(){R=B(this).attr("ID")})}});var P="<Query><Where>";if(S.CAMLQuery.length>0){P+="<And>"}P+="<Eq><FieldRef Name='Author' LookupId='TRUE'/><Value Type='Integer'>"+R+"</Value></Eq>";if(S.CAMLQuery.length>0){P+=S.CAMLQuery+"</And>"}P+="</Where><OrderBy><FieldRef Name='Created_x0020_Date' Ascending='FALSE'/></OrderBy></Query>";B().SPServices({operation:"GetListItems",async:false,webURL:S.webURL,listName:S.listName,CAMLQuery:P,CAMLViewFields:"<ViewFields><FieldRef Name='ID'/></ViewFields>",CAMLRowLimit:1,completefunc:function(V,U){B(V.responseXML).find("[nodeName=z:row]").each(function(){T=B(this).attr("ows_ID")})}});return T};B.fn.SPServices.SPRequireUnique=function(R){var S=B.extend({},{columnStaticName:"Title",duplicateAction:0,ignoreCase:"false",initMsg:"This value must be unique.",initMsgCSSClass:"ms-vb",errMsg:"This value is not unique.",errMsgCSSClass:"ms-formvalidation",completefunc:null},R);var W="<span id='SPRequireUnique"+S.columnStaticName+"' class='{0}'>{1}<br/></span>";var P=W.replace(/\{0\}/g,S.initMsgCSSClass).replace(/\{1\}/g,S.initMsg);var V=W.replace(/\{0\}/g,S.errMsgCSSClass).replace(/\{1\}/g,S.errMsg);var U=s();var T=B().SPServices.SPGetDisplayFromStatic({listName:U,columnStaticName:S.columnStaticName});var Q=B("input:[Title='"+T+"']");B(Q).parent().append(P);B(Q).change(function(){var Y=0;var Z=B(this).attr("value");B().SPServices({operation:"GetListItems",async:false,listName:s(),CAMLQuery:"<Query><Where><IsNotNull><FieldRef Name='"+S.columnStaticName+"'/></IsNotNull></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='"+S.columnStaticName+"' /></ViewFields>",CAMLRowLimit:0,completefunc:function(ac,aa){var ab=S.ignoreCase?Z.toUpperCase():Z;B(ac.responseXML).find("[nodeName=z:row]").each(function(){var ad=S.ignoreCase?B(this).attr("ows_"+S.columnStaticName).toUpperCase():B(this).attr("ows_"+S.columnStaticName);if(ab==ad){Y++}})}});var X=P;B("input:[value='OK']").attr("disabled","");if(Y>0){X=V;if(S.duplicateAction==1){B("input:[Title='"+S.columnDisplayName+"']").focus();B("input:[value='OK']").attr("disabled","disabled")}}B("span#SPRequireUnique"+S.columnStaticName).html(X)});if(S.completefunc!=null){S.completefunc()}};B.fn.SPServices.SPGetDisplayFromStatic=function(P){var R=B.extend({},{webURL:"",listName:"",columnStaticName:""},P);var Q="";B().SPServices({operation:"GetList",async:false,webURL:R.webURL,listName:R.listName,completefunc:function(T,S){B(T.responseXML).find("Field").each(function(){if(B(this).attr("StaticName")==R.columnStaticName){displayName=B(this).attr("DisplayName")}})}});return displayName};B.fn.SPServices.SPRedirectWithID=function(Q){var R=B.extend({},{redirectUrl:""},Q);var S=s();var U=B().SPServices.SPGetQueryString();var T=U.ID;if(U.ID==undefined){T=B().SPServices.SPGetLastItemId({listName:S});B("form[name='aspnetForm']").each(function(){var V=(location.href.indexOf("?")>0)?location.href.substring(0,location.href.indexOf("?")):location.href;var W=(typeof U.Source=="string")?"Source="+U.Source.replace(/\//g,"%2f").replace(/:/g,"%3a"):"";var X=V+"?Source="+V+"?ID="+T+((W.length>0)?("%26RealSource="+U.Source):"")+((typeof U.RedirectURL=="string")?("%26RedirectURL="+U.RedirectURL):"");B(this).attr("action",X)})}else{while(U.ID==T){T=B().SPServices.SPGetLastItemId({listName:S})}var P=(typeof U.RedirectURL=="string")?U.RedirectURL:R.redirectUrl;location.href=P+"?ID="+T+((typeof U.RealSource=="string")?("&Source="+U.RealSource):"")}};B.fn.SPServices.SPSetMultiSelectSizes=function(T){var U=B.extend({},{multiSelectColumn:""},T);var W=B("select:[Title='"+U.multiSelectColumn+" possible values']");var Q=W.closest("span").find("select:[Title*=' selected values']");var V="SPSetMultiSelectSizes_"+D(U.multiSelectColumn);W.clone().appendTo(W.closest("span")).css({width:"auto",height:0,visibility:"hidden"}).attr({id:V,length:0});var S=B("#"+V);W.find("option").each(function(){S.append("<option value='"+B(this).html()+"'>"+B(this).html()+"</option>")});Q.find("option").each(function(){S.append("<option value='"+B(this).html()+"'>"+B(this).html()+"</option>")});var P=B("#"+V).width()+5;var R=P-17;W.css("width",R+"px").parent().css("width",P+"px");Q.css("width",R+"px").parent().css("width",P+"px");B("#"+V).remove()};B.fn.SPServices.SPScriptAudit=function(Q){var R=B.extend({},{webURL:"",listName:"",outputId:"",auditForms:true,auditViews:true,auditPages:true,auditPagesListName:"Pages",showHiddenLists:false,showNoScript:false,showSrc:true},Q);var P=["Display","Edit","New"];var S;B("#"+R.outputId).append("<table id='SPScriptAudit' width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1><tr><th></th><th>List</th><th>Page Class</th><th>Page Type</th><th>Page</th>"+(R.showSrc?"<th>Script in the Page</th><th>Script in a Web Part</th>":"")+"<th>jQuery</th></tr></table>");B("#SPScriptAudit th").attr("class","ms-vh2-nofilter");if(R.auditForms||R.auditViews){B().SPServices({operation:"GetListCollection",webURL:R.webURL,async:false,completefunc:function(U,T){B(U.responseXML).find(l).each(function(){B(this).find("List").each(function(){S=B(this);if((R.showHiddenLists&&S.attr("Hidden")=="False")||!R.showHiddenLists){if(R.auditForms){B().SPServices({operation:"GetListContentTypes",webURL:R.webURL,listName:S.attr("ID"),async:false,completefunc:function(W,V){B(W.responseXML).find("ContentType").each(function(){if(B(this).attr("ID").substring(0,6)!="0x0120"){B(this).find("FormUrls").each(function(){for(var X=0;X<P.length;X++){B(this).find(P[X]).each(function(){h(R,S,"Form",P[X],((R.webURL.length>0)?R.webURL:B().SPServices.SPGetCurrentSite())+f+B(this).text())})}})}})}})}if(R.auditViews){B().SPServices({operation:"GetViewCollection",webURL:R.webURL,listName:S.attr("ID"),async:false,completefunc:function(W,V){B(W.responseXML).find("View").each(function(){h(R,S,"View",B(this).attr("DisplayName"),B(this).attr("Url"))})}})}}})})}})}if(R.auditPages){B().SPServices({operation:"GetList",async:false,webURL:R.webURL,listName:R.auditPagesListName,completefunc:function(U,T){B(U.responseXML).find("List").each(function(){S=B(this)})}});B().SPServices({operation:"GetListItems",async:false,webURL:R.webURL,listName:R.auditPagesListName,CAMLQuery:"<Query><Where><Neq><FieldRef Name='ContentType'/><Value Type='Text'>Folder</Value></Neq></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='Title'/><FieldRef Name='FileRef'/></ViewFields>",CAMLRowLimit:0,completefunc:function(U,T){B(U.responseXML).find("[nodeName=z:row]").each(function(){var W=B(this).attr("ows_FileRef").split(";#")[1];var V=(B(this).attr("ows_Title")!=undefined)?B(this).attr("ows_Title"):"";if(W.indexOf(".aspx")>0){h(R,S,"Page",V,f+W)}})}})}B("#SPScriptAudit tr[class='ms-alternating']:even").attr("class","")};function h(P,R,ab,V,T){var Z=0;var aa=0;var S=new Object();S.type=[];S.src=[];S.script=[];var U=new Object();U.type=[];U.src=[];U.script=[];var Q="$(";var W=RegExp("<head[\\s\\S]*?/head>","gi");var Y=RegExp("<script[\\s\\S]*?/script>","gi");var X;B.ajax({type:"GET",url:T,dataType:"text",success:function(ad){headHtml=W.exec(ad);while(scriptMatch=Y.exec(headHtml)){var ag=x(scriptMatch,"language");var ai=x(scriptMatch,"type");var ac=x(scriptMatch,"src");if(ac!=null&&ac.length>0&&!C(ac)){U.type.push((ag!=null&&ag.length>0)?ag:ai);U.src.push(ac)}var ak=scriptMatch.innerHTML;if(ak!=undefined&&ak.indexOf(Q)>-1){U.script.push(scriptMatch.innerHTML);Z++}}B(ad).find("script").each(function(){if(B(this).closest("td[id^='MSOZoneCell_WebPartWP']").html()==null){if((B(this).attr("src")!=undefined)&&(B(this).attr("src").length>0)&&!C(B(this).attr("src"))){U.type.push(B(this).attr("language").length>0?B(this).attr("language"):B(this).attr("type"));U.src.push(B(this).attr("src"))}if(B(this).html().indexOf(Q)>-1){U.script.push(B(this).html());Z++}}else{if(B(this).attr("src")!=undefined&&B(this).attr("src").length>0){S.type.push(B(this).attr("language").length>0?B(this).attr("language"):B(this).attr("type"));S.src.push(B(this).attr("src"))}if(B(this).html().indexOf(Q)>-1){S.script.push(B(this).html());aa++}}});if((!P.showNoScript&&(S.type.length>0||U.type.length>0))||P.showNoScript){var ah=T.substring(0,T.lastIndexOf(f)+1);var ae="<tr class=ms-alternating><td class=ms-vb-icon><a href='"+R.attr("DefaultViewUrl")+"'><IMG border=0 src='"+R.attr("ImageUrl")+"'width=16 height=16></A></TD><td class=ms-vb2><a href='"+R.attr("DefaultViewUrl")+"'>"+R.attr("Title")+((R.attr("Hidden")=="True")?"(Hidden)":"")+"</td><td class=ms-vb2>"+ab+"</td><td class=ms-vb2>"+V+"</td><td class=ms-vb2><a href='"+T+"'>"+u(T)+"</td>";if(P.showSrc){ae+="<td valign='top'><table width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1>";for(var af=0;af<U.type.length;af++){var aj=(U.src[af].substr(0,1)!=f)?ah+U.src[af]:U.src[af];ae+="<tr><td class=ms-vb2 width='30%'>"+U.type[af]+"</td>";ae+="<td class=ms-vb2 width='70%'><a href='"+aj+"'>"+u(U.src[af])+"</td></tr>"}if(Z>0){for(var af=0;af<U.script.length;af++){ae+="<tr><td class=ms-vb2 colspan=99><textarea class=ms-vb2 readonly='readonly' rows='5' cols='50'>"+U.script[af]+"</textarea></td></tr>"}}ae+="</table></td>";ae+="<td valign='top'><table width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1>";for(var af=0;af<S.type.length;af++){var aj=(S.src[af].substr(0,1)!=f)?ah+S.src[af]:S.src[af];ae+="<tr><td class=ms-vb2 width='30%'>"+S.type[af]+"</td>";ae+="<td class=ms-vb2 width='70%'><a href='"+aj+"'>"+u(S.src[af])+"</td></tr>"}if(aa>0){for(var af=0;af<S.script.length;af++){ae+="<tr><td class=ms-vb2 colspan=99><textarea class=ms-vb2 readonly='readonly' rows='5' cols='50'>"+S.script[af]+"</textarea></td></tr>"}}ae+="</table></td>"}ae+="<td class=ms-vb2>"+(((Z+aa)>0)?"Yes":"No")+"</td></tr>";B("#SPScriptAudit").append(ae)}}})}function x(R,Q){var P=RegExp(Q+"=(\"([^\"]*)\")|('([^']*)')","gi");if(matches=P.exec(R)){return matches[2]}return null}function C(R){var Q=["WebResource.axd","_layouts"];for(var P=0;P<Q.length;P++){if(R.indexOf(Q[P])>-1){return true}}return false}B.fn.SPServices.SPArrangeChoices=function(P){var Q=B.extend({},{columnName:"",perRow:99},P);var R=RegExp('FieldName="'+Q.columnName+'"',"gi");B("td.ms-formbody").each(function(){if(R.test(B(this).html())){var T="<TR>";var S=0;B(this).find("tr").each(function(){T+=B(this).html();S++;if(S%Q.perRow==0){T+="</TR><TR>"}});T+="</TR>";B(this).find("tr").remove();B(this).find("table").append(T)}})};B.fn.SPServices.SPGetQueryString=function(){var T=new Object();var P=location.search.substring(1,location.search.length);var R=P.split("&");for(var S=0;S<R.length;S++){var U=R[S].split("=");var Q=unescape(U[1]).split("+");U[1]=Q.join(" ");T[U[0]]=U[1]}return T};function r(U,T,S){if(T==undefined){return""}var P;switch(U.attr("Type")){case"Text":P=T;break;case"URL":switch(U.attr("Format")){case"Hyperlink":P="<a href='"+T.substring(0,T.search(","))+"'>"+T.substring(T.search(",")+1)+"</a>";break;case"Image":P="<img alt='"+T.substring(T.search(",")+1)+"' src='"+T.substring(0,T.search(","))+"'/>";break;default:P=T;break}break;case"User":P="<a href='/_layouts/userdisp.aspx?ID="+T.substring(0,T.search(";#"))+"&Source="+N(location.href)+"'>"+T.substring(T.search(";#")+2)+"</a>";break;case"Calculated":var Q=T.split(";#");P=Q[1];break;case"Number":P=parseFloat(T).toFixed(U.attr("Decimals")).toString();break;case"Lookup":var R;B().SPServices({operation:"GetFormCollection",async:false,listName:U.attr("List"),completefunc:function(W,V){B(W.responseXML).find("Form").each(function(){if(B(this).attr("Type")=="DisplayForm"){R=B(this).attr("Url")}})}});P="<a href='"+S.relatedWebURL+f+R+"?ID="+T.substring(0,T.search(";#"))+"&RootFolder=*'>"+T.substring(T.search(";#")+2)+"</a>";break;case"Counter":P=T;break;default:P=T;break}return P}function K(S,R){var P="<table class='ms-vb' width='100%'>";for(var Q=0;Q<S.attributes.length;Q++){P+="<tr><td width='10px' style='font-weight:bold;'>"+Q+"</td><td width='100px'>"+S.attributes.item(Q).nodeName+"</td><td>"+p(S.attributes.item(Q).nodeValue)+"</td></tr>"}P+="</table>";return P}function s(){var R=location.href;var Q=R.substring(0,R.indexOf(".aspx"));var S=M(Q.substring(0,Q.lastIndexOf(f)));var P="";B().SPServices({operation:"GetListCollection",async:false,completefunc:function(U,T){B(U.responseXML).find("List").each(function(){var V=B(this).attr("DefaultViewUrl");var W=V.substring(0,V.lastIndexOf(f));if(S.indexOf(W)>0){P=B(this).attr("ID")}})}});return P}function J(P){if((this.Obj=B("select[Title='"+P+"']")).html()!=null){this.Type="S"}else{if((this.Obj=B("input[Title='"+P+"']")).html()!=null){this.Type="C"}else{if((this.Obj=B("select[Title='"+P+" possible values']")).html()!=null){this.Type="M"}else{this.Type=null}}}}function z(Q,S,R){var P="<b>Error in function</b><br/>"+Q+"<br/><b>Parameter</b><br/>"+S+"<br/><b>Message</b><br/>"+R+"<br/><br/><span style='width=100%;text-align:right;'>Click to continue</span></div>";e(P)}function e(U){var R="position:absolute;width:300px;height:150px;padding:10px;background-color:#000000;color:#ffffff;z-index:30;font-family:'Arial';font-size:12px;display:none;";B("#aspnetForm").parent().append("<div id='SPServices_msgBox' style="+R+">"+U);var P=B("#SPServices_msgBox").height();var T=B("#SPServices_msgBox").width();var S=(B(window).width()/2)-(T/2)+"px";var Q=(B(window).height()/2)-(P/2)-100+"px";B("#SPServices_msgBox").css({border:"5px #C02000 solid",left:S,top:Q}).show().fadeTo("slow",0.75).click(function(){B(this).fadeOut("3000",function(){B(this).remove()})})}function p(P){return((P.indexOf("http")==0)||(P.indexOf(f)==0))?"<a href='"+P+"'>"+P+"</a>":P}function u(P){return P.substring(P.lastIndexOf(f)+1,P.length)}function a(P){return P.replace(/"/g,"&quot;").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function q(P){return P.replace(/&/g,"&amp;")}function M(P){return P.replace(/%20/g," ")}function N(P){return P.replace(/&/g,"%26")}function D(P){return P.replace(/ /g,"_x0020_")}function t(Q,P){return"<"+Q+">"+P+"</"+Q+">"}})(jQuery);