/*
* SPServices - Work with SharePoint's Web Services using jQuery
* Version 2.0.0
* @requires jQuery v1.8 or greater - jQuery 1.10.x+ recommended
*
* Copyright (c) 2009-2015 Sympraxis Consulting LLC
* Examples and docs at:
* http://spservices.codeplex.com/
* Licensed under the MIT license:
* http://www.opensource.org/licenses/mit-license.php
*/
/*
* @description SPServices is a jQuery library which abstracts SharePoint's Web Services and makes them easier to use. It also includes functions which use the various Web Service operations to provide more useful (and cool) capabilities. It works entirely client side and requires no server install.
* @type jQuery
* @name SPServices
* @category Plugins/SPServices
* @author Sympraxis Consulting LLC/marc.anderson@sympraxisconsulting.com
* @build SPServices 2.0.0 2015-05-27 03:45:31
*/
!function(){var a,b,c,d,e;!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(f){var g=jQuery;a=function(){var a={VERSION:"2.0.0",spDelim:";#",SLASH:"/",TXTColumnNotFound:"Column not found on page",SCHEMASharePoint:"http://schemas.microsoft.com/sharepoint",multiLookupPrefix:"MultiLookupPicker",multiLookupPrefix2013:"MultiLookup",dropdownType:{simple:"S",complex:"C",multiSelect:"M"},spListFieldTypes:["Integer","Text","Note","DateTime","Counter","Choice","Lookup","Boolean","Number","Currency","URL","MultiChoice","Calculated","File","Attachments","User","ModStat","ContentTypeId","WorkflowStatus","RelatedItems","UserMulti","LookupMulti","datetime","float","Calc"]};return a}(),b=function(a,b){var c={wrapNode:function(a,b){var c="undefined"!=typeof b?b:"";return"<"+a+">"+c+"</"+a+">"},randOrd:function(){return Math.round(Math.random())-.5},checkLink:function(a){return 0===a.indexOf("http")||0===a.indexOf("/")?"<a href='"+a+"'>"+a+"</a>":a},fileName:function(a){return a.substring(a.lastIndexOf("/")+1,a.length)},xml_special_to_escaped_one_map:{"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"},encodeXml:function(a){return a.replace(/([\&"<>])/g,function(a,b){return this.xml_special_to_escaped_one_map[b]})},escapeColumnValue:function(a){return"string"==typeof a?a.replace(/&(?![a-zA-Z]{1,8};)/g,"&amp;"):a},escapeUrl:function(a){return a.replace(/&/g,"%26")},SplitIndex:function(a){var c=a.split(b.spDelim);this.id=c[0],this.value=c[1]},pad:function(a){return 10>a?"0"+a:a},errBox:function(a,b,c){var e="<b>Error in function</b><br/>"+a+"<br/><b>Parameter</b><br/>"+b+"<br/><b>Message</b><br/>"+c+"<br/><br/><span onmouseover='this.style.cursor=\"hand\";' onmouseout='this.style.cursor=\"inherit\";' style='width=100%;text-align:right;'>Click to continue</span></div>";d(e)},findFormField:function(b){var c,d=RegExp('FieldName="'+b.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")+'"',"gi");return a("td.ms-formbody, td.ms-formbodysurvey").each(function(){return d.test(a(this).html())?(c=a(this),!1):void 0}),c},showAttrs:function(a){var b,d="<table class='ms-vb' width='100%'>";for(b=0;b<a.attributes.length;b++)d+="<tr><td width='10px' style='font-weight:bold;'>"+b+"</td><td width='100px'>"+a.attributes.item(b).nodeName+"</td><td>"+c.checkLink(a.attributes.item(b).nodeValue)+"</td></tr>";return d+="</table>"}},d=function(b){var c="position:absolute;width:300px;height:150px;padding:10px;background-color:#000000;color:#ffffff;z-index:30;font-family:'Arial';font-size:12px;display:none;";a("#aspnetForm").parent().append("<div id='SPServices_msgBox' style="+c+">"+b);var d=a("#SPServices_msgBox"),e=d.height(),f=d.width(),g=a(window).width()/2-f/2+"px",h=a(window).height()/2-e/2-100+"px";d.css({border:"5px #C02000 solid",left:g,top:h}).show().fadeTo("slow",.75).click(function(){a(this).fadeOut("3000",function(){a(this).remove()})})};return c}(g,a),c=function(a){var b=function(b,c,d){var e=void 0!==d?d:a().SPServices.SPListNameFromUrl();return b+"_"+a().SPServices.SPGetStaticFromDisplay({listName:e,columnDisplayName:c})};return b}(g),d=function(a,b,c,d){function e(d,e,h,i,j){var k=0,l=0,m={};m.type=[],m.src=[],m.script=[];var n=RegExp("<script[\\s\\S]*?/script>","gi");a.ajax({type:"GET",url:j,dataType:"text",async:!1,success:function(o){for(var p;p=n.exec(o);){var q=f(p,"language"),r=f(p,"type"),s=f(p,"src");null!==s&&s.length>0&&!g(s)&&(m.type.push(null!==q&&q.length>0?q:r),m.src.push(s),l++)}if(!d.showNoScript&&m.type.length>0||d.showNoScript){var t=j.substring(0,j.lastIndexOf(c.SLASH)+1),u="<tr class=ms-alternating><td class=ms-vb-icon><a href='"+e.attr("DefaultViewUrl")+"'><IMG border=0 src='"+e.attr("ImageUrl")+"'width=16 height=16></A></TD><td class=ms-vb2><a href='"+e.attr("DefaultViewUrl")+"'>"+e.attr("Title")+("True"===e.attr("Hidden")?"(Hidden)":"")+"</td><td class=ms-vb2>"+h+"</td><td class=ms-vb2>"+i+"</td><td class=ms-vb2><a href='"+j+"'>"+b.fileName(j)+"</td>";if(d.showSrc){var v;for(u+="<td valign='top'><table width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1>",k=0;k<m.type.length;k++)v=m.src[k].substr(0,1)!==c.SLASH?t+m.src[k]:m.src[k],u+="<tr><td class=ms-vb2 width='30%'>"+m.type[k]+"</td>",u+="<td class=ms-vb2 width='70%'><a href='"+v+"'>"+b.fileName(m.src[k])+"</td></tr>";u+="</table></td>"}a("#SPScriptAudit").append(u)}}})}function f(a,b){var c,d=RegExp(b+"=(\"([^\"]*)\")|('([^']*)')","gi");return(c=d.exec(a))?c[2]:null}function g(a){var b,c=["WebResource.axd","_layouts"];for(b=0;b<c.length;b++)if(a.indexOf(c[b])>-1)return!0;return!1}function h(){var a=location.protocol+"//"+location.host;"undefined"!=typeof _spPageContextInfo?(this.thisSite=a+_spPageContextInfo.webServerRelativeUrl,this.thisList=_spPageContextInfo.pageListId,this.thisUserId=_spPageContextInfo.userId):(this.thisSite="undefined"!=typeof L_Menu_BaseUrl?a+L_Menu_BaseUrl:"",this.thisList="",this.thisUserId="undefined"!=typeof _spUserId?_spUserId:void 0)}function i(c,d){var e;for(e=0;e<d.length;e++)"string"==typeof d[e]?N.payload+=b.wrapNode(d[e],c[d[e]]):a.isArray(d[e])&&2===d[e].length?N.payload+=b.wrapNode(d[e][0],c[d[e][1]]):"object"==typeof d[e]&&void 0!==d[e].sendNull?N.payload+=void 0===c[d[e].name]||0===c[d[e].name].length?"":b.wrapNode(d[e].name,c[d[e].name]):b.errBox(c.operation,"paramArray["+e+"]: "+d[e],"Invalid paramArray element passed to addToPayload()")}function j(a,b){var c=b.substring(8);return a.opheader=a.opheader.replace(b,c),a.opfooter=a.opfooter.replace(b,c),a}var k={},l="Alerts",m="Authentication",n="Copy",o="Forms",p="Lists",q="Meetings",r="OfficialFile",s="People",t="Permissions",u="PublishedLinksService",v="Search",w="SharePointDiagnostics",x="SiteData",y="Sites",z="SocialDataService",A="SpellCheck",B="TaxonomyClientService",C="usergroup",D="UserProfileService",E="Versions",F="Views",G="WebPartPages",H="Webs",I="Workflow",J=new h,K=0,L=["listName","description"],M=[];M.GetAlerts=[l,!1],M.DeleteAlerts=[l,!0],M.Mode=[m,!1],M.Login=[m,!1],M.CopyIntoItems=[n,!0],M.CopyIntoItemsLocal=[n,!0],M.GetItem=[n,!1],M.GetForm=[o,!1],M.GetFormCollection=[o,!1],M.AddAttachment=[p,!0],M.AddDiscussionBoardItem=[p,!0],M.AddList=[p,!0],M.AddListFromFeature=[p,!0],M.ApplyContentTypeToList=[p,!0],M.CheckInFile=[p,!0],M.CheckOutFile=[p,!0],M.CreateContentType=[p,!0],M.DeleteAttachment=[p,!0],M.DeleteContentType=[p,!0],M.DeleteContentTypeXmlDocument=[p,!0],M.DeleteList=[p,!0],M.GetAttachmentCollection=[p,!1],M.GetList=[p,!1],M.GetListAndView=[p,!1],M.GetListCollection=[p,!1],M.GetListContentType=[p,!1],M.GetListContentTypes=[p,!1],M.GetListItemChanges=[p,!1],M.GetListItemChangesSinceToken=[p,!1],M.GetListItems=[p,!1],M.GetVersionCollection=[p,!1],M.UndoCheckOut=[p,!0],M.UpdateContentType=[p,!0],M.UpdateContentTypesXmlDocument=[p,!0],M.UpdateContentTypeXmlDocument=[p,!0],M.UpdateList=[p,!0],M.UpdateListItems=[p,!0],M.AddMeeting=[q,!0],M.CreateWorkspace=[q,!0],M.RemoveMeeting=[q,!0],M.SetWorkSpaceTitle=[q,!0],M.GetRecordRouting=[r,!1],M.GetRecordRoutingCollection=[r,!1],M.GetServerInfo=[r,!1],M.SubmitFile=[r,!0],M.ResolvePrincipals=[s,!0],M.SearchPrincipals=[s,!1],M.AddPermission=[t,!0],M.AddPermissionCollection=[t,!0],M.GetPermissionCollection=[t,!0],M.RemovePermission=[t,!0],M.RemovePermissionCollection=[t,!0],M.UpdatePermission=[t,!0],M.GetLinks=[u,!0],M.GetPortalSearchInfo=[v,!1],M.GetQuerySuggestions=[v,!1],M.GetSearchMetadata=[v,!1],M.Query=[v,!1],M.QueryEx=[v,!1],M.Registration=[v,!1],M.Status=[v,!1],M.SendClientScriptErrorReport=[w,!0],M.GetAttachments=[x,!1],M.EnumerateFolder=[x,!1],M.SiteDataGetList=[x,!1],M.SiteDataGetListCollection=[x,!1],M.SiteDataGetSite=[x,!1],M.SiteDataGetSiteUrl=[x,!1],M.SiteDataGetWeb=[x,!1],M.CreateWeb=[y,!0],M.DeleteWeb=[y,!0],M.GetSite=[y,!1],M.GetSiteTemplates=[y,!1],M.AddComment=[z,!0],M.AddTag=[z,!0],M.AddTagByKeyword=[z,!0],M.CountCommentsOfUser=[z,!1],M.CountCommentsOfUserOnUrl=[z,!1],M.CountCommentsOnUrl=[z,!1],M.CountRatingsOnUrl=[z,!1],M.CountTagsOfUser=[z,!1],M.DeleteComment=[z,!0],M.DeleteRating=[z,!0],M.DeleteTag=[z,!0],M.DeleteTagByKeyword=[z,!0],M.DeleteTags=[z,!0],M.GetAllTagTerms=[z,!1],M.GetAllTagTermsForUrlFolder=[z,!1],M.GetAllTagUrls=[z,!1],M.GetAllTagUrlsByKeyword=[z,!1],M.GetCommentsOfUser=[z,!1],M.GetCommentsOfUserOnUrl=[z,!1],M.GetCommentsOnUrl=[z,!1],M.GetRatingAverageOnUrl=[z,!1],M.GetRatingOfUserOnUrl=[z,!1],M.GetRatingOnUrl=[z,!1],M.GetRatingsOfUser=[z,!1],M.GetRatingsOnUrl=[z,!1],M.GetSocialDataForFullReplication=[z,!1],M.GetTags=[z,!0],M.GetTagsOfUser=[z,!0],M.GetTagTerms=[z,!0],M.GetTagTermsOfUser=[z,!0],M.GetTagTermsOnUrl=[z,!0],M.GetTagUrlsOfUser=[z,!0],M.GetTagUrlsOfUserByKeyword=[z,!0],M.GetTagUrls=[z,!0],M.GetTagUrlsByKeyword=[z,!0],M.SetRating=[z,!0],M.UpdateComment=[z,!0],M.SpellCheck=[A,!1],M.AddTerms=[B,!0],M.GetChildTermsInTerm=[B,!1],M.GetChildTermsInTermSet=[B,!1],M.GetKeywordTermsByGuids=[B,!1],M.GetTermsByLabel=[B,!1],M.GetTermSets=[B,!1],M.AddGroup=[C,!0],M.AddGroupToRole=[C,!0],M.AddRole=[C,!0],M.AddRoleDef=[C,!0],M.AddUserCollectionToGroup=[C,!0],M.AddUserCollectionToRole=[C,!0],M.AddUserToGroup=[C,!0],M.AddUserToRole=[C,!0],M.GetAllUserCollectionFromWeb=[C,!1],M.GetGroupCollection=[C,!1],M.GetGroupCollectionFromRole=[C,!1],M.GetGroupCollectionFromSite=[C,!1],M.GetGroupCollectionFromUser=[C,!1],M.GetGroupCollectionFromWeb=[C,!1],M.GetGroupInfo=[C,!1],M.GetRoleCollection=[C,!1],M.GetRoleCollectionFromGroup=[C,!1],M.GetRoleCollectionFromUser=[C,!1],M.GetRoleCollectionFromWeb=[C,!1],M.GetRoleInfo=[C,!1],M.GetRolesAndPermissionsForCurrentUser=[C,!1],M.GetRolesAndPermissionsForSite=[C,!1],M.GetUserCollection=[C,!1],M.GetUserCollectionFromGroup=[C,!1],M.GetUserCollectionFromRole=[C,!1],M.GetUserCollectionFromSite=[C,!1],M.GetUserCollectionFromWeb=[C,!1],M.GetUserInfo=[C,!1],M.GetUserLoginFromEmail=[C,!1],M.RemoveGroup=[C,!0],M.RemoveGroupFromRole=[C,!0],M.RemoveRole=[C,!0],M.RemoveUserCollectionFromGroup=[C,!0],M.RemoveUserCollectionFromRole=[C,!0],M.RemoveUserCollectionFromSite=[C,!0],M.RemoveUserFromGroup=[C,!0],M.RemoveUserFromRole=[C,!0],M.RemoveUserFromSite=[C,!0],M.RemoveUserFromWeb=[C,!0],M.UpdateGroupInfo=[C,!0],M.UpdateRoleDefInfo=[C,!0],M.UpdateRoleInfo=[C,!0],M.UpdateUserInfo=[C,!0],M.AddColleague=[D,!0],M.AddLink=[D,!0],M.AddMembership=[D,!0],M.AddPinnedLink=[D,!0],M.CreateMemberGroup=[D,!0],M.CreateUserProfileByAccountName=[D,!0],M.GetCommonColleagues=[D,!1],M.GetCommonManager=[D,!1],M.GetCommonMemberships=[D,!1],M.GetInCommon=[D,!1],M.GetPropertyChoiceList=[D,!1],M.GetUserColleagues=[D,!1],M.GetUserLinks=[D,!1],M.GetUserMemberships=[D,!1],M.GetUserPinnedLinks=[D,!1],M.GetUserProfileByGuid=[D,!1],M.GetUserProfileByIndex=[D,!1],M.GetUserProfileByName=[D,!1],M.GetUserProfileCount=[D,!1],M.GetUserProfileSchema=[D,!1],M.GetUserPropertyByAccountName=[D,!1],M.ModifyUserPropertyByAccountName=[D,!0],M.RemoveAllColleagues=[D,!0],M.RemoveAllLinks=[D,!0],M.RemoveAllMemberships=[D,!0],M.RemoveAllPinnedLinks=[D,!0],M.RemoveColleague=[D,!0],M.RemoveLink=[D,!0],M.RemoveMembership=[D,!0],M.RemovePinnedLink=[D,!0],M.UpdateColleaguePrivacy=[D,!0],M.UpdateLink=[D,!0],M.UpdateMembershipPrivacy=[D,!0],M.UpdatePinnedLink=[D,!0],M.DeleteAllVersions=[E,!0],M.DeleteVersion=[E,!0],M.GetVersions=[E,!1],M.RestoreVersion=[E,!0],M.AddView=[F,!0],M.DeleteView=[F,!0],M.GetView=[F,!1],M.GetViewHtml=[F,!1],M.GetViewCollection=[F,!1],M.UpdateView=[F,!0],M.UpdateViewHtml=[F,!0],M.AddWebPart=[G,!0],M.AddWebPartToZone=[G,!0],M.DeleteWebPart=[G,!0],M.GetWebPart2=[G,!1],M.GetWebPartPage=[G,!1],M.GetWebPartProperties=[G,!1],M.GetWebPartProperties2=[G,!1],M.SaveWebPart2=[G,!0],M.CreateContentType=[H,!0],M.GetColumns=[H,!1],M.GetContentType=[H,!1],M.GetContentTypes=[H,!1],M.GetCustomizedPageStatus=[H,!1],M.GetListTemplates=[H,!1],M.GetObjectIdFromUrl=[H,!1],M.GetWeb=[H,!1],M.GetWebCollection=[H,!1],M.GetAllSubWebCollection=[H,!1],M.UpdateColumns=[H,!0],M.UpdateContentType=[H,!0],M.WebUrlFromPageUrl=[H,!1],M.AlterToDo=[I,!0],M.ClaimReleaseTask=[I,!0],M.GetTemplatesForItem=[I,!1],M.GetToDosForItem=[I,!1],M.GetWorkflowDataForItem=[I,!1],M.GetWorkflowTaskData=[I,!1],M.StartWorkflow=[I,!0];var N={};N.header="<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body>",N.footer="</soap:Body></soap:Envelope>",N.payload="";var O;a.fn.SPServices=function(d){for(var e=a.extend({},a.fn.SPServices.defaults,d),f=0;f<L.length;f++)"string"==typeof e[L[f]]&&(e[L[f]]=b.encodeXml(e[L[f]]));switch(N.opheader="<"+e.operation+" ",M[e.operation][0]){case l:N.opheader+="xmlns='"+c.SCHEMASharePoint+"/soap/2002/1/alerts/' >",O=c.SCHEMASharePoint+"/soap/2002/1/alerts/";break;case q:N.opheader+="xmlns='"+c.SCHEMASharePoint+"/soap/meetings/' >",O=c.SCHEMASharePoint+"/soap/meetings/";break;case r:N.opheader+="xmlns='"+c.SCHEMASharePoint+"/soap/recordsrepository/' >",O=c.SCHEMASharePoint+"/soap/recordsrepository/";break;case t:N.opheader+="xmlns='"+c.SCHEMASharePoint+"/soap/directory/' >",O=c.SCHEMASharePoint+"/soap/directory/";break;case u:N.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/' >",O="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/";break;case v:N.opheader+="xmlns='urn:Microsoft.Search' >",O="urn:Microsoft.Search/";break;case w:N.opheader+="xmlns='"+c.SCHEMASharePoint+"/diagnostics/' >",O="http://schemas.microsoft.com/sharepoint/diagnostics/";break;case z:N.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/SocialDataService' >",O="http://microsoft.com/webservices/SharePointPortalServer/SocialDataService/";break;case A:N.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/publishing/spelling/' >",O="http://schemas.microsoft.com/sharepoint/publishing/spelling/SpellCheck";break;case B:N.opheader+="xmlns='"+c.SCHEMASharePoint+"/taxonomy/soap/' >",O=c.SCHEMASharePoint+"/taxonomy/soap/";break;case C:N.opheader+="xmlns='"+c.SCHEMASharePoint+"/soap/directory/' >",O=c.SCHEMASharePoint+"/soap/directory/";break;case D:N.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/UserProfileService' >",O="http://microsoft.com/webservices/SharePointPortalServer/UserProfileService/";break;case G:N.opheader+="xmlns='http://microsoft.com/sharepoint/webpartpages' >",O="http://microsoft.com/sharepoint/webpartpages/";break;case I:N.opheader+="xmlns='"+c.SCHEMASharePoint+"/soap/workflow/' >",O=c.SCHEMASharePoint+"/soap/workflow/";break;default:N.opheader+="xmlns='"+c.SCHEMASharePoint+"/soap/'>",O=c.SCHEMASharePoint+"/soap/"}O+=e.operation,N.opfooter="</"+e.operation+">";var g="_vti_bin/"+M[e.operation][0]+".asmx",h=void 0!==e.webURL?e.webURL:e.webUrl;if(h.charAt(h.length-1)===c.SLASH)g=h+g;else if(h.length>0)g=h+c.SLASH+g;else{var m=a().SPServices.SPGetCurrentSite();g=m+(m.charAt(m.length-1)===c.SLASH?g:c.SLASH+g)}switch(N.payload="",e.operation){case"GetAlerts":break;case"DeleteAlerts":for(N.payload+="<IDs>",f=0;f<e.IDs.length;f++)N.payload+=b.wrapNode("string",e.IDs[f]);N.payload+="</IDs>";break;case"Mode":break;case"Login":i(e,["username","password"]);break;case"CopyIntoItems":for(i(e,["SourceUrl"]),N.payload+="<DestinationUrls>",f=0;f<e.DestinationUrls.length;f++)N.payload+=b.wrapNode("string",e.DestinationUrls[f]);N.payload+="</DestinationUrls>",i(e,["Fields","Stream","Results"]);break;case"CopyIntoItemsLocal":for(i(e,["SourceUrl"]),N.payload+="<DestinationUrls>",f=0;f<e.DestinationUrls.length;f++)N.payload+=b.wrapNode("string",e.DestinationUrls[f]);N.payload+="</DestinationUrls>";break;case"GetItem":i(e,["Url","Fields","Stream"]);break;case"GetForm":i(e,["listName","formUrl"]);break;case"GetFormCollection":i(e,["listName"]);break;case"AddAttachment":i(e,["listName","listItemID","fileName","attachment"]);break;case"AddDiscussionBoardItem":i(e,["listName","message"]);break;case"AddList":i(e,["listName","description","templateID"]);break;case"AddListFromFeature":i(e,["listName","description","featureID","templateID"]);break;case"ApplyContentTypeToList":i(e,["webUrl","contentTypeId","listName"]);break;case"CheckInFile":i(e,["pageUrl","comment","CheckinType"]);break;case"CheckOutFile":i(e,["pageUrl","checkoutToLocal","lastmodified"]);break;case"CreateContentType":i(e,["listName","displayName","parentType","fields","contentTypeProperties","addToView"]);break;case"DeleteAttachment":i(e,["listName","listItemID","url"]);break;case"DeleteContentType":i(e,["listName","contentTypeId"]);break;case"DeleteContentTypeXmlDocument":i(e,["listName","contentTypeId","documentUri"]);break;case"DeleteList":i(e,["listName"]);break;case"GetAttachmentCollection":i(e,["listName",["listItemID","ID"]]);break;case"GetList":i(e,["listName"]);break;case"GetListAndView":i(e,["listName","viewName"]);break;case"GetListCollection":break;case"GetListContentType":i(e,["listName","contentTypeId"]);break;case"GetListContentTypes":i(e,["listName"]);break;case"GetListItems":i(e,["listName","viewName",["query","CAMLQuery"],["viewFields","CAMLViewFields"],["rowLimit","CAMLRowLimit"],["queryOptions","CAMLQueryOptions"]]);break;case"GetListItemChanges":i(e,["listName","viewFields","since","contains"]);break;case"GetListItemChangesSinceToken":i(e,["listName","viewName",["query","CAMLQuery"],["viewFields","CAMLViewFields"],["rowLimit","CAMLRowLimit"],["queryOptions","CAMLQueryOptions"],{name:"changeToken",sendNull:!1},{name:"contains",sendNull:!1}]);break;case"GetVersionCollection":i(e,["strlistID","strlistItemID","strFieldName"]);break;case"UndoCheckOut":i(e,["pageUrl"]);break;case"UpdateContentType":i(e,["listName","contentTypeId","contentTypeProperties","newFields","updateFields","deleteFields","addToView"]);break;case"UpdateContentTypesXmlDocument":i(e,["listName","newDocument"]);break;case"UpdateContentTypeXmlDocument":i(e,["listName","contentTypeId","newDocument"]);break;case"UpdateList":i(e,["listName","listProperties","newFields","updateFields","deleteFields","listVersion"]);break;case"UpdateListItems":if(i(e,["listName"]),"undefined"!=typeof e.updates&&e.updates.length>0)i(e,["updates"]);else{for(N.payload+="<updates><Batch OnError='Continue'><Method ID='1' Cmd='"+e.batchCmd+"'>",f=0;f<e.valuepairs.length;f++)N.payload+="<Field Name='"+e.valuepairs[f][0]+"'>"+b.escapeColumnValue(e.valuepairs[f][1])+"</Field>";"New"!==e.batchCmd&&(N.payload+="<Field Name='ID'>"+e.ID+"</Field>"),N.payload+="</Method></Batch></updates>"}break;case"AddMeeting":i(e,["organizerEmail","uid","sequence","utcDateStamp","title","location","utcDateStart","utcDateEnd","nonGregorian"]);break;case"CreateWorkspace":i(e,["title","templateName","lcid","timeZoneInformation"]);break;case"RemoveMeeting":i(e,["recurrenceId","uid","sequence","utcDateStamp","cancelMeeting"]);break;case"SetWorkspaceTitle":i(e,["title"]);break;case"GetRecordRouting":i(e,["recordRouting"]);break;case"GetRecordRoutingCollection":break;case"GetServerInfo":break;case"SubmitFile":i(e,["fileToSubmit"],["properties"],["recordRouting"],["sourceUrl"],["userName"]);break;case"ResolvePrincipals":i(e,["principalKeys","principalType","addToUserInfoList"]);break;case"SearchPrincipals":i(e,["searchText","maxResults","principalType"]);break;case"AddPermission":i(e,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"AddPermissionCollection":i(e,["objectName","objectType","permissionsInfoXml"]);break;case"GetPermissionCollection":i(e,["objectName","objectType"]);break;case"RemovePermission":i(e,["objectName","objectType","permissionIdentifier","permissionType"]);break;case"RemovePermissionCollection":i(e,["objectName","objectType","memberIdsXml"]);break;case"UpdatePermission":i(e,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"GetLinks":break;case"GetPortalSearchInfo":N.opheader="<"+e.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",O="http://microsoft.com/webservices/OfficeServer/QueryService/"+e.operation;break;case"GetQuerySuggestions":N.opheader="<"+e.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",O="http://microsoft.com/webservices/OfficeServer/QueryService/"+e.operation,N.payload+=b.wrapNode("queryXml",b.encodeXml(e.queryXml));break;case"GetSearchMetadata":N.opheader="<"+e.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",O="http://microsoft.com/webservices/OfficeServer/QueryService/"+e.operation;break;case"Query":N.payload+=b.wrapNode("queryXml",b.encodeXml(e.queryXml));break;case"QueryEx":N.opheader="<"+e.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",O="http://microsoft.com/webservices/OfficeServer/QueryService/"+e.operation,N.payload+=b.wrapNode("queryXml",b.encodeXml(e.queryXml));break;case"Registration":N.payload+=b.wrapNode("registrationXml",b.encodeXml(e.registrationXml));break;case"Status":break;case"SendClientScriptErrorReport":i(e,["message","file","line","client","stack","team","originalFile"]);break;case"EnumerateFolder":i(e,["strFolderUrl"]);break;case"GetAttachments":i(e,["strListName","strItemId"]);break;case"SiteDataGetList":i(e,["strListName"]),N=j(N,e.operation);break;case"SiteDataGetListCollection":N=j(N,e.operation);break;case"SiteDataGetSite":N=j(N,e.operation);break;case"SiteDataGetSiteUrl":i(e,["Url"]),N=j(N,e.operation);break;case"SiteDataGetWeb":N=j(N,e.operation);break;case"CreateWeb":i(e,["url","title","description","templateName","language","languageSpecified","locale","localeSpecified","collationLocale","collationLocaleSpecified","uniquePermissions","uniquePermissionsSpecified","anonymous","anonymousSpecified","presence","presenceSpecified"]);break;case"DeleteWeb":i(e,["url"]);break;case"GetSite":i(e,["SiteUrl"]);break;case"GetSiteTemplates":i(e,["LCID","TemplateList"]);break;case"AddComment":i(e,["url","comment","isHighPriority","title"]);break;case"AddTag":i(e,["url","termID","title","isPrivate"]);break;case"AddTagByKeyword":i(e,["url","keyword","title","isPrivate"]);break;case"CountCommentsOfUser":i(e,["userAccountName"]);break;case"CountCommentsOfUserOnUrl":i(e,["userAccountName","url"]);break;case"CountCommentsOnUrl":i(e,["url"]);break;case"CountRatingsOnUrl":i(e,["url"]);break;case"CountTagsOfUser":i(e,["userAccountName"]);break;case"DeleteComment":i(e,["url","lastModifiedTime"]);break;case"DeleteRating":i(e,["url"]);break;case"DeleteTag":i(e,["url","termID"]);break;case"DeleteTagByKeyword":i(e,["url","keyword"]);break;case"DeleteTags":i(e,["url"]);break;case"GetAllTagTerms":i(e,["maximumItemsToReturn"]);break;case"GetAllTagTermsForUrlFolder":i(e,["urlFolder","maximumItemsToReturn"]);break;case"GetAllTagUrls":i(e,["termID"]);break;case"GetAllTagUrlsByKeyword":i(e,["keyword"]);break;case"GetCommentsOfUser":i(e,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetCommentsOfUserOnUrl":i(e,["userAccountName","url"]);break;case"GetCommentsOnUrl":i(e,["url","maximumItemsToReturn","startIndex"]),"undefined"!=typeof e.excludeItemsTime&&e.excludeItemsTime.length>0&&(N.payload+=b.wrapNode("excludeItemsTime",e.excludeItemsTime));break;case"GetRatingAverageOnUrl":i(e,["url"]);break;case"GetRatingOfUserOnUrl":i(e,["userAccountName","url"]);break;case"GetRatingOnUrl":i(e,["url"]);break;case"GetRatingsOfUser":i(e,["userAccountName"]);break;case"GetRatingsOnUrl":i(e,["url"]);break;case"GetSocialDataForFullReplication":i(e,["userAccountName"]);break;case"GetTags":i(e,["url"]);break;case"GetTagsOfUser":i(e,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetTagTerms":i(e,["maximumItemsToReturn"]);break;case"GetTagTermsOfUser":i(e,["userAccountName","maximumItemsToReturn"]);break;case"GetTagTermsOnUrl":i(e,["url","maximumItemsToReturn"]);break;case"GetTagUrls":i(e,["termID"]);break;case"GetTagUrlsByKeyword":i(e,["keyword"]);break;case"GetTagUrlsOfUser":i(e,["termID","userAccountName"]);break;case"GetTagUrlsOfUserByKeyword":i(e,["keyword","userAccountName"]);break;case"SetRating":i(e,["url","rating","title","analysisDataEntry"]);break;case"UpdateComment":i(e,["url","lastModifiedTime","comment","isHighPriority"]);break;case"SpellCheck":i(e,["chunksToSpell","declaredLanguage","useLad"]);break;case"AddTerms":i(e,["sharedServiceId","termSetId","lcid","newTerms"]);break;case"GetChildTermsInTerm":i(e,["sspId","lcid","termId","termSetId"]);break;case"GetChildTermsInTermSet":i(e,["sspId","lcid","termSetId"]);break;case"GetKeywordTermsByGuids":i(e,["termIds","lcid"]);break;case"GetTermsByLabel":i(e,["label","lcid","matchOption","resultCollectionSize","termIds","addIfNotFound"]);break;case"GetTermSets":i(e,["sharedServiceIds","termSetIds","lcid","clientTimeStamps","clientVersions"]);break;case"AddGroup":i(e,["groupName","ownerIdentifier","ownerType","defaultUserLoginName","description"]);break;case"AddGroupToRole":i(e,["groupName","roleName"]);break;case"AddRole":i(e,["roleName","description","permissionMask"]);break;case"AddRoleDef":i(e,["roleName","description","permissionMask"]);break;case"AddUserCollectionToGroup":i(e,["groupName","usersInfoXml"]);break;case"AddUserCollectionToRole":i(e,["roleName","usersInfoXml"]);break;case"AddUserToGroup":i(e,["groupName","userName","userLoginName","userEmail","userNotes"]);break;case"AddUserToRole":i(e,["roleName","userName","userLoginName","userEmail","userNotes"]);break;case"GetAllUserCollectionFromWeb":break;case"GetGroupCollection":i(e,["groupNamesXml"]);break;case"GetGroupCollectionFromRole":i(e,["roleName"]);break;case"GetGroupCollectionFromSite":break;case"GetGroupCollectionFromUser":i(e,["userLoginName"]);break;case"GetGroupCollectionFromWeb":break;case"GetGroupInfo":i(e,["groupName"]);break;case"GetRoleCollection":i(e,["roleNamesXml"]);break;case"GetRoleCollectionFromGroup":i(e,["groupName"]);break;case"GetRoleCollectionFromUser":i(e,["userLoginName"]);break;case"GetRoleCollectionFromWeb":break;case"GetRoleInfo":i(e,["roleName"]);break;case"GetRolesAndPermissionsForCurrentUser":break;case"GetRolesAndPermissionsForSite":break;case"GetUserCollection":i(e,["userLoginNamesXml"]);break;case"GetUserCollectionFromGroup":i(e,["groupName"]);break;case"GetUserCollectionFromRole":i(e,["roleName"]);break;case"GetUserCollectionFromSite":break;case"GetUserCollectionFromWeb":break;case"GetUserInfo":i(e,["userLoginName"]);break;case"GetUserLoginFromEmail":i(e,["emailXml"]);break;case"RemoveGroup":i(e,["groupName"]);break;case"RemoveGroupFromRole":i(e,["roleName","groupName"]);break;case"RemoveRole":i(e,["roleName"]);break;case"RemoveUserCollectionFromGroup":i(e,["groupName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromRole":i(e,["roleName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromSite":i(e,["userLoginNamesXml"]);break;case"RemoveUserFromGroup":i(e,["groupName","userLoginName"]);break;case"RemoveUserFromRole":i(e,["roleName","userLoginName"]);break;case"RemoveUserFromSite":i(e,["userLoginName"]);break;case"RemoveUserFromWeb":i(e,["userLoginName"]);break;case"UpdateGroupInfo":i(e,["oldGroupName","groupName","ownerIdentifier","ownerType","description"]);break;case"UpdateRoleDefInfo":i(e,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateRoleInfo":i(e,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateUserInfo":i(e,["userLoginName","userName","userEmail","userNotes"]);break;case"AddColleague":i(e,["accountName","colleagueAccountName","group","privacy","isInWorkGroup"]);break;case"AddLink":i(e,["accountName","name","url","group","privacy"]);break;case"AddMembership":i(e,["accountName","membershipInfo","group","privacy"]);break;case"AddPinnedLink":i(e,["accountName","name","url"]);break;case"CreateMemberGroup":i(e,["membershipInfo"]);break;case"CreateUserProfileByAccountName":i(e,["accountName"]);break;case"GetCommonColleagues":i(e,["accountName"]);break;case"GetCommonManager":i(e,["accountName"]);break;case"GetCommonMemberships":i(e,["accountName"]);break;case"GetInCommon":i(e,["accountName"]);break;case"GetPropertyChoiceList":i(e,["propertyName"]);break;case"GetUserColleagues":i(e,["accountName"]);break;case"GetUserLinks":i(e,["accountName"]);break;case"GetUserMemberships":i(e,["accountName"]);break;case"GetUserPinnedLinks":i(e,["accountName"]);break;case"GetUserProfileByGuid":i(e,["guid"]);break;case"GetUserProfileByIndex":i(e,["index"]);break;case"GetUserProfileByName":"undefined"!=typeof e.accountName&&e.accountName.length>0?i(e,[["AccountName","accountName"]]):i(e,["AccountName"]);break;case"GetUserProfileCount":break;case"GetUserProfileSchema":break;case"GetUserPropertyByAccountName":i(e,["accountName","propertyName"]);break;case"ModifyUserPropertyByAccountName":i(e,["accountName","newData"]);break;case"RemoveAllColleagues":i(e,["accountName"]);break;case"RemoveAllLinks":i(e,["accountName"]);break;case"RemoveAllMemberships":i(e,["accountName"]);break;case"RemoveAllPinnedLinks":i(e,["accountName"]);break;case"RemoveColleague":i(e,["accountName","colleagueAccountName"]);break;case"RemoveLink":i(e,["accountName","id"]);break;case"RemoveMembership":i(e,["accountName","sourceInternal","sourceReference"]);break;case"RemovePinnedLink":i(e,["accountName","id"]);break;case"UpdateColleaguePrivacy":i(e,["accountName","colleagueAccountName","newPrivacy"]);break;case"UpdateLink":i(e,["accountName","data"]);break;case"UpdateMembershipPrivacy":i(e,["accountName","sourceInternal","sourceReference","newPrivacy"]);break;case"UpdatePinnedLink ":i(e,["accountName","data"]);break;case"DeleteAllVersions":i(e,["fileName"]);break;case"DeleteVersion":i(e,["fileName","fileVersion"]);break;case"GetVersions":i(e,["fileName"]);break;case"RestoreVersion":i(e,["fileName","fileVersion"]);break;case"AddView":i(e,["listName","viewName","viewFields","query","rowLimit","rowLimit","type","makeViewDefault"]);break;case"DeleteView":i(e,["listName","viewName"]);break;case"GetView":i(e,["listName","viewName"]);break;case"GetViewCollection":i(e,["listName"]);break;case"GetViewHtml":i(e,["listName","viewName"]);break;case"UpdateView":i(e,["listName","viewName","viewProperties","query","viewFields","aggregations","formats","rowLimit"]);break;case"UpdateViewHtml":i(e,["listName","viewName","viewProperties","toolbar","viewHeader","viewBody","viewFooter","viewEmpty","rowLimitExceeded","query","viewFields","aggregations","formats","rowLimit"]);break;case"AddWebPart":i(e,["pageUrl","webPartXml","storage"]);break;case"AddWebPartToZone":i(e,["pageUrl","webPartXml","storage","zoneId","zoneIndex"]);break;case"DeleteWebPart":i(e,["pageUrl","storageKey","storage"]);break;case"GetWebPart2":i(e,["pageUrl","storageKey","storage","behavior"]);break;case"GetWebPartPage":i(e,["documentName","behavior"]);break;case"GetWebPartProperties":i(e,["pageUrl","storage"]);break;case"GetWebPartProperties2":i(e,["pageUrl","storage","behavior"]);break;case"SaveWebPart2":i(e,["pageUrl","storageKey","webPartXml","storage","allowTypeChange"]);break;case"Webs.CreateContentType":i(e,["displayName","parentType","newFields","contentTypeProperties"]);break;case"GetColumns":i(e,["webUrl"]);break;case"GetContentType":i(e,["contentTypeId"]);break;case"GetContentTypes":break;case"GetCustomizedPageStatus":i(e,["fileUrl"]);break;case"GetListTemplates":break;case"GetObjectIdFromUrl":i(e,["objectUrl"]);break;case"GetWeb":i(e,[["webUrl","webURL"]]);break;case"GetWebCollection":break;case"GetAllSubWebCollection":break;case"UpdateColumns":i(e,["newFields","updateFields","deleteFields"]);break;case"Webs.UpdateContentType":i(e,["contentTypeId","contentTypeProperties","newFields","updateFields","deleteFields"]);break;case"WebUrlFromPageUrl":i(e,[["pageUrl","pageURL"]]);break;case"AlterToDo":i(e,["item","todoId","todoListId","taskData"]);break;case"ClaimReleaseTask":i(e,["item","taskId","listId","fClaim"]);break;case"GetTemplatesForItem":i(e,["item"]);break;case"GetToDosForItem":i(e,["item"]);break;case"GetWorkflowDataForItem":i(e,["item"]);break;case"GetWorkflowTaskData":i(e,["item","listId","taskId"]);break;case"StartWorkflow":i(e,["item","templateId","workflowParameters"]);

}var n,o=N.header+N.opheader+N.payload+N.opfooter+N.footer;if(e.cacheXML&&(n=k[o]),"undefined"==typeof n){var p=a.ajax({url:g,async:e.async,beforeSend:function(a){M[e.operation][1]&&a.setRequestHeader("SOAPAction",O)},type:"POST",data:o,dataType:"xml",contentType:"text/xml;charset='utf-8'",complete:function(b,c){a.isFunction(e.completefunc)&&e.completefunc(b,c)}});return e.cacheXML&&(k[o]=p),p}return a.isFunction(e.completefunc)&&n.done(function(a,b,c){e.completefunc(c,b)}),n},a.fn.SPServices.defaults={cacheXML:!1,operation:"",webURL:"",makeViewDefault:!1,viewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:0,CAMLQueryOptions:"<QueryOptions></QueryOptions>",batchCmd:"Update",valuepairs:[],DestinationUrls:[],behavior:"Version3",storage:"Shared",objectType:"List",cancelMeeting:!0,nonGregorian:!1,fClaim:!1,recurrenceId:0,sequence:0,maximumItemsToReturn:0,startIndex:0,isHighPriority:!1,isPrivate:!1,rating:1,maxResults:10,principalType:"User",async:!0,completefunc:null},a.fn.SPServices.SPGetCurrentSite=function(){if(J.thisSite.length>0)return J.thisSite;var b=N.header+"<WebUrlFromPageUrl xmlns='"+c.SCHEMASharePoint+"/soap/' ><pageUrl>"+(location.href.indexOf("?")>0?location.href.substr(0,location.href.indexOf("?")):location.href)+"</pageUrl></WebUrlFromPageUrl>"+N.footer;return a.ajax({async:!1,url:"/_vti_bin/Webs.asmx",type:"POST",data:b,dataType:"xml",contentType:'text/xml;charset="utf-8"',complete:function(b){J.thisSite=a(b.responseXML).find("WebUrlFromPageUrlResult").text()}}),J.thisSite},a.fn.SPServices.SPGetCurrentUser=function(b){var c=a.extend({},{webURL:"",fieldName:"Name",fieldNames:{},debug:!1},b);if("ID"===c.fieldName&&"undefined"!=typeof J.thisUserId)return J.thisUserId;var d,e="",f={},g=c.fieldNames.length>0?c.fieldNames.length:1,h=c.webURL.length>0?c.webURL:a().SPServices.SPGetCurrentSite();for(a.ajax({async:!1,url:("/"===h?"":h)+"/_layouts/userdisp.aspx?Force=True&"+(new Date).getTime(),complete:function(a){d=a}}),K=0;g>K;K++){if("ID"===c.fieldNames[K])e=J.thisUserId;else{var i;i=g>1?RegExp('FieldInternalName="'+c.fieldNames[K]+'"',"gi"):RegExp('FieldInternalName="'+c.fieldName+'"',"gi"),a(d.responseText).find("table.ms-formtable td[id^='SPField']").each(function(){if(i.test(a(this).html())){switch(a(this).attr("id")){case"SPFieldText":e=a(this).text();break;case"SPFieldNote":e=a(this).find("div").html();break;case"SPFieldURL":e=a(this).find("img").attr("src");break;default:e=a(this).text()}return!1}})}"ID"!==c.fieldNames[K]&&(e="undefined"!=typeof e?e.replace(/(^[\s\xA0]+|[\s\xA0]+$)/g,""):null),g>1&&(f[c.fieldNames[K]]=e)}return g>1?f:e},a.fn.SPServices.SPRequireUnique=function(c){var d=a.extend({},{columnStaticName:"Title",duplicateAction:0,ignoreCase:!1,initMsg:"This value must be unique.",initMsgCSSClass:"ms-vb",errMsg:"This value is not unique.",errMsgCSSClass:"ms-formvalidation",showDupes:!1,completefunc:null},c),e=a().SPServices.SPGetQueryString(),f=e.ID;J.thisList=a().SPServices.SPListNameFromUrl();var g="<span id='SPRequireUnique"+d.columnStaticName+"' class='{0}'>{1}</span><br/>",h=g.replace(/\{0\}/g,d.initMsgCSSClass).replace(/\{1\}/g,d.initMsg),i=a().SPServices.SPGetDisplayFromStatic({listName:J.thisList,columnStaticName:d.columnStaticName}),j=b.findFormField(i).find("input[Title^='"+i+"']");j.parent().append(h),j.blur(function(){var b=[],c=a(this).val();if(0===c.length)return!1;a().SPServices({operation:"GetListItems",async:!1,listName:J.thisList,CAMLQuery:"<Query><Where><IsNotNull><FieldRef Name='"+d.columnStaticName+"'/></IsNotNull></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='ID' /><FieldRef Name='"+d.columnStaticName+"' /></ViewFields>",CAMLRowLimit:0,completefunc:function(e){var g=d.ignoreCase?c.toUpperCase():c;a(e.responseXML).SPFilterNode("z:row").each(function(){var c=d.ignoreCase?a(this).attr("ows_"+d.columnStaticName).toUpperCase():a(this).attr("ows_"+d.columnStaticName);g===c&&a(this).attr("ows_ID")!==f&&b.push([a(this).attr("ows_ID"),a(this).attr("ows_"+d.columnStaticName)])})}});var e=d.initMsg,g=a("#SPRequireUnique"+d.columnStaticName);if(g.html(e).attr("class",d.initMsgCSSClass),a("input[value='OK']:disabled, input[value='Save']:disabled").removeAttr("disabled"),b.length>0&&(e=d.errMsg,g.html(e).attr("class",d.errMsgCSSClass),1===d.duplicateAction&&(j.focus(),a("input[value='OK'], input[value='Save']").attr("disabled","disabled")),d.showDupes)){var h=" "+b.length+" duplicate item"+(b.length>1?"s":"")+": ";for(K=0;K<b.length;K++)h+="<a href='DispForm.aspx?ID="+b[K][0]+"&Source="+location.href+"'>"+b[K][1]+"</a> ";a("span#SPRequireUnique"+d.columnStaticName).append(h)}}),null!==d.completefunc&&d.completefunc()},a.fn.SPServices.SPGetDisplayFromStatic=function(b){var c=a.extend({},{webURL:"",listName:"",columnStaticName:"",columnStaticNames:{}},b),d="",e={},f=c.columnStaticNames.length>0?c.columnStaticNames.length:1;return a().SPServices({operation:"GetList",async:!1,cacheXML:!0,webURL:c.webURL,listName:c.listName,completefunc:function(b){if(f>1)for(K=0;f>K;K++)e[c.columnStaticNames[K]]=a(b.responseXML).find("Field[StaticName='"+c.columnStaticNames[K]+"']").attr("DisplayName");else d=a(b.responseXML).find("Field[StaticName='"+c.columnStaticName+"']").attr("DisplayName")}}),f>1?e:d},a.fn.SPServices.SPGetStaticFromDisplay=function(b){var c=a.extend({},{webURL:"",listName:"",columnDisplayName:"",columnDisplayNames:{}},b),d="",e={},f=c.columnDisplayNames.length>0?c.columnDisplayNames.length:1;return a().SPServices({operation:"GetList",async:!1,cacheXML:!0,webURL:c.webURL,listName:c.listName,completefunc:function(b){if(f>1)for(K=0;f>K;K++)e[c.columnDisplayNames[K]]=a(b.responseXML).find("Field[DisplayName='"+c.columnDisplayNames[K]+"']").attr("StaticName");else d=a(b.responseXML).find("Field[DisplayName='"+c.columnDisplayName+"']").attr("StaticName")}}),f>1?e:d},a.fn.SPServices.SPRedirectWithID=function(b){var c=a.extend({},{redirectUrl:"",qsParamName:"ID"},b);J.thisList=a().SPServices.SPListNameFromUrl();var d=a().SPServices.SPGetQueryString(),e=d.ID,f=d.List,g=d.RootFolder,h=d.ContentTypeId;if("undefined"==typeof d.ID)e=a().SPServices.SPGetLastItemId({listName:J.thisList}),a("form[id='aspnetForm']").each(function(){var a=location.href.indexOf("?")>0?location.href.substring(0,location.href.indexOf("?")):location.href,b="string"==typeof d.Source?"Source="+d.Source.replace(/\//g,"%2f").replace(/:/g,"%3a"):"",c=[];"undefined"!=typeof f&&c.push("List="+f),"undefined"!=typeof g&&c.push("RootFolder="+g),"undefined"!=typeof h&&c.push("ContentTypeId="+h);var i=a+(c.length>0?"?"+c.join("&")+"&":"?")+"Source="+a+"?ID="+e+(b.length>0?"%26RealSource="+d.Source:"")+("string"==typeof d.RedirectURL?"%26RedirectURL="+d.RedirectURL:"");setTimeout(function(){document.forms.aspnetForm.action=i},0)});else{for(;d.ID===e;)e=a().SPServices.SPGetLastItemId({listName:J.thisList});var i="string"==typeof d.RedirectURL?d.RedirectURL:c.redirectUrl;location.href=i+"?"+c.qsParamName+"="+e+("string"==typeof d.RealSource?"&Source="+d.RealSource:"")}},a.fn.SPServices.SPSetMultiSelectSizes=function(e){var f=a.extend({},{listName:a().SPServices.SPListNameFromUrl(),multiSelectColumn:"",minWidth:0,maxWidth:0,debug:!1},e),g="SPServices.SPSetMultiSelectSizes",h=a().SPServices.SPDropdownCtl({displayName:f.multiSelectColumn});if(null===h.Obj.html()&&f.debug)return void b.errBox(g,"multiSelectColumn: "+f.multiSelectColumn,c.TXTColumnNotFound);if(h.Type!==c.dropdownType.multiSelect&&f.debug)return void b.errBox(g,"multiSelectColumn: "+f.multiSelectColumn,"Column is not multi-select.");var i=d("SPSetMultiSelectSizes",f.multiSelectColumn,f.listName),j=a("<select id='"+i+"' ></select>").appendTo(h.container);j.css({width:"auto",height:0,visibility:"hidden"}),a(h.master.candidateControl).find("option").each(function(){j.append("<option value='"+a(this).html()+"'>"+a(this).html()+"</option>")}),a(h.master.resultControl).find("option").each(function(){j.append("<option value='"+a(this).val()+"'>"+a(this).html()+"</option>")});var k=j.width()+5,l=k;(f.minWidth>0||f.maxWidth>0)&&(k<f.minWidth&&(k=f.minWidth),l<f.minWidth&&(l=f.minWidth),l>f.maxWidth&&(l=f.maxWidth));var m=k;a(h.master.candidateControl).css("width",m+"px").parent().css("width",l+"px"),a(h.master.resultControl).css("width",m+"px").parent().css("width",l+"px"),j.remove()},a.fn.SPServices.SPScriptAudit=function(b){var d,f=a.extend({},{webURL:"",listName:"",outputId:"",auditForms:!0,auditViews:!0,auditPages:!0,auditPagesListName:"Pages",showHiddenLists:!1,showNoScript:!1,showSrc:!0},b),g=[["New","NewForm.aspx",!1],["Display","DispForm.aspx",!1],["Edit","EditForm.aspx",!1]];a("#"+f.outputId).append("<table id='SPScriptAudit' width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1><tr><th></th><th>List</th><th>Page Class</th><th>Page Type</th><th>Page</th>"+(f.showSrc?"<th>Script References</th>":"")+"</tr></table>");var h=a("#SPScriptAudit");h.find("th").attr("class","ms-vh2-nofilter"),(f.auditForms||f.auditViews)&&a().SPServices({operation:"GetListCollection",webURL:f.webURL,async:!1,completefunc:function(b){a(b.responseXML).find("List").each(function(){d=a(this),(0===f.listName.length||d.attr("Title")===f.listName)&&(f.showHiddenLists&&"False"===d.attr("Hidden")||!f.showHiddenLists)&&(f.auditForms&&a().SPServices({operation:"GetListContentTypes",webURL:f.webURL,listName:d.attr("ID"),async:!1,completefunc:function(b){a(b.responseXML).find("ContentType").each(function(){if("0x0120"!==a(this).attr("ID").substring(0,6)){var b=a(this).find("FormUrls");for(K=0;K<g.length;K++)if(a(b).find(g[K][0]).each(function(){e(f,d,"Form",this.nodeName,(f.webURL.length>0?f.webURL:a().SPServices.SPGetCurrentSite())+c.SLASH+a(this).text()),g[K][2]=!0}),!g[K][2]){var h=d.attr("DefaultViewUrl");e(f,d,"Form",g[K][0],h.substring(0,h.lastIndexOf(c.SLASH)+1)+g[K][1])}for(K=0;K<g.length;K++)g[K][2]=!1}})}}),f.auditViews&&a().SPServices({operation:"GetViewCollection",webURL:f.webURL,listName:d.attr("ID"),async:!1,completefunc:function(b){a(b.responseXML).find("View").each(function(){e(f,d,"View",a(this).attr("DisplayName"),a(this).attr("Url"))})}}))})}});var i=0,j=[];if("string"==typeof f.auditPagesListName?(i=1,j.push(f.auditPagesListName)):(i=f.auditPagesListName.length,j=f.auditPagesListName),f.auditPages)for(K=0;i>K;K++)a().SPServices({operation:"GetList",async:!1,cacheXML:!0,webURL:f.webURL,listName:j[K],completefunc:function(b){a(b.responseXML).find("List").each(function(){d=a(this)})}}),a().SPServices({operation:"GetListItems",async:!1,webURL:f.webURL,listName:j[K],CAMLQuery:"<Query><Where><Neq><FieldRef Name='ContentType'/><Value Type='Text'>Folder</Value></Neq></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='Title'/><FieldRef Name='FileRef'/></ViewFields>",CAMLRowLimit:0,completefunc:function(b){a(b.responseXML).SPFilterNode("z:row").each(function(){var b=a(this).attr("ows_FileRef").split(c.spDelim)[1],g=a(this).attr("ows_Title"),h="undefined"!=typeof g?g:"";b.indexOf(".aspx")>0&&e(f,d,"Page",h,c.SLASH+b)})}});h.find("tr[class='ms-alternating']:even").removeAttr("class")},a.fn.SPServices.SPArrangeChoices=function(c){var d=a.extend({},{listName:a().SPServices.SPListNameFromUrl(),columnName:"",perRow:99,randomize:!1},c),e=!1,f=[],g=a().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:d.listName});g.done(function(){a(g.responseXML).find("Field[DisplayName='"+d.columnName+"']").each(function(){return e="TRUE"===a(this).attr("FillInChoice"),!1});var c,h,i=b.findFormField(d.columnName),j=a(i).find("tr").length;a(i).find("tr").each(function(b){e&&b===j-2?c=a(this).find("td"):e&&b===j-1?h=a(this).find("td"):f.push(a(this).find("td"))}),d.randomize&&f.sort(b.randOrd);var k=a("<table cellpadding='0' cellspacing='1'></table>");for(K=0;K<f.length;K++)(K+1)%d.perRow===0&&k.append("<tr></tr>"),k.find("tr:last").append(f[K]);if(e){var l=a("<tr><td colspan='99'><table cellpadding='0' cellspacing='1'><tr></tr></table></td></tr>");l.find("tr").append(c),l.find("tr").append(h),k.append(l)}var m=a(i).find("table:first");m.before(k),m.hide()})},a.fn.SPServices.SPGetQueryString=function(b){for(var c=a.extend({},{lowercase:!1},b),d={},e=location.search.slice(1).split("&"),f=0;f<e.length;f++){var g=e[f].split("="),h=c.lowercase?g[0].toLowerCase():g[0];d[h]=decodeURIComponent(g[1]||"")}return d},a.fn.SPServices.SPListNameFromUrl=function(b){var d=a.extend({},{listName:""},b);if(d.listName.length>0)return J.thisList=d.listName,J.thisList;if(void 0!==J.thisList&&J.thisList.length>0)return J.thisList;var e=location.href,f=e.substring(0,e.indexOf(".aspx")),g=decodeURIComponent(f.substring(0,f.lastIndexOf(c.SLASH)+1)).toUpperCase();return a().SPServices({operation:"GetListCollection",async:!1,completefunc:function(b){a(b.responseXML).find("List").each(function(){var b=a(this).attr("DefaultViewUrl"),d=b.substring(0,b.lastIndexOf(c.SLASH)+1).toUpperCase();return g.indexOf(d)>0?(J.thisList=a(this).attr("ID"),!1):void 0})}}),J.thisList},a.fn.SPServices.SPUpdateMultipleListItems=function(d){var e,f=a.extend({},{webURL:"",listName:"",CAMLQuery:"",batchCmd:"Update",valuepairs:[],completefunc:null,debug:!1},d),g=[],h=[];a().SPServices({operation:"GetListItems",async:!1,webURL:f.webURL,listName:f.listName,CAMLQuery:f.CAMLQuery,CAMLQueryOptions:"<QueryOptions><ViewAttributes Scope='Recursive' /></QueryOptions>",completefunc:function(b){a(b.responseXML).SPFilterNode("z:row").each(function(){g.push(a(this).attr("ows_ID"));var b=a(this).attr("ows_FileRef");b="/"+b.substring(b.indexOf(c.spDelim)+2),h.push(b)})}});var i,j="<Batch OnError='Continue'>";for(e=0;e<g.length;e++){for(j+="<Method ID='"+e+"' Cmd='"+f.batchCmd+"'>",i=0;i<f.valuepairs.length;i++)j+="<Field Name='"+f.valuepairs[i][0]+"'>"+b.escapeColumnValue(f.valuepairs[i][1])+"</Field>";j+="<Field Name='ID'>"+g[e]+"</Field>",h[e].length>0&&(j+="<Field Name='FileRef'>"+h[e]+"</Field>"),j+="</Method>"}j+="</Batch>",a().SPServices({operation:"UpdateListItems",async:!1,webURL:f.webURL,listName:f.listName,updates:j,completefunc:function(a){null!==f.completefunc&&f.completefunc(a)}})},a.fn.SPServices.SPConvertDateToISO=function(c){var d=a.extend({},{dateToConvert:new Date,dateOffset:"-05:00"},c),e="",f=d.dateToConvert;return e+=f.getFullYear()+"-",e+=b.pad(f.getMonth()+1)+"-",e+=b.pad(f.getDate()),e+="T"+b.pad(f.getHours())+":",e+=b.pad(f.getMinutes())+":",e+=b.pad(f.getSeconds())+"Z"+d.dateOffset},a.fn.SPServices.Version=function(){return c.VERSION}}(g,b,a,c),e=function(a){return a}(g)})}();