/*
* SPServices - Work with SharePoint's Web Services using jQuery
* Version 2.0.0
* @requires jQuery v1.8 or greater - jQuery 1.10.x+ recommended
*
* Copyright (c) 2009-2015 Sympraxis Consulting LLC
* Examples and docs at:
* http://spservices.codeplex.com/
* Licensed under the MIT license:
* http://www.opensource.org/licenses/mit-license.php
*/
/*
* @description SPServices is a jQuery library which abstracts SharePoint's Web Services and makes them easier to use. It also includes functions which use the various Web Service operations to provide more useful (and cool) capabilities. It works entirely client side and requires no server install.
* @type jQuery
* @name SPServices
* @category Plugins/SPServices
* @author Sympraxis Consulting LLC/marc.anderson@sympraxisconsulting.com
* @build SPServices 2.0.0 2015-12-01 07:36:46
*/
!function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o;!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(p){var q=jQuery;a=function(){var a=window.SPServices||{};a.WebServices=a.WebService||{},a.SOAP=a.SOAP||{},a.SOAP.Action="";var b={VERSION:"2.0.0",spDelim:";#",SLASH:"/",TXTColumnNotFound:"Column not found on page",SCHEMASharePoint:"http://schemas.microsoft.com/sharepoint",multiLookupPrefix:"MultiLookupPicker",multiLookupPrefix2013:"MultiLookup",SOAPEnvelope:{header:"<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body>",footer:"</soap:Body></soap:Envelope>",payload:""},dropdownType:{simple:"S",complex:"C",multiSelect:"M"},spListFieldTypes:["Integer","Text","Note","DateTime","Counter","Choice","Lookup","Boolean","Number","Currency","URL","MultiChoice","Calculated","File","Attachments","User","Recurrence","ModStat","ContentTypeId","WorkflowStatus","AllDayEvent","RelatedItems","UserMulti","LookupMulti","datetime","float","Calc"]};return b}(),b=function(a,b){var c={SPServicesContext:function(){var a=location.protocol+"//"+location.host,b={};return"undefined"!=typeof _spPageContextInfo?(b.thisSite=a+_spPageContextInfo.webServerRelativeUrl,b.thisList=_spPageContextInfo.pageListId,b.thisUserId=_spPageContextInfo.userId):(b.thisSite="undefined"!=typeof L_Menu_BaseUrl?a+L_Menu_BaseUrl:"",b.thisList="",b.thisUserId="undefined"!=typeof _spUserId?_spUserId:void 0),b},wrapNode:function(a,b){var c="undefined"!=typeof b?b:"";return"<"+a+">"+c+"</"+a+">"},randOrd:function(){return Math.round(Math.random())-.5},checkLink:function(a){return 0===a.indexOf("http")||0===a.indexOf("/")?"<a href='"+a+"'>"+a+"</a>":a},fileName:function(a){return a.substring(a.lastIndexOf("/")+1,a.length)},xml_special_to_escaped_one_map:{"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"},encodeXml:function(a){return a.replace(/([\&"<>])/g,function(a,b){return this.xml_special_to_escaped_one_map[b]})},escapeColumnValue:function(a){return"string"==typeof a?a.replace(/&(?![a-zA-Z]{1,8};)/g,"&amp;"):a},escapeUrl:function(a){return a.replace(/&/g,"%26")},SplitIndex:function(a){var c=a.split(b.spDelim);this.id=c[0],this.value=c[1]},pad:function(a){return 10>a?"0"+a:a},errBox:function(a,b,c){var e="<b>Error in function</b><br/>"+a+"<br/><b>Parameter</b><br/>"+b+"<br/><b>Message</b><br/>"+c+"<br/><br/><span onmouseover='this.style.cursor=\"hand\";' onmouseout='this.style.cursor=\"inherit\";' style='width=100%;text-align:right;'>Click to continue</span></div>";d(e)},findFormField:function(b){var c,d=new RegExp('FieldName="'+b.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")+'"',"gi");return a("td.ms-formbody, td.ms-formbodysurvey").each(function(){return d.test(a(this).html())?(c=a(this),!1):void 0}),c},showAttrs:function(a){var b,d="<table class='ms-vb' width='100%'>";for(b=0;b<a.attributes.length;b++)d+="<tr><td width='10px' style='font-weight:bold;'>"+b+"</td><td width='100px'>"+a.attributes.item(b).nodeName+"</td><td>"+c.checkLink(a.attributes.item(b).nodeValue)+"</td></tr>";return d+="</table>"},addToPayload:function(d,e){var f;for(f=0;f<e.length;f++)"string"==typeof e[f]?b.SOAPEnvelope.payload+=c.wrapNode(e[f],d[e[f]]):a.isArray(e[f])&&2===e[f].length?b.SOAPEnvelope.payload+=c.wrapNode(e[f][0],d[e[f][1]]):"object"==typeof e[f]&&void 0!==e[f].sendNull?b.SOAPEnvelope.payload+=void 0===d[e[f].name]||0===d[e[f].name].length?"":c.wrapNode(e[f].name,d[e[f].name]):c.errBox(d.operation,"paramArray["+f+"]: "+e[f],"Invalid paramArray element passed to addToPayload()")},siteDataFixSOAPEnvelope:function(a,b){var c=b.substring(8);return a.opheader=a.opheader.replace(b,c),a.opfooter=a.opfooter.replace(b,c),a},getListFormUrl:function(b,c){var d;return a().SPServices({operation:"GetFormCollection",async:!1,listName:b,completefunc:function(b){d=a(b.responseXML).find("Form[Type='"+c+"']").attr("Url")}}),d},getDropdownSelected:function(c,d){var e=[];switch(c.Type){case b.dropdownType.simple:d?e.push(c.Obj.find("option:selected").val()||[]):e.push(c.Obj.find("option:selected").text()||[]);break;case b.dropdownType.complex:d?e.push(c.optHid.val()||[]):e.push(c.Obj.val()||[]);break;case b.dropdownType.multiSelect:a(c.master.resultControl).find("option").each(function(){d?e.push(a(this).val()):e.push(a(this).html())})}return e},genContainerId:function(b,c,d){var e=void 0!==d?d:a().SPServices.SPListNameFromUrl();return b+"_"+a().SPServices.SPGetStaticFromDisplay({listName:e,columnDisplayName:c})}},d=function(b){var c="position:absolute;width:300px;height:150px;padding:10px;background-color:#000000;color:#ffffff;z-index:30;font-family:'Arial';font-size:12px;display:none;";a("#aspnetForm").parent().append("<div id='SPServices_msgBox' style="+c+">"+b);var d=a("#SPServices_msgBox"),e=d.height(),f=d.width(),g=a(window).width()/2-f/2+"px",h=a(window).height()/2-e/2-100+"px";d.css({border:"5px #C02000 solid",left:g,top:h}).show().fadeTo("slow",.75).click(function(){a(this).fadeOut("3000",function(){a(this).remove()})})};return c}(q,a),c=function(a,b,c){var d,e={},f={ALERTS:"Alerts",AUTHENTICATION:"Authentication",COPY:"Copy",FORMS:"Forms",LISTS:"Lists",MEETINGS:"Meetings",OFFICIALFILE:"OfficialFile",PEOPLE:"People",PERMISSIONS:"Permissions",PUBLISHEDLINKSSERVICE:"PublishedLinksService",SEARCH:"Search",SHAREPOINTDIAGNOSTICS:"SharePointDiagnostics",SITEDATA:"SiteData",SITES:"Sites",SOCIALDATASERVICE:"SocialDataService",SPELLCHECK:"SpellCheck",TAXONOMYSERVICE:"TaxonomyClientService",USERGROUP:"usergroup",USERPROFILESERVICE:"UserProfileService",VERSIONS:"Versions",VIEWS:"Views",WEBPARTPAGES:"WebPartPages",WEBS:"Webs",WORKFLOW:"Workflow"},g=["listName","description"],h={};h.GetAlerts=[f.ALERTS,!1],h.DeleteAlerts=[f.ALERTS,!0],h.Mode=[f.AUTHENTICATION,!1],h.Login=[f.AUTHENTICATION,!1],h.CopyIntoItems=[f.COPY,!0],h.CopyIntoItemsLocal=[f.COPY,!0],h.GetItem=[f.COPY,!1],h.GetForm=[f.FORMS,!1],h.GetFormCollection=[f.FORMS,!1],h.AddAttachment=[f.LISTS,!0],h.AddDiscussionBoardItem=[f.LISTS,!0],h.AddList=[f.LISTS,!0],h.AddListFromFeature=[f.LISTS,!0],h.ApplyContentTypeToList=[f.LISTS,!0],h.CheckInFile=[f.LISTS,!0],h.CheckOutFile=[f.LISTS,!0],h.CreateContentType=[f.LISTS,!0],h.DeleteAttachment=[f.LISTS,!0],h.DeleteContentType=[f.LISTS,!0],h.DeleteContentTypeXmlDocument=[f.LISTS,!0],h.DeleteList=[f.LISTS,!0],h.GetAttachmentCollection=[f.LISTS,!1],h.GetList=[f.LISTS,!1],h.GetListAndView=[f.LISTS,!1],h.GetListCollection=[f.LISTS,!1],h.GetListContentType=[f.LISTS,!1],h.GetListContentTypes=[f.LISTS,!1],h.GetListItemChanges=[f.LISTS,!1],h.GetListItemChangesSinceToken=[f.LISTS,!1],h.GetListItems=[f.LISTS,!1],h.GetVersionCollection=[f.LISTS,!1],h.UndoCheckOut=[f.LISTS,!0],h.UpdateContentType=[f.LISTS,!0],h.UpdateContentTypesXmlDocument=[f.LISTS,!0],h.UpdateContentTypeXmlDocument=[f.LISTS,!0],h.UpdateList=[f.LISTS,!0],h.UpdateListItems=[f.LISTS,!0],h.AddMeeting=[f.MEETINGS,!0],h.CreateWorkspace=[f.MEETINGS,!0],h.RemoveMeeting=[f.MEETINGS,!0],h.SetWorkSpaceTitle=[f.MEETINGS,!0],h.GetRecordRouting=[f.OFFICIALFILE,!1],h.GetRecordRoutingCollection=[f.OFFICIALFILE,!1],h.GetServerInfo=[f.OFFICIALFILE,!1],h.SubmitFile=[f.OFFICIALFILE,!0],h.ResolvePrincipals=[f.PEOPLE,!0],h.SearchPrincipals=[f.PEOPLE,!1],h.AddPermission=[f.PERMISSIONS,!0],h.AddPermissionCollection=[f.PERMISSIONS,!0],h.GetPermissionCollection=[f.PERMISSIONS,!0],h.RemovePermission=[f.PERMISSIONS,!0],h.RemovePermissionCollection=[f.PERMISSIONS,!0],h.UpdatePermission=[f.PERMISSIONS,!0],h.GetLinks=[f.PUBLISHEDLINKSSERVICE,!0],h.GetPortalSearchInfo=[f.SEARCH,!1],h.GetQuerySuggestions=[f.SEARCH,!1],h.GetSearchMetadata=[f.SEARCH,!1],h.Query=[f.SEARCH,!1],h.QueryEx=[f.SEARCH,!1],h.Registration=[f.SEARCH,!1],h.Status=[f.SEARCH,!1],h.SendClientScriptErrorReport=[f.SHAREPOINTDIAGNOSTICS,!0],h.GetAttachments=[f.SITEDATA,!1],h.EnumerateFolder=[f.SITEDATA,!1],h.SiteDataGetList=[f.SITEDATA,!1],h.SiteDataGetListCollection=[f.SITEDATA,!1],h.SiteDataGetSite=[f.SITEDATA,!1],h.SiteDataGetSiteUrl=[f.SITEDATA,!1],h.SiteDataGetWeb=[f.SITEDATA,!1],h.CreateWeb=[f.SITES,!0],h.DeleteWeb=[f.SITES,!0],h.GetSite=[f.SITES,!1],h.GetSiteTemplates=[f.SITES,!1],h.AddComment=[f.SOCIALDATASERVICE,!0],h.AddTag=[f.SOCIALDATASERVICE,!0],h.AddTagByKeyword=[f.SOCIALDATASERVICE,!0],h.CountCommentsOfUser=[f.SOCIALDATASERVICE,!1],h.CountCommentsOfUserOnUrl=[f.SOCIALDATASERVICE,!1],h.CountCommentsOnUrl=[f.SOCIALDATASERVICE,!1],h.CountRatingsOnUrl=[f.SOCIALDATASERVICE,!1],h.CountTagsOfUser=[f.SOCIALDATASERVICE,!1],h.DeleteComment=[f.SOCIALDATASERVICE,!0],h.DeleteRating=[f.SOCIALDATASERVICE,!0],h.DeleteTag=[f.SOCIALDATASERVICE,!0],h.DeleteTagByKeyword=[f.SOCIALDATASERVICE,!0],h.DeleteTags=[f.SOCIALDATASERVICE,!0],h.GetAllTagTerms=[f.SOCIALDATASERVICE,!1],h.GetAllTagTermsForUrlFolder=[f.SOCIALDATASERVICE,!1],h.GetAllTagUrls=[f.SOCIALDATASERVICE,!1],h.GetAllTagUrlsByKeyword=[f.SOCIALDATASERVICE,!1],h.GetCommentsOfUser=[f.SOCIALDATASERVICE,!1],h.GetCommentsOfUserOnUrl=[f.SOCIALDATASERVICE,!1],h.GetCommentsOnUrl=[f.SOCIALDATASERVICE,!1],h.GetRatingAverageOnUrl=[f.SOCIALDATASERVICE,!1],h.GetRatingOfUserOnUrl=[f.SOCIALDATASERVICE,!1],h.GetRatingOnUrl=[f.SOCIALDATASERVICE,!1],h.GetRatingsOfUser=[f.SOCIALDATASERVICE,!1],h.GetRatingsOnUrl=[f.SOCIALDATASERVICE,!1],h.GetSocialDataForFullReplication=[f.SOCIALDATASERVICE,!1],h.GetTags=[f.SOCIALDATASERVICE,!0],h.GetTagsOfUser=[f.SOCIALDATASERVICE,!0],h.GetTagTerms=[f.SOCIALDATASERVICE,!0],h.GetTagTermsOfUser=[f.SOCIALDATASERVICE,!0],h.GetTagTermsOnUrl=[f.SOCIALDATASERVICE,!0],h.GetTagUrlsOfUser=[f.SOCIALDATASERVICE,!0],h.GetTagUrlsOfUserByKeyword=[f.SOCIALDATASERVICE,!0],h.GetTagUrls=[f.SOCIALDATASERVICE,!0],h.GetTagUrlsByKeyword=[f.SOCIALDATASERVICE,!0],h.SetRating=[f.SOCIALDATASERVICE,!0],h.UpdateComment=[f.SOCIALDATASERVICE,!0],h.SpellCheck=[f.SPELLCHECK,!1],h.AddTerms=[f.TAXONOMYSERVICE,!0],h.GetChildTermsInTerm=[f.TAXONOMYSERVICE,!1],h.GetChildTermsInTermSet=[f.TAXONOMYSERVICE,!1],h.GetKeywordTermsByGuids=[f.TAXONOMYSERVICE,!1],h.GetTermsByLabel=[f.TAXONOMYSERVICE,!1],h.GetTermSets=[f.TAXONOMYSERVICE,!1],h.AddGroup=[f.USERGROUP,!0],h.AddGroupToRole=[f.USERGROUP,!0],h.AddRole=[f.USERGROUP,!0],h.AddRoleDef=[f.USERGROUP,!0],h.AddUserCollectionToGroup=[f.USERGROUP,!0],h.AddUserCollectionToRole=[f.USERGROUP,!0],h.AddUserToGroup=[f.USERGROUP,!0],h.AddUserToRole=[f.USERGROUP,!0],h.GetAllUserCollectionFromWeb=[f.USERGROUP,!1],h.GetGroupCollection=[f.USERGROUP,!1],h.GetGroupCollectionFromRole=[f.USERGROUP,!1],h.GetGroupCollectionFromSite=[f.USERGROUP,!1],h.GetGroupCollectionFromUser=[f.USERGROUP,!1],h.GetGroupCollectionFromWeb=[f.USERGROUP,!1],h.GetGroupInfo=[f.USERGROUP,!1],h.GetRoleCollection=[f.USERGROUP,!1],h.GetRoleCollectionFromGroup=[f.USERGROUP,!1],h.GetRoleCollectionFromUser=[f.USERGROUP,!1],h.GetRoleCollectionFromWeb=[f.USERGROUP,!1],h.GetRoleInfo=[f.USERGROUP,!1],h.GetRolesAndPermissionsForCurrentUser=[f.USERGROUP,!1],h.GetRolesAndPermissionsForSite=[f.USERGROUP,!1],h.GetUserCollection=[f.USERGROUP,!1],h.GetUserCollectionFromGroup=[f.USERGROUP,!1],h.GetUserCollectionFromRole=[f.USERGROUP,!1],h.GetUserCollectionFromSite=[f.USERGROUP,!1],h.GetUserCollectionFromWeb=[f.USERGROUP,!1],h.GetUserInfo=[f.USERGROUP,!1],h.GetUserLoginFromEmail=[f.USERGROUP,!1],h.RemoveGroup=[f.USERGROUP,!0],h.RemoveGroupFromRole=[f.USERGROUP,!0],h.RemoveRole=[f.USERGROUP,!0],h.RemoveUserCollectionFromGroup=[f.USERGROUP,!0],h.RemoveUserCollectionFromRole=[f.USERGROUP,!0],h.RemoveUserCollectionFromSite=[f.USERGROUP,!0],h.RemoveUserFromGroup=[f.USERGROUP,!0],h.RemoveUserFromRole=[f.USERGROUP,!0],h.RemoveUserFromSite=[f.USERGROUP,!0],h.RemoveUserFromWeb=[f.USERGROUP,!0],h.UpdateGroupInfo=[f.USERGROUP,!0],h.UpdateRoleDefInfo=[f.USERGROUP,!0],h.UpdateRoleInfo=[f.USERGROUP,!0],h.UpdateUserInfo=[f.USERGROUP,!0],h.AddColleague=[f.USERPROFILESERVICE,!0],h.AddLink=[f.USERPROFILESERVICE,!0],h.AddMembership=[f.USERPROFILESERVICE,!0],h.AddPinnedLink=[f.USERPROFILESERVICE,!0],h.CreateMemberGroup=[f.USERPROFILESERVICE,!0],h.CreateUserProfileByAccountName=[f.USERPROFILESERVICE,!0],h.GetCommonColleagues=[f.USERPROFILESERVICE,!1],h.GetCommonManager=[f.USERPROFILESERVICE,!1],h.GetCommonMemberships=[f.USERPROFILESERVICE,!1],h.GetInCommon=[f.USERPROFILESERVICE,!1],h.GetPropertyChoiceList=[f.USERPROFILESERVICE,!1],h.GetUserColleagues=[f.USERPROFILESERVICE,!1],h.GetUserLinks=[f.USERPROFILESERVICE,!1],h.GetUserMemberships=[f.USERPROFILESERVICE,!1],h.GetUserPinnedLinks=[f.USERPROFILESERVICE,!1],h.GetUserProfileByGuid=[f.USERPROFILESERVICE,!1],h.GetUserProfileByIndex=[f.USERPROFILESERVICE,!1],h.GetUserProfileByName=[f.USERPROFILESERVICE,!1],h.GetUserProfileCount=[f.USERPROFILESERVICE,!1],h.GetUserProfileSchema=[f.USERPROFILESERVICE,!1],h.GetUserPropertyByAccountName=[f.USERPROFILESERVICE,!1],h.ModifyUserPropertyByAccountName=[f.USERPROFILESERVICE,!0],h.RemoveAllColleagues=[f.USERPROFILESERVICE,!0],h.RemoveAllLinks=[f.USERPROFILESERVICE,!0],h.RemoveAllMemberships=[f.USERPROFILESERVICE,!0],h.RemoveAllPinnedLinks=[f.USERPROFILESERVICE,!0],h.RemoveColleague=[f.USERPROFILESERVICE,!0],h.RemoveLink=[f.USERPROFILESERVICE,!0],h.RemoveMembership=[f.USERPROFILESERVICE,!0],h.RemovePinnedLink=[f.USERPROFILESERVICE,!0],h.UpdateColleaguePrivacy=[f.USERPROFILESERVICE,!0],h.UpdateLink=[f.USERPROFILESERVICE,!0],h.UpdateMembershipPrivacy=[f.USERPROFILESERVICE,!0],h.UpdatePinnedLink=[f.USERPROFILESERVICE,!0],h.DeleteAllVersions=[f.VERSIONS,!0],h.DeleteVersion=[f.VERSIONS,!0],h.GetVersions=[f.VERSIONS,!1],h.RestoreVersion=[f.VERSIONS,!0],h.AddView=[f.VIEWS,!0],h.DeleteView=[f.VIEWS,!0],h.GetView=[f.VIEWS,!1],h.GetViewHtml=[f.VIEWS,!1],h.GetViewCollection=[f.VIEWS,!1],h.UpdateView=[f.VIEWS,!0],h.UpdateViewHtml=[f.VIEWS,!0],h.AddWebPart=[f.WEBPARTPAGES,!0],h.AddWebPartToZone=[f.WEBPARTPAGES,!0],h.DeleteWebPart=[f.WEBPARTPAGES,!0],h.GetWebPart2=[f.WEBPARTPAGES,!1],h.GetWebPartPage=[f.WEBPARTPAGES,!1],h.GetWebPartProperties=[f.WEBPARTPAGES,!1],h.GetWebPartProperties2=[f.WEBPARTPAGES,!1],h.SaveWebPart2=[f.WEBPARTPAGES,!0],h.WebsCreateContentType=[f.WEBS,!0],h.GetColumns=[f.WEBS,!1],h.GetContentType=[f.WEBS,!1],h.GetContentTypes=[f.WEBS,!1],h.GetCustomizedPageStatus=[f.WEBS,!1],h.GetListTemplates=[f.WEBS,!1],h.GetObjectIdFromUrl=[f.WEBS,!1],h.GetWeb=[f.WEBS,!1],h.GetWebCollection=[f.WEBS,!1],h.GetAllSubWebCollection=[f.WEBS,!1],h.UpdateColumns=[f.WEBS,!0],h.WebsUpdateContentType=[f.WEBS,!0],h.WebUrlFromPageUrl=[f.WEBS,!1],h.AlterToDo=[f.WORKFLOW,!0],h.ClaimReleaseTask=[f.WORKFLOW,!0],h.GetTemplatesForItem=[f.WORKFLOW,!1],h.GetToDosForItem=[f.WORKFLOW,!1],h.GetWorkflowDataForItem=[f.WORKFLOW,!1],h.GetWorkflowTaskData=[f.WORKFLOW,!1],h.StartWorkflow=[f.WORKFLOW,!0],a.fn.SPServices=function(i){for(var j=a.extend({},a.fn.SPServices.defaults,i),k=0;k<g.length;k++)"string"==typeof j[g[k]]&&(j[g[k]]=b.encodeXml(j[g[k]]));switch(c.SOAPEnvelope.opheader="<"+j.operation+" ",h[j.operation][0]){case f.ALERTS:c.utils.SOAPEnvelope.opheader+="xmlns='"+c.SCHEMASharePoint+"/soap/2002/1/alerts/' >",d=c.SCHEMASharePoint+"/soap/2002/1/alerts/";break;case f.MEETINGS:c.SOAPEnvelope.opheader+="xmlns='"+c.SCHEMASharePoint+"/soap/meetings/' >",d=c.SCHEMASharePoint+"/soap/meetings/";break;case f.OFFICIALFILE:c.SOAPEnvelope.opheader+="xmlns='"+c.SCHEMASharePoint+"/soap/recordsrepository/' >",d=c.SCHEMASharePoint+"/soap/recordsrepository/";break;case f.PERMISSIONS:c.SOAPEnvelope.opheader+="xmlns='"+c.SCHEMASharePoint+"/soap/directory/' >",d=c.SCHEMASharePoint+"/soap/directory/";break;case f.PUBLISHEDLINKSSERVICE:c.SOAPEnvelope.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/' >",d="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/";break;case f.SEARCH:c.SOAPEnvelope.opheader+="xmlns='urn:Microsoft.Search' >",d="urn:Microsoft.Search/";break;case f.SHAREPOINTDIAGNOSTICS:c.SOAPEnvelope.opheader+="xmlns='"+c.SCHEMASharePoint+"/diagnostics/' >",d="http://schemas.microsoft.com/sharepoint/diagnostics/";break;case f.SOCIALDATASERVICE:c.SOAPEnvelope.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/SocialDataService' >",d="http://microsoft.com/webservices/SharePointPortalServer/SocialDataService/";break;case f.SPELLCHECK:c.SOAPEnvelope.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/publishing/spelling/' >",d="http://schemas.microsoft.com/sharepoint/publishing/spelling/SpellCheck";break;case f.TAXONOMYSERVICE:c.SOAPEnvelope.opheader+="xmlns='"+c.SCHEMASharePoint+"/taxonomy/soap/' >",d=c.SCHEMASharePoint+"/taxonomy/soap/";break;case f.USERGROUP:c.SOAPEnvelope.opheader+="xmlns='"+c.SCHEMASharePoint+"/soap/directory/' >",d=c.SCHEMASharePoint+"/soap/directory/";break;case f.USERPROFILESERVICE:c.SOAPEnvelope.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/UserProfileService' >",d="http://microsoft.com/webservices/SharePointPortalServer/UserProfileService/";break;case f.WEBPARTPAGES:c.SOAPEnvelope.opheader+="xmlns='http://microsoft.com/sharepoint/webpartpages' >",d="http://microsoft.com/sharepoint/webpartpages/";break;case f.WORKFLOW:c.SOAPEnvelope.opheader+="xmlns='"+c.SCHEMASharePoint+"/soap/workflow/' >",d=c.SCHEMASharePoint+"/soap/workflow/";break;default:c.SOAPEnvelope.opheader+="xmlns='"+c.SCHEMASharePoint+"/soap/'>",d=c.SCHEMASharePoint+"/soap/"}d+=j.operation,c.SOAPEnvelope.opfooter="</"+j.operation+">";var l="_vti_bin/"+h[j.operation][0]+".asmx",m=void 0!==j.webURL?j.webURL:j.webUrl;if(m.charAt(m.length-1)===c.SLASH)l=m+l;else if(m.length>0)l=m+c.SLASH+l;else{var n=a().SPServices.SPGetCurrentSite();l=n+(n.charAt(n.length-1)===c.SLASH?l:c.SLASH+l)}switch(c.SOAPEnvelope.payload="",j.operation){case"GetAlerts":break;case"DeleteAlerts":for(c.SOAPEnvelope.payload+="<IDs>",k=0;k<j.IDs.length;k++)c.SOAPEnvelope.payload+=c.wrapNode("string",j.IDs[k]);c.SOAPEnvelope.payload+="</IDs>";break;case"Mode":break;case"Login":b.addToPayload(j,["username","password"]);break;case"CopyIntoItems":for(b.addToPayload(j,["SourceUrl"]),c.SOAPEnvelope.payload+="<DestinationUrls>",k=0;k<j.DestinationUrls.length;k++)c.SOAPEnvelope.payload+=b.wrapNode("string",j.DestinationUrls[k]);c.SOAPEnvelope.payload+="</DestinationUrls>",b.addToPayload(j,["Fields","Stream","Results"]);break;case"CopyIntoItemsLocal":for(b.addToPayload(j,["SourceUrl"]),c.SOAPEnvelope.payload+="<DestinationUrls>",k=0;k<j.DestinationUrls.length;k++)c.SOAPEnvelope.payload+=b.wrapNode("string",j.DestinationUrls[k]);c.SOAPEnvelope.payload+="</DestinationUrls>";break;case"GetItem":b.addToPayload(j,["Url","Fields","Stream"]);break;case"GetForm":b.addToPayload(j,["listName","formUrl"]);break;case"GetFormCollection":b.addToPayload(j,["listName"]);break;case"AddAttachment":b.addToPayload(j,["listName","listItemID","fileName","attachment"]);break;case"AddDiscussionBoardItem":b.addToPayload(j,["listName","message"]);break;case"AddList":b.addToPayload(j,["listName","description","templateID"]);break;case"AddListFromFeature":b.addToPayload(j,["listName","description","featureID","templateID"]);break;case"ApplyContentTypeToList":b.addToPayload(j,["webUrl","contentTypeId","listName"]);break;case"CheckInFile":b.addToPayload(j,["pageUrl","comment","CheckinType"]);break;case"CheckOutFile":b.addToPayload(j,["pageUrl","checkoutToLocal","lastmodified"]);break;case"CreateContentType":b.addToPayload(j,["listName","displayName","parentType","fields","contentTypeProperties","addToView"]);break;case"DeleteAttachment":b.addToPayload(j,["listName","listItemID","url"]);break;case"DeleteContentType":b.addToPayload(j,["listName","contentTypeId"]);break;case"DeleteContentTypeXmlDocument":b.addToPayload(j,["listName","contentTypeId","documentUri"]);break;case"DeleteList":b.addToPayload(j,["listName"]);break;case"GetAttachmentCollection":b.addToPayload(j,["listName",["listItemID","ID"]]);break;case"GetList":b.addToPayload(j,["listName"]);break;case"GetListAndView":b.addToPayload(j,["listName","viewName"]);break;case"GetListCollection":break;case"GetListContentType":b.addToPayload(j,["listName","contentTypeId"]);break;case"GetListContentTypes":b.addToPayload(j,["listName"]);break;case"GetListItems":b.addToPayload(j,["listName","viewName",["query","CAMLQuery"],["viewFields","CAMLViewFields"],["rowLimit","CAMLRowLimit"],["queryOptions","CAMLQueryOptions"]]);break;case"GetListItemChanges":b.addToPayload(j,["listName","viewFields","since","contains"]);break;case"GetListItemChangesSinceToken":b.addToPayload(j,["listName","viewName",["query","CAMLQuery"],["viewFields","CAMLViewFields"],["rowLimit","CAMLRowLimit"],["queryOptions","CAMLQueryOptions"],{name:"changeToken",sendNull:!1},{name:"contains",sendNull:!1}]);break;case"GetVersionCollection":b.addToPayload(j,["strlistID","strlistItemID","strFieldName"]);break;case"UndoCheckOut":b.addToPayload(j,["pageUrl"]);break;case"UpdateContentType":b.addToPayload(j,["listName","contentTypeId","contentTypeProperties","newFields","updateFields","deleteFields","addToView"]);break;case"UpdateContentTypesXmlDocument":b.addToPayload(j,["listName","newDocument"]);break;case"UpdateContentTypeXmlDocument":b.addToPayload(j,["listName","contentTypeId","newDocument"]);break;case"UpdateList":b.addToPayload(j,["listName","listProperties","newFields","updateFields","deleteFields","listVersion"]);break;case"UpdateListItems":if(b.addToPayload(j,["listName"]),"undefined"!=typeof j.updates&&j.updates.length>0)b.addToPayload(j,["updates"]);else{for(c.SOAPEnvelope.payload+="<updates><Batch OnError='Continue'><Method ID='1' Cmd='"+j.batchCmd+"'>",k=0;k<j.valuepairs.length;k++)c.SOAPEnvelope.payload+="<Field Name='"+j.valuepairs[k][0]+"'>"+b.escapeColumnValue(j.valuepairs[k][1])+"</Field>";"New"!==j.batchCmd&&(c.SOAPEnvelope.payload+="<Field Name='ID'>"+j.ID+"</Field>"),c.SOAPEnvelope.payload+="</Method></Batch></updates>"}break;case"AddMeeting":b.addToPayload(j,["organizerEmail","uid","sequence","utcDateStamp","title","location","utcDateStart","utcDateEnd","nonGregorian"]);break;case"CreateWorkspace":b.addToPayload(j,["title","templateName","lcid","timeZoneInformation"]);break;case"RemoveMeeting":b.addToPayload(j,["recurrenceId","uid","sequence","utcDateStamp","cancelMeeting"]);break;case"SetWorkspaceTitle":b.addToPayload(j,["title"]);break;case"GetRecordRouting":b.addToPayload(j,["recordRouting"]);break;case"GetRecordRoutingCollection":break;case"GetServerInfo":break;case"SubmitFile":b.addToPayload(j,["fileToSubmit"],["properties"],["recordRouting"],["sourceUrl"],["userName"]);break;case"ResolvePrincipals":b.addToPayload(j,["principalKeys","principalType","addToUserInfoList"]);break;case"SearchPrincipals":b.addToPayload(j,["searchText","maxResults","principalType"]);break;case"AddPermission":b.addToPayload(j,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"AddPermissionCollection":b.addToPayload(j,["objectName","objectType","permissionsInfoXml"]);break;case"GetPermissionCollection":b.addToPayload(j,["objectName","objectType"]);break;case"RemovePermission":b.addToPayload(j,["objectName","objectType","permissionIdentifier","permissionType"]);break;case"RemovePermissionCollection":b.addToPayload(j,["objectName","objectType","memberIdsXml"]);break;case"UpdatePermission":b.addToPayload(j,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"GetLinks":break;case"GetPortalSearchInfo":c.SOAPEnvelope.opheader="<"+j.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",d="http://microsoft.com/webservices/OfficeServer/QueryService/"+j.operation;break;case"GetQuerySuggestions":c.SOAPEnvelope.opheader="<"+j.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",d="http://microsoft.com/webservices/OfficeServer/QueryService/"+j.operation,c.SOAPEnvelope.payload+=b.wrapNode("queryXml",c.encodeXml(j.queryXml));break;case"GetSearchMetadata":c.SOAPEnvelope.opheader="<"+j.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",d="http://microsoft.com/webservices/OfficeServer/QueryService/"+j.operation;break;case"Query":c.SOAPEnvelope.payload+=b.wrapNode("queryXml",c.encodeXml(j.queryXml));break;case"QueryEx":c.SOAPEnvelope.opheader="<"+j.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",d="http://microsoft.com/webservices/OfficeServer/QueryService/"+j.operation,c.SOAPEnvelope.payload+=b.wrapNode("queryXml",c.encodeXml(j.queryXml));break;case"Registration":c.SOAPEnvelope.payload+=b.wrapNode("registrationXml",c.encodeXml(j.registrationXml));break;case"Status":break;case"SendClientScriptErrorReport":b.addToPayload(j,["message","file","line","client","stack","team","originalFile"]);break;case"EnumerateFolder":b.addToPayload(j,["strFolderUrl"]);break;case"GetAttachments":b.addToPayload(j,["strListName","strItemId"]);break;case"SiteDataGetList":b.addToPayload(j,["strListName"]),c.SOAPEnvelope=c.siteDataFixSOAPEnvelope(c.SOAPEnvelope,j.operation);break;case"SiteDataGetListCollection":c.SOAPEnvelope=c.siteDataFixSOAPEnvelope(c.SOAPEnvelope,j.operation);break;case"SiteDataGetSite":c.SOAPEnvelope=c.siteDataFixSOAPEnvelope(c.SOAPEnvelope,j.operation);break;case"SiteDataGetSiteUrl":b.addToPayload(j,["Url"]),c.SOAPEnvelope=c.siteDataFixSOAPEnvelope(c.SOAPEnvelope,j.operation);break;case"SiteDataGetWeb":c.SOAPEnvelope=c.siteDataFixSOAPEnvelope(c.SOAPEnvelope,j.operation);break;case"CreateWeb":b.addToPayload(j,["url","title","description","templateName","language","languageSpecified","locale","localeSpecified","collationLocale","collationLocaleSpecified","uniquePermissions","uniquePermissionsSpecified","anonymous","anonymousSpecified","presence","presenceSpecified"]);break;case"DeleteWeb":b.addToPayload(j,["url"]);break;case"GetSite":b.addToPayload(j,["SiteUrl"]);break;case"GetSiteTemplates":b.addToPayload(j,["LCID","TemplateList"]);break;case"AddComment":b.addToPayload(j,["url","comment","isHighPriority","title"]);break;case"AddTag":b.addToPayload(j,["url","termID","title","isPrivate"]);break;case"AddTagByKeyword":b.addToPayload(j,["url","keyword","title","isPrivate"]);break;case"CountCommentsOfUser":b.addToPayload(j,["userAccountName"]);break;case"CountCommentsOfUserOnUrl":b.addToPayload(j,["userAccountName","url"]);break;case"CountCommentsOnUrl":b.addToPayload(j,["url"]);break;case"CountRatingsOnUrl":b.addToPayload(j,["url"]);break;case"CountTagsOfUser":b.addToPayload(j,["userAccountName"]);break;case"DeleteComment":b.addToPayload(j,["url","lastModifiedTime"]);break;case"DeleteRating":b.addToPayload(j,["url"]);break;case"DeleteTag":b.addToPayload(j,["url","termID"]);break;case"DeleteTagByKeyword":b.addToPayload(j,["url","keyword"]);break;case"DeleteTags":b.addToPayload(j,["url"]);break;case"GetAllTagTerms":b.addToPayload(j,["maximumItemsToReturn"]);break;case"GetAllTagTermsForUrlFolder":b.addToPayload(j,["urlFolder","maximumItemsToReturn"]);break;case"GetAllTagUrls":b.addToPayload(j,["termID"]);break;case"GetAllTagUrlsByKeyword":b.addToPayload(j,["keyword"]);break;case"GetCommentsOfUser":b.addToPayload(j,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetCommentsOfUserOnUrl":b.addToPayload(j,["userAccountName","url"]);break;case"GetCommentsOnUrl":b.addToPayload(j,["url","maximumItemsToReturn","startIndex"]),"undefined"!=typeof j.excludeItemsTime&&j.excludeItemsTime.length>0&&(c.SOAPEnvelope.payload+=b.wrapNode("excludeItemsTime",j.excludeItemsTime));break;case"GetRatingAverageOnUrl":b.addToPayload(j,["url"]);break;case"GetRatingOfUserOnUrl":b.addToPayload(j,["userAccountName","url"]);break;case"GetRatingOnUrl":b.addToPayload(j,["url"]);break;case"GetRatingsOfUser":b.addToPayload(j,["userAccountName"]);break;case"GetRatingsOnUrl":b.addToPayload(j,["url"]);break;case"GetSocialDataForFullReplication":b.addToPayload(j,["userAccountName"]);break;case"GetTags":b.addToPayload(j,["url"]);break;case"GetTagsOfUser":b.addToPayload(j,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetTagTerms":b.addToPayload(j,["maximumItemsToReturn"]);break;case"GetTagTermsOfUser":b.addToPayload(j,["userAccountName","maximumItemsToReturn"]);break;case"GetTagTermsOnUrl":b.addToPayload(j,["url","maximumItemsToReturn"]);break;case"GetTagUrls":b.addToPayload(j,["termID"]);break;case"GetTagUrlsByKeyword":b.addToPayload(j,["keyword"]);break;case"GetTagUrlsOfUser":b.addToPayload(j,["termID","userAccountName"]);break;case"GetTagUrlsOfUserByKeyword":b.addToPayload(j,["keyword","userAccountName"]);break;case"SetRating":b.addToPayload(j,["url","rating","title","analysisDataEntry"]);break;case"UpdateComment":b.addToPayload(j,["url","lastModifiedTime","comment","isHighPriority"]);break;case"SpellCheck":b.addToPayload(j,["chunksToSpell","declaredLanguage","useLad"]);break;case"AddTerms":b.addToPayload(j,["sharedServiceId","termSetId","lcid","newTerms"]);break;case"GetChildTermsInTerm":b.addToPayload(j,["sspId","lcid","termId","termSetId"]);break;case"GetChildTermsInTermSet":b.addToPayload(j,["sspId","lcid","termSetId"]);break;case"GetKeywordTermsByGuids":b.addToPayload(j,["termIds","lcid"]);break;case"GetTermsByLabel":b.addToPayload(j,["label","lcid","matchOption","resultCollectionSize","termIds","addIfNotFound"]);break;case"GetTermSets":b.addToPayload(j,["sharedServiceIds","termSetIds","lcid","clientTimeStamps","clientVersions"]);break;case"AddGroup":b.addToPayload(j,["groupName","ownerIdentifier","ownerType","defaultUserLoginName","description"]);break;case"AddGroupToRole":b.addToPayload(j,["groupName","roleName"]);break;case"AddRole":b.addToPayload(j,["roleName","description","permissionMask"]);break;case"AddRoleDef":b.addToPayload(j,["roleName","description","permissionMask"]);break;case"AddUserCollectionToGroup":b.addToPayload(j,["groupName","usersInfoXml"]);break;case"AddUserCollectionToRole":b.addToPayload(j,["roleName","usersInfoXml"]);break;case"AddUserToGroup":b.addToPayload(j,["groupName","userName","userLoginName","userEmail","userNotes"]);break;case"AddUserToRole":b.addToPayload(j,["roleName","userName","userLoginName","userEmail","userNotes"]);break;case"GetAllUserCollectionFromWeb":break;case"GetGroupCollection":b.addToPayload(j,["groupNamesXml"]);break;case"GetGroupCollectionFromRole":b.addToPayload(j,["roleName"]);break;case"GetGroupCollectionFromSite":break;case"GetGroupCollectionFromUser":b.addToPayload(j,["userLoginName"]);break;case"GetGroupCollectionFromWeb":break;case"GetGroupInfo":b.addToPayload(j,["groupName"]);break;case"GetRoleCollection":b.addToPayload(j,["roleNamesXml"]);break;case"GetRoleCollectionFromGroup":b.addToPayload(j,["groupName"]);break;case"GetRoleCollectionFromUser":b.addToPayload(j,["userLoginName"]);break;case"GetRoleCollectionFromWeb":break;case"GetRoleInfo":b.addToPayload(j,["roleName"]);break;case"GetRolesAndPermissionsForCurrentUser":break;case"GetRolesAndPermissionsForSite":break;case"GetUserCollection":b.addToPayload(j,["userLoginNamesXml"]);break;case"GetUserCollectionFromGroup":b.addToPayload(j,["groupName"]);break;case"GetUserCollectionFromRole":b.addToPayload(j,["roleName"]);break;case"GetUserCollectionFromSite":break;case"GetUserCollectionFromWeb":break;case"GetUserInfo":b.addToPayload(j,["userLoginName"]);break;case"GetUserLoginFromEmail":b.addToPayload(j,["emailXml"]);break;case"RemoveGroup":b.addToPayload(j,["groupName"]);break;case"RemoveGroupFromRole":b.addToPayload(j,["roleName","groupName"]);break;case"RemoveRole":b.addToPayload(j,["roleName"]);break;case"RemoveUserCollectionFromGroup":b.addToPayload(j,["groupName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromRole":b.addToPayload(j,["roleName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromSite":b.addToPayload(j,["userLoginNamesXml"]);break;case"RemoveUserFromGroup":b.addToPayload(j,["groupName","userLoginName"]);break;case"RemoveUserFromRole":b.addToPayload(j,["roleName","userLoginName"]);break;case"RemoveUserFromSite":b.addToPayload(j,["userLoginName"]);break;case"RemoveUserFromWeb":b.addToPayload(j,["userLoginName"]);break;case"UpdateGroupInfo":
b.addToPayload(j,["oldGroupName","groupName","ownerIdentifier","ownerType","description"]);break;case"UpdateRoleDefInfo":b.addToPayload(j,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateRoleInfo":b.addToPayload(j,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateUserInfo":b.addToPayload(j,["userLoginName","userName","userEmail","userNotes"]);break;case"AddColleague":b.addToPayload(j,["accountName","colleagueAccountName","group","privacy","isInWorkGroup"]);break;case"AddLink":b.addToPayload(j,["accountName","name","url","group","privacy"]);break;case"AddMembership":b.addToPayload(j,["accountName","membershipInfo","group","privacy"]);break;case"AddPinnedLink":b.addToPayload(j,["accountName","name","url"]);break;case"CreateMemberGroup":b.addToPayload(j,["membershipInfo"]);break;case"CreateUserProfileByAccountName":b.addToPayload(j,["accountName"]);break;case"GetCommonColleagues":b.addToPayload(j,["accountName"]);break;case"GetCommonManager":b.addToPayload(j,["accountName"]);break;case"GetCommonMemberships":b.addToPayload(j,["accountName"]);break;case"GetInCommon":b.addToPayload(j,["accountName"]);break;case"GetPropertyChoiceList":b.addToPayload(j,["propertyName"]);break;case"GetUserColleagues":b.addToPayload(j,["accountName"]);break;case"GetUserLinks":b.addToPayload(j,["accountName"]);break;case"GetUserMemberships":b.addToPayload(j,["accountName"]);break;case"GetUserPinnedLinks":b.addToPayload(j,["accountName"]);break;case"GetUserProfileByGuid":b.addToPayload(j,["guid"]);break;case"GetUserProfileByIndex":b.addToPayload(j,["index"]);break;case"GetUserProfileByName":"undefined"!=typeof j.accountName&&j.accountName.length>0?b.addToPayload(j,[["AccountName","accountName"]]):b.addToPayload(j,["AccountName"]);break;case"GetUserProfileCount":break;case"GetUserProfileSchema":break;case"GetUserPropertyByAccountName":b.addToPayload(j,["accountName","propertyName"]);break;case"ModifyUserPropertyByAccountName":b.addToPayload(j,["accountName","newData"]);break;case"RemoveAllColleagues":b.addToPayload(j,["accountName"]);break;case"RemoveAllLinks":b.addToPayload(j,["accountName"]);break;case"RemoveAllMemberships":b.addToPayload(j,["accountName"]);break;case"RemoveAllPinnedLinks":b.addToPayload(j,["accountName"]);break;case"RemoveColleague":b.addToPayload(j,["accountName","colleagueAccountName"]);break;case"RemoveLink":b.addToPayload(j,["accountName","id"]);break;case"RemoveMembership":b.addToPayload(j,["accountName","sourceInternal","sourceReference"]);break;case"RemovePinnedLink":b.addToPayload(j,["accountName","id"]);break;case"UpdateColleaguePrivacy":b.addToPayload(j,["accountName","colleagueAccountName","newPrivacy"]);break;case"UpdateLink":b.addToPayload(j,["accountName","data"]);break;case"UpdateMembershipPrivacy":b.addToPayload(j,["accountName","sourceInternal","sourceReference","newPrivacy"]);break;case"UpdatePinnedLink ":b.addToPayload(j,["accountName","data"]);break;case"DeleteAllVersions":b.addToPayload(j,["fileName"]);break;case"DeleteVersion":b.addToPayload(j,["fileName","fileVersion"]);break;case"GetVersions":b.addToPayload(j,["fileName"]);break;case"RestoreVersion":b.addToPayload(j,["fileName","fileVersion"]);break;case"AddView":b.addToPayload(j,["listName","viewName","viewFields","query","rowLimit","rowLimit","type","makeViewDefault"]);break;case"DeleteView":b.addToPayload(j,["listName","viewName"]);break;case"GetView":b.addToPayload(j,["listName","viewName"]);break;case"GetViewCollection":b.addToPayload(j,["listName"]);break;case"GetViewHtml":b.addToPayload(j,["listName","viewName"]);break;case"UpdateView":b.addToPayload(j,["listName","viewName","viewProperties","query","viewFields","aggregations","formats","rowLimit"]);break;case"UpdateViewHtml":b.addToPayload(j,["listName","viewName","viewProperties","toolbar","viewHeader","viewBody","viewFooter","viewEmpty","rowLimitExceeded","query","viewFields","aggregations","formats","rowLimit"]);break;case"AddWebPart":b.addToPayload(j,["pageUrl","webPartXml","storage"]);break;case"AddWebPartToZone":b.addToPayload(j,["pageUrl","webPartXml","storage","zoneId","zoneIndex"]);break;case"DeleteWebPart":b.addToPayload(j,["pageUrl","storageKey","storage"]);break;case"GetWebPart2":b.addToPayload(j,["pageUrl","storageKey","storage","behavior"]);break;case"GetWebPartPage":b.addToPayload(j,["documentName","behavior"]);break;case"GetWebPartProperties":b.addToPayload(j,["pageUrl","storage"]);break;case"GetWebPartProperties2":b.addToPayload(j,["pageUrl","storage","behavior"]);break;case"SaveWebPart2":b.addToPayload(j,["pageUrl","storageKey","webPartXml","storage","allowTypeChange"]);break;case"WebsCreateContentType":b.addToPayload(j,["displayName","parentType","newFields","contentTypeProperties"]);break;case"GetColumns":b.addToPayload(j,["webUrl"]);break;case"GetContentType":b.addToPayload(j,["contentTypeId"]);break;case"GetContentTypes":break;case"GetCustomizedPageStatus":b.addToPayload(j,["fileUrl"]);break;case"GetListTemplates":break;case"GetObjectIdFromUrl":b.addToPayload(j,["objectUrl"]);break;case"GetWeb":b.addToPayload(j,[["webUrl","webURL"]]);break;case"GetWebCollection":break;case"GetAllSubWebCollection":break;case"UpdateColumns":b.addToPayload(j,["newFields","updateFields","deleteFields"]);break;case"WebsUpdateContentType":b.addToPayload(j,["contentTypeId","contentTypeProperties","newFields","updateFields","deleteFields"]);break;case"WebUrlFromPageUrl":b.addToPayload(j,[["pageUrl","pageURL"]]);break;case"AlterToDo":b.addToPayload(j,["item","todoId","todoListId","taskData"]);break;case"ClaimReleaseTask":b.addToPayload(j,["item","taskId","listId","fClaim"]);break;case"GetTemplatesForItem":b.addToPayload(j,["item"]);break;case"GetToDosForItem":b.addToPayload(j,["item"]);break;case"GetWorkflowDataForItem":b.addToPayload(j,["item"]);break;case"GetWorkflowTaskData":b.addToPayload(j,["item","listId","taskId"]);break;case"StartWorkflow":b.addToPayload(j,["item","templateId","workflowParameters"])}var o,p=c.SOAPEnvelope.header+c.SOAPEnvelope.opheader+c.SOAPEnvelope.payload+c.SOAPEnvelope.opfooter+c.SOAPEnvelope.footer;if(j.cacheXML&&(o=e[p]),"undefined"==typeof o){var q=a.ajax({url:l,async:j.async,beforeSend:function(a){h[j.operation][1]&&a.setRequestHeader("SOAPAction",d)},type:"POST",data:p,dataType:"xml",contentType:"text/xml;charset='utf-8'",complete:function(b,c){a.isFunction(j.completefunc)&&j.completefunc(b,c)}});return j.cacheXML&&(e[p]=q),q}return a.isFunction(j.completefunc)&&o.done(function(a,b,c){j.completefunc(c,b)}),o},a.fn.SPServices.defaults={cacheXML:!1,operation:"",webURL:"",makeViewDefault:!1,viewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:0,CAMLQueryOptions:"<QueryOptions></QueryOptions>",batchCmd:"Update",valuepairs:[],DestinationUrls:[],behavior:"Version3",storage:"Shared",objectType:"List",cancelMeeting:!0,nonGregorian:!1,fClaim:!1,recurrenceId:0,sequence:0,maximumItemsToReturn:0,startIndex:0,isHighPriority:!1,isPrivate:!1,rating:1,maxResults:10,principalType:"User",async:!0,completefunc:null}}(q,b,a),d=function(a,b){return a.fn.SPServices.Version=function(){return b.VERSION},a}(q,a),e=function(a,b,c){return a.fn.SPServices.SPGetCurrentSite=function(){if(b.SPServicesContext().thisSite.length>0)return b.SPServicesContext().thisSite;var d=b.SOAPEnvelope.header+"<WebUrlFromPageUrl xmlns='"+c.SCHEMASharePoint+"/soap/' ><pageUrl>"+(location.href.indexOf("?")>0?location.href.substr(0,location.href.indexOf("?")):location.href)+"</pageUrl></WebUrlFromPageUrl>"+b.SOAPEnvelope.footer;return a.ajax({async:!1,url:"/_vti_bin/Webs.asmx",type:"POST",data:d,dataType:"xml",contentType:'text/xml;charset="utf-8"',complete:function(c){b.SPServicesContext().thisSite=a(c.responseXML).find("WebUrlFromPageUrlResult").text()}}),b.SPServicesContext().thisSite},a}(q,b,a),f=function(a,b){return a.fn.SPServices.SPGetCurrentUser=function(c){var d=a.extend({},{webURL:"",fieldName:"Name",fieldNames:{},debug:!1},c);if("ID"===d.fieldName&&"undefined"!=typeof b.SPServicesContext().thisUserId)return b.SPServicesContext().thisUserId;var e,f="",g={},h=d.fieldNames.length>0?d.fieldNames.length:1,i=d.webURL.length>0?d.webURL:a().SPServices.SPGetCurrentSite();a.ajax({async:!1,url:("/"===i?"":i)+"/_layouts/userdisp.aspx?Force=True&"+(new Date).getTime(),complete:function(a){e=a}});for(var j=0;h>j;j++){if("ID"===d.fieldNames[j])f=b.SPServicesContext().thisUserId;else{var k;k=h>1?RegExp('FieldInternalName="'+d.fieldNames[j]+'"',"gi"):RegExp('FieldInternalName="'+d.fieldName+'"',"gi"),a(e.responseText).find("table.ms-formtable td[id^='SPField']").each(function(){if(k.test(a(this).html())){switch(a(this).attr("id")){case"SPFieldText":f=a(this).text();break;case"SPFieldNote":f=a(this).find("div").html();break;case"SPFieldURL":f=a(this).find("img").attr("src");break;default:f=a(this).text()}return!1}})}"ID"!==d.fieldNames[j]&&(f="undefined"!=typeof f?f.replace(/(^[\s\xA0]+|[\s\xA0]+$)/g,""):null),h>1&&(g[d.fieldNames[j]]=f)}return h>1?g:f},a}(q,b),g=function(a){return a.fn.SPFilterNode=function(a){return this.find("*").filter(function(){return this.nodeName===a})},a}(q),h=function(a,b,c){return a.fn.SPServices.SPGetListItemsJson=function(b){var d,e=a.extend({},{webURL:"",listName:"",viewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:"",CAMLQueryOptions:"",changeToken:"",contains:"",mapping:null,mappingOverrides:null,debug:!1},a().SPServices.defaults,b),f={},g=[],h=a.Deferred(),i=a().SPServices({operation:"GetListItemChangesSinceToken",webURL:e.webURL,listName:e.listName,viewName:e.viewName,CAMLQuery:e.CAMLQuery,CAMLViewFields:e.CAMLViewFields,CAMLRowLimit:e.CAMLRowLimit,CAMLQueryOptions:e.CAMLQueryOptions,changeToken:e.changeToken,contains:e.contains});return i.done(function(){var b="SPGetListItemsJson"+e.webURL+e.listName,j=a(i.responseXML);if(d=j.find("Changes").attr("LastChangeToken"),j.find("listitems Changes Id[ChangeType='Delete']").each(function(){g.push(a(this).text())}),null===e.mapping?j.find("List > Fields > Field").each(function(){var b=a(this),d=b.attr("Type");a.inArray(d,c.spListFieldTypes)>=0&&(f["ows_"+b.attr("Name")]={mappedName:b.attr("Name"),objectType:b.attr("Type")})}):f=e.mapping,null!==e.mappingOverrides)for(var k in e.mappingOverrides)f[k]=e.mappingOverrides[k];a.isEmptyObject(f)?f=a(document).data(b):a(document).data(b,f);var l=j.SPFilterNode("z:row").SPXmlToJson({mapping:f,sparse:!0}),m={changeToken:d,mapping:f,data:l,deletedIds:g};h.resolveWith(m)}),h.promise()},a}(q,b,a),i=function(a,b,c){function d(a,b){var c={Integer:e(a),Number:f(a),Boolean:g(a),DateTime:h(a),User:i(a),UserMulti:j(a),Lookup:k(a),lookupMulti:l(a),MultiChoice:m(a),Calculated:p(a),Attachments:n(a),URL:o(a),JSON:q(a),Text:c.Default(a),Counter:c.Integer(a),datetime:c.DateTime(a),AllDayEvent:c.Boolean(a),Recurrence:c.Boolean(a),Currency:c.Number(a),"float":c.Number(a),RelatedItems:c.JSON(a),Default:a};return void 0!==c[b]?c.objectType(a):a}function e(a){return parseInt(a,10)}function f(a){return parseFloat(a)}function g(a){return"0"!==a}function h(a){var b=a.split("T")[0]!==a?a.split("T"):a.split(" "),c=b[0].split("-"),d=b[1].split(":"),e=d[2].split("Z");return new Date(c[0],c[1]-1,c[2],d[0],d[1],e[0])}function i(a){if(0===a.length)return null;var c=new b.SplitIndex(a),d=c.value.split(",#");return 1===d.length?{userId:c.id,userName:c.value}:{userId:c.id,userName:d[0].replace(/(,,)/g,","),loginName:d[1].replace(/(,,)/g,","),email:d[2].replace(/(,,)/g,","),sipAddress:d[3].replace(/(,,)/g,","),title:d[4].replace(/(,,)/g,",")}}function j(a){if(0===a.length)return null;for(var b=[],d=a.split(c.spDelim),e=0;e<d.length;e+=2){var f=i(d[e]+c.spDelim+d[e+1]);b.push(f)}return b}function k(a){if(0===a.length)return null;var b=a.split(c.spDelim);return{lookupId:b[0],lookupValue:b[1]}}function l(a){if(0===a.length)return null;for(var b=[],d=a.split(c.spDelim),e=0;e<d.length;e+=2){var f=k(d[e]+c.spDelim+d[e+1]);b.push(f)}return b}function m(a){if(0===a.length)return null;for(var b=[],d=a.split(c.spDelim),e=0;e<d.length;e++)0!==d[e].length&&b.push(d[e]);return b}function n(a){if(0===a.length)return null;if("0"===a||"1"===a)return a;for(var b=[],d=a.split(c.spDelim),e=0;e<d.length;e++)if(0!==d[e].length){var f=d[e];if(-1!==d[e].lastIndexOf("/")){var g=d[e].split("/");f=g[g.length-1]}b.push({attachment:d[e],fileName:f})}return b}function o(a){if(0===a.length)return null;var b=a.split(", ");return{Url:b[0],Description:b[1]}}function p(a){if(0===a.length)return null;var b=a.split(c.spDelim);return d(b[1],b[0])}function q(b){return 0===b.length?null:a.parseJSON(b)}return a.fn.SPXmlToJson=function(b){var c,e=a.extend({},{mapping:{},includeAllAttrs:!1,removeOws:!0,sparse:!1},b),f=[];return this.each(function(){var b={},g=this.attributes;for(e.sparse||a.each(e.mapping,function(){b[this.mappedName]=""}),c=0;c<g.length;c++){var h=g[c].name,i=e.mapping[h],j="undefined"!=typeof i?i.mappedName:e.removeOws?h.split("ows_")[1]:h,k="undefined"!=typeof i?i.objectType:void 0;(e.includeAllAttrs||void 0!==i)&&(b[j]=d(g[c].value,k))}f.push(b)}),f},a}(q,b,a),j=function(a,b){return a.fn.SPServices.SPConvertDateToISO=function(c){var d=a.extend({},{dateToConvert:new Date,dateOffset:"-05:00"},c),e="",f=d.dateToConvert;return e+=f.getFullYear()+"-",e+=b.pad(f.getMonth()+1)+"-",e+=b.pad(f.getDate()),e+="T"+b.pad(f.getHours())+":",e+=b.pad(f.getMinutes())+":",e+=b.pad(f.getSeconds())+"Z"+d.dateOffset},a}(q,b),k=function(a){return a.fn.SPServices.SPGetDisplayFromStatic=function(b){var c=a.extend({},{webURL:"",listName:"",columnStaticName:"",columnStaticNames:{}},b),d="",e={},f=c.columnStaticNames.length>0?c.columnStaticNames.length:1;return a().SPServices({operation:"GetList",async:!1,cacheXML:!0,webURL:c.webURL,listName:c.listName,completefunc:function(b){if(f>1)for(var g=0;f>g;g++)e[c.columnStaticNames[g]]=a(b.responseXML).find("Field[StaticName='"+c.columnStaticNames[g]+"']").attr("DisplayName");else d=a(b.responseXML).find("Field[StaticName='"+c.columnStaticName+"']").attr("DisplayName")}}),f>1?e:d},a}(q),l=function(a){return a.fn.SPServices.SPGetStaticFromDisplay=function(b){var c=a.extend({},{webURL:"",listName:"",columnDisplayName:"",columnDisplayNames:{}},b),d="",e={},f=c.columnDisplayNames.length>0?c.columnDisplayNames.length:1;return a().SPServices({operation:"GetList",async:!1,cacheXML:!0,webURL:c.webURL,listName:c.listName,completefunc:function(b){if(f>1)for(var g=0;f>g;g++)e[c.columnDisplayNames[g]]=a(b.responseXML).find("Field[DisplayName='"+c.columnDisplayNames[g]+"']").attr("StaticName");else d=a(b.responseXML).find("Field[DisplayName='"+c.columnDisplayName+"']").attr("StaticName")}}),f>1?e:d},a}(q),m=function(a){return a.fn.SPServices.SPGetLastItemId=function(b){var c,d=a.extend({},{webURL:"",listName:"",userAccount:"",CAMLQuery:""},b),e=0;a().SPServices({operation:"GetUserInfo",webURL:d.webURL,async:!1,userLoginName:""!==d.userAccount?d.userAccount:a().SPServices.SPGetCurrentUser(),completefunc:function(b){a(b.responseXML).find("User").each(function(){c=a(this).attr("ID")})}});var f="<Query><Where>";return d.CAMLQuery.length>0&&(f+="<And>"),f+="<Eq><FieldRef Name='Author' LookupId='TRUE'/><Value Type='Integer'>"+c+"</Value></Eq>",d.CAMLQuery.length>0&&(f+=d.CAMLQuery+"</And>"),f+="</Where><OrderBy><FieldRef Name='Created_x0020_Date' Ascending='FALSE'/></OrderBy></Query>",a().SPServices({operation:"GetListItems",async:!1,webURL:d.webURL,listName:d.listName,CAMLQuery:f,CAMLViewFields:"<ViewFields><FieldRef Name='ID'/></ViewFields>",CAMLRowLimit:1,CAMLQueryOptions:"<QueryOptions><ViewAttributes Scope='Recursive' /></QueryOptions>",completefunc:function(b){a(b.responseXML).SPFilterNode("z:row").each(function(){e=a(this).attr("ows_ID")})}}),e},a}(q),n=function(a,b,c){function d(d){var e,f,g,h,i,j="",k=null,l=d.Obj.data("SPCascadeDropdownsChildColumns");a(l).each(function(){var l,m=this.opt,n=this.childSelect,o=this.childColumnStatic,p=this.childColumnRequired;e=c.getDropdownSelected(d,m.matchOnId);var q=e.join(b.spDelim);if(d.Obj.data("SPCascadeDropdown_Selected_"+o)!==q){d.Obj.data("SPCascadeDropdown_Selected_"+o,q),k=c.getDropdownSelected(n,!0);var r=m.relationshipListSortColumn.length>0?m.relationshipListSortColumn:m.relationshipListChildColumn,s="<Query><OrderBy><FieldRef Name='"+r+"'/></OrderBy><Where><And>";if(m.CAMLQuery.length>0&&(s+="<And>"),0===e.length)s+="<Eq><FieldRef Name='"+m.relationshipListParentColumn+"'/><Value Type='Text'></Value></Eq>";else if(1===e.length)s+="<Eq><FieldRef Name='"+m.relationshipListParentColumn+(m.matchOnId?"' LookupId='True'/><Value Type='Integer'>":"'/><Value Type='Text'>")+c.escapeColumnValue(e[0])+"</Value></Eq>";else{var t=e.length>2;for(l=0;l<e.length-1;l++)s+="<Or>";for(l=0;l<e.length;l++)s+="<Eq><FieldRef Name='"+m.relationshipListParentColumn+(m.matchOnId?"' LookupId='True'/><Value Type='Integer'>":"'/><Value Type='Text'>")+c.escapeColumnValue(e[l])+"</Value></Eq>",l>0&&l<e.length-1&&t&&(s+="</Or>");s+="</Or>"}m.CAMLQuery.length>0&&(s+=m.CAMLQuery+"</And>"),s+="<IsNotNull><FieldRef Name='"+m.relationshipListChildColumn+"' /></IsNotNull>",s+="</And></Where></Query>",a().SPServices({operation:"GetListItems",async:!1,webURL:m.relationshipWebURL,listName:m.relationshipList,CAMLQuery:s,CAMLViewFields:"<ViewFields><FieldRef Name='"+m.relationshipListParentColumn+"' /><FieldRef Name='"+m.relationshipListChildColumn+"' /></ViewFields>",CAMLRowLimit:0,CAMLQueryOptions:m.CAMLQueryOptions,completefunc:function(d){switch(a(d.responseXML).find("errorstring").each(function(){var b="SPServices.SPCascadeDropdowns",d=a(this).text();m.debug&&"One or more field types are not installed properly. Go to the list settings page to delete these fields."===d?c.errBox(b,"relationshipListParentColumn: "+m.relationshipListParentColumn+" or relationshipListChildColumn: "+m.relationshipListChildColumn,"Not found in relationshipList "+m.relationshipList):m.debug&&"Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)."===d&&c.errBox(b,"relationshipList: "+m.relationshipList,"List not found")}),n.Type){case b.dropdownType.simple:n.Obj[0].innerHTML="",!p&&m.promptText.length>0?n.Obj.append("<option value='0'>"+m.promptText.replace(/\{0\}/g,m.childColumn)+"</option>"):p||n.Obj.append("<option value='0'>"+m.noneText+"</option>");break;case b.dropdownType.complex:j=p?"":m.noneText+"|0",n.Obj.val("");break;case b.dropdownType.multiSelect:a(n.master.candidateControl).find("option").remove(),f=""}switch(g=parseFloat(a(d.responseXML).SPFilterNode("rs:data").attr("ItemCount")),a(d.responseXML).SPFilterNode("z:row").each(function(){var d={},e=a(this).attr("ows_"+m.relationshipListChildColumn);switch("undefined"!=typeof e&&e.indexOf(b.spDelim)>0?d=new c.SplitIndex(e):(d.id=a(this).attr("ows_ID"),d.value=e),isNaN(d.id)&&(d.id=a(this).attr("ows_ID")),h=d.id,i=d.value,n.Type){case b.dropdownType.simple:var g=a(this).attr("ows_ID")===k[0]?" selected='selected'":"";n.Obj.append("<option"+g+" value='"+d.id+"'>"+d.value+"</option>");break;case b.dropdownType.complex:d.id===k[0]&&n.Obj.val(d.value),j=j+(j.length>0?"|":"")+d.value+"|"+d.id;break;case b.dropdownType.multiSelect:a(n.master.candidateControl).append("<option value='"+d.id+"'>"+d.value+"</option>"),f+=d.id+"|t"+d.value+"|t |t |t"}}),n.Type){case b.dropdownType.simple:n.Obj.trigger("change"),1===g&&m.selectSingleOption===!0&&a(n.Obj).find("option[value!='0']:first").attr("selected","selected");break;case b.dropdownType.complex:n.Obj.attr("choices",j),1===g&&m.selectSingleOption===!0&&(a(n.Obj).val(i),n.optHid.val(h)),""===n.Obj.val()&&n.optHid.val("");break;case b.dropdownType.multiSelect:n.master.data="",n.MultiLookupPickerdata.val(f),a(n.master.resultControl).find("option").each(function(){var b=a(this);b.prop("selected",!0),a(n.master.candidateControl).find("option[value='"+b.val()+"']").each(function(){b.prop("selected",!1)})}),GipRemoveSelectedItems(n.master),a(n.master.candidateControl).find("option").each(function(){var b=a(this);a(n.master.resultControl).find("option[value='"+b.val()+"']").each(function(){b.remove()})}),GipAddSelectedItems(n.master),n.master.data=GipGetGroupData(f),a(n.master.candidateControl).trigger("dblclick")}}}),null!==m.completefunc&&m.completefunc()}})}return a.fn.SPServices.SPCascadeDropdowns=function(e){var f=a.extend({},{relationshipWebURL:"",relationshipList:"",relationshipListParentColumn:"",relationshipListChildColumn:"",relationshipListSortColumn:"",parentColumn:"",childColumn:"",listName:a().SPServices.SPListNameFromUrl(),CAMLQuery:"",CAMLQueryOptions:"<QueryOptions><IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns></QueryOptions>",promptText:"",noneText:"(None)",simpleChild:!1,selectSingleOption:!1,matchOnId:!1,completefunc:null,debug:!1},e),g=!1,h="SPServices.SPCascadeDropdowns",i=a().SPServices.SPDropdownCtl({displayName:f.parentColumn});if(null===i.Obj.html()&&f.debug)return void c.errBox(h,"parentColumn: "+f.parentColumn,b.TXTColumnNotFound);var j=a().SPServices.SPDropdownCtl({displayName:f.childColumn});if(null===j.Obj.html()&&f.debug)return void c.errBox(h,"childColumn: "+f.childColumn,b.TXTColumnNotFound);f.simpleChild===!0&&j.Type===b.dropdownType.complex&&(a().SPServices.SPComplexToSimpleDropdown({listName:f.listName,columnName:f.childColumn}),j=a().SPServices.SPDropdownCtl({displayName:f.childColumn}));var k,l;a().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:f.listName,completefunc:function(b){a(b.responseXML).find("Fields").each(function(){a(this).find("Field[DisplayName='"+f.childColumn+"']").each(function(){return k="TRUE"===a(this).attr("Required"),l=a(this).attr("StaticName"),!1})})}});var m={opt:f,childSelect:j,childColumnStatic:l,childColumnRequired:k},n=i.Obj.data("SPCascadeDropdownsChildColumns");if("undefined"==typeof n?i.Obj.data("SPCascadeDropdownsChildColumns",[m]):(n.push(m),i.Obj.data("SPCascadeDropdownsChildColumns",n),g=!0),!g)switch(i.Type){case b.dropdownType.simple:i.Obj.bind("change",function(){d(i)});break;case b.dropdownType.complex:i.optHid.bind("propertychange",function(){d(i)});break;case b.dropdownType.multiSelect:a(i.master.candidateControl).bind("dblclick",function(){d(i)}),a(i.master.resultControl).bind("dblclick",function(){d(i)}),a(i.master.addControl).bind("click",function(){d(i)}),a(i.master.removeControl).bind("click",function(){d(i)})}d(i)},a}(q,a,b),o=function(a){return a}(q)})}();