/*
* SPServices - Work with SharePoint's Web Services using jQuery
* Version 1.36.0
* @requires jQuery v1.8 or greater - jQuery 1.10.x+ recommended
*
* Copyright (c) 2009-2015 Sympraxis Consulting LLC
* Examples and docs at:
* http://spservices.codeplex.com/
* Licensed under the MIT license:
* http://www.opensource.org/licenses/mit-license.php
*/
/*
* @description SPServices is a jQuery library which abstracts SharePoint's Web Services and makes them easier to use. It also includes functions which use the various Web Service operations to provide more useful (and cool) capabilities. It works entirely client side and requires no server install.
* @type jQuery
* @name SPServices
* @category Plugins/SPServices
* @author Sympraxis Consulting LLC/marc.anderson@sympraxisconsulting.com
! @build SPServices 1.36.0 2015-05-09 01:49:15
*/
!function(){var a,b,c,d,e;!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(f){var g=jQuery;a=function(){var a={spDelim:";#",TXTColumnNotFound:"Column not found on page",dropdownType:{simple:"S",complex:"C",multiSelect:"M"}};return a}(),b=function(a,b){var c={wrapNode:function(a,b){var c="undefined"!=typeof b?b:"";return"<"+a+">"+c+"</"+a+">"},randOrd:function(){return Math.round(Math.random())-.5},checkLink:function(a){return 0===a.indexOf("http")||0===a.indexOf("/")?"<a href='"+a+"'>"+a+"</a>":a},fileName:function(a){return a.substring(a.lastIndexOf("/")+1,a.length)},xml_special_to_escaped_one_map:{"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"},encodeXml:function(a){return a.replace(/([\&"<>])/g,function(a,b){return this.xml_special_to_escaped_one_map[b]})},escapeColumnValue:function(a){return"string"==typeof a?a.replace(/&(?![a-zA-Z]{1,8};)/g,"&amp;"):a},escapeUrl:function(a){return a.replace(/&/g,"%26")},SplitIndex:function(a){var c=a.split(b.spDelim);this.id=c[0],this.value=c[1]},pad:function(a){return 10>a?"0"+a:a},errBox:function(a,b,c){var e="<b>Error in function</b><br/>"+a+"<br/><b>Parameter</b><br/>"+b+"<br/><b>Message</b><br/>"+c+"<br/><br/><span onmouseover='this.style.cursor=\"hand\";' onmouseout='this.style.cursor=\"inherit\";' style='width=100%;text-align:right;'>Click to continue</span></div>";d(e)}},d=function(b){var c="position:absolute;width:300px;height:150px;padding:10px;background-color:#000000;color:#ffffff;z-index:30;font-family:'Arial';font-size:12px;display:none;";a("#aspnetForm").parent().append("<div id='SPServices_msgBox' style="+c+">"+b);var d=a("#SPServices_msgBox"),e=d.height(),f=d.width(),g=a(window).width()/2-f/2+"px",h=a(window).height()/2-e/2-100+"px";d.css({border:"5px #C02000 solid",left:g,top:h}).show().fadeTo("slow",.75).click(function(){a(this).fadeOut("3000",function(){a(this).remove()})})};return c}(g,a),c=function(a,b){var c=function(c,d){var e=[];switch(c.Type){case b.dropdownType.simple:e.push(d?c.Obj.find("option:selected").val()||[]:c.Obj.find("option:selected").text()||[]);break;case b.dropdownType.complex:e.push(d?c.optHid.val()||[]:c.Obj.val()||[]);break;case b.dropdownType.multiSelect:a(c.master.resultControl).find("option").each(function(){e.push(d?a(this).val():a(this).html())})}return e};return c}(g,a),d=function(a,b,c,d){function e(e,f,g,h){var i,j="SPServices.SPDisplayRelatedInfo",k=a().SPServices.SPDropdownCtl({displayName:e.columnName});if(i=d(k,e.matchOnId),!(k.Type===c.dropdownType.complex&&e.numChars>0&&i[0].length<e.numChars)&&k.Obj.attr("showRelatedSelected")!==i[0]){k.Obj.attr("showRelatedSelected",i[0]),a("#"+f).remove(),k.Obj.parent().append("<div id="+f+"></div>");var l="<Query><Where>";e.CAMLQuery.length>0&&(l+="<And>");var m=h[e.relatedListColumn].attr("Type");l+="Lookup"===m?"<Eq><FieldRef Name='"+e.relatedListColumn+(e.matchOnId?"' LookupId='True'/><Value Type='Integer'>":"'/><Value Type='Text'>")+b.escapeColumnValue(i[0])+"</Value></Eq>":"<Eq><FieldRef Name='"+(e.matchOnId?"ID' /><Value Type='Counter'>":e.relatedListColumn+"'/><Value Type='Text'>")+b.escapeColumnValue(i[0])+"</Value></Eq>",e.CAMLQuery.length>0&&(l+=e.CAMLQuery+"</And>"),l+="</Where></Query>";var n=" ";for(ia=0;ia<e.relatedColumns.length;ia++)n+="<FieldRef Name='"+e.relatedColumns[ia]+"' />";a().SPServices({operation:"GetListItems",async:!1,webURL:e.relatedWebURL,listName:e.relatedList,CAMLQuery:l,CAMLViewFields:"<ViewFields>"+n+"</ViewFields>",CAMLRowLimit:0,completefunc:function(c){a(c.responseXML).find("errorstring").each(function(){var c=a(this).text();e.debug&&"One or more field types are not installed properly. Go to the list settings page to delete these fields."===c?b.errBox(j,"relatedListColumn: "+e.relatedListColumn,"Column not found in relatedList "+e.relatedList):e.debug&&"Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)."===c&&b.errBox(j,"relatedList: "+e.relatedList,"List not found")});var d;switch(e.displayFormat){case"table":for(d="<table>",d+="<tr>",ia=0;ia<e.relatedColumns.length;ia++){if("undefined"==typeof h[e.relatedColumns[ia]]&&e.debug)return void b.errBox(j,"columnName: "+e.relatedColumns[ia],"Column not found in relatedList");d+="<th class='"+e.headerCSSClass+"'>"+h[e.relatedColumns[ia]].attr("DisplayName")+"</th>"}d+="</tr>",a(c.responseXML).SPFilterNode("z:row").each(function(){for(d+="<tr>",ia=0;ia<e.relatedColumns.length;ia++)d+="<td class='"+e.rowCSSClass+"'>"+x(g,h[e.relatedColumns[ia]],a(this).attr("ows_"+e.relatedColumns[ia]),e)+"</td>";d+="</tr>"}),d+="</table>";break;case"list":d="<table>",a(c.responseXML).SPFilterNode("z:row").each(function(){for(ia=0;ia<e.relatedColumns.length;ia++){if("undefined"==typeof h[e.relatedColumns[ia]]&&e.debug)return void b.errBox(j,"columnName: "+e.relatedColumns[ia],"Column not found in relatedList");d+="<tr>",d+="<th class='"+e.headerCSSClass+"'>"+h[e.relatedColumns[ia]].attr("DisplayName")+"</th>",d+="<td class='"+e.rowCSSClass+"'>"+x(g,h[e.relatedColumns[ia]],a(this).attr("ows_"+e.relatedColumns[ia]),e)+"</td>",d+="</tr>"}}),d+="</table>"}a("#"+f).html(d)}}),null!==e.completefunc&&e.completefunc()}}function f(c,d,e,f,i){var j=0,k=0,l={};l.type=[],l.src=[],l.script=[];var m=RegExp("<script[\\s\\S]*?/script>","gi");a.ajax({type:"GET",url:i,dataType:"text",async:!1,success:function(n){for(var o;o=m.exec(n);){var p=g(o,"language"),q=g(o,"type"),r=g(o,"src");null!==r&&r.length>0&&!h(r)&&(l.type.push(null!==p&&p.length>0?p:q),l.src.push(r),k++)}if(!c.showNoScript&&l.type.length>0||c.showNoScript){var s=i.substring(0,i.lastIndexOf(F)+1),t="<tr class=ms-alternating><td class=ms-vb-icon><a href='"+d.attr("DefaultViewUrl")+"'><IMG border=0 src='"+d.attr("ImageUrl")+"'width=16 height=16></A></TD><td class=ms-vb2><a href='"+d.attr("DefaultViewUrl")+"'>"+d.attr("Title")+("True"===d.attr("Hidden")?"(Hidden)":"")+"</td><td class=ms-vb2>"+e+"</td><td class=ms-vb2>"+f+"</td><td class=ms-vb2><a href='"+i+"'>"+b.fileName(i)+"</td>";if(c.showSrc){var u;for(t+="<td valign='top'><table width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1>",j=0;j<l.type.length;j++)u=l.src[j].substr(0,1)!==F?s+l.src[j]:l.src[j],t+="<tr><td class=ms-vb2 width='30%'>"+l.type[j]+"</td>",t+="<td class=ms-vb2 width='70%'><a href='"+u+"'>"+b.fileName(l.src[j])+"</td></tr>";t+="</table></td>"}a("#SPScriptAudit").append(t)}}})}function g(a,b){var c,d=RegExp(b+"=(\"([^\"]*)\")|('([^']*)')","gi");return(c=d.exec(a))?c[2]:null}function h(a){var b,c=["WebResource.axd","_layouts"];for(b=0;b<c.length;b++)if(a.indexOf(c[b])>-1)return!0;return!1}function i(a,b){var c;switch(b){case"Text":c=a;break;case"DateTime":case"datetime":c=m(a);break;case"User":c=n(a);break;case"UserMulti":c=o(a);break;case"Lookup":c=p(a);break;case"LookupMulti":c=q(a);break;case"Boolean":c=l(a);break;case"Integer":c=j(a);break;case"Counter":c=j(a);break;case"MultiChoice":c=r(a);break;case"Number":case"Currency":case"float":c=k(a);break;case"Calculated":c=u(a);break;case"Attachments":c=s(a);break;case"URL":c=t(a);break;case"JSON":case"RelatedItems":c=v(a);break;default:c=a}return c}function j(a){return parseInt(a,10)}function k(a){return parseFloat(a)}function l(a){return"0"!==a}function m(a){var b=a.split(a.split("T")[0]!==a?"T":" "),c=b[0].split("-"),d=b[1].split(":"),e=d[2].split("Z");return new Date(c[0],c[1]-1,c[2],d[0],d[1],e[0])}function n(a){if(0===a.length)return null;var c=new b.SplitIndex(a),d=c.value.split(",#");return 1===d.length?{userId:c.id,userName:c.value}:{userId:c.id,userName:d[0].replace(/(,,)/g,","),loginName:d[1].replace(/(,,)/g,","),email:d[2].replace(/(,,)/g,","),sipAddress:d[3].replace(/(,,)/g,","),title:d[4].replace(/(,,)/g,",")}}function o(a){if(0===a.length)return null;var b=[],d=a.split(c.spDelim);for(ia=0;ia<d.length;ia+=2){var e=n(d[ia]+c.spDelim+d[ia+1]);b.push(e)}return b}function p(a){if(0===a.length)return null;var b=a.split(c.spDelim);return{lookupId:b[0],lookupValue:b[1]}}function q(a){if(0===a.length)return null;var b=[],d=a.split(c.spDelim);for(ia=0;ia<d.length;ia+=2){var e=p(d[ia]+c.spDelim+d[ia+1]);b.push(e)}return b}function r(a){if(0===a.length)return null;var b=[],d=a.split(c.spDelim);for(ia=0;ia<d.length;ia++)0!==d[ia].length&&b.push(d[ia]);return b}function s(a){if(0===a.length)return null;if("0"===a||"1"===a)return a;var b=[],d=a.split(c.spDelim);for(ia=0;ia<d.length;ia++)if(0!==d[ia].length){var e=d[ia];if(-1!==d[ia].lastIndexOf("/")){var f=d[ia].split("/");e=f[f.length-1]}b.push({attachment:d[ia],fileName:e})}return b}function t(a){if(0===a.length)return null;var b=a.split(", ");return{Url:b[0],Description:b[1]}}function u(a){if(0===a.length)return null;var b=a.split(c.spDelim);return i(b[1],b[0])}function v(b){return 0===b.length?null:a.parseJSON(b)}function w(){var a=location.protocol+"//"+location.host;"undefined"!=typeof _spPageContextInfo?(this.thisSite=a+_spPageContextInfo.webServerRelativeUrl,this.thisList=_spPageContextInfo.pageListId,this.thisUserId=_spPageContextInfo.userId):(this.thisSite="undefined"!=typeof L_Menu_BaseUrl?a+L_Menu_BaseUrl:"",this.thisList="",this.thisUserId="undefined"!=typeof _spUserId?_spUserId:void 0)}function x(d,e,f,g){if("undefined"==typeof f)return"";var h,i,j,k="",l="",m=[],n=g.relatedWebURL.length>0?g.relatedWebURL:a().SPServices.SPGetCurrentSite();switch(e.attr("Type")){case"Text":k=f;break;case"URL":switch(e.attr("Format")){case"Hyperlink":k="<a href='"+f.substring(0,f.search(","))+"'>"+f.substring(f.search(",")+1)+"</a>";break;case"Image":k="<img alt='"+f.substring(f.search(",")+1)+"' src='"+f.substring(0,f.search(","))+"'/>";break;default:k=f}break;case"User":case"UserMulti":var o=f.split(c.spDelim);for(h=0;h<o.length;h+=2)m.push("<a href='/_layouts/userdisp.aspx?ID="+o[h]+"&Source="+b.escapeUrl(location.href)+"'>"+o[h+1]+"</a>");k=m.join(", ");break;case"Calculated":var p=f.split(c.spDelim);k=p[1];break;case"Number":j=e.attr("Decimals"),k="undefined"==typeof j?parseFloat(f).toString():parseFloat(f).toFixed(j).toString();break;case"Currency":j=e.attr("Decimals"),k="undefined"==typeof j?parseFloat(f).toFixed(2).toString():parseFloat(f).toFixed(j).toString();break;case"Lookup":switch(e.attr("Name")){case"FileRef":i="1"===d.attr("BaseType")?d.attr("RootFolder")+F+"Forms/DispForm.aspx":d.attr("RootFolder")+F+"DispForm.aspx",k="<a href='"+i+"?ID="+f.substring(0,f.search(c.spDelim))+"&RootFolder=*&Source="+b.escapeUrl(location.href)+"'>"+f.substring(f.search(c.spDelim)+2)+"</a>";break;case"FileDirRef":i=F+f.substring(f.search(c.spDelim)+2),k="<a href='"+i+"'>"+f.substring(f.search(c.spDelim)+2)+"</a>";break;default:i=A(e.attr("List"),"DisplayForm"),k="<a href='"+g.relatedWebURL+F+i+"?ID="+f.substring(0,f.search(c.spDelim))+"&RootFolder=*&Source="+b.escapeUrl(location.href)+"'>"+f.substring(f.search(c.spDelim)+2)+"</a>"}break;case"LookupMulti":if(i=A(e.attr("List"),"DisplayForm"),k="",f.length>0){var q=f.split(c.spDelim);for(h=0;h<q.length/2;h++)m.push("<a href='"+n+F+i+"?ID="+q[2*h]+"&RootFolder=*&Source="+b.escapeUrl(location.href)+"'>"+q[2*h+1]+"</a>")}k=m.join(", ");break;case"File":l=f.substring(f.search(c.spDelim)+2),k="<a href='"+d.attr("RootFolder")+F+l+"'>"+l+"</a>";break;case"Counter":k=f;break;case"DateTime":k=f;break;default:k=f}return k}function y(a){var c,d="<table class='ms-vb' width='100%'>";for(c=0;c<a.attributes.length;c++)d+="<tr><td width='10px' style='font-weight:bold;'>"+c+"</td><td width='100px'>"+a.attributes.item(c).nodeName+"</td><td>"+b.checkLink(a.attributes.item(c).nodeValue)+"</td></tr>";return d+="</table>"}function z(b,c,d){var e=void 0!==d?d:a().SPServices.SPListNameFromUrl();return b+"_"+a().SPServices.SPGetStaticFromDisplay({listName:e,columnDisplayName:c})}function A(b,c){var d;return a().SPServices({operation:"GetFormCollection",async:!1,listName:b,completefunc:function(b){d=a(b.responseXML).find("Form[Type='"+c+"']").attr("Url")}}),d}function B(c,d){var e;for(e=0;e<d.length;e++)"string"==typeof d[e]?la.payload+=b.wrapNode(d[e],c[d[e]]):a.isArray(d[e])&&2===d[e].length?la.payload+=b.wrapNode(d[e][0],c[d[e][1]]):"object"==typeof d[e]&&void 0!==d[e].sendNull?la.payload+=void 0===c[d[e].name]||0===c[d[e].name].length?"":b.wrapNode(d[e].name,c[d[e].name]):b.errBox(c.operation,"paramArray["+e+"]: "+d[e],"Invalid paramArray element passed to addToPayload()")}function C(b){var c,d=RegExp('FieldName="'+b.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")+'"',"gi");return a("td.ms-formbody, td.ms-formbodysurvey").each(function(){return d.test(a(this).html())?(c=a(this),!1):void 0}),c}function D(a,b){var c=b.substring(8);return a.opheader=a.opheader.replace(b,c),a.opfooter=a.opfooter.replace(b,c),a}var E="2014.02",F="/",G="http://schemas.microsoft.com/sharepoint",H="MultiLookupPicker",I="MultiLookup",J=["Integer","Text","Note","DateTime","Counter","Choice","Lookup","Boolean","Number","Currency","URL","MultiChoice","Calculated","File","Attachments","User","ModStat","ContentTypeId","WorkflowStatus","RelatedItems","UserMulti","LookupMulti","datetime","float","Calc"],K={},L="Alerts",M="Authentication",N="Copy",O="Forms",P="Lists",Q="Meetings",R="OfficialFile",S="People",T="Permissions",U="PublishedLinksService",V="Search",W="SharePointDiagnostics",X="SiteData",Y="Sites",Z="SocialDataService",$="SpellCheck",_="TaxonomyClientService",aa="usergroup",ba="UserProfileService",ca="Versions",da="Views",ea="WebPartPages",fa="Webs",ga="Workflow",ha=new w,ia=0,ja=["listName","description"],ka=[];ka.GetAlerts=[L,!1],ka.DeleteAlerts=[L,!0],ka.Mode=[M,!1],ka.Login=[M,!1],ka.CopyIntoItems=[N,!0],ka.CopyIntoItemsLocal=[N,!0],ka.GetItem=[N,!1],ka.GetForm=[O,!1],ka.GetFormCollection=[O,!1],ka.AddAttachment=[P,!0],ka.AddDiscussionBoardItem=[P,!0],ka.AddList=[P,!0],ka.AddListFromFeature=[P,!0],ka.ApplyContentTypeToList=[P,!0],ka.CheckInFile=[P,!0],ka.CheckOutFile=[P,!0],ka.CreateContentType=[P,!0],ka.DeleteAttachment=[P,!0],ka.DeleteContentType=[P,!0],ka.DeleteContentTypeXmlDocument=[P,!0],ka.DeleteList=[P,!0],ka.GetAttachmentCollection=[P,!1],ka.GetList=[P,!1],ka.GetListAndView=[P,!1],ka.GetListCollection=[P,!1],ka.GetListContentType=[P,!1],ka.GetListContentTypes=[P,!1],ka.GetListItemChanges=[P,!1],ka.GetListItemChangesSinceToken=[P,!1],ka.GetListItems=[P,!1],ka.GetVersionCollection=[P,!1],ka.UndoCheckOut=[P,!0],ka.UpdateContentType=[P,!0],ka.UpdateContentTypesXmlDocument=[P,!0],ka.UpdateContentTypeXmlDocument=[P,!0],ka.UpdateList=[P,!0],ka.UpdateListItems=[P,!0],ka.AddMeeting=[Q,!0],ka.CreateWorkspace=[Q,!0],ka.RemoveMeeting=[Q,!0],ka.SetWorkSpaceTitle=[Q,!0],ka.GetRecordRouting=[R,!1],ka.GetRecordRoutingCollection=[R,!1],ka.GetServerInfo=[R,!1],ka.SubmitFile=[R,!0],ka.ResolvePrincipals=[S,!0],ka.SearchPrincipals=[S,!1],ka.AddPermission=[T,!0],ka.AddPermissionCollection=[T,!0],ka.GetPermissionCollection=[T,!0],ka.RemovePermission=[T,!0],ka.RemovePermissionCollection=[T,!0],ka.UpdatePermission=[T,!0],ka.GetLinks=[U,!0],ka.GetPortalSearchInfo=[V,!1],ka.GetQuerySuggestions=[V,!1],ka.GetSearchMetadata=[V,!1],ka.Query=[V,!1],ka.QueryEx=[V,!1],ka.Registration=[V,!1],ka.Status=[V,!1],ka.SendClientScriptErrorReport=[W,!0],ka.GetAttachments=[X,!1],ka.EnumerateFolder=[X,!1],ka.SiteDataGetList=[X,!1],ka.SiteDataGetListCollection=[X,!1],ka.SiteDataGetSite=[X,!1],ka.SiteDataGetSiteUrl=[X,!1],ka.SiteDataGetWeb=[X,!1],ka.CreateWeb=[Y,!0],ka.DeleteWeb=[Y,!0],ka.GetSite=[Y,!1],ka.GetSiteTemplates=[Y,!1],ka.AddComment=[Z,!0],ka.AddTag=[Z,!0],ka.AddTagByKeyword=[Z,!0],ka.CountCommentsOfUser=[Z,!1],ka.CountCommentsOfUserOnUrl=[Z,!1],ka.CountCommentsOnUrl=[Z,!1],ka.CountRatingsOnUrl=[Z,!1],ka.CountTagsOfUser=[Z,!1],ka.DeleteComment=[Z,!0],ka.DeleteRating=[Z,!0],ka.DeleteTag=[Z,!0],ka.DeleteTagByKeyword=[Z,!0],ka.DeleteTags=[Z,!0],ka.GetAllTagTerms=[Z,!1],ka.GetAllTagTermsForUrlFolder=[Z,!1],ka.GetAllTagUrls=[Z,!1],ka.GetAllTagUrlsByKeyword=[Z,!1],ka.GetCommentsOfUser=[Z,!1],ka.GetCommentsOfUserOnUrl=[Z,!1],ka.GetCommentsOnUrl=[Z,!1],ka.GetRatingAverageOnUrl=[Z,!1],ka.GetRatingOfUserOnUrl=[Z,!1],ka.GetRatingOnUrl=[Z,!1],ka.GetRatingsOfUser=[Z,!1],ka.GetRatingsOnUrl=[Z,!1],ka.GetSocialDataForFullReplication=[Z,!1],ka.GetTags=[Z,!0],ka.GetTagsOfUser=[Z,!0],ka.GetTagTerms=[Z,!0],ka.GetTagTermsOfUser=[Z,!0],ka.GetTagTermsOnUrl=[Z,!0],ka.GetTagUrlsOfUser=[Z,!0],ka.GetTagUrlsOfUserByKeyword=[Z,!0],ka.GetTagUrls=[Z,!0],ka.GetTagUrlsByKeyword=[Z,!0],ka.SetRating=[Z,!0],ka.UpdateComment=[Z,!0],ka.SpellCheck=[$,!1],ka.AddTerms=[_,!0],ka.GetChildTermsInTerm=[_,!1],ka.GetChildTermsInTermSet=[_,!1],ka.GetKeywordTermsByGuids=[_,!1],ka.GetTermsByLabel=[_,!1],ka.GetTermSets=[_,!1],ka.AddGroup=[aa,!0],ka.AddGroupToRole=[aa,!0],ka.AddRole=[aa,!0],ka.AddRoleDef=[aa,!0],ka.AddUserCollectionToGroup=[aa,!0],ka.AddUserCollectionToRole=[aa,!0],ka.AddUserToGroup=[aa,!0],ka.AddUserToRole=[aa,!0],ka.GetAllUserCollectionFromWeb=[aa,!1],ka.GetGroupCollection=[aa,!1],ka.GetGroupCollectionFromRole=[aa,!1],ka.GetGroupCollectionFromSite=[aa,!1],ka.GetGroupCollectionFromUser=[aa,!1],ka.GetGroupCollectionFromWeb=[aa,!1],ka.GetGroupInfo=[aa,!1],ka.GetRoleCollection=[aa,!1],ka.GetRoleCollectionFromGroup=[aa,!1],ka.GetRoleCollectionFromUser=[aa,!1],ka.GetRoleCollectionFromWeb=[aa,!1],ka.GetRoleInfo=[aa,!1],ka.GetRolesAndPermissionsForCurrentUser=[aa,!1],ka.GetRolesAndPermissionsForSite=[aa,!1],ka.GetUserCollection=[aa,!1],ka.GetUserCollectionFromGroup=[aa,!1],ka.GetUserCollectionFromRole=[aa,!1],ka.GetUserCollectionFromSite=[aa,!1],ka.GetUserCollectionFromWeb=[aa,!1],ka.GetUserInfo=[aa,!1],ka.GetUserLoginFromEmail=[aa,!1],ka.RemoveGroup=[aa,!0],ka.RemoveGroupFromRole=[aa,!0],ka.RemoveRole=[aa,!0],ka.RemoveUserCollectionFromGroup=[aa,!0],ka.RemoveUserCollectionFromRole=[aa,!0],ka.RemoveUserCollectionFromSite=[aa,!0],ka.RemoveUserFromGroup=[aa,!0],ka.RemoveUserFromRole=[aa,!0],ka.RemoveUserFromSite=[aa,!0],ka.RemoveUserFromWeb=[aa,!0],ka.UpdateGroupInfo=[aa,!0],ka.UpdateRoleDefInfo=[aa,!0],ka.UpdateRoleInfo=[aa,!0],ka.UpdateUserInfo=[aa,!0],ka.AddColleague=[ba,!0],ka.AddLink=[ba,!0],ka.AddMembership=[ba,!0],ka.AddPinnedLink=[ba,!0],ka.CreateMemberGroup=[ba,!0],ka.CreateUserProfileByAccountName=[ba,!0],ka.GetCommonColleagues=[ba,!1],ka.GetCommonManager=[ba,!1],ka.GetCommonMemberships=[ba,!1],ka.GetInCommon=[ba,!1],ka.GetPropertyChoiceList=[ba,!1],ka.GetUserColleagues=[ba,!1],ka.GetUserLinks=[ba,!1],ka.GetUserMemberships=[ba,!1],ka.GetUserPinnedLinks=[ba,!1],ka.GetUserProfileByGuid=[ba,!1],ka.GetUserProfileByIndex=[ba,!1],ka.GetUserProfileByName=[ba,!1],ka.GetUserProfileCount=[ba,!1],ka.GetUserProfileSchema=[ba,!1],ka.GetUserPropertyByAccountName=[ba,!1],ka.ModifyUserPropertyByAccountName=[ba,!0],ka.RemoveAllColleagues=[ba,!0],ka.RemoveAllLinks=[ba,!0],ka.RemoveAllMemberships=[ba,!0],ka.RemoveAllPinnedLinks=[ba,!0],ka.RemoveColleague=[ba,!0],ka.RemoveLink=[ba,!0],ka.RemoveMembership=[ba,!0],ka.RemovePinnedLink=[ba,!0],ka.UpdateColleaguePrivacy=[ba,!0],ka.UpdateLink=[ba,!0],ka.UpdateMembershipPrivacy=[ba,!0],ka.UpdatePinnedLink=[ba,!0],ka.DeleteAllVersions=[ca,!0],ka.DeleteVersion=[ca,!0],ka.GetVersions=[ca,!1],ka.RestoreVersion=[ca,!0],ka.AddView=[da,!0],ka.DeleteView=[da,!0],ka.GetView=[da,!1],ka.GetViewHtml=[da,!1],ka.GetViewCollection=[da,!1],ka.UpdateView=[da,!0],ka.UpdateViewHtml=[da,!0],ka.AddWebPart=[ea,!0],ka.AddWebPartToZone=[ea,!0],ka.DeleteWebPart=[ea,!0],ka.GetWebPart2=[ea,!1],ka.GetWebPartPage=[ea,!1],ka.GetWebPartProperties=[ea,!1],ka.GetWebPartProperties2=[ea,!1],ka.SaveWebPart2=[ea,!0],ka.CreateContentType=[fa,!0],ka.GetColumns=[fa,!1],ka.GetContentType=[fa,!1],ka.GetContentTypes=[fa,!1],ka.GetCustomizedPageStatus=[fa,!1],ka.GetListTemplates=[fa,!1],ka.GetObjectIdFromUrl=[fa,!1],ka.GetWeb=[fa,!1],ka.GetWebCollection=[fa,!1],ka.GetAllSubWebCollection=[fa,!1],ka.UpdateColumns=[fa,!0],ka.UpdateContentType=[fa,!0],ka.WebUrlFromPageUrl=[fa,!1],ka.AlterToDo=[ga,!0],ka.ClaimReleaseTask=[ga,!0],ka.GetTemplatesForItem=[ga,!1],ka.GetToDosForItem=[ga,!1],ka.GetWorkflowDataForItem=[ga,!1],ka.GetWorkflowTaskData=[ga,!1],ka.StartWorkflow=[ga,!0];var la={};la.header="<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body>",la.footer="</soap:Body></soap:Envelope>",la.payload="";var ma;a.fn.SPServices=function(c){for(var d=a.extend({},a.fn.SPServices.defaults,c),e=0;e<ja.length;e++)"string"==typeof d[ja[e]]&&(d[ja[e]]=b.encodeXml(d[ja[e]]));switch(la.opheader="<"+d.operation+" ",ka[d.operation][0]){case L:la.opheader+="xmlns='"+G+"/soap/2002/1/alerts/' >",ma=G+"/soap/2002/1/alerts/";break;case Q:la.opheader+="xmlns='"+G+"/soap/meetings/' >",ma=G+"/soap/meetings/";break;case R:la.opheader+="xmlns='"+G+"/soap/recordsrepository/' >",ma=G+"/soap/recordsrepository/";break;case T:la.opheader+="xmlns='"+G+"/soap/directory/' >",ma=G+"/soap/directory/";break;case U:la.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/' >",ma="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/";break;case V:la.opheader+="xmlns='urn:Microsoft.Search' >",ma="urn:Microsoft.Search/";break;case W:la.opheader+="xmlns='"+G+"/diagnostics/' >",ma="http://schemas.microsoft.com/sharepoint/diagnostics/";break;case Z:la.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/SocialDataService' >",ma="http://microsoft.com/webservices/SharePointPortalServer/SocialDataService/";break;case $:la.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/publishing/spelling/' >",ma="http://schemas.microsoft.com/sharepoint/publishing/spelling/SpellCheck";break;case _:la.opheader+="xmlns='"+G+"/taxonomy/soap/' >",ma=G+"/taxonomy/soap/";break;case aa:la.opheader+="xmlns='"+G+"/soap/directory/' >",ma=G+"/soap/directory/";break;case ba:la.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/UserProfileService' >",ma="http://microsoft.com/webservices/SharePointPortalServer/UserProfileService/";break;case ea:la.opheader+="xmlns='http://microsoft.com/sharepoint/webpartpages' >",ma="http://microsoft.com/sharepoint/webpartpages/";break;case ga:la.opheader+="xmlns='"+G+"/soap/workflow/' >",ma=G+"/soap/workflow/";break;default:la.opheader+="xmlns='"+G+"/soap/'>",ma=G+"/soap/"}ma+=d.operation,la.opfooter="</"+d.operation+">";var f="_vti_bin/"+ka[d.operation][0]+".asmx",g=void 0!==d.webURL?d.webURL:d.webUrl;if(g.charAt(g.length-1)===F)f=g+f;else if(g.length>0)f=g+F+f;else{var h=a().SPServices.SPGetCurrentSite();f=h+(h.charAt(h.length-1)===F?f:F+f)}switch(la.payload="",d.operation){case"GetAlerts":break;case"DeleteAlerts":for(la.payload+="<IDs>",e=0;e<d.IDs.length;e++)la.payload+=b.wrapNode("string",d.IDs[e]);la.payload+="</IDs>";break;case"Mode":break;case"Login":B(d,["username","password"]);break;case"CopyIntoItems":for(B(d,["SourceUrl"]),la.payload+="<DestinationUrls>",e=0;e<d.DestinationUrls.length;e++)la.payload+=b.wrapNode("string",d.DestinationUrls[e]);la.payload+="</DestinationUrls>",B(d,["Fields","Stream","Results"]);break;case"CopyIntoItemsLocal":for(B(d,["SourceUrl"]),la.payload+="<DestinationUrls>",e=0;e<d.DestinationUrls.length;e++)la.payload+=b.wrapNode("string",d.DestinationUrls[e]);la.payload+="</DestinationUrls>";break;case"GetItem":B(d,["Url","Fields","Stream"]);break;case"GetForm":B(d,["listName","formUrl"]);break;case"GetFormCollection":B(d,["listName"]);break;case"AddAttachment":B(d,["listName","listItemID","fileName","attachment"]);break;case"AddDiscussionBoardItem":B(d,["listName","message"]);break;case"AddList":B(d,["listName","description","templateID"]);break;case"AddListFromFeature":B(d,["listName","description","featureID","templateID"]);break;case"ApplyContentTypeToList":B(d,["webUrl","contentTypeId","listName"]);break;case"CheckInFile":B(d,["pageUrl","comment","CheckinType"]);break;case"CheckOutFile":B(d,["pageUrl","checkoutToLocal","lastmodified"]);break;case"CreateContentType":B(d,["listName","displayName","parentType","fields","contentTypeProperties","addToView"]);break;case"DeleteAttachment":B(d,["listName","listItemID","url"]);break;case"DeleteContentType":B(d,["listName","contentTypeId"]);break;case"DeleteContentTypeXmlDocument":B(d,["listName","contentTypeId","documentUri"]);break;case"DeleteList":B(d,["listName"]);break;case"GetAttachmentCollection":B(d,["listName",["listItemID","ID"]]);break;case"GetList":B(d,["listName"]);break;case"GetListAndView":B(d,["listName","viewName"]);break;case"GetListCollection":break;case"GetListContentType":B(d,["listName","contentTypeId"]);break;case"GetListContentTypes":B(d,["listName"]);break;case"GetListItems":B(d,["listName","viewName",["query","CAMLQuery"],["viewFields","CAMLViewFields"],["rowLimit","CAMLRowLimit"],["queryOptions","CAMLQueryOptions"]]);break;case"GetListItemChanges":B(d,["listName","viewFields","since","contains"]);break;case"GetListItemChangesSinceToken":B(d,["listName","viewName",["query","CAMLQuery"],["viewFields","CAMLViewFields"],["rowLimit","CAMLRowLimit"],["queryOptions","CAMLQueryOptions"],{name:"changeToken",sendNull:!1},{name:"contains",sendNull:!1}]);break;case"GetVersionCollection":B(d,["strlistID","strlistItemID","strFieldName"]);break;case"UndoCheckOut":B(d,["pageUrl"]);break;case"UpdateContentType":B(d,["listName","contentTypeId","contentTypeProperties","newFields","updateFields","deleteFields","addToView"]);break;case"UpdateContentTypesXmlDocument":B(d,["listName","newDocument"]);break;case"UpdateContentTypeXmlDocument":B(d,["listName","contentTypeId","newDocument"]);break;case"UpdateList":B(d,["listName","listProperties","newFields","updateFields","deleteFields","listVersion"]);break;case"UpdateListItems":if(B(d,["listName"]),"undefined"!=typeof d.updates&&d.updates.length>0)B(d,["updates"]);else{for(la.payload+="<updates><Batch OnError='Continue'><Method ID='1' Cmd='"+d.batchCmd+"'>",e=0;e<d.valuepairs.length;e++)la.payload+="<Field Name='"+d.valuepairs[e][0]+"'>"+b.escapeColumnValue(d.valuepairs[e][1])+"</Field>";"New"!==d.batchCmd&&(la.payload+="<Field Name='ID'>"+d.ID+"</Field>"),la.payload+="</Method></Batch></updates>"}break;case"AddMeeting":B(d,["organizerEmail","uid","sequence","utcDateStamp","title","location","utcDateStart","utcDateEnd","nonGregorian"]);break;case"CreateWorkspace":B(d,["title","templateName","lcid","timeZoneInformation"]);break;case"RemoveMeeting":B(d,["recurrenceId","uid","sequence","utcDateStamp","cancelMeeting"]);break;case"SetWorkspaceTitle":B(d,["title"]);break;case"GetRecordRouting":B(d,["recordRouting"]);break;case"GetRecordRoutingCollection":break;case"GetServerInfo":break;case"SubmitFile":B(d,["fileToSubmit"],["properties"],["recordRouting"],["sourceUrl"],["userName"]);break;case"ResolvePrincipals":B(d,["principalKeys","principalType","addToUserInfoList"]);break;case"SearchPrincipals":B(d,["searchText","maxResults","principalType"]);break;case"AddPermission":B(d,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"AddPermissionCollection":B(d,["objectName","objectType","permissionsInfoXml"]);break;case"GetPermissionCollection":B(d,["objectName","objectType"]);break;case"RemovePermission":B(d,["objectName","objectType","permissionIdentifier","permissionType"]);break;case"RemovePermissionCollection":B(d,["objectName","objectType","memberIdsXml"]);break;case"UpdatePermission":B(d,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"GetLinks":break;case"GetPortalSearchInfo":la.opheader="<"+d.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",ma="http://microsoft.com/webservices/OfficeServer/QueryService/"+d.operation;break;case"GetQuerySuggestions":la.opheader="<"+d.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",ma="http://microsoft.com/webservices/OfficeServer/QueryService/"+d.operation,la.payload+=b.wrapNode("queryXml",b.encodeXml(d.queryXml));break;case"GetSearchMetadata":la.opheader="<"+d.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",ma="http://microsoft.com/webservices/OfficeServer/QueryService/"+d.operation;break;case"Query":la.payload+=b.wrapNode("queryXml",b.encodeXml(d.queryXml));break;case"QueryEx":la.opheader="<"+d.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",ma="http://microsoft.com/webservices/OfficeServer/QueryService/"+d.operation,la.payload+=b.wrapNode("queryXml",b.encodeXml(d.queryXml));break;case"Registration":la.payload+=b.wrapNode("registrationXml",b.encodeXml(d.registrationXml));break;case"Status":break;case"SendClientScriptErrorReport":B(d,["message","file","line","client","stack","team","originalFile"]);break;case"EnumerateFolder":B(d,["strFolderUrl"]);break;case"GetAttachments":B(d,["strListName","strItemId"]);break;case"SiteDataGetList":B(d,["strListName"]),la=D(la,d.operation);break;case"SiteDataGetListCollection":la=D(la,d.operation);break;case"SiteDataGetSite":la=D(la,d.operation);break;case"SiteDataGetSiteUrl":B(d,["Url"]),la=D(la,d.operation);break;case"SiteDataGetWeb":la=D(la,d.operation);break;case"CreateWeb":B(d,["url","title","description","templateName","language","languageSpecified","locale","localeSpecified","collationLocale","collationLocaleSpecified","uniquePermissions","uniquePermissionsSpecified","anonymous","anonymousSpecified","presence","presenceSpecified"]);break;case"DeleteWeb":B(d,["url"]);break;case"GetSite":B(d,["SiteUrl"]);break;case"GetSiteTemplates":B(d,["LCID","TemplateList"]);break;case"AddComment":B(d,["url","comment","isHighPriority","title"]);break;case"AddTag":B(d,["url","termID","title","isPrivate"]);break;case"AddTagByKeyword":B(d,["url","keyword","title","isPrivate"]);break;case"CountCommentsOfUser":B(d,["userAccountName"]);break;case"CountCommentsOfUserOnUrl":B(d,["userAccountName","url"]);break;case"CountCommentsOnUrl":B(d,["url"]);break;case"CountRatingsOnUrl":B(d,["url"]);break;case"CountTagsOfUser":B(d,["userAccountName"]);break;case"DeleteComment":B(d,["url","lastModifiedTime"]);break;case"DeleteRating":B(d,["url"]);break;case"DeleteTag":B(d,["url","termID"]);break;case"DeleteTagByKeyword":B(d,["url","keyword"]);break;case"DeleteTags":B(d,["url"]);break;case"GetAllTagTerms":B(d,["maximumItemsToReturn"]);break;case"GetAllTagTermsForUrlFolder":B(d,["urlFolder","maximumItemsToReturn"]);break;case"GetAllTagUrls":B(d,["termID"]);break;case"GetAllTagUrlsByKeyword":B(d,["keyword"]);break;case"GetCommentsOfUser":B(d,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetCommentsOfUserOnUrl":B(d,["userAccountName","url"]);break;case"GetCommentsOnUrl":B(d,["url","maximumItemsToReturn","startIndex"]),"undefined"!=typeof d.excludeItemsTime&&d.excludeItemsTime.length>0&&(la.payload+=b.wrapNode("excludeItemsTime",d.excludeItemsTime));break;case"GetRatingAverageOnUrl":B(d,["url"]);break;case"GetRatingOfUserOnUrl":B(d,["userAccountName","url"]);break;case"GetRatingOnUrl":B(d,["url"]);break;case"GetRatingsOfUser":B(d,["userAccountName"]);break;case"GetRatingsOnUrl":B(d,["url"]);break;case"GetSocialDataForFullReplication":B(d,["userAccountName"]);break;case"GetTags":B(d,["url"]);break;case"GetTagsOfUser":B(d,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetTagTerms":B(d,["maximumItemsToReturn"]);break;case"GetTagTermsOfUser":B(d,["userAccountName","maximumItemsToReturn"]);break;case"GetTagTermsOnUrl":B(d,["url","maximumItemsToReturn"]);break;case"GetTagUrls":B(d,["termID"]);break;case"GetTagUrlsByKeyword":B(d,["keyword"]);break;case"GetTagUrlsOfUser":B(d,["termID","userAccountName"]);break;case"GetTagUrlsOfUserByKeyword":B(d,["keyword","userAccountName"]);break;case"SetRating":B(d,["url","rating","title","analysisDataEntry"]);break;case"UpdateComment":B(d,["url","lastModifiedTime","comment","isHighPriority"]);break;case"SpellCheck":B(d,["chunksToSpell","declaredLanguage","useLad"]);break;case"AddTerms":B(d,["sharedServiceId","termSetId","lcid","newTerms"]);break;case"GetChildTermsInTerm":B(d,["sspId","lcid","termId","termSetId"]);

break;case"GetChildTermsInTermSet":B(d,["sspId","lcid","termSetId"]);break;case"GetKeywordTermsByGuids":B(d,["termIds","lcid"]);break;case"GetTermsByLabel":B(d,["label","lcid","matchOption","resultCollectionSize","termIds","addIfNotFound"]);break;case"GetTermSets":B(d,["sharedServiceIds","termSetIds","lcid","clientTimeStamps","clientVersions"]);break;case"AddGroup":B(d,["groupName","ownerIdentifier","ownerType","defaultUserLoginName","description"]);break;case"AddGroupToRole":B(d,["groupName","roleName"]);break;case"AddRole":B(d,["roleName","description","permissionMask"]);break;case"AddRoleDef":B(d,["roleName","description","permissionMask"]);break;case"AddUserCollectionToGroup":B(d,["groupName","usersInfoXml"]);break;case"AddUserCollectionToRole":B(d,["roleName","usersInfoXml"]);break;case"AddUserToGroup":B(d,["groupName","userName","userLoginName","userEmail","userNotes"]);break;case"AddUserToRole":B(d,["roleName","userName","userLoginName","userEmail","userNotes"]);break;case"GetAllUserCollectionFromWeb":break;case"GetGroupCollection":B(d,["groupNamesXml"]);break;case"GetGroupCollectionFromRole":B(d,["roleName"]);break;case"GetGroupCollectionFromSite":break;case"GetGroupCollectionFromUser":B(d,["userLoginName"]);break;case"GetGroupCollectionFromWeb":break;case"GetGroupInfo":B(d,["groupName"]);break;case"GetRoleCollection":B(d,["roleNamesXml"]);break;case"GetRoleCollectionFromGroup":B(d,["groupName"]);break;case"GetRoleCollectionFromUser":B(d,["userLoginName"]);break;case"GetRoleCollectionFromWeb":break;case"GetRoleInfo":B(d,["roleName"]);break;case"GetRolesAndPermissionsForCurrentUser":break;case"GetRolesAndPermissionsForSite":break;case"GetUserCollection":B(d,["userLoginNamesXml"]);break;case"GetUserCollectionFromGroup":B(d,["groupName"]);break;case"GetUserCollectionFromRole":B(d,["roleName"]);break;case"GetUserCollectionFromSite":break;case"GetUserCollectionFromWeb":break;case"GetUserInfo":B(d,["userLoginName"]);break;case"GetUserLoginFromEmail":B(d,["emailXml"]);break;case"RemoveGroup":B(d,["groupName"]);break;case"RemoveGroupFromRole":B(d,["roleName","groupName"]);break;case"RemoveRole":B(d,["roleName"]);break;case"RemoveUserCollectionFromGroup":B(d,["groupName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromRole":B(d,["roleName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromSite":B(d,["userLoginNamesXml"]);break;case"RemoveUserFromGroup":B(d,["groupName","userLoginName"]);break;case"RemoveUserFromRole":B(d,["roleName","userLoginName"]);break;case"RemoveUserFromSite":B(d,["userLoginName"]);break;case"RemoveUserFromWeb":B(d,["userLoginName"]);break;case"UpdateGroupInfo":B(d,["oldGroupName","groupName","ownerIdentifier","ownerType","description"]);break;case"UpdateRoleDefInfo":B(d,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateRoleInfo":B(d,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateUserInfo":B(d,["userLoginName","userName","userEmail","userNotes"]);break;case"AddColleague":B(d,["accountName","colleagueAccountName","group","privacy","isInWorkGroup"]);break;case"AddLink":B(d,["accountName","name","url","group","privacy"]);break;case"AddMembership":B(d,["accountName","membershipInfo","group","privacy"]);break;case"AddPinnedLink":B(d,["accountName","name","url"]);break;case"CreateMemberGroup":B(d,["membershipInfo"]);break;case"CreateUserProfileByAccountName":B(d,["accountName"]);break;case"GetCommonColleagues":B(d,["accountName"]);break;case"GetCommonManager":B(d,["accountName"]);break;case"GetCommonMemberships":B(d,["accountName"]);break;case"GetInCommon":B(d,["accountName"]);break;case"GetPropertyChoiceList":B(d,["propertyName"]);break;case"GetUserColleagues":B(d,["accountName"]);break;case"GetUserLinks":B(d,["accountName"]);break;case"GetUserMemberships":B(d,["accountName"]);break;case"GetUserPinnedLinks":B(d,["accountName"]);break;case"GetUserProfileByGuid":B(d,["guid"]);break;case"GetUserProfileByIndex":B(d,["index"]);break;case"GetUserProfileByName":"undefined"!=typeof d.accountName&&d.accountName.length>0?B(d,[["AccountName","accountName"]]):B(d,["AccountName"]);break;case"GetUserProfileCount":break;case"GetUserProfileSchema":break;case"GetUserPropertyByAccountName":B(d,["accountName","propertyName"]);break;case"ModifyUserPropertyByAccountName":B(d,["accountName","newData"]);break;case"RemoveAllColleagues":B(d,["accountName"]);break;case"RemoveAllLinks":B(d,["accountName"]);break;case"RemoveAllMemberships":B(d,["accountName"]);break;case"RemoveAllPinnedLinks":B(d,["accountName"]);break;case"RemoveColleague":B(d,["accountName","colleagueAccountName"]);break;case"RemoveLink":B(d,["accountName","id"]);break;case"RemoveMembership":B(d,["accountName","sourceInternal","sourceReference"]);break;case"RemovePinnedLink":B(d,["accountName","id"]);break;case"UpdateColleaguePrivacy":B(d,["accountName","colleagueAccountName","newPrivacy"]);break;case"UpdateLink":B(d,["accountName","data"]);break;case"UpdateMembershipPrivacy":B(d,["accountName","sourceInternal","sourceReference","newPrivacy"]);break;case"UpdatePinnedLink ":B(d,["accountName","data"]);break;case"DeleteAllVersions":B(d,["fileName"]);break;case"DeleteVersion":B(d,["fileName","fileVersion"]);break;case"GetVersions":B(d,["fileName"]);break;case"RestoreVersion":B(d,["fileName","fileVersion"]);break;case"AddView":B(d,["listName","viewName","viewFields","query","rowLimit","rowLimit","type","makeViewDefault"]);break;case"DeleteView":B(d,["listName","viewName"]);break;case"GetView":B(d,["listName","viewName"]);break;case"GetViewCollection":B(d,["listName"]);break;case"GetViewHtml":B(d,["listName","viewName"]);break;case"UpdateView":B(d,["listName","viewName","viewProperties","query","viewFields","aggregations","formats","rowLimit"]);break;case"UpdateViewHtml":B(d,["listName","viewName","viewProperties","toolbar","viewHeader","viewBody","viewFooter","viewEmpty","rowLimitExceeded","query","viewFields","aggregations","formats","rowLimit"]);break;case"AddWebPart":B(d,["pageUrl","webPartXml","storage"]);break;case"AddWebPartToZone":B(d,["pageUrl","webPartXml","storage","zoneId","zoneIndex"]);break;case"DeleteWebPart":B(d,["pageUrl","storageKey","storage"]);break;case"GetWebPart2":B(d,["pageUrl","storageKey","storage","behavior"]);break;case"GetWebPartPage":B(d,["documentName","behavior"]);break;case"GetWebPartProperties":B(d,["pageUrl","storage"]);break;case"GetWebPartProperties2":B(d,["pageUrl","storage","behavior"]);break;case"SaveWebPart2":B(d,["pageUrl","storageKey","webPartXml","storage","allowTypeChange"]);break;case"Webs.CreateContentType":B(d,["displayName","parentType","newFields","contentTypeProperties"]);break;case"GetColumns":B(d,["webUrl"]);break;case"GetContentType":B(d,["contentTypeId"]);break;case"GetContentTypes":break;case"GetCustomizedPageStatus":B(d,["fileUrl"]);break;case"GetListTemplates":break;case"GetObjectIdFromUrl":B(d,["objectUrl"]);break;case"GetWeb":B(d,[["webUrl","webURL"]]);break;case"GetWebCollection":break;case"GetAllSubWebCollection":break;case"UpdateColumns":B(d,["newFields","updateFields","deleteFields"]);break;case"Webs.UpdateContentType":B(d,["contentTypeId","contentTypeProperties","newFields","updateFields","deleteFields"]);break;case"WebUrlFromPageUrl":B(d,[["pageUrl","pageURL"]]);break;case"AlterToDo":B(d,["item","todoId","todoListId","taskData"]);break;case"ClaimReleaseTask":B(d,["item","taskId","listId","fClaim"]);break;case"GetTemplatesForItem":B(d,["item"]);break;case"GetToDosForItem":B(d,["item"]);break;case"GetWorkflowDataForItem":B(d,["item"]);break;case"GetWorkflowTaskData":B(d,["item","listId","taskId"]);break;case"StartWorkflow":B(d,["item","templateId","workflowParameters"])}var i,j=la.header+la.opheader+la.payload+la.opfooter+la.footer;if(d.cacheXML&&(i=K[j]),"undefined"==typeof i){var k=a.ajax({url:f,async:d.async,beforeSend:function(a){ka[d.operation][1]&&a.setRequestHeader("SOAPAction",ma)},type:"POST",data:j,dataType:"xml",contentType:"text/xml;charset='utf-8'",complete:function(b,c){a.isFunction(d.completefunc)&&d.completefunc(b,c)}});return d.cacheXML&&(K[j]=k),k}return a.isFunction(d.completefunc)&&i.done(function(a,b,c){d.completefunc(c,b)}),i},a.fn.SPServices.defaults={cacheXML:!1,operation:"",webURL:"",makeViewDefault:!1,viewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:0,CAMLQueryOptions:"<QueryOptions></QueryOptions>",batchCmd:"Update",valuepairs:[],DestinationUrls:[],behavior:"Version3",storage:"Shared",objectType:"List",cancelMeeting:!0,nonGregorian:!1,fClaim:!1,recurrenceId:0,sequence:0,maximumItemsToReturn:0,startIndex:0,isHighPriority:!1,isPrivate:!1,rating:1,maxResults:10,principalType:"User",async:!0,completefunc:null},a.fn.SPServices.SPGetCurrentSite=function(){if(ha.thisSite.length>0)return ha.thisSite;var b=la.header+"<WebUrlFromPageUrl xmlns='"+G+"/soap/' ><pageUrl>"+(location.href.indexOf("?")>0?location.href.substr(0,location.href.indexOf("?")):location.href)+"</pageUrl></WebUrlFromPageUrl>"+la.footer;return a.ajax({async:!1,url:"/_vti_bin/Webs.asmx",type:"POST",data:b,dataType:"xml",contentType:'text/xml;charset="utf-8"',complete:function(b){ha.thisSite=a(b.responseXML).find("WebUrlFromPageUrlResult").text()}}),ha.thisSite},a.fn.SPServices.SPComplexToSimpleDropdown=function(d){var e=a.extend({},{listName:a().SPServices.SPListNameFromUrl(),columnName:"",completefunc:null,debug:!1},d),f=a().SPServices.SPDropdownCtl({displayName:e.columnName});if(null===f.Obj.html()&&e.debug)return void b.errBox("SPServices.SPComplexToSimpleDropdown","columnName: "+e.columnName,c.TXTColumnNotFound);if(f.Type===c.dropdownType.complex){var g=a(f.Obj).attr("choices").split("|"),h=f.optHid.val(),i=z("SPComplexToSimpleDropdown",f.Obj.attr("title"),e.listName),j="<select id='"+i+"' title='"+e.columnName+"'>";for(ia=0;ia<g.length;ia+=2){var k=g[ia+1]===h?" selected='selected' ":" ";j+="<option"+k+"value='"+g[ia+1]+"'>"+g[ia]+"</option>"}j+="</select>",f.Obj.closest("td").prepend(j);var l=a("#"+i);f.Obj.closest("span").find("img").remove(),f.Obj.closest("span").find("input").hide(),l.change(function(){var b=a(this).val();f.optHid.val(b),a(f.Obj).val(a(this).find("option[value='"+("0"!==b?b:"")+"']").html())}),l.trigger("change"),null!==e.completefunc&&e.completefunc()}},a.fn.SPServices.SPDisplayRelatedInfo=function(d){var f,g,h=a.extend({},{listName:a().SPServices.SPListNameFromUrl(),columnName:"",relatedWebURL:"",relatedList:"",relatedListColumn:"",relatedColumns:[],displayFormat:"table",headerCSSClass:"ms-vh2",rowCSSClass:"ms-vb",CAMLQuery:"",numChars:0,matchType:"Eq",matchOnId:!1,completefunc:null,debug:!1},d),i=[],j="SPServices.SPDisplayRelatedInfo",k=a().SPServices.SPDropdownCtl({displayName:h.columnName});if(null===k.Obj.html()&&h.debug)return void b.errBox(j,"columnName: "+h.columnName,c.TXTColumnNotFound);switch(f=z("SPDisplayRelatedInfo",h.columnName,h.listName),a().SPServices({operation:"GetList",async:!1,cacheXML:!0,webURL:h.relatedWebURL,listName:h.relatedList,completefunc:function(c){for(a(c.responseXML).find("faultcode").each(function(){h.debug&&b.errBox(j,"relatedList: "+h.relatedList,"List not found")}),g=a(c.responseXML).find("List"),ia=0;ia<h.relatedColumns.length;ia++)i[h.relatedColumns[ia]]=a(c.responseXML).find("Fields > Field[Name='"+h.relatedColumns[ia]+"']");i[h.relatedListColumn]=a(c.responseXML).find("Fields > Field[Name='"+h.relatedListColumn+"']")}}),k.Type){case c.dropdownType.simple:k.Obj.bind("change",function(){e(h,f,g,i)});break;case c.dropdownType.complex:k.optHid.bind("propertychange",function(){e(h,f,g,i)});break;case c.dropdownType.multiSelect:h.debug&&b.errBox(j,"columnName: "+h.columnName,"Multi-select columns not supported by this function")}e(h,f,g,i)},a.fn.SPServices.SPFilterDropdown=function(e){var f,g,h=a.extend({},{relationshipWebURL:"",relationshipList:"",relationshipListColumn:"",relationshipListSortColumn:"",relationshipListSortAscending:!0,columnName:"",listName:a().SPServices.SPListNameFromUrl(),promptText:"",noneText:"(None)",CAMLQuery:"",CAMLQueryOptions:"<QueryOptions><IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns><ViewAttributes Scope='RecursiveAll'/></QueryOptions>",completefunc:null,debug:!1},e),i="",j=null,k="SPServices.SPFilterDropdown",l=a().SPServices.SPDropdownCtl({displayName:h.columnName});if(null===l.Obj.html()&&h.debug)return void b.errBox(k,"columnName: "+h.columnName,c.TXTColumnNotFound);j=d(l,!0);var m=h.relationshipListSortColumn.length>0?h.relationshipListSortColumn:h.relationshipListColumn,n=h.relationshipListSortAscending===!0?"":"Ascending='FALSE'",o="<Query><OrderBy><FieldRef Name='"+m+"' "+n+"/></OrderBy><Where>";h.CAMLQuery.length>0&&(o+=h.CAMLQuery),o+="</Where></Query>",a().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:h.listName,completefunc:function(b){a(b.responseXML).find("Fields").each(function(){a(this).find("Field[DisplayName='"+h.columnName+"']").each(function(){return g="TRUE"===a(this).attr("Required"),!1})})}}),a().SPServices({operation:"GetListItems",async:!1,webURL:h.relationshipWebURL,listName:h.relationshipList,CAMLQuery:o,CAMLViewFields:"<ViewFields><FieldRef Name='"+h.relationshipListColumn+"' /></ViewFields>",CAMLRowLimit:0,CAMLQueryOptions:h.CAMLQueryOptions,completefunc:function(d){switch(a(d.responseXML).find("errorstring").each(function(){var c=a(this).text();h.debug&&"One or more field types are not installed properly. Go to the list settings page to delete these fields."===c?b.errBox(k,"relationshipListColumn: "+h.relationshipListColumn,"Not found in relationshipList "+h.relationshipList):h.debug&&"Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)."===c&&b.errBox(k,"relationshipList: "+h.relationshipList,"List not found")}),l.Type){case c.dropdownType.simple:a(l.Obj).find("option").remove(),!g&&h.promptText.length>0?l.Obj.append("<option value='0'>"+h.promptText.replace(/\{0\}/g,h.columnName)+"</option>"):g||l.Obj.append("<option value='0'>"+h.noneText+"</option>");break;case c.dropdownType.complex:i=g?"":h.noneText+"|0",l.Obj.val("");break;case c.dropdownType.multiSelect:a(l.master.candidateControl).find("option").remove(),f=""}switch(a(d.responseXML).SPFilterNode("z:row").each(function(){var d={},e=a(this).attr("ows_"+h.relationshipListColumn);switch("undefined"!=typeof e&&e.indexOf(c.spDelim)>0?d=new b.SplitIndex(e):(d.id=a(this).attr("ows_ID"),d.value=e),isNaN(d.id)&&(d.id=a(this).attr("ows_ID")),l.Type){case c.dropdownType.simple:var g=a(this).attr("ows_ID")===j[0]?" selected='selected'":"";l.Obj.append("<option"+g+" value='"+d.id+"'>"+d.value+"</option>");break;case c.dropdownType.complex:d.id===j[0]&&l.Obj.val(d.value),i=i+(i.length>0?"|":"")+d.value+"|"+d.id;break;case c.dropdownType.multiSelect:a(l.master.candidateControl).append("<option value='"+d.id+"'>"+d.value+"</option>"),f+=d.id+"|t"+d.value+"|t |t |t"}}),l.Type){case c.dropdownType.simple:l.Obj.trigger("change");break;case c.dropdownType.complex:l.Obj.attr("choices",i),l.Obj.trigger("propertychange");break;case c.dropdownType.multiSelect:l.master.data="",l.MultiLookupPickerdata.val(f),a(l.master.resultControl).find("option").each(function(){var b=a(this);a(this).attr("selected","selected"),a(l.master.candidateControl).find("option").each(function(){a(this).html()===b.html()&&b.removeAttr("selected")})}),GipRemoveSelectedItems(l.master),a(l.master.candidateControl).find("option").each(function(){var b=a(this);a(l.master.resultControl).find("option").each(function(){a(this).html()===b.html()&&b.remove()})}),GipAddSelectedItems(l.master),l.master.data=GipGetGroupData(f),a(l.master.candidateControl).trigger("dblclick")}}}),null!==h.completefunc&&h.completefunc()},a.fn.SPServices.SPDebugXMLHttpResult=function(c){var d,e=a.extend({},{node:null,indent:0},c),f=3,g=4,h="";if(h+="<table class='ms-vb' style='margin-left:"+3*e.indent+"px;' width='100%'>","DisplayPattern"===e.node.nodeName)h+="<tr><td width='100px' style='font-weight:bold;'>"+e.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+e.node.xml+"</textarea></td></tr>";else if(e.node.hasChildNodes())if(e.node.hasChildNodes()&&e.node.firstChild.nodeType===g)h+="<tr><td width='100px' style='font-weight:bold;'>"+e.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+e.node.parentNode.text+"</textarea></td></tr>";else if(e.node.hasChildNodes()&&e.node.firstChild.nodeType===f)h+="<tr><td width='100px' style='font-weight:bold;'>"+e.node.nodeName+"</td><td>"+b.checkLink(e.node.firstChild.nodeValue)+"</td></tr>";else{for(h+="<tr><td width='100px' style='font-weight:bold;' colspan='99'>"+e.node.nodeName+"</td></tr>",e.node.attributes&&(h+="<tr><td colspan='99'>"+y(e.node)+"</td></tr>"),h+="<tr><td>",d=0;d<e.node.childNodes.length;d++)h+=a().SPServices.SPDebugXMLHttpResult({node:e.node.childNodes.item(d),indent:e.indent+1});h+="</td></tr>"}else h+="<tr><td width='100px' style='font-weight:bold;'>"+e.node.nodeName+"</td><td>"+(null!==e.node.nodeValue?b.checkLink(e.node.nodeValue):"&nbsp;")+"</td></tr>",e.node.attributes&&(h+="<tr><td colspan='99'>"+y(e.node)+"</td></tr>");return h+="</table>"},a.fn.SPServices.SPGetCurrentUser=function(b){var c=a.extend({},{webURL:"",fieldName:"Name",fieldNames:{},debug:!1},b);if("ID"===c.fieldName&&"undefined"!=typeof ha.thisUserId)return ha.thisUserId;var d,e="",f={},g=c.fieldNames.length>0?c.fieldNames.length:1,h=c.webURL.length>0?c.webURL:a().SPServices.SPGetCurrentSite();for(a.ajax({async:!1,url:("/"===h?"":h)+"/_layouts/userdisp.aspx?Force=True&"+(new Date).getTime(),complete:function(a){d=a}}),ia=0;g>ia;ia++){if("ID"===c.fieldNames[ia])e=ha.thisUserId;else{var i;i=g>1?RegExp('FieldInternalName="'+c.fieldNames[ia]+'"',"gi"):RegExp('FieldInternalName="'+c.fieldName+'"',"gi"),a(d.responseText).find("table.ms-formtable td[id^='SPField']").each(function(){if(i.test(a(this).html())){switch(a(this).attr("id")){case"SPFieldText":e=a(this).text();break;case"SPFieldNote":e=a(this).find("div").html();break;case"SPFieldURL":e=a(this).find("img").attr("src");break;default:e=a(this).text()}return!1}})}"ID"!==c.fieldNames[ia]&&(e="undefined"!=typeof e?e.replace(/(^[\s\xA0]+|[\s\xA0]+$)/g,""):null),g>1&&(f[c.fieldNames[ia]]=e)}return g>1?f:e},a.fn.SPServices.SPLookupAddNew=function(d){var e=a.extend({},{lookupColumn:"",promptText:"Add new {0}",newWindow:!1,ContentTypeID:"",completefunc:null,debug:!1},d),f="SPServices.SPLookupAddNew",g=a().SPServices.SPDropdownCtl({displayName:e.lookupColumn});if(null===g.Obj.html()&&e.debug)return void b.errBox(f,"lookupColumn: "+e.lookupColumn,c.TXTColumnNotFound);var h="",i="",j="";if(a().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:a().SPServices.SPListNameFromUrl(),completefunc:function(b){a(b.responseXML).find("Field[DisplayName='"+e.lookupColumn+"']").each(function(){return j=a(this).attr("StaticName"),a().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:a(this).attr("List"),completefunc:function(b){a(b.responseXML).find("List").each(function(){i=a(this).attr("WebFullUrl"),i=i!==F?i+F:i})}}),h=A(a(this).attr("List"),"NewForm"),!1})}}),0===i.length&&e.debug)return void b.errBox(f,"lookupColumn: "+e.lookupColumn,"This column does not appear to be a lookup column");if(h.length>0){var k=i+h;k+=e.newWindow?(e.ContentTypeID.length>0?"?ContentTypeID="+e.ContentTypeID:"")+"' target='_blank'":"?"+(e.ContentTypeID.length>0?"ContentTypeID="+e.ContentTypeID+"&":"")+"Source="+b.escapeUrl(location.href)+"'";var l="<div id='SPLookupAddNew_"+j+"'><a href='"+k+">"+e.promptText.replace(/\{0\}/g,e.lookupColumn)+"</a></div>";a(g.Obj).parents("td.ms-formbody").append(l)}else if(e.debug)return void b.errBox(f,"lookupColumn: "+e.lookupColumn,"NewForm cannot be found");null!==e.completefunc&&e.completefunc()},a.fn.SPServices.SPGetLastItemId=function(b){var c,d=a.extend({},{webURL:"",listName:"",userAccount:"",CAMLQuery:""},b),e=0;a().SPServices({operation:"GetUserInfo",webURL:d.webURL,async:!1,userLoginName:""!==d.userAccount?d.userAccount:a().SPServices.SPGetCurrentUser(),completefunc:function(b){a(b.responseXML).find("User").each(function(){c=a(this).attr("ID")})}});var f="<Query><Where>";return d.CAMLQuery.length>0&&(f+="<And>"),f+="<Eq><FieldRef Name='Author' LookupId='TRUE'/><Value Type='Integer'>"+c+"</Value></Eq>",d.CAMLQuery.length>0&&(f+=d.CAMLQuery+"</And>"),f+="</Where><OrderBy><FieldRef Name='Created_x0020_Date' Ascending='FALSE'/></OrderBy></Query>",a().SPServices({operation:"GetListItems",async:!1,webURL:d.webURL,listName:d.listName,CAMLQuery:f,CAMLViewFields:"<ViewFields><FieldRef Name='ID'/></ViewFields>",CAMLRowLimit:1,CAMLQueryOptions:"<QueryOptions><ViewAttributes Scope='Recursive' /></QueryOptions>",completefunc:function(b){a(b.responseXML).SPFilterNode("z:row").each(function(){e=a(this).attr("ows_ID")})}}),e},a.fn.SPServices.SPRequireUnique=function(b){var c=a.extend({},{columnStaticName:"Title",duplicateAction:0,ignoreCase:!1,initMsg:"This value must be unique.",initMsgCSSClass:"ms-vb",errMsg:"This value is not unique.",errMsgCSSClass:"ms-formvalidation",showDupes:!1,completefunc:null},b),d=a().SPServices.SPGetQueryString(),e=d.ID;ha.thisList=a().SPServices.SPListNameFromUrl();var f="<span id='SPRequireUnique"+c.columnStaticName+"' class='{0}'>{1}</span><br/>",g=f.replace(/\{0\}/g,c.initMsgCSSClass).replace(/\{1\}/g,c.initMsg),h=a().SPServices.SPGetDisplayFromStatic({listName:ha.thisList,columnStaticName:c.columnStaticName}),i=C(h).find("input[Title^='"+h+"']");i.parent().append(g),i.blur(function(){var b=[],d=a(this).val();if(0===d.length)return!1;a().SPServices({operation:"GetListItems",async:!1,listName:ha.thisList,CAMLQuery:"<Query><Where><IsNotNull><FieldRef Name='"+c.columnStaticName+"'/></IsNotNull></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='ID' /><FieldRef Name='"+c.columnStaticName+"' /></ViewFields>",CAMLRowLimit:0,completefunc:function(f){var g=c.ignoreCase?d.toUpperCase():d;a(f.responseXML).SPFilterNode("z:row").each(function(){var d=c.ignoreCase?a(this).attr("ows_"+c.columnStaticName).toUpperCase():a(this).attr("ows_"+c.columnStaticName);g===d&&a(this).attr("ows_ID")!==e&&b.push([a(this).attr("ows_ID"),a(this).attr("ows_"+c.columnStaticName)])})}});var f=c.initMsg,g=a("#SPRequireUnique"+c.columnStaticName);if(g.html(f).attr("class",c.initMsgCSSClass),a("input[value='OK']:disabled, input[value='Save']:disabled").removeAttr("disabled"),b.length>0&&(f=c.errMsg,g.html(f).attr("class",c.errMsgCSSClass),1===c.duplicateAction&&(i.focus(),a("input[value='OK'], input[value='Save']").attr("disabled","disabled")),c.showDupes)){var h=" "+b.length+" duplicate item"+(b.length>1?"s":"")+": ";for(ia=0;ia<b.length;ia++)h+="<a href='DispForm.aspx?ID="+b[ia][0]+"&Source="+location.href+"'>"+b[ia][1]+"</a> ";a("span#SPRequireUnique"+c.columnStaticName).append(h)}}),null!==c.completefunc&&c.completefunc()},a.fn.SPServices.SPGetDisplayFromStatic=function(b){var c=a.extend({},{webURL:"",listName:"",columnStaticName:"",columnStaticNames:{}},b),d="",e={},f=c.columnStaticNames.length>0?c.columnStaticNames.length:1;return a().SPServices({operation:"GetList",async:!1,cacheXML:!0,webURL:c.webURL,listName:c.listName,completefunc:function(b){if(f>1)for(ia=0;f>ia;ia++)e[c.columnStaticNames[ia]]=a(b.responseXML).find("Field[StaticName='"+c.columnStaticNames[ia]+"']").attr("DisplayName");else d=a(b.responseXML).find("Field[StaticName='"+c.columnStaticName+"']").attr("DisplayName")}}),f>1?e:d},a.fn.SPServices.SPGetStaticFromDisplay=function(b){var c=a.extend({},{webURL:"",listName:"",columnDisplayName:"",columnDisplayNames:{}},b),d="",e={},f=c.columnDisplayNames.length>0?c.columnDisplayNames.length:1;return a().SPServices({operation:"GetList",async:!1,cacheXML:!0,webURL:c.webURL,listName:c.listName,completefunc:function(b){if(f>1)for(ia=0;f>ia;ia++)e[c.columnDisplayNames[ia]]=a(b.responseXML).find("Field[DisplayName='"+c.columnDisplayNames[ia]+"']").attr("StaticName");else d=a(b.responseXML).find("Field[DisplayName='"+c.columnDisplayName+"']").attr("StaticName")}}),f>1?e:d},a.fn.SPServices.SPRedirectWithID=function(b){var c=a.extend({},{redirectUrl:"",qsParamName:"ID"},b);ha.thisList=a().SPServices.SPListNameFromUrl();var d=a().SPServices.SPGetQueryString(),e=d.ID,f=d.List,g=d.RootFolder,h=d.ContentTypeId;if("undefined"==typeof d.ID)e=a().SPServices.SPGetLastItemId({listName:ha.thisList}),a("form[id='aspnetForm']").each(function(){var a=location.href.indexOf("?")>0?location.href.substring(0,location.href.indexOf("?")):location.href,b="string"==typeof d.Source?"Source="+d.Source.replace(/\//g,"%2f").replace(/:/g,"%3a"):"",c=[];"undefined"!=typeof f&&c.push("List="+f),"undefined"!=typeof g&&c.push("RootFolder="+g),"undefined"!=typeof h&&c.push("ContentTypeId="+h);var i=a+(c.length>0?"?"+c.join("&")+"&":"?")+"Source="+a+"?ID="+e+(b.length>0?"%26RealSource="+d.Source:"")+("string"==typeof d.RedirectURL?"%26RedirectURL="+d.RedirectURL:"");setTimeout(function(){document.forms.aspnetForm.action=i},0)});else{for(;d.ID===e;)e=a().SPServices.SPGetLastItemId({listName:ha.thisList});var i="string"==typeof d.RedirectURL?d.RedirectURL:c.redirectUrl;location.href=i+"?"+c.qsParamName+"="+e+("string"==typeof d.RealSource?"&Source="+d.RealSource:"")}},a.fn.SPServices.SPSetMultiSelectSizes=function(d){var e=a.extend({},{listName:a().SPServices.SPListNameFromUrl(),multiSelectColumn:"",minWidth:0,maxWidth:0,debug:!1},d),f="SPServices.SPSetMultiSelectSizes",g=a().SPServices.SPDropdownCtl({displayName:e.multiSelectColumn});if(null===g.Obj.html()&&e.debug)return void b.errBox(f,"multiSelectColumn: "+e.multiSelectColumn,c.TXTColumnNotFound);if(g.Type!==c.dropdownType.multiSelect&&e.debug)return void b.errBox(f,"multiSelectColumn: "+e.multiSelectColumn,"Column is not multi-select.");var h=z("SPSetMultiSelectSizes",e.multiSelectColumn,e.listName),i=a("<select id='"+h+"' ></select>").appendTo(g.container);i.css({width:"auto",height:0,visibility:"hidden"}),a(g.master.candidateControl).find("option").each(function(){i.append("<option value='"+a(this).html()+"'>"+a(this).html()+"</option>")}),a(g.master.resultControl).find("option").each(function(){i.append("<option value='"+a(this).val()+"'>"+a(this).html()+"</option>")});var j=i.width()+5,k=j;(e.minWidth>0||e.maxWidth>0)&&(j<e.minWidth&&(j=e.minWidth),k<e.minWidth&&(k=e.minWidth),k>e.maxWidth&&(k=e.maxWidth));var l=j;a(g.master.candidateControl).css("width",l+"px").parent().css("width",k+"px"),a(g.master.resultControl).css("width",l+"px").parent().css("width",k+"px"),i.remove()},a.fn.SPServices.SPScriptAudit=function(b){var d,e=a.extend({},{webURL:"",listName:"",outputId:"",auditForms:!0,auditViews:!0,auditPages:!0,auditPagesListName:"Pages",showHiddenLists:!1,showNoScript:!1,showSrc:!0},b),g=[["New","NewForm.aspx",!1],["Display","DispForm.aspx",!1],["Edit","EditForm.aspx",!1]];a("#"+e.outputId).append("<table id='SPScriptAudit' width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1><tr><th></th><th>List</th><th>Page Class</th><th>Page Type</th><th>Page</th>"+(e.showSrc?"<th>Script References</th>":"")+"</tr></table>");var h=a("#SPScriptAudit");h.find("th").attr("class","ms-vh2-nofilter"),(e.auditForms||e.auditViews)&&a().SPServices({operation:"GetListCollection",webURL:e.webURL,async:!1,completefunc:function(b){a(b.responseXML).find("List").each(function(){d=a(this),(0===e.listName.length||d.attr("Title")===e.listName)&&(e.showHiddenLists&&"False"===d.attr("Hidden")||!e.showHiddenLists)&&(e.auditForms&&a().SPServices({operation:"GetListContentTypes",webURL:e.webURL,listName:d.attr("ID"),async:!1,completefunc:function(b){a(b.responseXML).find("ContentType").each(function(){if("0x0120"!==a(this).attr("ID").substring(0,6)){var b=a(this).find("FormUrls");for(ia=0;ia<g.length;ia++)if(a(b).find(g[ia][0]).each(function(){f(e,d,"Form",this.nodeName,(e.webURL.length>0?e.webURL:a().SPServices.SPGetCurrentSite())+F+a(this).text()),g[ia][2]=!0}),!g[ia][2]){var c=d.attr("DefaultViewUrl");f(e,d,"Form",g[ia][0],c.substring(0,c.lastIndexOf(F)+1)+g[ia][1])}for(ia=0;ia<g.length;ia++)g[ia][2]=!1}})}}),e.auditViews&&a().SPServices({operation:"GetViewCollection",webURL:e.webURL,listName:d.attr("ID"),async:!1,completefunc:function(b){a(b.responseXML).find("View").each(function(){f(e,d,"View",a(this).attr("DisplayName"),a(this).attr("Url"))})}}))})}});var i=0,j=[];if("string"==typeof e.auditPagesListName?(i=1,j.push(e.auditPagesListName)):(i=e.auditPagesListName.length,j=e.auditPagesListName),e.auditPages)for(ia=0;i>ia;ia++)a().SPServices({operation:"GetList",async:!1,cacheXML:!0,webURL:e.webURL,listName:j[ia],completefunc:function(b){a(b.responseXML).find("List").each(function(){d=a(this)})}}),a().SPServices({operation:"GetListItems",async:!1,webURL:e.webURL,listName:j[ia],CAMLQuery:"<Query><Where><Neq><FieldRef Name='ContentType'/><Value Type='Text'>Folder</Value></Neq></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='Title'/><FieldRef Name='FileRef'/></ViewFields>",CAMLRowLimit:0,completefunc:function(b){a(b.responseXML).SPFilterNode("z:row").each(function(){var b=a(this).attr("ows_FileRef").split(c.spDelim)[1],g=a(this).attr("ows_Title"),h="undefined"!=typeof g?g:"";b.indexOf(".aspx")>0&&f(e,d,"Page",h,F+b)})}});h.find("tr[class='ms-alternating']:even").removeAttr("class")},a.fn.SPServices.SPArrangeChoices=function(c){var d=a.extend({},{listName:a().SPServices.SPListNameFromUrl(),columnName:"",perRow:99,randomize:!1},c),e=!1,f=[],g=a().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:d.listName});g.done(function(){a(g.responseXML).find("Field[DisplayName='"+d.columnName+"']").each(function(){return e="TRUE"===a(this).attr("FillInChoice"),!1});var c,h,i=C(d.columnName),j=a(i).find("tr").length;a(i).find("tr").each(function(b){e&&b===j-2?c=a(this).find("td"):e&&b===j-1?h=a(this).find("td"):f.push(a(this).find("td"))}),d.randomize&&f.sort(b.randOrd);var k=a("<table cellpadding='0' cellspacing='1'></table>");for(ia=0;ia<f.length;ia++)(ia+1)%d.perRow===0&&k.append("<tr></tr>"),k.find("tr:last").append(f[ia]);if(e){var l=a("<tr><td colspan='99'><table cellpadding='0' cellspacing='1'><tr></tr></table></td></tr>");l.find("tr").append(c),l.find("tr").append(h),k.append(l)}var m=a(i).find("table:first");m.before(k),m.hide()})},a.fn.SPServices.SPAutocomplete=function(c){var d,e=a.extend({},{webURL:"",sourceList:"",sourceColumn:"",columnName:"",listName:a().SPServices.SPListNameFromUrl(),CAMLQuery:"",CAMLQueryOptions:"<QueryOptions></QueryOptions>",CAMLRowLimit:0,filterType:"BeginsWith",numChars:0,ignoreCase:!1,highlightClass:"",uniqueVals:!1,maxHeight:99999,slideDownSpeed:"fast",processingIndicator:"_layouts/images/REFRESH.GIF",debug:!1},c),f=C(e.columnName).find("input[Title^='"+e.columnName+"']");f.css("position","");var g=f.css("color"),h=f.css("width");if(null===f.html()&&e.debug)return void b.errBox("SPServices.SPAutocomplete","columnName: "+e.columnName,"Column is not an input control or is not found on page");f.closest("span").find("br").remove(),f.wrap("<div>");var i=z("SPAutocomplete",e.columnName,e.listName);f.after("<div><ul id='"+i+"' style='width:"+h+";display:none;padding:2px;border:1px solid #2A1FAA;background-color:#FFF;position:absolute;z-index:40;margin:0'></div>");var j=a("#"+i);j.css("width",h),a(f).keyup(function(){var b=a(this).val();if(j.hide(),b.length<e.numChars)return!1;f.css({"background-image":"url("+e.processingIndicator+")","background-position":"right","background-repeat":"no-repeat"});var c=[],h="<Query><OrderBy><FieldRef Name='"+e.sourceColumn+"'/></OrderBy><Where>";e.CAMLQuery.length>0&&(h+="<And>"),h+="<"+e.filterType+"><FieldRef Name='"+e.sourceColumn+"'/><Value Type='Text'>"+b+"</Value></"+e.filterType+">",e.CAMLQuery.length>0&&(h+=e.CAMLQuery+"</And>"),h+="</Where></Query>",a().SPServices({operation:"GetListItems",async:!1,webURL:e.WebURL,listName:e.sourceList,CAMLQuery:h,CAMLQueryOptions:e.CAMLQueryOptions,CAMLViewFields:"<ViewFields><FieldRef Name='"+e.sourceColumn+"' /></ViewFields>",CAMLRowLimit:e.CAMLRowLimit,completefunc:function(d){
var f=e.ignoreCase?b.toUpperCase():b;a(d.responseXML).SPFilterNode("z:row").each(function(){var b=a(this).attr("ows_"+e.sourceColumn),d=e.ignoreCase?a(this).attr("ows_"+e.sourceColumn).toUpperCase():a(this).attr("ows_"+e.sourceColumn);if("Contains"===e.filterType){var g=d.indexOf(f);g>=0&&(!e.uniqueVals||-1===a.inArray(b,c))&&c.push(a(this).attr("ows_"+e.sourceColumn))}else f!==d.substr(0,f.length)||e.uniqueVals&&-1!==a.inArray(b,c)||c.push(a(this).attr("ows_"+e.sourceColumn))})}});var k="";for(ia=0;ia<c.length;ia++){if(e.highlightClass.length>0){var l=new RegExp(b,e.ignoreCase?"gi":"g"),m=c[ia].match(l),n=0;for(d=0;d<m.length;d++){var o=c[ia].indexOf(m[d],n),p=o+m[d].length,q="<span class='"+e.highlightClass+"'>"+m[d]+"</span>";c[ia]=c[ia].substr(0,o)+q+c[ia].substr(p),n=o+q.length}}k+="<li style='display: block;position: relative;cursor: pointer;'>"+c[ia]+"</li>"}j.html(k),a("#"+i+" li").click(function(){a("#"+i).fadeOut(e.slideUpSpeed),f.val(a(this).text())}).mouseover(function(){var b={cursor:"hand",color:"#ffffff",background:"#3399ff"};a(this).css(b)}).mouseout(function(){var b={cursor:"inherit",color:g,background:"transparent"};a(this).css(b)}),c.length>0&&a("#"+i).slideDown(e.slideDownSpeed),f.css("background-image","")})},a.fn.SPServices.SPGetQueryString=function(b){for(var c=a.extend({},{lowercase:!1},b),d={},e=location.search.slice(1).split("&"),f=0;f<e.length;f++){var g=e[f].split("="),h=c.lowercase?g[0].toLowerCase():g[0];d[h]=decodeURIComponent(g[1]||"")}return d},a.fn.SPServices.SPListNameFromUrl=function(b){var c=a.extend({},{listName:""},b);if(c.listName.length>0)return ha.thisList=c.listName,ha.thisList;if(void 0!==ha.thisList&&ha.thisList.length>0)return ha.thisList;var d=location.href,e=d.substring(0,d.indexOf(".aspx")),f=decodeURIComponent(e.substring(0,e.lastIndexOf(F)+1)).toUpperCase();return a().SPServices({operation:"GetListCollection",async:!1,completefunc:function(b){a(b.responseXML).find("List").each(function(){var b=a(this).attr("DefaultViewUrl"),c=b.substring(0,b.lastIndexOf(F)+1).toUpperCase();return f.indexOf(c)>0?(ha.thisList=a(this).attr("ID"),!1):void 0})}}),ha.thisList},a.fn.SPServices.SPUpdateMultipleListItems=function(d){var e,f=a.extend({},{webURL:"",listName:"",CAMLQuery:"",batchCmd:"Update",valuepairs:[],completefunc:null,debug:!1},d),g=[],h=[];a().SPServices({operation:"GetListItems",async:!1,webURL:f.webURL,listName:f.listName,CAMLQuery:f.CAMLQuery,CAMLQueryOptions:"<QueryOptions><ViewAttributes Scope='Recursive' /></QueryOptions>",completefunc:function(b){a(b.responseXML).SPFilterNode("z:row").each(function(){g.push(a(this).attr("ows_ID"));var b=a(this).attr("ows_FileRef");b="/"+b.substring(b.indexOf(c.spDelim)+2),h.push(b)})}});var i,j="<Batch OnError='Continue'>";for(e=0;e<g.length;e++){for(j+="<Method ID='"+e+"' Cmd='"+f.batchCmd+"'>",i=0;i<f.valuepairs.length;i++)j+="<Field Name='"+f.valuepairs[i][0]+"'>"+b.escapeColumnValue(f.valuepairs[i][1])+"</Field>";j+="<Field Name='ID'>"+g[e]+"</Field>",h[e].length>0&&(j+="<Field Name='FileRef'>"+h[e]+"</Field>"),j+="</Method>"}j+="</Batch>",a().SPServices({operation:"UpdateListItems",async:!1,webURL:f.webURL,listName:f.listName,updates:j,completefunc:function(a){null!==f.completefunc&&f.completefunc(a)}})},a.fn.SPServices.SPGetListItemsJson=function(b){var c,d=a.extend({},{webURL:"",listName:"",viewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:"",CAMLQueryOptions:"",changeToken:"",contains:"",mapping:null,mappingOverrides:null,debug:!1},a().SPServices.defaults,b),e={},f=[],g=a.Deferred(),h=a().SPServices({operation:"GetListItemChangesSinceToken",webURL:d.webURL,listName:d.listName,viewName:d.viewName,CAMLQuery:d.CAMLQuery,CAMLViewFields:d.CAMLViewFields,CAMLRowLimit:d.CAMLRowLimit,CAMLQueryOptions:d.CAMLQueryOptions,changeToken:d.changeToken,contains:d.contains});return h.done(function(){var b="SPGetListItemsJson"+d.webURL+d.listName,i=a(h.responseXML);if(c=i.find("Changes").attr("LastChangeToken"),i.find("listitems Changes Id[ChangeType='Delete']").each(function(){f.push(a(this).text())}),null===d.mapping?i.find("List > Fields > Field").each(function(){var b=a(this),c=b.attr("Type");a.inArray(c,J)>=0&&(e["ows_"+b.attr("Name")]={mappedName:b.attr("Name"),objectType:b.attr("Type")})}):e=d.mapping,null!==d.mappingOverrides)for(var j in d.mappingOverrides)e[j]=d.mappingOverrides[j];a.isEmptyObject(e)?e=a(document).data(b):a(document).data(b,e);var k=i.SPFilterNode("z:row").SPXmlToJson({mapping:e,sparse:!0}),l={changeToken:c,mapping:e,data:k,deletedIds:f};g.resolveWith(l)}),g.promise()},a.fn.SPServices.SPConvertDateToISO=function(c){var d=a.extend({},{dateToConvert:new Date,dateOffset:"-05:00"},c),e="",f=d.dateToConvert;return e+=f.getFullYear()+"-",e+=b.pad(f.getMonth()+1)+"-",e+=b.pad(f.getDate()),e+="T"+b.pad(f.getHours())+":",e+=b.pad(f.getMinutes())+":",e+=b.pad(f.getSeconds())+"Z"+d.dateOffset},a.fn.SPFilterNode=function(a){return this.find("*").filter(function(){return this.nodeName===a})},a.fn.SPXmlToJson=function(b){var c,d=a.extend({},{mapping:{},includeAllAttrs:!1,removeOws:!0,sparse:!1},b),e=[];return this.each(function(){var b={},f=this.attributes;for(d.sparse||a.each(d.mapping,function(){b[this.mappedName]=""}),c=0;c<f.length;c++){var g=f[c].name,h=d.mapping[g],j="undefined"!=typeof h?h.mappedName:d.removeOws?g.split("ows_")[1]:g,k="undefined"!=typeof h?h.objectType:void 0;(d.includeAllAttrs||void 0!==h)&&(b[j]=i(f[c].value,k))}e.push(b)}),e},a.fn.SPServices.SPFindPeoplePicker=function(b){var c=a.extend({},{peoplePickerDisplayName:"",valueToSet:"",checkNames:!0,checkNamesPhrase:"Check Names"},b),d=a("nobr").filter(function(){return a(this).contents().eq(0).text()===c.peoplePickerDisplayName}).closest("tr"),e=d.find("div[name='upLevelDiv']"),f=d.find("img[Title='"+c.checkNamesPhrase+"']:first");c.valueToSet.length>0&&e.html(c.valueToSet),c.checkNames&&f.click();var g=a.trim(e.text()),h=[];return e.children("span").each(function(){var b=a(this).find("div[data]").attr("data"),c={};if("undefined"!=typeof b){var d=a.parseXML(b),e=a(d);e.find("DictionaryEntry").each(function(){var b=a(this).find("Key").text();c[b]=a(this).find("Value").text()}),h.push(c)}else a().SPServices({operation:"GetUserInfo",async:!1,cacheXML:!0,userLoginName:a(this).attr("title"),completefunc:function(b){a(b.responseXML).find("User").each(function(){a.each(this.attributes,function(a,b){c[b.name]=b.value}),h.push(c)})}})}),{row:d,contents:e,currentValue:g,checkNames:f,dictionaryEntries:h}},a.fn.SPFindPeoplePicker=function(b){return a().SPServices.SPFindPeoplePicker(b)},a.fn.SPServices.SPFindMMSPicker=function(b){for(var c=a.extend({},{MMSDisplayName:""},b),d=[],e=a("div[title='"+c.MMSDisplayName+"']"),f=e.closest("td").find("input[type='hidden']"),g=f.val().split(";"),h=0;h<g.length;h++){var i=g[h].split("|");d.push({value:i[0],guid:i[1]})}return{terms:d}},a.fn.SPServices.Version=function(){return E},a.fn.SPServices.SPDropdownCtl=function(b){var d=a.extend({},{displayName:""},b),e={};if(1===(e.Obj=a("select[Title='"+d.displayName+"']")).length?e.Type=c.dropdownType.simple:1===(e.Obj=a("input[Title='"+d.displayName+"']")).length?e.Type=c.dropdownType.complex:1===(e.Obj=a("select[ID$='SelectCandidate'][Title^='"+d.displayName+" ']")).length?e.Type=c.dropdownType.multiSelect:1===(e.Obj=a("select[ID$='SelectCandidate'][Title$=': "+d.displayName+"']")).length?e.Type=c.dropdownType.multiSelect:1===(e.Obj=a("select[ID$='SelectCandidate'][Title$='\""+d.displayName+"\".']")).length?e.Type=c.dropdownType.multiSelect:1===(e.Obj=a("select[ID$='SelectCandidate'][Title$=' "+d.displayName+"']")).length?e.Type=c.dropdownType.multiSelect:e.Type=null,null===e.Type){var f=C(d.displayName);if(void 0!==f){var g=f.find("select[title^='"+d.displayName+" '][id$='_Lookup']"),h=f.find("select[title^='"+d.displayName+" '][id$='LookupField']"),i=g.length>0?g:h;i&&1===i.length&&(e.Type=c.dropdownType.simple,e.Obj=i)}}if(e.Type===c.dropdownType.complex)e.optHid=a("input[id='"+e.Obj.attr("optHid")+"']");else if(e.Type===c.dropdownType.multiSelect){e.container=e.Obj.closest("span"),e.MultiLookupPickerdata=e.container.find("input[id$='"+H+"_data'], input[id$='"+I+"_data']");var j=e.container.find("[id$='AddButton']").attr("id");e.master=window[j.replace(/AddButton/,H+"_m")]||window[j.replace(/AddButton/,I+"_m")]}return e}}(g,b,a,c),e=function(a){return a}(g)})}();