/*
* spservices - Work with SharePoint's Web Services using jQuery
* Version 2.0.0-pre-alpha
* @requires jQuery v1.8 or greater - jQuery 1.10.x+ recommended
*
* Copyright (c) 2009-2016 Sympraxis Consulting LLC
* Examples and docs at:
* http://spservices.codeplex.com/
* Licensed under the MIT license:
* http://www.opensource.org/licenses/mit-license.php
*/
/*
* @description SPServices is a jQuery library which abstracts SharePoint's Web Services and makes them easier to use. It also includes functions which use the various Web Service operations to provide more useful (and cool) capabilities. It works entirely client side and requires no server install.
* @type jQuery
* @name spservices
* @category Plugins/spservices
* @author Sympraxis Consulting LLC/marc.anderson@sympraxisconsulting.com
* @build spservices 2.0.0-pre-alpha 2016-01-06 11:58:01
*/
!function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F;!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(G){var H=jQuery;a=function(){var a={VERSION:"2.0.0-pre-alpha",spDelim:";#",SLASH:"/",TXTColumnNotFound:"Column not found on page",SCHEMASharePoint:"http://schemas.microsoft.com/sharepoint",multiLookupPrefix:"MultiLookupPicker",multiLookupPrefix2013:"MultiLookup",dropdownType:{simple:"S",complex:"C",multiSelect:"M"},spListFieldTypes:["Integer","Text","Note","DateTime","Counter","Choice","Lookup","Boolean","Number","Currency","URL","MultiChoice","Calculated","File","Attachments","User","Recurrence","ModStat","ContentTypeId","WorkflowStatus","AllDayEvent","RelatedItems","UserMulti","LookupMulti","datetime","float","Calc"]};return a}(),b=function(a,b){var c={SPServicesContext:function(b){var c=a.extend({},{listName:"",thisUserId:""},b),d=location.protocol+"//"+location.host,e={};return"undefined"!=typeof _spPageContextInfo?(e.thisSite=d+_spPageContextInfo.webServerRelativeUrl,e.thisList=c.listName?c.listName:_spPageContextInfo.pageListId,e.thisUserId=c.thisUserId?c.thisUserId:_spPageContextInfo.userId):(e.thisSite="undefined"!=typeof L_Menu_BaseUrl?d+L_Menu_BaseUrl:"",e.thisList=c.listName?c.listName:"",e.thisUserId=c.thisUserId?c.thisUserId:"undefined"!=typeof _spUserId?_spUserId:void 0),e},wrapNode:function(a,b){var c="undefined"!=typeof b?b:"";return"<"+a+">"+c+"</"+a+">"},randOrd:function(){return Math.round(Math.random())-.5},checkLink:function(a){return 0===a.indexOf("http")||0===a.indexOf("/")?"<a href='"+a+"'>"+a+"</a>":a},fileName:function(a){return a.substring(a.lastIndexOf("/")+1,a.length)},xml_special_to_escaped_one_map:{"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"},encodeXml:function(a){return a.replace(/([\&"<>])/g,function(a,b){return this.xml_special_to_escaped_one_map[b]})},escapeColumnValue:function(a){return"string"==typeof a?a.replace(/&(?![a-zA-Z]{1,8};)/g,"&amp;"):a},escapeUrl:function(a){return a.replace(/&/g,"%26")},SplitIndex:function(a){var c=a.split(b.spDelim);this.id=c[0],this.value=c[1]},pad:function(a){return 10>a?"0"+a:a},errBox:function(a,b,c){var e="<b>Error in function</b><br/>"+a+"<br/><b>Parameter</b><br/>"+b+"<br/><b>Message</b><br/>"+c+"<br/><br/><span onmouseover='this.style.cursor=\"hand\";' onmouseout='this.style.cursor=\"inherit\";' style='width=100%;text-align:right;'>Click to continue</span></div>";d(e)},findFormField:function(b){var c,d=new RegExp('FieldName="'+b.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")+'"',"gi");return a("td.ms-formbody, td.ms-formbodysurvey").each(function(){return d.test(a(this).html())?(c=a(this),!1):void 0}),c},showAttrs:function(a){var b,d="<table class='ms-vb' width='100%'>";for(b=0;b<a.attributes.length;b++)d+="<tr><td width='10px' style='font-weight:bold;'>"+b+"</td><td width='100px'>"+a.attributes.item(b).nodeName+"</td><td>"+c.checkLink(a.attributes.item(b).nodeValue)+"</td></tr>";return d+="</table>"},addToPayload:function(b,d,e){var f;for(f=0;f<e.length;f++)"string"==typeof e[f]?d.payload+=c.wrapNode(e[f],b[e[f]]):a.isArray(e[f])&&2===e[f].length?d.payload+=c.wrapNode(e[f][0],b[e[f][1]]):"object"==typeof e[f]&&void 0!==e[f].sendNull?d.payload+=void 0===b[e[f].name]||0===b[e[f].name].length?"":c.wrapNode(e[f].name,b[e[f].name]):c.errBox(b.operation,"paramArray["+f+"]: "+e[f],"Invalid paramArray element passed to addToPayload()")},siteDataFixSOAPEnvelope:function(a,b){var c=b.substring(8);return a.opheader=a.opheader.replace(b,c),a.opfooter=a.opfooter.replace(b,c),a},getListFormUrl:function(b,c){var d;return a().SPServices({operation:"GetFormCollection",async:!1,listName:b,completefunc:function(b){d=a(b.responseXML).find("Form[Type='"+c+"']").attr("Url")}}),d},getDropdownSelected:function(c,d){var e=[];switch(c.Type){case b.dropdownType.simple:d?e.push(c.Obj.find("option:selected").val()||[]):e.push(c.Obj.find("option:selected").text()||[]);break;case b.dropdownType.complex:d?e.push(c.optHid.val()||[]):e.push(c.Obj.val()||[]);break;case b.dropdownType.multiSelect:a(c.master.resultControl).find("option").each(function(){d?e.push(a(this).val()):e.push(a(this).html())})}return e},genContainerId:function(b,c,d){var e=void 0!==d?d:a().SPServices.SPListNameFromUrl();return b+"_"+a().SPServices.SPGetStaticFromDisplay({listName:e,columnDisplayName:c})}},d=function(b){var c="position:absolute;width:300px;height:150px;padding:10px;background-color:#000000;color:#ffffff;z-index:30;font-family:'Arial';font-size:12px;display:none;";a("#aspnetForm").parent().append("<div id='SPServices_msgBox' style="+c+">"+b);var d=a("#SPServices_msgBox"),e=d.height(),f=d.width(),g=a(window).width()/2-f/2+"px",h=a(window).height()/2-e/2-100+"px";d.css({border:"5px #C02000 solid",left:g,top:h}).show().fadeTo("slow",.75).click(function(){a(this).fadeOut("3000",function(){a(this).remove()})})};return c}(H,a),c=function(a,b,c){var d="",e={header:"<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body>",footer:"</soap:Body></soap:Envelope>",payload:""},f={},g={ALERTS:"Alerts",AUTHENTICATION:"Authentication",COPY:"Copy",FORMS:"Forms",LISTS:"Lists",MEETINGS:"Meetings",OFFICIALFILE:"OfficialFile",PEOPLE:"People",PERMISSIONS:"Permissions",PUBLISHEDLINKSSERVICE:"PublishedLinksService",SEARCH:"Search",SHAREPOINTDIAGNOSTICS:"SharePointDiagnostics",SITEDATA:"SiteData",SITES:"Sites",SOCIALDATASERVICE:"SocialDataService",SPELLCHECK:"SpellCheck",TAXONOMYSERVICE:"TaxonomyClientService",USERGROUP:"usergroup",USERPROFILESERVICE:"UserProfileService",VERSIONS:"Versions",VIEWS:"Views",WEBPARTPAGES:"WebPartPages",WEBS:"Webs",WORKFLOW:"Workflow"},h=["listName","description"],i={};i.GetAlerts=[g.ALERTS,!1],i.DeleteAlerts=[g.ALERTS,!0],i.Mode=[g.AUTHENTICATION,!1],i.Login=[g.AUTHENTICATION,!1],i.CopyIntoItems=[g.COPY,!0],i.CopyIntoItemsLocal=[g.COPY,!0],i.GetItem=[g.COPY,!1],i.GetForm=[g.FORMS,!1],i.GetFormCollection=[g.FORMS,!1],i.AddAttachment=[g.LISTS,!0],i.AddDiscussionBoardItem=[g.LISTS,!0],i.AddList=[g.LISTS,!0],i.AddListFromFeature=[g.LISTS,!0],i.ApplyContentTypeToList=[g.LISTS,!0],i.CheckInFile=[g.LISTS,!0],i.CheckOutFile=[g.LISTS,!0],i.CreateContentType=[g.LISTS,!0],i.DeleteAttachment=[g.LISTS,!0],i.DeleteContentType=[g.LISTS,!0],i.DeleteContentTypeXmlDocument=[g.LISTS,!0],i.DeleteList=[g.LISTS,!0],i.GetAttachmentCollection=[g.LISTS,!1],i.GetList=[g.LISTS,!1],i.GetListAndView=[g.LISTS,!1],i.GetListCollection=[g.LISTS,!1],i.GetListContentType=[g.LISTS,!1],i.GetListContentTypes=[g.LISTS,!1],i.GetListItemChanges=[g.LISTS,!1],i.GetListItemChangesSinceToken=[g.LISTS,!1],i.GetListItems=[g.LISTS,!1],i.GetVersionCollection=[g.LISTS,!1],i.UndoCheckOut=[g.LISTS,!0],i.UpdateContentType=[g.LISTS,!0],i.UpdateContentTypesXmlDocument=[g.LISTS,!0],i.UpdateContentTypeXmlDocument=[g.LISTS,!0],i.UpdateList=[g.LISTS,!0],i.UpdateListItems=[g.LISTS,!0],i.AddMeeting=[g.MEETINGS,!0],i.CreateWorkspace=[g.MEETINGS,!0],i.RemoveMeeting=[g.MEETINGS,!0],i.SetWorkSpaceTitle=[g.MEETINGS,!0],i.GetRecordRouting=[g.OFFICIALFILE,!1],i.GetRecordRoutingCollection=[g.OFFICIALFILE,!1],i.GetServerInfo=[g.OFFICIALFILE,!1],i.SubmitFile=[g.OFFICIALFILE,!0],i.ResolvePrincipals=[g.PEOPLE,!0],i.SearchPrincipals=[g.PEOPLE,!1],i.AddPermission=[g.PERMISSIONS,!0],i.AddPermissionCollection=[g.PERMISSIONS,!0],i.GetPermissionCollection=[g.PERMISSIONS,!0],i.RemovePermission=[g.PERMISSIONS,!0],i.RemovePermissionCollection=[g.PERMISSIONS,!0],i.UpdatePermission=[g.PERMISSIONS,!0],i.GetLinks=[g.PUBLISHEDLINKSSERVICE,!0],i.GetPortalSearchInfo=[g.SEARCH,!1],i.GetQuerySuggestions=[g.SEARCH,!1],i.GetSearchMetadata=[g.SEARCH,!1],i.Query=[g.SEARCH,!1],i.QueryEx=[g.SEARCH,!1],i.Registration=[g.SEARCH,!1],i.Status=[g.SEARCH,!1],i.SendClientScriptErrorReport=[g.SHAREPOINTDIAGNOSTICS,!0],i.GetAttachments=[g.SITEDATA,!1],i.EnumerateFolder=[g.SITEDATA,!1],i.SiteDataGetList=[g.SITEDATA,!1],i.SiteDataGetListCollection=[g.SITEDATA,!1],i.SiteDataGetSite=[g.SITEDATA,!1],i.SiteDataGetSiteUrl=[g.SITEDATA,!1],i.SiteDataGetWeb=[g.SITEDATA,!1],i.CreateWeb=[g.SITES,!0],i.DeleteWeb=[g.SITES,!0],i.GetSite=[g.SITES,!1],i.GetSiteTemplates=[g.SITES,!1],i.AddComment=[g.SOCIALDATASERVICE,!0],i.AddTag=[g.SOCIALDATASERVICE,!0],i.AddTagByKeyword=[g.SOCIALDATASERVICE,!0],i.CountCommentsOfUser=[g.SOCIALDATASERVICE,!1],i.CountCommentsOfUserOnUrl=[g.SOCIALDATASERVICE,!1],i.CountCommentsOnUrl=[g.SOCIALDATASERVICE,!1],i.CountRatingsOnUrl=[g.SOCIALDATASERVICE,!1],i.CountTagsOfUser=[g.SOCIALDATASERVICE,!1],i.DeleteComment=[g.SOCIALDATASERVICE,!0],i.DeleteRating=[g.SOCIALDATASERVICE,!0],i.DeleteTag=[g.SOCIALDATASERVICE,!0],i.DeleteTagByKeyword=[g.SOCIALDATASERVICE,!0],i.DeleteTags=[g.SOCIALDATASERVICE,!0],i.GetAllTagTerms=[g.SOCIALDATASERVICE,!1],i.GetAllTagTermsForUrlFolder=[g.SOCIALDATASERVICE,!1],i.GetAllTagUrls=[g.SOCIALDATASERVICE,!1],i.GetAllTagUrlsByKeyword=[g.SOCIALDATASERVICE,!1],i.GetCommentsOfUser=[g.SOCIALDATASERVICE,!1],i.GetCommentsOfUserOnUrl=[g.SOCIALDATASERVICE,!1],i.GetCommentsOnUrl=[g.SOCIALDATASERVICE,!1],i.GetRatingAverageOnUrl=[g.SOCIALDATASERVICE,!1],i.GetRatingOfUserOnUrl=[g.SOCIALDATASERVICE,!1],i.GetRatingOnUrl=[g.SOCIALDATASERVICE,!1],i.GetRatingsOfUser=[g.SOCIALDATASERVICE,!1],i.GetRatingsOnUrl=[g.SOCIALDATASERVICE,!1],i.GetSocialDataForFullReplication=[g.SOCIALDATASERVICE,!1],i.GetTags=[g.SOCIALDATASERVICE,!0],i.GetTagsOfUser=[g.SOCIALDATASERVICE,!0],i.GetTagTerms=[g.SOCIALDATASERVICE,!0],i.GetTagTermsOfUser=[g.SOCIALDATASERVICE,!0],i.GetTagTermsOnUrl=[g.SOCIALDATASERVICE,!0],i.GetTagUrlsOfUser=[g.SOCIALDATASERVICE,!0],i.GetTagUrlsOfUserByKeyword=[g.SOCIALDATASERVICE,!0],i.GetTagUrls=[g.SOCIALDATASERVICE,!0],i.GetTagUrlsByKeyword=[g.SOCIALDATASERVICE,!0],i.SetRating=[g.SOCIALDATASERVICE,!0],i.UpdateComment=[g.SOCIALDATASERVICE,!0],i.SpellCheck=[g.SPELLCHECK,!1],i.AddTerms=[g.TAXONOMYSERVICE,!0],i.GetChildTermsInTerm=[g.TAXONOMYSERVICE,!1],i.GetChildTermsInTermSet=[g.TAXONOMYSERVICE,!1],i.GetKeywordTermsByGuids=[g.TAXONOMYSERVICE,!1],i.GetTermsByLabel=[g.TAXONOMYSERVICE,!1],i.GetTermSets=[g.TAXONOMYSERVICE,!1],i.AddGroup=[g.USERGROUP,!0],i.AddGroupToRole=[g.USERGROUP,!0],i.AddRole=[g.USERGROUP,!0],i.AddRoleDef=[g.USERGROUP,!0],i.AddUserCollectionToGroup=[g.USERGROUP,!0],i.AddUserCollectionToRole=[g.USERGROUP,!0],i.AddUserToGroup=[g.USERGROUP,!0],i.AddUserToRole=[g.USERGROUP,!0],i.GetAllUserCollectionFromWeb=[g.USERGROUP,!1],i.GetGroupCollection=[g.USERGROUP,!1],i.GetGroupCollectionFromRole=[g.USERGROUP,!1],i.GetGroupCollectionFromSite=[g.USERGROUP,!1],i.GetGroupCollectionFromUser=[g.USERGROUP,!1],i.GetGroupCollectionFromWeb=[g.USERGROUP,!1],i.GetGroupInfo=[g.USERGROUP,!1],i.GetRoleCollection=[g.USERGROUP,!1],i.GetRoleCollectionFromGroup=[g.USERGROUP,!1],i.GetRoleCollectionFromUser=[g.USERGROUP,!1],i.GetRoleCollectionFromWeb=[g.USERGROUP,!1],i.GetRoleInfo=[g.USERGROUP,!1],i.GetRolesAndPermissionsForCurrentUser=[g.USERGROUP,!1],i.GetRolesAndPermissionsForSite=[g.USERGROUP,!1],i.GetUserCollection=[g.USERGROUP,!1],i.GetUserCollectionFromGroup=[g.USERGROUP,!1],i.GetUserCollectionFromRole=[g.USERGROUP,!1],i.GetUserCollectionFromSite=[g.USERGROUP,!1],i.GetUserCollectionFromWeb=[g.USERGROUP,!1],i.GetUserInfo=[g.USERGROUP,!1],i.GetUserLoginFromEmail=[g.USERGROUP,!1],i.RemoveGroup=[g.USERGROUP,!0],i.RemoveGroupFromRole=[g.USERGROUP,!0],i.RemoveRole=[g.USERGROUP,!0],i.RemoveUserCollectionFromGroup=[g.USERGROUP,!0],i.RemoveUserCollectionFromRole=[g.USERGROUP,!0],i.RemoveUserCollectionFromSite=[g.USERGROUP,!0],i.RemoveUserFromGroup=[g.USERGROUP,!0],i.RemoveUserFromRole=[g.USERGROUP,!0],i.RemoveUserFromSite=[g.USERGROUP,!0],i.RemoveUserFromWeb=[g.USERGROUP,!0],i.UpdateGroupInfo=[g.USERGROUP,!0],i.UpdateRoleDefInfo=[g.USERGROUP,!0],i.UpdateRoleInfo=[g.USERGROUP,!0],i.UpdateUserInfo=[g.USERGROUP,!0],i.AddColleague=[g.USERPROFILESERVICE,!0],i.AddLink=[g.USERPROFILESERVICE,!0],i.AddMembership=[g.USERPROFILESERVICE,!0],i.AddPinnedLink=[g.USERPROFILESERVICE,!0],i.CreateMemberGroup=[g.USERPROFILESERVICE,!0],i.CreateUserProfileByAccountName=[g.USERPROFILESERVICE,!0],i.GetCommonColleagues=[g.USERPROFILESERVICE,!1],i.GetCommonManager=[g.USERPROFILESERVICE,!1],i.GetCommonMemberships=[g.USERPROFILESERVICE,!1],i.GetInCommon=[g.USERPROFILESERVICE,!1],i.GetPropertyChoiceList=[g.USERPROFILESERVICE,!1],i.GetUserColleagues=[g.USERPROFILESERVICE,!1],i.GetUserLinks=[g.USERPROFILESERVICE,!1],i.GetUserMemberships=[g.USERPROFILESERVICE,!1],i.GetUserPinnedLinks=[g.USERPROFILESERVICE,!1],i.GetUserProfileByGuid=[g.USERPROFILESERVICE,!1],i.GetUserProfileByIndex=[g.USERPROFILESERVICE,!1],i.GetUserProfileByName=[g.USERPROFILESERVICE,!1],i.GetUserProfileCount=[g.USERPROFILESERVICE,!1],i.GetUserProfileSchema=[g.USERPROFILESERVICE,!1],i.GetUserPropertyByAccountName=[g.USERPROFILESERVICE,!1],i.ModifyUserPropertyByAccountName=[g.USERPROFILESERVICE,!0],i.RemoveAllColleagues=[g.USERPROFILESERVICE,!0],i.RemoveAllLinks=[g.USERPROFILESERVICE,!0],i.RemoveAllMemberships=[g.USERPROFILESERVICE,!0],i.RemoveAllPinnedLinks=[g.USERPROFILESERVICE,!0],i.RemoveColleague=[g.USERPROFILESERVICE,!0],i.RemoveLink=[g.USERPROFILESERVICE,!0],i.RemoveMembership=[g.USERPROFILESERVICE,!0],i.RemovePinnedLink=[g.USERPROFILESERVICE,!0],i.UpdateColleaguePrivacy=[g.USERPROFILESERVICE,!0],i.UpdateLink=[g.USERPROFILESERVICE,!0],i.UpdateMembershipPrivacy=[g.USERPROFILESERVICE,!0],i.UpdatePinnedLink=[g.USERPROFILESERVICE,!0],i.DeleteAllVersions=[g.VERSIONS,!0],i.DeleteVersion=[g.VERSIONS,!0],i.GetVersions=[g.VERSIONS,!1],i.RestoreVersion=[g.VERSIONS,!0],i.AddView=[g.VIEWS,!0],i.DeleteView=[g.VIEWS,!0],i.GetView=[g.VIEWS,!1],i.GetViewHtml=[g.VIEWS,!1],i.GetViewCollection=[g.VIEWS,!1],i.UpdateView=[g.VIEWS,!0],i.UpdateViewHtml=[g.VIEWS,!0],i.AddWebPart=[g.WEBPARTPAGES,!0],i.AddWebPartToZone=[g.WEBPARTPAGES,!0],i.DeleteWebPart=[g.WEBPARTPAGES,!0],i.GetWebPart2=[g.WEBPARTPAGES,!1],i.GetWebPartPage=[g.WEBPARTPAGES,!1],i.GetWebPartProperties=[g.WEBPARTPAGES,!1],i.GetWebPartProperties2=[g.WEBPARTPAGES,!1],i.SaveWebPart2=[g.WEBPARTPAGES,!0],i.WebsCreateContentType=[g.WEBS,!0],i.GetColumns=[g.WEBS,!1],i.GetContentType=[g.WEBS,!1],i.GetContentTypes=[g.WEBS,!1],i.GetCustomizedPageStatus=[g.WEBS,!1],i.GetListTemplates=[g.WEBS,!1],i.GetObjectIdFromUrl=[g.WEBS,!1],i.GetWeb=[g.WEBS,!1],i.GetWebCollection=[g.WEBS,!1],i.GetAllSubWebCollection=[g.WEBS,!1],i.UpdateColumns=[g.WEBS,!0],i.WebsUpdateContentType=[g.WEBS,!0],i.WebUrlFromPageUrl=[g.WEBS,!1],i.AlterToDo=[g.WORKFLOW,!0],i.ClaimReleaseTask=[g.WORKFLOW,!0],i.GetTemplatesForItem=[g.WORKFLOW,!1],i.GetToDosForItem=[g.WORKFLOW,!1],i.GetWorkflowDataForItem=[g.WORKFLOW,!1],i.GetWorkflowTaskData=[g.WORKFLOW,!1],i.StartWorkflow=[g.WORKFLOW,!0],a.fn.SPServices=function(j){for(var k=a.extend({},a.fn.SPServices.defaults,j),l=0;l<h.length;l++)"string"==typeof k[h[l]]&&(k[h[l]]=c.encodeXml(k[h[l]]));switch(e.opheader="<"+k.operation+" ",i[k.operation][0]){case g.ALERTS:e.opheader+="xmlns='"+b.SCHEMASharePoint+"/soap/2002/1/alerts/' >",d=b.SCHEMASharePoint+"/soap/2002/1/alerts/";break;case g.MEETINGS:e.opheader+="xmlns='"+b.SCHEMASharePoint+"/soap/meetings/' >",d=b.SCHEMASharePoint+"/soap/meetings/";break;case g.OFFICIALFILE:e.opheader+="xmlns='"+b.SCHEMASharePoint+"/soap/recordsrepository/' >",d=b.SCHEMASharePoint+"/soap/recordsrepository/";break;case g.PERMISSIONS:e.opheader+="xmlns='"+b.SCHEMASharePoint+"/soap/directory/' >",d=b.SCHEMASharePoint+"/soap/directory/";break;case g.PUBLISHEDLINKSSERVICE:e.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/' >",d="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/";break;case g.SEARCH:e.opheader+="xmlns='urn:Microsoft.Search' >",d="urn:Microsoft.Search/";break;case g.SHAREPOINTDIAGNOSTICS:e.opheader+="xmlns='"+b.SCHEMASharePoint+"/diagnostics/' >",d="http://schemas.microsoft.com/sharepoint/diagnostics/";break;case g.SOCIALDATASERVICE:e.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/SocialDataService' >",d="http://microsoft.com/webservices/SharePointPortalServer/SocialDataService/";break;case g.SPELLCHECK:e.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/publishing/spelling/' >",d="http://schemas.microsoft.com/sharepoint/publishing/spelling/SpellCheck";break;case g.TAXONOMYSERVICE:e.opheader+="xmlns='"+b.SCHEMASharePoint+"/taxonomy/soap/' >",d=b.SCHEMASharePoint+"/taxonomy/soap/";break;case g.USERGROUP:e.opheader+="xmlns='"+b.SCHEMASharePoint+"/soap/directory/' >",d=b.SCHEMASharePoint+"/soap/directory/";break;case g.USERPROFILESERVICE:e.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/UserProfileService' >",d="http://microsoft.com/webservices/SharePointPortalServer/UserProfileService/";break;case g.WEBPARTPAGES:e.opheader+="xmlns='http://microsoft.com/sharepoint/webpartpages' >",d="http://microsoft.com/sharepoint/webpartpages/";break;case g.WORKFLOW:e.opheader+="xmlns='"+b.SCHEMASharePoint+"/soap/workflow/' >",d=b.SCHEMASharePoint+"/soap/workflow/";break;default:e.opheader+="xmlns='"+b.SCHEMASharePoint+"/soap/'>",d=b.SCHEMASharePoint+"/soap/"}d+=k.operation,e.opfooter="</"+k.operation+">";var m="_vti_bin/"+i[k.operation][0]+".asmx",n=void 0!==k.webURL?k.webURL:k.webUrl;if(n.charAt(n.length-1)===b.SLASH)m=n+m;else if(n.length>0)m=n+b.SLASH+m;else{var o=a().SPServices.SPGetCurrentSite();m=o+(o.charAt(o.length-1)===b.SLASH?m:b.SLASH+m)}switch(e.payload="",k.operation){case"GetAlerts":break;case"DeleteAlerts":for(e.payload+="<IDs>",l=0;l<k.IDs.length;l++)e.payload+=b.wrapNode("string",k.IDs[l]);e.payload+="</IDs>";break;case"Mode":break;case"Login":c.addToPayload(k,e,["username","password"]);break;case"CopyIntoItems":for(c.addToPayload(k,e,["SourceUrl"]),e.payload+="<DestinationUrls>",l=0;l<k.DestinationUrls.length;l++)e.payload+=c.wrapNode("string",k.DestinationUrls[l]);e.payload+="</DestinationUrls>",c.addToPayload(k,e,["Fields","Stream","Results"]);break;case"CopyIntoItemsLocal":for(c.addToPayload(k,e,["SourceUrl"]),e.payload+="<DestinationUrls>",l=0;l<k.DestinationUrls.length;l++)e.payload+=c.wrapNode("string",k.DestinationUrls[l]);e.payload+="</DestinationUrls>";break;case"GetItem":c.addToPayload(k,e,["Url","Fields","Stream"]);break;case"GetForm":c.addToPayload(k,e,["listName","formUrl"]);break;case"GetFormCollection":c.addToPayload(k,e,["listName"]);break;case"AddAttachment":c.addToPayload(k,e,["listName","listItemID","fileName","attachment"]);break;case"AddDiscussionBoardItem":c.addToPayload(k,e,["listName","message"]);break;case"AddList":c.addToPayload(k,e,["listName","description","templateID"]);break;case"AddListFromFeature":c.addToPayload(k,e,["listName","description","featureID","templateID"]);break;case"ApplyContentTypeToList":c.addToPayload(k,e,["webUrl","contentTypeId","listName"]);break;case"CheckInFile":c.addToPayload(k,e,["pageUrl","comment","CheckinType"]);break;case"CheckOutFile":c.addToPayload(k,e,["pageUrl","checkoutToLocal","lastmodified"]);break;case"CreateContentType":c.addToPayload(k,e,["listName","displayName","parentType","fields","contentTypeProperties","addToView"]);break;case"DeleteAttachment":c.addToPayload(k,e,["listName","listItemID","url"]);break;case"DeleteContentType":c.addToPayload(k,e,["listName","contentTypeId"]);break;case"DeleteContentTypeXmlDocument":c.addToPayload(k,e,["listName","contentTypeId","documentUri"]);break;case"DeleteList":c.addToPayload(k,e,["listName"]);break;case"GetAttachmentCollection":c.addToPayload(k,e,["listName",["listItemID","ID"]]);break;case"GetList":c.addToPayload(k,e,["listName"]);break;case"GetListAndView":c.addToPayload(k,e,["listName","viewName"]);break;case"GetListCollection":break;case"GetListContentType":c.addToPayload(k,e,["listName","contentTypeId"]);break;case"GetListContentTypes":c.addToPayload(k,e,["listName"]);break;case"GetListItems":c.addToPayload(k,e,["listName","viewName",["query","CAMLQuery"],["viewFields","CAMLViewFields"],["rowLimit","CAMLRowLimit"],["queryOptions","CAMLQueryOptions"]]);break;case"GetListItemChanges":c.addToPayload(k,e,["listName","viewFields","since","contains"]);break;case"GetListItemChangesSinceToken":c.addToPayload(k,e,["listName","viewName",["query","CAMLQuery"],["viewFields","CAMLViewFields"],["rowLimit","CAMLRowLimit"],["queryOptions","CAMLQueryOptions"],{name:"changeToken",sendNull:!1},{name:"contains",sendNull:!1}]);break;case"GetVersionCollection":c.addToPayload(k,e,["strlistID","strlistItemID","strFieldName"]);break;case"UndoCheckOut":c.addToPayload(k,e,["pageUrl"]);break;case"UpdateContentType":c.addToPayload(k,e,["listName","contentTypeId","contentTypeProperties","newFields","updateFields","deleteFields","addToView"]);break;case"UpdateContentTypesXmlDocument":c.addToPayload(k,e,["listName","newDocument"]);break;case"UpdateContentTypeXmlDocument":c.addToPayload(k,e,["listName","contentTypeId","newDocument"]);break;case"UpdateList":c.addToPayload(k,e,["listName","listProperties","newFields","updateFields","deleteFields","listVersion"]);break;case"UpdateListItems":if(c.addToPayload(k,e,["listName"]),"undefined"!=typeof k.updates&&k.updates.length>0)c.addToPayload(k,e,["updates"]);else{for(e.payload+="<updates><Batch OnError='Continue'><Method ID='1' Cmd='"+k.batchCmd+"'>",l=0;l<k.valuepairs.length;l++)e.payload+="<Field Name='"+k.valuepairs[l][0]+"'>"+c.escapeColumnValue(k.valuepairs[l][1])+"</Field>";"New"!==k.batchCmd&&(e.payload+="<Field Name='ID'>"+k.ID+"</Field>"),e.payload+="</Method></Batch></updates>"}break;case"AddMeeting":c.addToPayload(k,e,["organizerEmail","uid","sequence","utcDateStamp","title","location","utcDateStart","utcDateEnd","nonGregorian"]);break;case"CreateWorkspace":c.addToPayload(k,e,["title","templateName","lcid","timeZoneInformation"]);break;case"RemoveMeeting":c.addToPayload(k,e,["recurrenceId","uid","sequence","utcDateStamp","cancelMeeting"]);break;case"SetWorkspaceTitle":c.addToPayload(k,e,["title"]);break;case"GetRecordRouting":c.addToPayload(k,e,["recordRouting"]);break;case"GetRecordRoutingCollection":break;case"GetServerInfo":break;case"SubmitFile":c.addToPayload(k,e,["fileToSubmit"],["properties"],["recordRouting"],["sourceUrl"],["userName"]);break;case"ResolvePrincipals":c.addToPayload(k,e,["principalKeys","principalType","addToUserInfoList"]);break;case"SearchPrincipals":c.addToPayload(k,e,["searchText","maxResults","principalType"]);break;case"AddPermission":c.addToPayload(k,e,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"AddPermissionCollection":c.addToPayload(k,e,["objectName","objectType","permissionsInfoXml"]);break;case"GetPermissionCollection":c.addToPayload(k,e,["objectName","objectType"]);break;case"RemovePermission":c.addToPayload(k,e,["objectName","objectType","permissionIdentifier","permissionType"]);break;case"RemovePermissionCollection":c.addToPayload(k,e,["objectName","objectType","memberIdsXml"]);break;case"UpdatePermission":c.addToPayload(k,e,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"GetLinks":break;case"GetPortalSearchInfo":e.opheader="<"+k.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",d="http://microsoft.com/webservices/OfficeServer/QueryService/"+k.operation;break;case"GetQuerySuggestions":e.opheader="<"+k.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",d="http://microsoft.com/webservices/OfficeServer/QueryService/"+k.operation,e.payload+=c.wrapNode("queryXml",b.encodeXml(k.queryXml));break;case"GetSearchMetadata":e.opheader="<"+k.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",d="http://microsoft.com/webservices/OfficeServer/QueryService/"+k.operation;break;case"Query":e.payload+=c.wrapNode("queryXml",b.encodeXml(k.queryXml));break;case"QueryEx":e.opheader="<"+k.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",d="http://microsoft.com/webservices/OfficeServer/QueryService/"+k.operation,e.payload+=c.wrapNode("queryXml",b.encodeXml(k.queryXml));break;case"Registration":e.payload+=c.wrapNode("registrationXml",b.encodeXml(k.registrationXml));break;case"Status":break;case"SendClientScriptErrorReport":c.addToPayload(k,e,["message","file","line","client","stack","team","originalFile"]);break;case"EnumerateFolder":c.addToPayload(k,e,["strFolderUrl"]);break;case"GetAttachments":c.addToPayload(k,e,["strListName","strItemId"]);break;case"SiteDataGetList":c.addToPayload(k,e,["strListName"]),e=b.siteDataFixSOAPEnvelope(e,k.operation);break;case"SiteDataGetListCollection":e=b.siteDataFixSOAPEnvelope(e,k.operation);break;case"SiteDataGetSite":e=b.siteDataFixSOAPEnvelope(e,k.operation);break;case"SiteDataGetSiteUrl":c.addToPayload(k,e,["Url"]),e=b.siteDataFixSOAPEnvelope(e,k.operation);break;case"SiteDataGetWeb":e=b.siteDataFixSOAPEnvelope(e,k.operation);break;case"CreateWeb":c.addToPayload(k,e,["url","title","description","templateName","language","languageSpecified","locale","localeSpecified","collationLocale","collationLocaleSpecified","uniquePermissions","uniquePermissionsSpecified","anonymous","anonymousSpecified","presence","presenceSpecified"]);break;case"DeleteWeb":c.addToPayload(k,e,["url"]);break;case"GetSite":c.addToPayload(k,e,["SiteUrl"]);break;case"GetSiteTemplates":c.addToPayload(k,e,["LCID","TemplateList"]);break;case"AddComment":c.addToPayload(k,e,["url","comment","isHighPriority","title"]);break;case"AddTag":c.addToPayload(k,e,["url","termID","title","isPrivate"]);break;case"AddTagByKeyword":c.addToPayload(k,e,["url","keyword","title","isPrivate"]);break;case"CountCommentsOfUser":c.addToPayload(k,e,["userAccountName"]);break;case"CountCommentsOfUserOnUrl":c.addToPayload(k,e,["userAccountName","url"]);break;case"CountCommentsOnUrl":c.addToPayload(k,e,["url"]);break;case"CountRatingsOnUrl":c.addToPayload(k,e,["url"]);break;case"CountTagsOfUser":c.addToPayload(k,e,["userAccountName"]);break;case"DeleteComment":c.addToPayload(k,e,["url","lastModifiedTime"]);break;case"DeleteRating":c.addToPayload(k,e,["url"]);break;case"DeleteTag":c.addToPayload(k,e,["url","termID"]);break;case"DeleteTagByKeyword":c.addToPayload(k,e,["url","keyword"]);break;case"DeleteTags":c.addToPayload(k,e,["url"]);break;case"GetAllTagTerms":c.addToPayload(k,e,["maximumItemsToReturn"]);break;case"GetAllTagTermsForUrlFolder":c.addToPayload(k,e,["urlFolder","maximumItemsToReturn"]);break;case"GetAllTagUrls":c.addToPayload(k,e,["termID"]);break;case"GetAllTagUrlsByKeyword":c.addToPayload(k,e,["keyword"]);break;case"GetCommentsOfUser":c.addToPayload(k,e,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetCommentsOfUserOnUrl":c.addToPayload(k,e,["userAccountName","url"]);break;case"GetCommentsOnUrl":c.addToPayload(k,e,["url","maximumItemsToReturn","startIndex"]),"undefined"!=typeof k.excludeItemsTime&&k.excludeItemsTime.length>0&&(e.payload+=c.wrapNode("excludeItemsTime",k.excludeItemsTime));break;case"GetRatingAverageOnUrl":c.addToPayload(k,e,["url"]);break;case"GetRatingOfUserOnUrl":c.addToPayload(k,e,["userAccountName","url"]);break;case"GetRatingOnUrl":c.addToPayload(k,e,["url"]);break;case"GetRatingsOfUser":c.addToPayload(k,e,["userAccountName"]);break;case"GetRatingsOnUrl":c.addToPayload(k,e,["url"]);break;case"GetSocialDataForFullReplication":c.addToPayload(k,e,["userAccountName"]);break;case"GetTags":c.addToPayload(k,e,["url"]);break;case"GetTagsOfUser":c.addToPayload(k,e,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetTagTerms":c.addToPayload(k,e,["maximumItemsToReturn"]);break;case"GetTagTermsOfUser":c.addToPayload(k,e,["userAccountName","maximumItemsToReturn"]);break;case"GetTagTermsOnUrl":c.addToPayload(k,e,["url","maximumItemsToReturn"]);break;case"GetTagUrls":c.addToPayload(k,e,["termID"]);break;case"GetTagUrlsByKeyword":c.addToPayload(k,e,["keyword"]);break;case"GetTagUrlsOfUser":c.addToPayload(k,e,["termID","userAccountName"]);break;case"GetTagUrlsOfUserByKeyword":c.addToPayload(k,e,["keyword","userAccountName"]);break;case"SetRating":c.addToPayload(k,e,["url","rating","title","analysisDataEntry"]);break;case"UpdateComment":c.addToPayload(k,e,["url","lastModifiedTime","comment","isHighPriority"]);break;case"SpellCheck":c.addToPayload(k,e,["chunksToSpell","declaredLanguage","useLad"]);break;case"AddTerms":c.addToPayload(k,e,["sharedServiceId","termSetId","lcid","newTerms"]);break;case"GetChildTermsInTerm":c.addToPayload(k,e,["sspId","lcid","termId","termSetId"]);break;case"GetChildTermsInTermSet":c.addToPayload(k,e,["sspId","lcid","termSetId"]);break;case"GetKeywordTermsByGuids":c.addToPayload(k,e,["termIds","lcid"]);break;case"GetTermsByLabel":c.addToPayload(k,e,["label","lcid","matchOption","resultCollectionSize","termIds","addIfNotFound"]);break;case"GetTermSets":c.addToPayload(k,e,["sharedServiceIds","termSetIds","lcid","clientTimeStamps","clientVersions"]);break;case"AddGroup":c.addToPayload(k,e,["groupName","ownerIdentifier","ownerType","defaultUserLoginName","description"]);break;case"AddGroupToRole":c.addToPayload(k,e,["groupName","roleName"]);break;case"AddRole":c.addToPayload(k,e,["roleName","description","permissionMask"]);break;case"AddRoleDef":c.addToPayload(k,e,["roleName","description","permissionMask"]);break;case"AddUserCollectionToGroup":c.addToPayload(k,e,["groupName","usersInfoXml"]);break;case"AddUserCollectionToRole":c.addToPayload(k,e,["roleName","usersInfoXml"]);break;case"AddUserToGroup":c.addToPayload(k,e,["groupName","userName","userLoginName","userEmail","userNotes"]);break;case"AddUserToRole":c.addToPayload(k,e,["roleName","userName","userLoginName","userEmail","userNotes"]);break;case"GetAllUserCollectionFromWeb":break;case"GetGroupCollection":c.addToPayload(k,e,["groupNamesXml"]);break;case"GetGroupCollectionFromRole":c.addToPayload(k,e,["roleName"]);break;case"GetGroupCollectionFromSite":break;case"GetGroupCollectionFromUser":c.addToPayload(k,e,["userLoginName"]);break;case"GetGroupCollectionFromWeb":break;case"GetGroupInfo":c.addToPayload(k,e,["groupName"]);break;case"GetRoleCollection":c.addToPayload(k,e,["roleNamesXml"]);break;case"GetRoleCollectionFromGroup":c.addToPayload(k,e,["groupName"]);break;case"GetRoleCollectionFromUser":c.addToPayload(k,e,["userLoginName"]);break;case"GetRoleCollectionFromWeb":break;case"GetRoleInfo":c.addToPayload(k,e,["roleName"]);break;case"GetRolesAndPermissionsForCurrentUser":break;case"GetRolesAndPermissionsForSite":break;case"GetUserCollection":c.addToPayload(k,e,["userLoginNamesXml"]);break;case"GetUserCollectionFromGroup":c.addToPayload(k,e,["groupName"]);break;case"GetUserCollectionFromRole":c.addToPayload(k,e,["roleName"]);break;case"GetUserCollectionFromSite":break;case"GetUserCollectionFromWeb":break;case"GetUserInfo":c.addToPayload(k,e,["userLoginName"]);break;case"GetUserLoginFromEmail":c.addToPayload(k,e,["emailXml"]);break;case"RemoveGroup":c.addToPayload(k,e,["groupName"]);break;case"RemoveGroupFromRole":c.addToPayload(k,e,["roleName","groupName"]);break;case"RemoveRole":c.addToPayload(k,e,["roleName"]);break;case"RemoveUserCollectionFromGroup":c.addToPayload(k,e,["groupName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromRole":c.addToPayload(k,e,["roleName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromSite":c.addToPayload(k,e,["userLoginNamesXml"]);break;case"RemoveUserFromGroup":c.addToPayload(k,e,["groupName","userLoginName"]);break;case"RemoveUserFromRole":c.addToPayload(k,e,["roleName","userLoginName"]);break;case"RemoveUserFromSite":c.addToPayload(k,e,["userLoginName"]);break;case"RemoveUserFromWeb":c.addToPayload(k,e,["userLoginName"]);break;case"UpdateGroupInfo":c.addToPayload(k,e,["oldGroupName","groupName","ownerIdentifier","ownerType","description"]);break;case"UpdateRoleDefInfo":c.addToPayload(k,e,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateRoleInfo":c.addToPayload(k,e,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateUserInfo":
c.addToPayload(k,e,["userLoginName","userName","userEmail","userNotes"]);break;case"AddColleague":c.addToPayload(k,e,["accountName","colleagueAccountName","group","privacy","isInWorkGroup"]);break;case"AddLink":c.addToPayload(k,e,["accountName","name","url","group","privacy"]);break;case"AddMembership":c.addToPayload(k,e,["accountName","membershipInfo","group","privacy"]);break;case"AddPinnedLink":c.addToPayload(k,e,["accountName","name","url"]);break;case"CreateMemberGroup":c.addToPayload(k,e,["membershipInfo"]);break;case"CreateUserProfileByAccountName":c.addToPayload(k,e,["accountName"]);break;case"GetCommonColleagues":c.addToPayload(k,e,["accountName"]);break;case"GetCommonManager":c.addToPayload(k,e,["accountName"]);break;case"GetCommonMemberships":c.addToPayload(k,e,["accountName"]);break;case"GetInCommon":c.addToPayload(k,e,["accountName"]);break;case"GetPropertyChoiceList":c.addToPayload(k,e,["propertyName"]);break;case"GetUserColleagues":c.addToPayload(k,e,["accountName"]);break;case"GetUserLinks":c.addToPayload(k,e,["accountName"]);break;case"GetUserMemberships":c.addToPayload(k,e,["accountName"]);break;case"GetUserPinnedLinks":c.addToPayload(k,e,["accountName"]);break;case"GetUserProfileByGuid":c.addToPayload(k,e,["guid"]);break;case"GetUserProfileByIndex":c.addToPayload(k,e,["index"]);break;case"GetUserProfileByName":"undefined"!=typeof k.accountName&&k.accountName.length>0?c.addToPayload(k,e,[["AccountName","accountName"]]):c.addToPayload(k,e,["AccountName"]);break;case"GetUserProfileCount":break;case"GetUserProfileSchema":break;case"GetUserPropertyByAccountName":c.addToPayload(k,e,["accountName","propertyName"]);break;case"ModifyUserPropertyByAccountName":c.addToPayload(k,e,["accountName","newData"]);break;case"RemoveAllColleagues":c.addToPayload(k,e,["accountName"]);break;case"RemoveAllLinks":c.addToPayload(k,e,["accountName"]);break;case"RemoveAllMemberships":c.addToPayload(k,e,["accountName"]);break;case"RemoveAllPinnedLinks":c.addToPayload(k,e,["accountName"]);break;case"RemoveColleague":c.addToPayload(k,e,["accountName","colleagueAccountName"]);break;case"RemoveLink":c.addToPayload(k,e,["accountName","id"]);break;case"RemoveMembership":c.addToPayload(k,e,["accountName","sourceInternal","sourceReference"]);break;case"RemovePinnedLink":c.addToPayload(k,e,["accountName","id"]);break;case"UpdateColleaguePrivacy":c.addToPayload(k,e,["accountName","colleagueAccountName","newPrivacy"]);break;case"UpdateLink":c.addToPayload(k,e,["accountName","data"]);break;case"UpdateMembershipPrivacy":c.addToPayload(k,e,["accountName","sourceInternal","sourceReference","newPrivacy"]);break;case"UpdatePinnedLink ":c.addToPayload(k,e,["accountName","data"]);break;case"DeleteAllVersions":c.addToPayload(k,e,["fileName"]);break;case"DeleteVersion":c.addToPayload(k,e,["fileName","fileVersion"]);break;case"GetVersions":c.addToPayload(k,e,["fileName"]);break;case"RestoreVersion":c.addToPayload(k,e,["fileName","fileVersion"]);break;case"AddView":c.addToPayload(k,e,["listName","viewName","viewFields","query","rowLimit","type","makeViewDefault"]);break;case"DeleteView":c.addToPayload(k,e,["listName","viewName"]);break;case"GetView":c.addToPayload(k,e,["listName","viewName"]);break;case"GetViewCollection":c.addToPayload(k,e,["listName"]);break;case"GetViewHtml":c.addToPayload(k,e,["listName","viewName"]);break;case"UpdateView":c.addToPayload(k,e,["listName","viewName","viewProperties","query","viewFields","aggregations","formats","rowLimit"]);break;case"UpdateViewHtml":c.addToPayload(k,e,["listName","viewName","viewProperties","toolbar","viewHeader","viewBody","viewFooter","viewEmpty","rowLimitExceeded","query","viewFields","aggregations","formats","rowLimit"]);break;case"AddWebPart":c.addToPayload(k,e,["pageUrl","webPartXml","storage"]);break;case"AddWebPartToZone":c.addToPayload(k,e,["pageUrl","webPartXml","storage","zoneId","zoneIndex"]);break;case"DeleteWebPart":c.addToPayload(k,e,["pageUrl","storageKey","storage"]);break;case"GetWebPart2":c.addToPayload(k,e,["pageUrl","storageKey","storage","behavior"]);break;case"GetWebPartPage":c.addToPayload(k,e,["documentName","behavior"]);break;case"GetWebPartProperties":c.addToPayload(k,e,["pageUrl","storage"]);break;case"GetWebPartProperties2":c.addToPayload(k,e,["pageUrl","storage","behavior"]);break;case"SaveWebPart2":c.addToPayload(k,e,["pageUrl","storageKey","webPartXml","storage","allowTypeChange"]);break;case"WebsCreateContentType":c.addToPayload(k,e,["displayName","parentType","newFields","contentTypeProperties"]);break;case"GetColumns":c.addToPayload(k,e,["webUrl"]);break;case"GetContentType":c.addToPayload(k,e,["contentTypeId"]);break;case"GetContentTypes":break;case"GetCustomizedPageStatus":c.addToPayload(k,e,["fileUrl"]);break;case"GetListTemplates":break;case"GetObjectIdFromUrl":c.addToPayload(k,e,["objectUrl"]);break;case"GetWeb":c.addToPayload(k,e,[["webUrl","webURL"]]);break;case"GetWebCollection":break;case"GetAllSubWebCollection":break;case"UpdateColumns":c.addToPayload(k,e,["newFields","updateFields","deleteFields"]);break;case"WebsUpdateContentType":c.addToPayload(k,e,["contentTypeId","contentTypeProperties","newFields","updateFields","deleteFields"]);break;case"WebUrlFromPageUrl":c.addToPayload(k,e,[["pageUrl","pageURL"]]);break;case"AlterToDo":c.addToPayload(k,e,["item","todoId","todoListId","taskData"]);break;case"ClaimReleaseTask":c.addToPayload(k,e,["item","taskId","listId","fClaim"]);break;case"GetTemplatesForItem":c.addToPayload(k,e,["item"]);break;case"GetToDosForItem":c.addToPayload(k,e,["item"]);break;case"GetWorkflowDataForItem":c.addToPayload(k,e,["item"]);break;case"GetWorkflowTaskData":c.addToPayload(k,e,["item","listId","taskId"]);break;case"StartWorkflow":c.addToPayload(k,e,["item","templateId","workflowParameters"])}var p,q=e.header+e.opheader+e.payload+e.opfooter+e.footer;if(k.cacheXML&&(p=f[q]),"undefined"==typeof p){var r=a.ajax({url:m,async:k.async,beforeSend:function(a){i[k.operation][1]&&a.setRequestHeader("SOAPAction",d)},type:"POST",data:q,dataType:"xml",contentType:"text/xml;charset='utf-8'",complete:function(b,c){a.isFunction(k.completefunc)&&k.completefunc(b,c)}});return k.cacheXML&&(f[q]=r),r}return a.isFunction(k.completefunc)&&p.done(function(a,b,c){k.completefunc(c,b)}),p},a.fn.SPServices.defaults={cacheXML:!1,operation:"",webURL:"",makeViewDefault:!1,viewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:0,CAMLQueryOptions:"<QueryOptions></QueryOptions>",batchCmd:"Update",valuepairs:[],DestinationUrls:[],behavior:"Version3",storage:"Shared",objectType:"List",cancelMeeting:!0,nonGregorian:!1,fClaim:!1,recurrenceId:0,sequence:0,maximumItemsToReturn:0,startIndex:0,isHighPriority:!1,isPrivate:!1,rating:1,maxResults:10,principalType:"User",async:!0,completefunc:null}}(H,a,b),d=function(a,b){return a.fn.SPServices.Version=function(){return b.VERSION},a}(H,a),e=function(a,b,c){return a.fn.SPServices.SPConvertDateToISO=function(b){var d=a.extend({},{dateToConvert:new Date,dateOffset:"-05:00"},b),e="",f=d.dateToConvert;return e+=f.getFullYear()+"-",e+=c.pad(f.getMonth()+1)+"-",e+=c.pad(f.getDate()),e+="T"+c.pad(f.getHours())+":",e+=c.pad(f.getMinutes())+":",e+=c.pad(f.getSeconds())+"Z"+d.dateOffset},a}(H,a,b),f=function(a,b){return a.fn.SPServices.SPDebugXMLHttpResult=function(c){var d,e=a.extend({},{node:null,indent:0},c),f=3,g=4,h="";if(h+="<table class='ms-vb' style='margin-left:"+3*e.indent+"px;' width='100%'>","DisplayPattern"===e.node.nodeName)h+="<tr><td width='100px' style='font-weight:bold;'>"+e.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+e.node.xml+"</textarea></td></tr>";else if(e.node.hasChildNodes())if(e.node.hasChildNodes()&&e.node.firstChild.nodeType===g)h+="<tr><td width='100px' style='font-weight:bold;'>"+e.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+e.node.parentNode.text+"</textarea></td></tr>";else if(e.node.hasChildNodes()&&e.node.firstChild.nodeType===f)h+="<tr><td width='100px' style='font-weight:bold;'>"+e.node.nodeName+"</td><td>"+b.checkLink(e.node.firstChild.nodeValue)+"</td></tr>";else{for(h+="<tr><td width='100px' style='font-weight:bold;' colspan='99'>"+e.node.nodeName+"</td></tr>",e.node.attributes&&(h+="<tr><td colspan='99'>"+b.showAttrs(e.node)+"</td></tr>"),h+="<tr><td>",d=0;d<e.node.childNodes.length;d++)h+=a().SPServices.SPDebugXMLHttpResult({node:e.node.childNodes.item(d),indent:e.indent+1});h+="</td></tr>"}else h+="<tr><td width='100px' style='font-weight:bold;'>"+e.node.nodeName+"</td><td>"+(null!==e.node.nodeValue?b.checkLink(e.node.nodeValue):"&nbsp;")+"</td></tr>",e.node.attributes&&(h+="<tr><td colspan='99'>"+b.showAttrs(e.node)+"</td></tr>");return h+="</table>"},a}(H,b),g=function(a,b,c){return a.fn.SPServices.SPDropdownCtl=function(d){var e=a.extend({},{displayName:""},d),f={};if(1===(f.Obj=a("select[Title='"+e.displayName+"']")).length?f.Type=c.dropdownType.simple:1===(f.Obj=a("input[Title='"+e.displayName+"']")).length?f.Type=c.dropdownType.complex:1===(f.Obj=a("select[ID$='SelectCandidate'][Title^='"+e.displayName+" ']")).length?f.Type=c.dropdownType.multiSelect:1===(f.Obj=a("select[ID$='SelectCandidate'][Title$=': "+e.displayName+"']")).length?f.Type=c.dropdownType.multiSelect:1===(f.Obj=a("select[ID$='SelectCandidate'][Title$='\""+e.displayName+"\".']")).length?f.Type=c.dropdownType.multiSelect:1===(f.Obj=a("select[ID$='SelectCandidate'][Title$=' "+e.displayName+"']")).length?f.Type=c.dropdownType.multiSelect:f.Type=null,null===f.Type){var g=b.findFormField(e.displayName);if(void 0!==g){var h=g.find("select[title^='"+e.displayName+" '][id$='_Lookup']"),i=g.find("select[title^='"+e.displayName+" '][id$='LookupField']"),j=h.length>0?h:i;j&&1===j.length&&(f.Type=c.dropdownType.simple,f.Obj=j)}}if(f.Type===c.dropdownType.complex)f.optHid=a("input[id='"+f.Obj.attr("optHid")+"']");else if(f.Type===c.dropdownType.multiSelect){f.container=f.Obj.closest("span"),f.MultiLookupPickerdata=f.container.find("input[id$='"+b.multiLookupPrefix+"_data'], input[id$='"+b.multiLookupPrefix2013+"_data']");var k=f.container.find("[id$='AddButton']").attr("id");f.master=window[k.replace(/AddButton/,c.multiLookupPrefix+"_m")]||window[k.replace(/AddButton/,c.multiLookupPrefix2013+"_m")]}return f},a}(H,b,a),h=function(a){return a.fn.SPFilterNode=function(a){return this.find("*").filter(function(){return this.nodeName===a})},a}(H),i=function(a,b,c){var d=window.SPServices||{};return a.fn.SPServices.SPGetCurrentSite=function(){var e=c.SPServicesContext();if(e.thisSite.length>0)return e.thisSite;var f=d.SOAPEnvelope.header+"<WebUrlFromPageUrl xmlns='"+b.SCHEMASharePoint+"/soap/' ><pageUrl>"+(location.href.indexOf("?")>0?location.href.substr(0,location.href.indexOf("?")):location.href)+"</pageUrl></WebUrlFromPageUrl>"+d.SOAPEnvelope.footer;return a.ajax({async:!1,url:"/_vti_bin/Webs.asmx",type:"POST",data:f,dataType:"xml",contentType:'text/xml;charset="utf-8"',complete:function(b){e.thisSite=a(b.responseXML).find("WebUrlFromPageUrlResult").text()}}),e.thisSite},a}(H,a,b),j=function(a,b){return a.fn.SPServices.SPGetCurrentUser=function(c){var d=a.extend({},{webURL:"",fieldName:"Name",fieldNames:{},debug:!1},c),e=b.SPServicesContext();if("ID"===d.fieldName&&"undefined"!=typeof e.thisUserId)return e.thisUserId;var f,g="",h={},i=d.fieldNames.length>0?d.fieldNames.length:1,j=d.webURL.length>0?d.webURL:a().SPServices.SPGetCurrentSite();a.ajax({async:!1,url:("/"===j?"":j)+"/_layouts/userdisp.aspx?Force=True&"+(new Date).getTime(),complete:function(a){f=a}});for(var k=0;i>k;k++){if("ID"===d.fieldNames[k])g=e.thisUserId;else{var l;l=i>1?RegExp('FieldInternalName="'+d.fieldNames[k]+'"',"gi"):RegExp('FieldInternalName="'+d.fieldName+'"',"gi"),a(f.responseText).find("table.ms-formtable td[id^='SPField']").each(function(){if(l.test(a(this).html())){switch(a(this).attr("id")){case"SPFieldText":g=a(this).text();break;case"SPFieldNote":g=a(this).find("div").html();break;case"SPFieldURL":g=a(this).find("img").attr("src");break;default:g=a(this).text()}return!1}})}"ID"!==d.fieldNames[k]&&(g="undefined"!=typeof g?g.replace(/(^[\s\xA0]+|[\s\xA0]+$)/g,""):null),i>1&&(h[d.fieldNames[k]]=g)}return i>1?h:g},a}(H,b),k=function(a){return a.fn.SPServices.SPGetDisplayFromStatic=function(b){var c=a.extend({},{webURL:"",listName:"",columnStaticName:"",columnStaticNames:{}},b),d="",e={},f=c.columnStaticNames.length>0?c.columnStaticNames.length:1;return a().SPServices({operation:"GetList",async:!1,cacheXML:!0,webURL:c.webURL,listName:c.listName,completefunc:function(b){if(f>1)for(var g=0;f>g;g++)e[c.columnStaticNames[g]]=a(b.responseXML).find("Field[StaticName='"+c.columnStaticNames[g]+"']").attr("DisplayName");else d=a(b.responseXML).find("Field[StaticName='"+c.columnStaticName+"']").attr("DisplayName")}}),f>1?e:d},a}(H),l=function(a){return a.fn.SPServices.SPGetLastItemId=function(b){var c,d=a.extend({},{webURL:"",listName:"",userAccount:"",CAMLQuery:""},b),e=0;a().SPServices({operation:"GetUserInfo",webURL:d.webURL,async:!1,userLoginName:""!==d.userAccount?d.userAccount:a().SPServices.SPGetCurrentUser(),completefunc:function(b){a(b.responseXML).find("User").each(function(){c=a(this).attr("ID")})}});var f="<Query><Where>";return d.CAMLQuery.length>0&&(f+="<And>"),f+="<Eq><FieldRef Name='Author' LookupId='TRUE'/><Value Type='Integer'>"+c+"</Value></Eq>",d.CAMLQuery.length>0&&(f+=d.CAMLQuery+"</And>"),f+="</Where><OrderBy><FieldRef Name='Created_x0020_Date' Ascending='FALSE'/></OrderBy></Query>",a().SPServices({operation:"GetListItems",async:!1,webURL:d.webURL,listName:d.listName,CAMLQuery:f,CAMLViewFields:"<ViewFields><FieldRef Name='ID'/></ViewFields>",CAMLRowLimit:1,CAMLQueryOptions:"<QueryOptions><ViewAttributes Scope='Recursive' /></QueryOptions>",completefunc:function(b){a(b.responseXML).SPFilterNode("z:row").each(function(){e=a(this).attr("ows_ID")})}}),e},a}(H),m=function(a,b){return a.fn.SPServices.SPGetListItemsJson=function(c){var d,e=a.extend({},{webURL:"",listName:"",viewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:"",CAMLQueryOptions:"",changeToken:"",contains:"",mapping:null,mappingOverrides:null,debug:!1},a().SPServices.defaults,c),f={},g=[],h=a.Deferred(),i=a().SPServices({operation:"GetListItemChangesSinceToken",webURL:e.webURL,listName:e.listName,viewName:e.viewName,CAMLQuery:e.CAMLQuery,CAMLViewFields:e.CAMLViewFields,CAMLRowLimit:e.CAMLRowLimit,CAMLQueryOptions:e.CAMLQueryOptions,changeToken:e.changeToken,contains:e.contains});return i.then(function(){var c="SPGetListItemsJson"+e.webURL+e.listName,j=a(i.responseXML);if(d=j.find("Changes").attr("LastChangeToken"),j.find("listitems Changes Id[ChangeType='Delete']").each(function(){g.push(a(this).text())}),null===e.mapping?j.find("List > Fields > Field").each(function(){var c=a(this),d=c.attr("Type");a.inArray(d,b.spListFieldTypes)>=0&&(f["ows_"+c.attr("Name")]={mappedName:c.attr("Name"),objectType:c.attr("Type")})}):f=e.mapping,null!==e.mappingOverrides)for(var k in e.mappingOverrides)f[k]=e.mappingOverrides[k];a.isEmptyObject(f)?f=a(document).data(c):a(document).data(c,f);var l=j.SPFilterNode("z:row").SPXmlToJson({mapping:f,sparse:!0}),m={changeToken:d,mapping:f,data:l,deletedIds:g};h.resolveWith(m)},function(a){h.rejectWith(a)}),h.promise()},a}(H,a),n=function(a){return a.fn.SPServices.SPGetQueryString=function(b){for(var c=a.extend({},{lowercase:!1},b),d={},e=location.search.slice(1).split("&"),f=0;f<e.length;f++){var g=e[f].split("="),h=c.lowercase?g[0].toLowerCase():g[0];d[h]=decodeURIComponent(g[1]||"")}return d},a}(H),o=function(a){return a.fn.SPServices.SPGetStaticFromDisplay=function(b){var c=a.extend({},{webURL:"",listName:"",columnDisplayName:"",columnDisplayNames:{}},b),d="",e={},f=c.columnDisplayNames.length>0?c.columnDisplayNames.length:1;return a().SPServices({operation:"GetList",async:!1,cacheXML:!0,webURL:c.webURL,listName:c.listName,completefunc:function(b){if(f>1)for(var g=0;f>g;g++)e[c.columnDisplayNames[g]]=a(b.responseXML).find("Field[DisplayName='"+c.columnDisplayNames[g]+"']").attr("StaticName");else d=a(b.responseXML).find("Field[DisplayName='"+c.columnDisplayName+"']").attr("StaticName")}}),f>1?e:d},a}(H),p=function(a,b,c){return a.fn.SPServices.SPListNameFromUrl=function(d){var e=a.extend({},{listName:""},d),f=c.SPServicesContext();if(e.listName.length>0)return e.listName;if(void 0!==f.thisList&&f.thisList.length>0)return f.thisList;var g=location.href,h=g.substring(0,g.indexOf(".aspx")),i=decodeURIComponent(h.substring(0,h.lastIndexOf(b.SLASH)+1)).toUpperCase();return a().SPServices({operation:"GetListCollection",async:!1,completefunc:function(c){a(c.responseXML).find("List").each(function(){var c=a(this).attr("DefaultViewUrl"),d=c.substring(0,c.lastIndexOf(b.SLASH)+1).toUpperCase();return i.indexOf(d)>0?(f.thisList=a(this).attr("ID"),!1):void 0})}}),f.thisList},a}(H,a,b),q=function(a,b,c){function d(a,b){var c={Integer:e(a),Number:f(a),Boolean:g(a),DateTime:h(a),User:i(a),UserMulti:j(a),Lookup:k(a),lookupMulti:l(a),MultiChoice:m(a),Calculated:p(a),Attachments:n(a),URL:o(a),JSON:q(a),Text:c.Default(a),Counter:c.Integer(a),datetime:c.DateTime(a),AllDayEvent:c.Boolean(a),Recurrence:c.Boolean(a),Currency:c.Number(a),"float":c.Number(a),RelatedItems:c.JSON(a),Default:a};return void 0!==c[b]?c.objectType(a):a}function e(a){return parseInt(a,10)}function f(a){return parseFloat(a)}function g(a){return"0"!==a}function h(a){var b=a.split("T")[0]!==a?a.split("T"):a.split(" "),c=b[0].split("-"),d=b[1].split(":"),e=d[2].split("Z");return new Date(c[0],c[1]-1,c[2],d[0],d[1],e[0])}function i(a){if(0===a.length)return null;var b=new c.SplitIndex(a),d=b.value.split(",#");return 1===d.length?{userId:b.id,userName:b.value}:{userId:b.id,userName:d[0].replace(/(,,)/g,","),loginName:d[1].replace(/(,,)/g,","),email:d[2].replace(/(,,)/g,","),sipAddress:d[3].replace(/(,,)/g,","),title:d[4].replace(/(,,)/g,",")}}function j(a){if(0===a.length)return null;for(var c=[],d=a.split(b.spDelim),e=0;e<d.length;e+=2){var f=i(d[e]+b.spDelim+d[e+1]);c.push(f)}return c}function k(a){if(0===a.length)return null;var c=a.split(b.spDelim);return{lookupId:c[0],lookupValue:c[1]}}function l(a){if(0===a.length)return null;for(var c=[],d=a.split(b.spDelim),e=0;e<d.length;e+=2){var f=k(d[e]+b.spDelim+d[e+1]);c.push(f)}return c}function m(a){if(0===a.length)return null;for(var c=[],d=a.split(b.spDelim),e=0;e<d.length;e++)0!==d[e].length&&c.push(d[e]);return c}function n(a){if(0===a.length)return null;if("0"===a||"1"===a)return a;for(var c=[],d=a.split(b.spDelim),e=0;e<d.length;e++)if(0!==d[e].length){var f=d[e];if(-1!==d[e].lastIndexOf("/")){var g=d[e].split("/");f=g[g.length-1]}c.push({attachment:d[e],fileName:f})}return c}function o(a){if(0===a.length)return null;var b=a.split(", ");return{Url:b[0],Description:b[1]}}function p(a){if(0===a.length)return null;var c=a.split(b.spDelim);return d(c[1],c[0])}function q(b){return 0===b.length?null:a.parseJSON(b)}return a.fn.SPXmlToJson=function(b){var c,e=a.extend({},{mapping:{},includeAllAttrs:!1,removeOws:!0,sparse:!1},b),f=[];return this.each(function(){var b={},g=this.attributes;for(e.sparse||a.each(e.mapping,function(){b[this.mappedName]=""}),c=0;c<g.length;c++){var h=g[c].name,i=e.mapping[h],j="undefined"!=typeof i?i.mappedName:e.removeOws?h.split("ows_")[1]:h,k="undefined"!=typeof i?i.objectType:void 0;(e.includeAllAttrs||void 0!==i)&&(b[j]=d(g[c].value,k))}f.push(b)}),f},a}(H,a,b),r=function(a,b){return a.fn.SPServices.SPArrangeChoices=function(c){var d=a.extend({},{listName:a().SPServices.SPListNameFromUrl(),columnName:"",perRow:99,randomize:!1},c),e=!1,f=[],g=a().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:d.listName});g.done(function(){a(g.responseXML).find("Field[DisplayName='"+d.columnName+"']").each(function(){return e="TRUE"===a(this).attr("FillInChoice"),!1});var c,h,i=b.findFormField(d.columnName),j=a(i).find("tr").length;a(i).find("tr").each(function(b){e&&b===j-2?c=a(this).find("td"):e&&b===j-1?h=a(this).find("td"):f.push(a(this).find("td"))}),d.randomize&&f.sort(b.randOrd);for(var k=a("<table cellpadding='0' cellspacing='1'></table>"),l=0;l<f.length;l++)(l+1)%d.perRow===0&&k.append("<tr></tr>"),k.append(f[l]);if(e){var m=a("<tr><td colspan='99'><table cellpadding='0' cellspacing='1'><tr></tr></table></td></tr>");m.find("tr").append(c),m.find("tr").append(h),k.append(m)}var n=a(i).find("table:first");n.before(k),n.hide()})},a}(H,b),s=function(a,b){return a.fn.SPServices.SPAutocomplete=function(c){var d,e=a.extend({},{webURL:"",sourceList:"",sourceColumn:"",columnName:"",listName:a().SPServices.SPListNameFromUrl(),CAMLQuery:"",CAMLQueryOptions:"<QueryOptions></QueryOptions>",CAMLRowLimit:0,filterType:"BeginsWith",numChars:0,ignoreCase:!1,highlightClass:"",uniqueVals:!1,maxHeight:99999,slideDownSpeed:"fast",processingIndicator:"_layouts/images/REFRESH.GIF",debug:!1},c),f=b.findFormField(e.columnName).find("input[Title^='"+e.columnName+"']");f.css("position","");var g=f.css("color"),h=f.css("width");if(null===f.html()&&e.debug)return void b.errBox("SPServices.SPAutocomplete","columnName: "+e.columnName,"Column is not an input control or is not found on page");f.closest("span").find("br").remove(),f.wrap("<div>");var i=b.genContainerId("SPAutocomplete",e.columnName,e.listName);f.after("<div><ul id='"+i+"' style='width:"+h+";display:none;padding:2px;border:1px solid #2A1FAA;background-color:#FFF;position:absolute;z-index:40;margin:0'></div>");var j=a("#"+i);j.css("width",h),a(f).keyup(function(){var b=a(this).val();if(j.hide(),b.length<e.numChars)return!1;f.css({"background-image":"url("+e.processingIndicator+")","background-position":"right","background-repeat":"no-repeat"});var c=[],h="<Query><OrderBy><FieldRef Name='"+e.sourceColumn+"'/></OrderBy><Where>";e.CAMLQuery.length>0&&(h+="<And>"),h+="<"+e.filterType+"><FieldRef Name='"+e.sourceColumn+"'/><Value Type='Text'>"+b+"</Value></"+e.filterType+">",e.CAMLQuery.length>0&&(h+=e.CAMLQuery+"</And>"),h+="</Where></Query>",a().SPServices({operation:"GetListItems",async:!1,webURL:e.WebURL,listName:e.sourceList,CAMLQuery:h,CAMLQueryOptions:e.CAMLQueryOptions,CAMLViewFields:"<ViewFields><FieldRef Name='"+e.sourceColumn+"' /></ViewFields>",CAMLRowLimit:e.CAMLRowLimit,completefunc:function(d){var f=e.ignoreCase?b.toUpperCase():b;a(d.responseXML).SPFilterNode("z:row").each(function(){var b=a(this).attr("ows_"+e.sourceColumn),d=e.ignoreCase?a(this).attr("ows_"+e.sourceColumn).toUpperCase():a(this).attr("ows_"+e.sourceColumn);if("Contains"===e.filterType){var g=d.indexOf(f);g>=0&&(!e.uniqueVals||-1===a.inArray(b,c))&&c.push(a(this).attr("ows_"+e.sourceColumn))}else f!==d.substr(0,f.length)||e.uniqueVals&&-1!==a.inArray(b,c)||c.push(a(this).attr("ows_"+e.sourceColumn))})}});for(var k="",l=0;l<c.length;l++){if(e.highlightClass.length>0){var m=new RegExp(b,e.ignoreCase?"gi":"g"),n=c[l].match(m),o=0;for(d=0;d<n.length;d++){var p=c[l].indexOf(n[d],o),q=p+n[d].length,r="<span class='"+e.highlightClass+"'>"+n[d]+"</span>";c[l]=c[l].substr(0,p)+r+c[l].substr(q),o=p+r.length}}k+="<li style='display: block;position: relative;cursor: pointer;'>"+c[l]+"</li>"}j.html(k),a("#"+i+" li").click(function(){a("#"+i).fadeOut(e.slideUpSpeed),f.val(a(this).text())}).mouseover(function(){var b={cursor:"hand",color:"#ffffff",background:"#3399ff"};a(this).css(b)}).mouseout(function(){var b={cursor:"inherit",color:g,background:"transparent"};a(this).css(b)}),c.length>0&&a("#"+i).slideDown(e.slideDownSpeed),f.css("background-image","")})},a}(H,b),t=function(a,b,c){function d(d){var e,f,g,h,i,j="",k=null,l=d.Obj.data("SPCascadeDropdownsChildColumns");a(l).each(function(){var l,m=this.opt,n=this.childSelect,o=this.childColumnStatic,p=this.childColumnRequired;e=c.getDropdownSelected(d,m.matchOnId);var q=e.join(b.spDelim);if(d.Obj.data("SPCascadeDropdown_Selected_"+o)!==q){d.Obj.data("SPCascadeDropdown_Selected_"+o,q),k=c.getDropdownSelected(n,!0);var r=m.relationshipListSortColumn.length>0?m.relationshipListSortColumn:m.relationshipListChildColumn,s="<Query><OrderBy><FieldRef Name='"+r+"'/></OrderBy><Where><And>";if(m.CAMLQuery.length>0&&(s+="<And>"),0===e.length)s+="<Eq><FieldRef Name='"+m.relationshipListParentColumn+"'/><Value Type='Text'></Value></Eq>";else if(1===e.length)s+="<Eq><FieldRef Name='"+m.relationshipListParentColumn+(m.matchOnId?"' LookupId='True'/><Value Type='Integer'>":"'/><Value Type='Text'>")+c.escapeColumnValue(e[0])+"</Value></Eq>";else{var t=e.length>2;for(l=0;l<e.length-1;l++)s+="<Or>";for(l=0;l<e.length;l++)s+="<Eq><FieldRef Name='"+m.relationshipListParentColumn+(m.matchOnId?"' LookupId='True'/><Value Type='Integer'>":"'/><Value Type='Text'>")+c.escapeColumnValue(e[l])+"</Value></Eq>",l>0&&l<e.length-1&&t&&(s+="</Or>");s+="</Or>"}m.CAMLQuery.length>0&&(s+=m.CAMLQuery+"</And>"),s+="<IsNotNull><FieldRef Name='"+m.relationshipListChildColumn+"' /></IsNotNull>",s+="</And></Where></Query>",a().SPServices({operation:"GetListItems",async:!1,webURL:m.relationshipWebURL,listName:m.relationshipList,CAMLQuery:s,CAMLViewFields:"<ViewFields><FieldRef Name='"+m.relationshipListParentColumn+"' /><FieldRef Name='"+m.relationshipListChildColumn+"' /></ViewFields>",CAMLRowLimit:0,CAMLQueryOptions:m.CAMLQueryOptions,completefunc:function(d){switch(a(d.responseXML).find("errorstring").each(function(){var b="SPServices.SPCascadeDropdowns",d=a(this).text();m.debug&&"One or more field types are not installed properly. Go to the list settings page to delete these fields."===d?c.errBox(b,"relationshipListParentColumn: "+m.relationshipListParentColumn+" or relationshipListChildColumn: "+m.relationshipListChildColumn,"Not found in relationshipList "+m.relationshipList):m.debug&&"Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)."===d&&c.errBox(b,"relationshipList: "+m.relationshipList,"List not found")}),n.Type){case b.dropdownType.simple:n.Obj[0].innerHTML="",!p&&m.promptText.length>0?n.Obj.append("<option value='0'>"+m.promptText.replace(/\{0\}/g,m.childColumn)+"</option>"):p||n.Obj.append("<option value='0'>"+m.noneText+"</option>");break;case b.dropdownType.complex:j=p?"":m.noneText+"|0",n.Obj.val("");break;case b.dropdownType.multiSelect:a(n.master.candidateControl).find("option").remove(),f=""}switch(g=parseFloat(a(d.responseXML).SPFilterNode("rs:data").attr("ItemCount")),a(d.responseXML).SPFilterNode("z:row").each(function(){var d={},e=a(this).attr("ows_"+m.relationshipListChildColumn);switch("undefined"!=typeof e&&e.indexOf(b.spDelim)>0?d=new c.SplitIndex(e):(d.id=a(this).attr("ows_ID"),d.value=e),isNaN(d.id)&&(d.id=a(this).attr("ows_ID")),h=d.id,i=d.value,n.Type){case b.dropdownType.simple:var g=a(this).attr("ows_ID")===k[0]?" selected='selected'":"";n.Obj.append("<option"+g+" value='"+d.id+"'>"+d.value+"</option>");break;case b.dropdownType.complex:d.id===k[0]&&n.Obj.val(d.value),j=j+(j.length>0?"|":"")+d.value+"|"+d.id;break;case b.dropdownType.multiSelect:a(n.master.candidateControl).append("<option value='"+d.id+"'>"+d.value+"</option>"),f+=d.id+"|t"+d.value+"|t |t |t"}}),n.Type){case b.dropdownType.simple:n.Obj.trigger("change"),1===g&&m.selectSingleOption===!0&&a(n.Obj).find("option[value!='0']:first").attr("selected","selected");break;case b.dropdownType.complex:n.Obj.attr("choices",j),1===g&&m.selectSingleOption===!0&&(a(n.Obj).val(i),n.optHid.val(h)),""===n.Obj.val()&&n.optHid.val("");break;case b.dropdownType.multiSelect:n.master.data="",n.MultiLookupPickerdata.val(f),a(n.master.resultControl).find("option").each(function(){var b=a(this);b.prop("selected",!0),a(n.master.candidateControl).find("option[value='"+b.val()+"']").each(function(){b.prop("selected",!1)})}),GipRemoveSelectedItems(n.master),a(n.master.candidateControl).find("option").each(function(){var b=a(this);a(n.master.resultControl).find("option[value='"+b.val()+"']").each(function(){b.remove()})}),GipAddSelectedItems(n.master),n.master.data=GipGetGroupData(f),a(n.master.candidateControl).trigger("dblclick")}}}),null!==m.completefunc&&m.completefunc()}})}return a.fn.SPServices.SPCascadeDropdowns=function(e){var f=a.extend({},{relationshipWebURL:"",relationshipList:"",relationshipListParentColumn:"",relationshipListChildColumn:"",relationshipListSortColumn:"",parentColumn:"",childColumn:"",listName:a().SPServices.SPListNameFromUrl(),CAMLQuery:"",CAMLQueryOptions:"<QueryOptions><IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns></QueryOptions>",promptText:"",noneText:"(None)",simpleChild:!1,selectSingleOption:!1,matchOnId:!1,completefunc:null,debug:!1},e),g=!1,h="SPServices.SPCascadeDropdowns",i=a().SPServices.SPDropdownCtl({displayName:f.parentColumn});if(null===i.Obj.html()&&f.debug)return void c.errBox(h,"parentColumn: "+f.parentColumn,b.TXTColumnNotFound);var j=a().SPServices.SPDropdownCtl({displayName:f.childColumn});if(null===j.Obj.html()&&f.debug)return void c.errBox(h,"childColumn: "+f.childColumn,b.TXTColumnNotFound);f.simpleChild===!0&&j.Type===b.dropdownType.complex&&(a().SPServices.SPComplexToSimpleDropdown({listName:f.listName,columnName:f.childColumn}),j=a().SPServices.SPDropdownCtl({displayName:f.childColumn}));var k,l;a().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:f.listName,completefunc:function(b){a(b.responseXML).find("Fields").each(function(){a(this).find("Field[DisplayName='"+f.childColumn+"']").each(function(){return k="TRUE"===a(this).attr("Required"),l=a(this).attr("StaticName"),!1})})}});var m={opt:f,childSelect:j,childColumnStatic:l,childColumnRequired:k},n=i.Obj.data("SPCascadeDropdownsChildColumns");if("undefined"==typeof n?i.Obj.data("SPCascadeDropdownsChildColumns",[m]):(n.push(m),i.Obj.data("SPCascadeDropdownsChildColumns",n),g=!0),!g)switch(i.Type){case b.dropdownType.simple:i.Obj.bind("change",function(){d(i)});break;case b.dropdownType.complex:i.optHid.bind("propertychange",function(){d(i)});break;case b.dropdownType.multiSelect:a(i.master.candidateControl).bind("dblclick",function(){d(i)}),a(i.master.resultControl).bind("dblclick",function(){d(i)}),a(i.master.addControl).bind("click",function(){d(i)}),a(i.master.removeControl).bind("click",function(){d(i)})}d(i)},a}(H,a,b),u=function(a,b,c){return a.fn.SPServices.SPComplexToSimpleDropdown=function(d){var e=a.extend({},{listName:a().SPServices.SPListNameFromUrl(),columnName:"",completefunc:null,debug:!1},d),f=a().SPServices.SPDropdownCtl({displayName:e.columnName});if(null===f.Obj.html()&&e.debug)return void c.errBox("SPServices.SPComplexToSimpleDropdown","columnName: "+e.columnName,b.TXTColumnNotFound);if(f.Type===b.dropdownType.complex){for(var g=a(f.Obj).attr("choices").split("|"),h=f.optHid.val(),i=c.genContainerId("SPComplexToSimpleDropdown",f.Obj.attr("title"),e.listName),j="<select id='"+i+"' title='"+e.columnName+"'>",k=0;k<g.length;k+=2){var l=g[k+1]===h?" selected='selected' ":" ";j+="<option"+l+"value='"+g[k+1]+"'>"+g[k]+"</option>"}j+="</select>",f.Obj.closest("td").prepend(j);var m=a("#"+i);f.Obj.closest("span").find("img").remove(),f.Obj.closest("span").find("input").hide(),m.change(function(){var b=a(this).val();f.optHid.val(b),a(f.Obj).val(a(this).find("option[value='"+("0"!==b?b:"")+"']").html())}),m.trigger("change"),null!==e.completefunc&&e.completefunc()}},a}(H,a,b),v=function(a,b,c){function d(d,f,g,h){var i,j,k="SPServices.SPDisplayRelatedInfo",l=a().SPServices.SPDropdownCtl({displayName:d.columnName});if(j=c.getDropdownSelected(l,d.matchOnId),!(l.Type===b.dropdownType.complex&&d.numChars>0&&j[0].length<d.numChars)&&l.Obj.attr("showRelatedSelected")!==j[0]){l.Obj.attr("showRelatedSelected",j[0]),a("#"+f).remove(),l.Obj.parent().append("<div id="+f+"></div>");var m="<Query><Where>";d.CAMLQuery.length>0&&(m+="<And>");var n=h[d.relatedListColumn].attr("Type");m+="Lookup"===n?"<Eq><FieldRef Name='"+d.relatedListColumn+(d.matchOnId?"' LookupId='True'/><Value Type='Integer'>":"'/><Value Type='Text'>")+c.escapeColumnValue(j[0])+"</Value></Eq>":"<Eq><FieldRef Name='"+(d.matchOnId?"ID' /><Value Type='Counter'>":d.relatedListColumn+"'/><Value Type='Text'>")+c.escapeColumnValue(j[0])+"</Value></Eq>",
d.CAMLQuery.length>0&&(m+=d.CAMLQuery+"</And>"),m+="</Where></Query>";var o=" ";for(i=0;i<d.relatedColumns.length;i++)o+="<FieldRef Name='"+d.relatedColumns[i]+"' />";a().SPServices({operation:"GetListItems",async:!1,webURL:d.relatedWebURL,listName:d.relatedList,CAMLQuery:m,CAMLViewFields:"<ViewFields>"+o+"</ViewFields>",CAMLRowLimit:0,completefunc:function(b){a(b.responseXML).find("errorstring").each(function(){var b=a(this).text();d.debug&&"One or more field types are not installed properly. Go to the list settings page to delete these fields."===b?c.errBox(k,"relatedListColumn: "+d.relatedListColumn,"Column not found in relatedList "+d.relatedList):d.debug&&"Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)."===b&&c.errBox(k,"relatedList: "+d.relatedList,"List not found")});var j;switch(d.displayFormat){case"table":for(j="<table>",j+="<tr>",i=0;i<d.relatedColumns.length;i++){if("undefined"==typeof h[d.relatedColumns[i]]&&d.debug)return void c.errBox(k,"columnName: "+d.relatedColumns[i],"Column not found in relatedList");j+="<th class='"+d.headerCSSClass+"'>"+h[d.relatedColumns[i]].attr("DisplayName")+"</th>"}j+="</tr>",a(b.responseXML).SPFilterNode("z:row").each(function(){for(j+="<tr>",i=0;i<d.relatedColumns.length;i++)j+="<td class='"+d.rowCSSClass+"'>"+e(g,h[d.relatedColumns[i]],a(this).attr("ows_"+d.relatedColumns[i]),d)+"</td>";j+="</tr>"}),j+="</table>";break;case"list":j="<table>",a(b.responseXML).SPFilterNode("z:row").each(function(){for(i=0;i<d.relatedColumns.length;i++){if("undefined"==typeof h[d.relatedColumns[i]]&&d.debug)return void c.errBox(k,"columnName: "+d.relatedColumns[i],"Column not found in relatedList");j+="<tr>",j+="<th class='"+d.headerCSSClass+"'>"+h[d.relatedColumns[i]].attr("DisplayName")+"</th>",j+="<td class='"+d.rowCSSClass+"'>"+e(g,h[d.relatedColumns[i]],a(this).attr("ows_"+d.relatedColumns[i]),d)+"</td>",j+="</tr>"}}),j+="</table>"}a("#"+f).html(j)}}),null!==d.completefunc&&d.completefunc()}}function e(d,e,f,g){if("undefined"==typeof f)return"";var h,i,j,k="",l="",m=[],n=g.relatedWebURL.length>0?g.relatedWebURL:a().SPServices.SPGetCurrentSite();switch(e.attr("Type")){case"Text":k=f;break;case"URL":switch(e.attr("Format")){case"Hyperlink":k="<a href='"+f.substring(0,f.search(","))+"'>"+f.substring(f.search(",")+1)+"</a>";break;case"Image":k="<img alt='"+f.substring(f.search(",")+1)+"' src='"+f.substring(0,f.search(","))+"'/>";break;default:k=f}break;case"User":case"UserMulti":var o=f.split(b.spDelim);for(h=0;h<o.length;h+=2)m.push("<a href='/_layouts/userdisp.aspx?ID="+o[h]+"&Source="+c.escapeUrl(location.href)+"'>"+o[h+1]+"</a>");k=m.join(", ");break;case"Calculated":var p=f.split(b.spDelim);k=p[1];break;case"Number":j=e.attr("Decimals"),k="undefined"==typeof j?parseFloat(f).toString():parseFloat(f).toFixed(j).toString();break;case"Currency":j=e.attr("Decimals"),k="undefined"==typeof j?parseFloat(f).toFixed(2).toString():parseFloat(f).toFixed(j).toString();break;case"Lookup":switch(e.attr("Name")){case"FileRef":i="1"===d.attr("BaseType")?d.attr("RootFolder")+b.SLASH+"Forms/DispForm.aspx":d.attr("RootFolder")+b.SLASH+"DispForm.aspx",k="<a href='"+i+"?ID="+f.substring(0,f.search(b.spDelim))+"&RootFolder=*&Source="+c.escapeUrl(location.href)+"'>"+f.substring(f.search(b.spDelim)+2)+"</a>";break;case"FileDirRef":i=b.SLASH+f.substring(f.search(b.spDelim)+2),k="<a href='"+i+"'>"+f.substring(f.search(b.spDelim)+2)+"</a>";break;default:i=c.getListFormUrl(e.attr("List"),"DisplayForm"),k="<a href='"+g.relatedWebURL+b.SLASH+i+"?ID="+f.substring(0,f.search(b.spDelim))+"&RootFolder=*&Source="+c.escapeUrl(location.href)+"'>"+f.substring(f.search(b.spDelim)+2)+"</a>"}break;case"LookupMulti":if(i=c.getListFormUrl(e.attr("List"),"DisplayForm"),k="",f.length>0){var q=f.split(b.spDelim);for(h=0;h<q.length/2;h++)m.push("<a href='"+n+b.SLASH+i+"?ID="+q[2*h]+"&RootFolder=*&Source="+c.escapeUrl(location.href)+"'>"+q[2*h+1]+"</a>")}k=m.join(", ");break;case"File":l=f.substring(f.search(b.spDelim)+2),k="<a href='"+d.attr("RootFolder")+b.SLASH+l+"'>"+l+"</a>";break;case"Counter":k=f;break;case"DateTime":k=f;break;default:k=f}return k}return a.fn.SPServices.SPDisplayRelatedInfo=function(e){var f,g,h,i=a.extend({},{listName:a().SPServices.SPListNameFromUrl(),columnName:"",relatedWebURL:"",relatedList:"",relatedListColumn:"",relatedColumns:[],displayFormat:"table",headerCSSClass:"ms-vh2",rowCSSClass:"ms-vb",CAMLQuery:"",numChars:0,matchType:"Eq",matchOnId:!1,completefunc:null,debug:!1},e),j=[],k="SPServices.SPDisplayRelatedInfo",l=a().SPServices.SPDropdownCtl({displayName:i.columnName});if(null===l.Obj.html()&&i.debug)return void c.errBox(k,"columnName: "+i.columnName,b.TXTColumnNotFound);switch(g=c.genContainerId("SPDisplayRelatedInfo",i.columnName,i.listName),a().SPServices({operation:"GetList",async:!1,cacheXML:!0,webURL:i.relatedWebURL,listName:i.relatedList,completefunc:function(b){for(a(b.responseXML).find("faultcode").each(function(){i.debug&&c.errBox(k,"relatedList: "+i.relatedList,"List not found")}),h=a(b.responseXML).find("List"),f=0;f<i.relatedColumns.length;f++)j[i.relatedColumns[f]]=a(b.responseXML).find("Fields > Field[Name='"+i.relatedColumns[f]+"']");j[i.relatedListColumn]=a(b.responseXML).find("Fields > Field[Name='"+i.relatedListColumn+"']")}}),l.Type){case b.dropdownType.simple:l.Obj.bind("change",function(){d(i,g,h,j)});break;case b.dropdownType.complex:l.optHid.bind("propertychange",function(){d(i,g,h,j)});break;case b.dropdownType.multiSelect:i.debug&&c.errBox(k,"columnName: "+i.columnName,"Multi-select columns not supported by this function")}d(i,g,h,j)},a}(H,a,b),w=function(a,b,c){return a.fn.SPServices.SPFilterDropdown=function(d){var e,f,g=a.extend({},{relationshipWebURL:"",relationshipList:"",relationshipListColumn:"",relationshipListSortColumn:"",relationshipListSortAscending:!0,columnName:"",listName:a().SPServices.SPListNameFromUrl(),promptText:"",noneText:"(None)",CAMLQuery:"",CAMLQueryOptions:"<QueryOptions><IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns><ViewAttributes Scope='RecursiveAll'/></QueryOptions>",completefunc:null,debug:!1},d),h="",i=null,j="SPServices.SPFilterDropdown",k=a().SPServices.SPDropdownCtl({displayName:g.columnName});if(null===k.Obj.html()&&g.debug)return void c.errBox(j,"columnName: "+g.columnName,b.TXTColumnNotFound);i=c.getDropdownSelected(k,!0);var l=g.relationshipListSortColumn.length>0?g.relationshipListSortColumn:g.relationshipListColumn,m=g.relationshipListSortAscending===!0?"":"Ascending='FALSE'",n="<Query><OrderBy><FieldRef Name='"+l+"' "+m+"/></OrderBy><Where>";g.CAMLQuery.length>0&&(n+=g.CAMLQuery),n+="</Where></Query>",a().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:g.listName,completefunc:function(b){a(b.responseXML).find("Fields").each(function(){a(this).find("Field[DisplayName='"+g.columnName+"']").each(function(){return f="TRUE"===a(this).attr("Required"),!1})})}}),a().SPServices({operation:"GetListItems",async:!1,webURL:g.relationshipWebURL,listName:g.relationshipList,CAMLQuery:n,CAMLViewFields:"<ViewFields><FieldRef Name='"+g.relationshipListColumn+"' /></ViewFields>",CAMLRowLimit:0,CAMLQueryOptions:g.CAMLQueryOptions,completefunc:function(d){switch(a(d.responseXML).find("errorstring").each(function(){var b=a(this).text();g.debug&&"One or more field types are not installed properly. Go to the list settings page to delete these fields."===b?c.errBox(j,"relationshipListColumn: "+g.relationshipListColumn,"Not found in relationshipList "+g.relationshipList):g.debug&&"Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)."===b&&c.errBox(j,"relationshipList: "+g.relationshipList,"List not found")}),k.Type){case b.dropdownType.simple:a(k.Obj).find("option").remove(),!f&&g.promptText.length>0?k.Obj.append("<option value='0'>"+g.promptText.replace(/\{0\}/g,g.columnName)+"</option>"):f||k.Obj.append("<option value='0'>"+g.noneText+"</option>");break;case b.dropdownType.complex:h=f?"":g.noneText+"|0",k.Obj.val("");break;case b.dropdownType.multiSelect:a(k.master.candidateControl).find("option").remove(),e=""}switch(a(d.responseXML).SPFilterNode("z:row").each(function(){var d={},f=a(this).attr("ows_"+g.relationshipListColumn);switch("undefined"!=typeof f&&f.indexOf(b.spDelim)>0?d=new c.SplitIndex(f):(d.id=a(this).attr("ows_ID"),d.value=f),isNaN(d.id)&&(d.id=a(this).attr("ows_ID")),k.Type){case b.dropdownType.simple:var j=a(this).attr("ows_ID")===i[0]?" selected='selected'":"";k.Obj.append("<option"+j+" value='"+d.id+"'>"+d.value+"</option>");break;case b.dropdownType.complex:d.id===i[0]&&k.Obj.val(d.value),h=h+(h.length>0?"|":"")+d.value+"|"+d.id;break;case b.dropdownType.multiSelect:a(k.master.candidateControl).append("<option value='"+d.id+"'>"+d.value+"</option>"),e+=d.id+"|t"+d.value+"|t |t |t"}}),k.Type){case b.dropdownType.simple:k.Obj.trigger("change");break;case b.dropdownType.complex:k.Obj.attr("choices",h),k.Obj.trigger("propertychange");break;case b.dropdownType.multiSelect:k.master.data="",k.MultiLookupPickerdata.val(e),a(k.master.resultControl).find("option").each(function(){var b=a(this);a(this).attr("selected","selected"),a(k.master.candidateControl).find("option").each(function(){a(this).html()===b.html()&&b.removeAttr("selected")})}),GipRemoveSelectedItems(k.master),a(k.master.candidateControl).find("option").each(function(){var b=a(this);a(k.master.resultControl).find("option").each(function(){a(this).html()===b.html()&&b.remove()})}),GipAddSelectedItems(k.master),k.master.data=GipGetGroupData(e),a(k.master.candidateControl).trigger("dblclick")}}}),null!==g.completefunc&&g.completefunc()},a}(H,a,b),x=function(a){return a.fn.SPServices.SPFindMMSPicker=function(b){for(var c=a.extend({},{MMSDisplayName:""},b),d=[],e=a("div[title='"+c.MMSDisplayName+"']"),f=e.closest("td").find("input[type='hidden']"),g=f.val().split(";"),h=0;h<g.length;h++){var i=g[h].split("|");d.push({value:i[0],guid:i[1]})}return{terms:d}},a}(H),y=function(a){return a.fn.SPServices.SPFindPeoplePicker=function(b){var c=a.extend({},{peoplePickerDisplayName:"",valueToSet:"",checkNames:!0,checkNamesPhrase:"Check Names"},b),d=a("nobr").filter(function(){return a(this).contents().eq(0).text()===c.peoplePickerDisplayName}).closest("tr"),e=d.find("div[name='upLevelDiv']"),f=d.find("img[Title='"+c.checkNamesPhrase+"']:first");c.valueToSet.length>0&&e.html(c.valueToSet),c.checkNames&&f.click();var g=a.trim(e.text()),h=[];return e.children("span").each(function(){var b=a(this).find("div[data]").attr("data"),c={};if("undefined"!=typeof b){var d=a.parseXML(b),e=a(d);e.find("DictionaryEntry").each(function(){var b=a(this).find("Key").text();c[b]=a(this).find("Value").text()}),h.push(c)}else a().SPServices({operation:"GetUserInfo",async:!1,cacheXML:!0,userLoginName:a(this).attr("title"),completefunc:function(b){a(b.responseXML).find("User").each(function(){a.each(this.attributes,function(a,b){c[b.name]=b.value}),h.push(c)})}})}),{row:d,contents:e,currentValue:g,checkNames:f,dictionaryEntries:h}},a.fn.SPFindPeoplePicker=function(b){return a().SPServices.SPFindPeoplePicker(b)},a}(H),z=function(a,b,c){return a.fn.SPServices.SPLookupAddNew=function(d){var e=a.extend({},{lookupColumn:"",promptText:"Add new {0}",newWindow:!1,ContentTypeID:"",completefunc:null,debug:!1},d),f="SPServices.SPLookupAddNew",g=a().SPServices.SPDropdownCtl({displayName:e.lookupColumn});if(null===g.Obj.html()&&e.debug)return void c.errBox(f,"lookupColumn: "+e.lookupColumn,b.TXTColumnNotFound);var h="",i="",j="";if(a().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:a().SPServices.SPListNameFromUrl(),completefunc:function(d){a(d.responseXML).find("Field[DisplayName='"+e.lookupColumn+"']").each(function(){return j=a(this).attr("StaticName"),a().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:a(this).attr("List"),completefunc:function(c){a(c.responseXML).find("List").each(function(){i=a(this).attr("WebFullUrl"),i=i!==b.SLASH?i+b.SLASH:i})}}),h=c.getListFormUrl(a(this).attr("List"),"NewForm"),!1})}}),0===i.length&&e.debug)return void c.errBox(f,"lookupColumn: "+e.lookupColumn,"This column does not appear to be a lookup column");if(h.length>0){var k=i+h;k+=e.newWindow?(e.ContentTypeID.length>0?"?ContentTypeID="+e.ContentTypeID:"")+"' target='_blank'":"?"+(e.ContentTypeID.length>0?"ContentTypeID="+e.ContentTypeID+"&":"")+"Source="+c.escapeUrl(location.href)+"'";var l="<div id='SPLookupAddNew_"+j+"'><a href='"+k+">"+e.promptText.replace(/\{0\}/g,e.lookupColumn)+"</a></div>";a(g.Obj).parents("td.ms-formbody").append(l)}else if(e.debug)return void c.errBox(f,"lookupColumn: "+e.lookupColumn,"NewForm cannot be found");null!==e.completefunc&&e.completefunc()},a}(H,a,b),A=function(a){return a.fn.SPServices.SPRedirectWithID=function(b){var c=a.extend({},{redirectUrl:"",qsParamName:"ID"},b),d=a().SPServices.SPListNameFromUrl(),e=a().SPServices.SPGetQueryString(),f=e.ID,g=e.List,h=e.RootFolder,i=e.ContentTypeId;if("undefined"==typeof e.ID)f=a().SPServices.SPGetLastItemId({listName:d}),a("form[id='aspnetForm']").each(function(){var a=location.href.indexOf("?")>0?location.href.substring(0,location.href.indexOf("?")):location.href,b="string"==typeof e.Source?"Source="+e.Source.replace(/\//g,"%2f").replace(/:/g,"%3a"):"",c=[];"undefined"!=typeof g&&c.push("List="+g),"undefined"!=typeof h&&c.push("RootFolder="+h),"undefined"!=typeof i&&c.push("ContentTypeId="+i);var d=a+(c.length>0?"?"+c.join("&")+"&":"?")+"Source="+a+"?ID="+f+(b.length>0?"%26RealSource="+e.Source:"")+("string"==typeof e.RedirectURL?"%26RedirectURL="+e.RedirectURL:"");setTimeout(function(){document.forms.aspnetForm.action=d},0)});else{for(;e.ID===f;)f=a().SPServices.SPGetLastItemId({listName:d});var j="string"==typeof e.RedirectURL?e.RedirectURL:c.redirectUrl;location.href=j+"?"+c.qsParamName+"="+f+("string"==typeof e.RealSource?"&Source="+e.RealSource:"")}},a}(H),B=function(a,b){return a.fn.SPServices.SPRequireUnique=function(c){var d=a.extend({},{columnStaticName:"Title",duplicateAction:0,ignoreCase:!1,initMsg:"This value must be unique.",initMsgCSSClass:"ms-vb",errMsg:"This value is not unique.",errMsgCSSClass:"ms-formvalidation",showDupes:!1,completefunc:null},c),e=a().SPServices.SPGetQueryString(),f=e.ID,g=a().SPServices.SPListNameFromUrl(),h="<span id='SPRequireUnique"+d.columnStaticName+"' class='{0}'>{1}</span><br/>",i=h.replace(/\{0\}/g,d.initMsgCSSClass).replace(/\{1\}/g,d.initMsg),j=a().SPServices.SPGetDisplayFromStatic({listName:g,columnStaticName:d.columnStaticName}),k=b.findFormField(j).find("input[Title^='"+j+"']");k.parent().append(i),k.blur(function(){var b=[],c=a(this).val();if(0===c.length)return!1;a().SPServices({operation:"GetListItems",async:!1,listName:g,CAMLQuery:"<Query><Where><IsNotNull><FieldRef Name='"+d.columnStaticName+"'/></IsNotNull></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='ID' /><FieldRef Name='"+d.columnStaticName+"' /></ViewFields>",CAMLRowLimit:0,completefunc:function(e){var g=d.ignoreCase?c.toUpperCase():c;a(e.responseXML).SPFilterNode("z:row").each(function(){var c=d.ignoreCase?a(this).attr("ows_"+d.columnStaticName).toUpperCase():a(this).attr("ows_"+d.columnStaticName);g===c&&a(this).attr("ows_ID")!==f&&b.push([a(this).attr("ows_ID"),a(this).attr("ows_"+d.columnStaticName)])})}});var e=d.initMsg,h=a("#SPRequireUnique"+d.columnStaticName);if(h.html(e).attr("class",d.initMsgCSSClass),a("input[value='OK']:disabled, input[value='Save']:disabled").removeAttr("disabled"),b.length>0&&(e=d.errMsg,h.html(e).attr("class",d.errMsgCSSClass),1===d.duplicateAction&&(k.focus(),a("input[value='OK'], input[value='Save']").attr("disabled","disabled")),d.showDupes)){for(var i=" "+b.length+" duplicate item"+(b.length>1?"s":"")+": ",j=0;j<b.length;j++)i+="<a href='DispForm.aspx?ID="+b[j][0]+"&Source="+location.href+"'>"+b[j][1]+"</a> ";a("span#SPRequireUnique"+d.columnStaticName).append(i)}}),null!==d.completefunc&&d.completefunc()},a}(H,b),C=function(a,b,c){function d(d,g,h,i,j){var k=0,l={};l.type=[],l.src=[],l.script=[];var m=RegExp("<script[\\s\\S]*?/script>","gi");a.ajax({type:"GET",url:j,dataType:"text",async:!1,success:function(n){for(var o;o=m.exec(n);){var p=e(o,"language"),q=e(o,"type"),r=e(o,"src");null!==r&&r.length>0&&!f(r)&&(l.type.push(null!==p&&p.length>0?p:q),l.src.push(r),k++)}if(!d.showNoScript&&l.type.length>0||d.showNoScript){var s=j.substring(0,j.lastIndexOf(b.SLASH)+1),t="<tr class=ms-alternating><td class=ms-vb-icon><a href='"+g.attr("DefaultViewUrl")+"'><IMG border=0 src='"+g.attr("ImageUrl")+"'width=16 height=16></A></TD><td class=ms-vb2><a href='"+g.attr("DefaultViewUrl")+"'>"+g.attr("Title")+("True"===g.attr("Hidden")?"(Hidden)":"")+"</td><td class=ms-vb2>"+h+"</td><td class=ms-vb2>"+i+"</td><td class=ms-vb2><a href='"+j+"'>"+c.fileName(j)+"</td>";if(d.showSrc){var u;t+="<td valign='top'><table width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1>";for(var v=0;v<l.type.length;v++)u=l.src[v].substr(0,1)!==b.SLASH?s+l.src[v]:l.src[v],t+="<tr><td class=ms-vb2 width='30%'>"+l.type[v]+"</td>",t+="<td class=ms-vb2 width='70%'><a href='"+u+"'>"+c.fileName(l.src[v])+"</td></tr>";t+="</table></td>"}a("#SPScriptAudit").append(t)}}})}function e(a,b){var c,d=RegExp(b+"=(\"([^\"]*)\")|('([^']*)')","gi");return(c=d.exec(a))?c[2]:null}function f(a){for(var b=["WebResource.axd","_layouts"],c=0;c<b.length;c++)if(a.indexOf(b[c])>-1)return!0;return!1}return a.fn.SPServices.SPScriptAudit=function(c){var e,f=a.extend({},{webURL:"",listName:"",outputId:"",auditForms:!0,auditViews:!0,auditPages:!0,auditPagesListName:"Pages",showHiddenLists:!1,showNoScript:!1,showSrc:!0},c),g=[["New","NewForm.aspx",!1],["Display","DispForm.aspx",!1],["Edit","EditForm.aspx",!1]];a("#"+f.outputId).append("<table id='SPScriptAudit' width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1><tr><th></th><th>List</th><th>Page Class</th><th>Page Type</th><th>Page</th>"+(f.showSrc?"<th>Script References</th>":"")+"</tr></table>");var h=a("#SPScriptAudit");h.find("th").attr("class","ms-vh2-nofilter"),(f.auditForms||f.auditViews)&&a().SPServices({operation:"GetListCollection",webURL:f.webURL,async:!1,completefunc:function(c){a(c.responseXML).find("List").each(function(){e=a(this),(0===f.listName.length||e.attr("Title")===f.listName)&&(f.showHiddenLists&&"False"===e.attr("Hidden")||!f.showHiddenLists)&&(f.auditForms&&a().SPServices({operation:"GetListContentTypes",webURL:f.webURL,listName:e.attr("ID"),async:!1,completefunc:function(c){a(c.responseXML).find("ContentType").each(function(){if("0x0120"!==a(this).attr("ID").substring(0,6)){for(var c=a(this).find("FormUrls"),h=0;h<g.length;h++)if(a(c).find(g[h][0]).each(function(){d(f,e,"Form",this.nodeName,(f.webURL.length>0?f.webURL:a().SPServices.SPGetCurrentSite())+b.SLASH+a(this).text()),g[h][2]=!0}),!g[h][2]){var i=e.attr("DefaultViewUrl");d(f,e,"Form",g[h][0],i.substring(0,i.lastIndexOf(b.SLASH)+1)+g[h][1])}for(h=0;h<g.length;h++)g[h][2]=!1}})}}),f.auditViews&&a().SPServices({operation:"GetViewCollection",webURL:f.webURL,listName:e.attr("ID"),async:!1,completefunc:function(b){a(b.responseXML).find("View").each(function(){d(f,e,"View",a(this).attr("DisplayName"),a(this).attr("Url"))})}}))})}});var i=0,j=[];if("string"==typeof f.auditPagesListName?(i=1,j.push(f.auditPagesListName)):(i=f.auditPagesListName.length,j=f.auditPagesListName),f.auditPages)for(var k=0;i>k;k++)a().SPServices({operation:"GetList",async:!1,cacheXML:!0,webURL:f.webURL,listName:j[k],completefunc:function(b){a(b.responseXML).find("List").each(function(){e=a(this)})}}),a().SPServices({operation:"GetListItems",async:!1,webURL:f.webURL,listName:j[k],CAMLQuery:"<Query><Where><Neq><FieldRef Name='ContentType'/><Value Type='Text'>Folder</Value></Neq></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='Title'/><FieldRef Name='FileRef'/></ViewFields>",CAMLRowLimit:0,completefunc:function(c){a(c.responseXML).SPFilterNode("z:row").each(function(){var c=a(this).attr("ows_FileRef").split(b.spDelim)[1],g=a(this).attr("ows_Title"),h="undefined"!=typeof g?g:"";c.indexOf(".aspx")>0&&d(f,e,"Page",h,b.SLASH+c)})}});h.find("tr[class='ms-alternating']:even").removeAttr("class")},a}(H,a,b),D=function(a,b,c){return a.fn.SPServices.SPSetMultiSelectSizes=function(d){var e=a.extend({},{listName:a().SPServices.SPListNameFromUrl(),multiSelectColumn:"",minWidth:0,maxWidth:0,debug:!1},d),f="SPServices.SPSetMultiSelectSizes",g=a().SPServices.SPDropdownCtl({displayName:e.multiSelectColumn});if(null===g.Obj.html()&&e.debug)return void c.errBox(f,"multiSelectColumn: "+e.multiSelectColumn,b.TXTColumnNotFound);if(g.Type!==b.dropdownType.multiSelect&&e.debug)return void c.errBox(f,"multiSelectColumn: "+e.multiSelectColumn,"Column is not multi-select.");var h=c.genContainerId("SPSetMultiSelectSizes",e.multiSelectColumn,e.listName),i=a("<select id='"+h+"' ></select>").appendTo(g.container);i.css({width:"auto",height:0,visibility:"hidden"}),a(g.master.candidateControl).find("option").each(function(){i.append("<option value='"+a(this).html()+"'>"+a(this).html()+"</option>")}),a(g.master.resultControl).find("option").each(function(){i.append("<option value='"+a(this).val()+"'>"+a(this).html()+"</option>")});var j=i.width()+5,k=j;(e.minWidth>0||e.maxWidth>0)&&(j<e.minWidth&&(j=e.minWidth),k<e.minWidth&&(k=e.minWidth),k>e.maxWidth&&(k=e.maxWidth));var l=j;a(g.master.candidateControl).css("width",l+"px").parent().css("width",k+"px"),a(g.master.resultControl).css("width",l+"px").parent().css("width",k+"px"),i.remove()},a}(H,a,b),E=function(a,b,c){return a.fn.SPServices.SPUpdateMultipleListItems=function(d){var e,f=a.extend({},{webURL:"",listName:"",CAMLQuery:"",batchCmd:"Update",valuepairs:[],completefunc:null,debug:!1},d),g=[],h=[];a().SPServices({operation:"GetListItems",async:!1,webURL:f.webURL,listName:f.listName,CAMLQuery:f.CAMLQuery,CAMLQueryOptions:"<QueryOptions><ViewAttributes Scope='Recursive' /></QueryOptions>",completefunc:function(c){a(c.responseXML).SPFilterNode("z:row").each(function(){g.push(a(this).attr("ows_ID"));var c=a(this).attr("ows_FileRef");c="/"+c.substring(c.indexOf(b.spDelim)+2),h.push(c)})}});var i,j="<Batch OnError='Continue'>";for(e=0;e<g.length;e++){for(j+="<Method ID='"+e+"' Cmd='"+f.batchCmd+"'>",i=0;i<f.valuepairs.length;i++)j+="<Field Name='"+f.valuepairs[i][0]+"'>"+c.escapeColumnValue(f.valuepairs[i][1])+"</Field>";j+="<Field Name='ID'>"+g[e]+"</Field>",h[e].length>0&&(j+="<Field Name='FileRef'>"+h[e]+"</Field>"),j+="</Method>"}j+="</Batch>",a().SPServices({operation:"UpdateListItems",async:!1,webURL:f.webURL,listName:f.listName,updates:j,completefunc:function(a){null!==f.completefunc&&f.completefunc(a)}})},a}(H,a,b),F=function(a){return a}(H)})}();