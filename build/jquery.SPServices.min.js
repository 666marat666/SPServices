/*
* SPServices - Work with SharePoint's Web Services using jQuery
* Version 1.36.0
* @requires jQuery v1.8 or greater - jQuery 1.10.x+ recommended
*
* Copyright (c) 2009-2015 Sympraxis Consulting LLC
* Examples and docs at:
* http://spservices.codeplex.com/
* Licensed under the MIT license:
* http://www.opensource.org/licenses/mit-license.php
*/
/*
* @description SPServices is a jQuery library which abstracts SharePoint's Web Services and makes them easier to use. It also includes functions which use the various Web Service operations to provide more useful (and cool) capabilities. It works entirely client side and requires no server install.
* @type jQuery
* @name SPServices
* @category Plugins/SPServices
* @author Sympraxis Consulting LLC/marc.anderson@sympraxisconsulting.com
! @build SPServices 1.36.0 2015-05-02 07:57:07
*/
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){"use strict";function b(b,c,d,e){var f,g="SPServices.SPDisplayRelatedInfo",h=a().SPServices.SPDropdownCtl({displayName:b.columnName});if(f=w(h,b.matchOnId),!(h.Type===U.complex&&b.numChars>0&&f[0].length<b.numChars)&&h.Obj.attr("showRelatedSelected")!==f[0]){h.Obj.attr("showRelatedSelected",f[0]),a("#"+c).remove(),h.Obj.parent().append("<div id="+c+"></div>");var i="<Query><Where>";b.CAMLQuery.length>0&&(i+="<And>");var j=e[b.relatedListColumn].attr("Type");i+="Lookup"===j?"<Eq><FieldRef Name='"+b.relatedListColumn+(b.matchOnId?"' LookupId='True'/><Value Type='Integer'>":"'/><Value Type='Text'>")+J(f[0])+"</Value></Eq>":"<Eq><FieldRef Name='"+(b.matchOnId?"ID' /><Value Type='Counter'>":b.relatedListColumn+"'/><Value Type='Text'>")+J(f[0])+"</Value></Eq>",b.CAMLQuery.length>0&&(i+=b.CAMLQuery+"</And>"),i+="</Where></Query>";var k=" ";for(ua=0;ua<b.relatedColumns.length;ua++)k+="<FieldRef Name='"+b.relatedColumns[ua]+"' />";a().SPServices({operation:"GetListItems",async:!1,webURL:b.relatedWebURL,listName:b.relatedList,CAMLQuery:i,CAMLViewFields:"<ViewFields>"+k+"</ViewFields>",CAMLRowLimit:0,completefunc:function(f){a(f.responseXML).find("errorstring").each(function(){var c=a(this).text();b.debug&&"One or more field types are not installed properly. Go to the list settings page to delete these fields."===c?x(g,"relatedListColumn: "+b.relatedListColumn,"Column not found in relatedList "+b.relatedList):b.debug&&"Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)."===c&&x(g,"relatedList: "+b.relatedList,"List not found")});var h;switch(b.displayFormat){case"table":for(h="<table>",h+="<tr>",ua=0;ua<b.relatedColumns.length;ua++){if("undefined"==typeof e[b.relatedColumns[ua]]&&b.debug)return void x(g,"columnName: "+b.relatedColumns[ua],"Column not found in relatedList");h+="<th class='"+b.headerCSSClass+"'>"+e[b.relatedColumns[ua]].attr("DisplayName")+"</th>"}h+="</tr>",a(f.responseXML).SPFilterNode("z:row").each(function(){for(h+="<tr>",ua=0;ua<b.relatedColumns.length;ua++)h+="<td class='"+b.rowCSSClass+"'>"+u(d,e[b.relatedColumns[ua]],a(this).attr("ows_"+b.relatedColumns[ua]),b)+"</td>";h+="</tr>"}),h+="</table>";break;case"list":h="<table>",a(f.responseXML).SPFilterNode("z:row").each(function(){for(ua=0;ua<b.relatedColumns.length;ua++){if("undefined"==typeof e[b.relatedColumns[ua]]&&b.debug)return void x(g,"columnName: "+b.relatedColumns[ua],"Column not found in relatedList");h+="<tr>",h+="<th class='"+b.headerCSSClass+"'>"+e[b.relatedColumns[ua]].attr("DisplayName")+"</th>",h+="<td class='"+b.rowCSSClass+"'>"+u(d,e[b.relatedColumns[ua]],a(this).attr("ows_"+b.relatedColumns[ua]),b)+"</td>",h+="</tr>"}}),h+="</table>"}a("#"+c).html(h)}}),null!==b.completefunc&&b.completefunc()}}function c(b,c,f,g,h){var i=0,j=0,k={};k.type=[],k.src=[],k.script=[];var l=RegExp("<script[\\s\\S]*?/script>","gi");a.ajax({type:"GET",url:h,dataType:"text",async:!1,success:function(m){for(var n;n=l.exec(m);){var o=d(n,"language"),p=d(n,"type"),q=d(n,"src");null!==q&&q.length>0&&!e(q)&&(k.type.push(null!==o&&o.length>0?o:p),k.src.push(q),j++)}if(!b.showNoScript&&k.type.length>0||b.showNoScript){var r=h.substring(0,h.lastIndexOf(O)+1),s="<tr class=ms-alternating><td class=ms-vb-icon><a href='"+c.attr("DefaultViewUrl")+"'><IMG border=0 src='"+c.attr("ImageUrl")+"'width=16 height=16></A></TD><td class=ms-vb2><a href='"+c.attr("DefaultViewUrl")+"'>"+c.attr("Title")+("True"===c.attr("Hidden")?"(Hidden)":"")+"</td><td class=ms-vb2>"+f+"</td><td class=ms-vb2>"+g+"</td><td class=ms-vb2><a href='"+h+"'>"+H(h)+"</td>";if(b.showSrc){var t;for(s+="<td valign='top'><table width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1>",i=0;i<k.type.length;i++)t=k.src[i].substr(0,1)!==O?r+k.src[i]:k.src[i],s+="<tr><td class=ms-vb2 width='30%'>"+k.type[i]+"</td>",s+="<td class=ms-vb2 width='70%'><a href='"+t+"'>"+H(k.src[i])+"</td></tr>";s+="</table></td>"}a("#SPScriptAudit").append(s)}}})}function d(a,b){var c,d=RegExp(b+"=(\"([^\"]*)\")|('([^']*)')","gi");return(c=d.exec(a))?c[2]:null}function e(a){var b,c=["WebResource.axd","_layouts"];for(b=0;b<c.length;b++)if(a.indexOf(c[b])>-1)return!0;return!1}function f(a,b){var c;switch(b){case"Text":c=a;break;case"DateTime":case"datetime":c=j(a);break;case"User":c=k(a);break;case"UserMulti":c=l(a);break;case"Lookup":c=m(a);break;case"LookupMulti":c=n(a);break;case"Boolean":c=i(a);break;case"Integer":c=g(a);break;case"Counter":c=g(a);break;case"MultiChoice":c=o(a);break;case"Number":case"Currency":case"float":c=h(a);break;case"Calculated":c=r(a);break;case"Attachments":c=p(a);break;case"URL":c=q(a);break;case"JSON":case"RelatedItems":c=s(a);break;default:c=a}return c}function g(a){return parseInt(a,10)}function h(a){return parseFloat(a)}function i(a){return"0"!==a}function j(a){var b=a.split(a.split("T")[0]!==a?"T":" "),c=b[0].split("-"),d=b[1].split(":"),e=d[2].split("Z");return new Date(c[0],c[1]-1,c[2],d[0],d[1],e[0])}function k(a){if(0===a.length)return null;var b=new L(a),c=b.value.split(",#");return 1===c.length?{userId:b.id,userName:b.value}:{userId:b.id,userName:c[0].replace(/(,,)/g,","),loginName:c[1].replace(/(,,)/g,","),email:c[2].replace(/(,,)/g,","),sipAddress:c[3].replace(/(,,)/g,","),title:c[4].replace(/(,,)/g,",")}}function l(a){if(0===a.length)return null;var b=[],c=a.split(P);for(ua=0;ua<c.length;ua+=2){var d=k(c[ua]+P+c[ua+1]);b.push(d)}return b}function m(a){if(0===a.length)return null;var b=a.split(P);return{lookupId:b[0],lookupValue:b[1]}}function n(a){if(0===a.length)return null;var b=[],c=a.split(P);for(ua=0;ua<c.length;ua+=2){var d=m(c[ua]+P+c[ua+1]);b.push(d)}return b}function o(a){if(0===a.length)return null;var b=[],c=a.split(P);for(ua=0;ua<c.length;ua++)0!==c[ua].length&&b.push(c[ua]);return b}function p(a){if(0===a.length)return null;if("0"===a||"1"===a)return a;var b=[],c=a.split(P);for(ua=0;ua<c.length;ua++)if(0!==c[ua].length){var d=c[ua];if(-1!==c[ua].lastIndexOf("/")){var e=c[ua].split("/");d=e[e.length-1]}b.push({attachment:c[ua],fileName:d})}return b}function q(a){if(0===a.length)return null;var b=a.split(", ");return{Url:b[0],Description:b[1]}}function r(a){if(0===a.length)return null;var b=a.split(P);return f(b[1],b[0])}function s(b){return 0===b.length?null:a.parseJSON(b)}function t(){var a=location.protocol+"//"+location.host;"undefined"!=typeof _spPageContextInfo?(this.thisSite=a+_spPageContextInfo.webServerRelativeUrl,this.thisList=_spPageContextInfo.pageListId,this.thisUserId=_spPageContextInfo.userId):(this.thisSite="undefined"!=typeof L_Menu_BaseUrl?a+L_Menu_BaseUrl:"",this.thisList="",this.thisUserId="undefined"!=typeof _spUserId?_spUserId:void 0)}function u(b,c,d,e){if("undefined"==typeof d)return"";var f,g,h,i="",j=[],k=e.relatedWebURL.length>0?e.relatedWebURL:a().SPServices.SPGetCurrentSite();switch(c.attr("Type")){case"Text":i=d;break;case"URL":switch(c.attr("Format")){case"Hyperlink":i="<a href='"+d.substring(0,d.search(","))+"'>"+d.substring(d.search(",")+1)+"</a>";break;case"Image":i="<img alt='"+d.substring(d.search(",")+1)+"' src='"+d.substring(0,d.search(","))+"'/>";break;default:i=d}break;case"User":case"UserMulti":var l=d.split(P);for(f=0;f<l.length;f+=2)j.push("<a href='/_layouts/userdisp.aspx?ID="+l[f]+"&Source="+K(location.href)+"'>"+l[f+1]+"</a>");i=j.join(", ");break;case"Calculated":var m=d.split(P);i=m[1];break;case"Number":h=c.attr("Decimals"),i="undefined"==typeof h?parseFloat(d).toString():parseFloat(d).toFixed(h).toString();break;case"Currency":h=c.attr("Decimals"),i="undefined"==typeof h?parseFloat(d).toFixed(2).toString():parseFloat(d).toFixed(h).toString();break;case"Lookup":switch(c.attr("Name")){case"FileRef":g="1"===b.attr("BaseType")?b.attr("RootFolder")+O+"Forms/DispForm.aspx":b.attr("RootFolder")+O+"DispForm.aspx",i="<a href='"+g+"?ID="+d.substring(0,d.search(P))+"&RootFolder=*&Source="+K(location.href)+"'>"+d.substring(d.search(P)+2)+"</a>";break;case"FileDirRef":g=O+d.substring(d.search(P)+2),i="<a href='"+g+"'>"+d.substring(d.search(P)+2)+"</a>";break;default:g=A(c.attr("List"),"DisplayForm"),i="<a href='"+e.relatedWebURL+O+g+"?ID="+d.substring(0,d.search(P))+"&RootFolder=*&Source="+K(location.href)+"'>"+d.substring(d.search(P)+2)+"</a>"}break;case"LookupMulti":if(g=A(c.attr("List"),"DisplayForm"),i="",d.length>0){var n=d.split(P);for(f=0;f<n.length/2;f++)j.push("<a href='"+k+O+g+"?ID="+n[2*f]+"&RootFolder=*&Source="+K(location.href)+"'>"+n[2*f+1]+"</a>")}i=j.join(", ");break;case"File":H=d.substring(d.search(P)+2),i="<a href='"+b.attr("RootFolder")+O+H+"'>"+H+"</a>";break;case"Counter":i=d;break;case"DateTime":i=d;break;default:i=d}return i}function v(a){var b,c="<table class='ms-vb' width='100%'>";for(b=0;b<a.attributes.length;b++)c+="<tr><td width='10px' style='font-weight:bold;'>"+b+"</td><td width='100px'>"+a.attributes.item(b).nodeName+"</td><td>"+G(a.attributes.item(b).nodeValue)+"</td></tr>";return c+="</table>"}function w(b,c){var d=[];switch(b.Type){case U.simple:d.push(c?b.Obj.find("option:selected").val()||[]:b.Obj.find("option:selected").text()||[]);break;case U.complex:d.push(c?b.optHid.val()||[]:b.Obj.val()||[]);break;case U.multiSelect:a(b.master.resultControl).find("option").each(function(){d.push(c?a(this).val():a(this).html())})}return d}function x(a,b,c){var d="<b>Error in function</b><br/>"+a+"<br/><b>Parameter</b><br/>"+b+"<br/><b>Message</b><br/>"+c+"<br/><br/><span onmouseover='this.style.cursor=\"hand\";' onmouseout='this.style.cursor=\"inherit\";' style='width=100%;text-align:right;'>Click to continue</span></div>";y(d)}function y(b){var c="position:absolute;width:300px;height:150px;padding:10px;background-color:#000000;color:#ffffff;z-index:30;font-family:'Arial';font-size:12px;display:none;";a("#aspnetForm").parent().append("<div id='SPServices_msgBox' style="+c+">"+b);var d=a("#SPServices_msgBox"),e=d.height(),f=d.width(),g=a(window).width()/2-f/2+"px",h=a(window).height()/2-e/2-100+"px";d.css({border:"5px #C02000 solid",left:g,top:h}).show().fadeTo("slow",.75).click(function(){a(this).fadeOut("3000",function(){a(this).remove()})})}function z(b,c,d){var e=void 0!==d?d:a().SPServices.SPListNameFromUrl();return b+"_"+a().SPServices.SPGetStaticFromDisplay({listName:e,columnDisplayName:c})}function A(b,c){var d;return a().SPServices({operation:"GetFormCollection",async:!1,listName:b,completefunc:function(b){d=a(b.responseXML).find("Form[Type='"+c+"']").attr("Url")}}),d}function B(b,c){var d;for(d=0;d<c.length;d++)"string"==typeof c[d]?xa.payload+=E(c[d],b[c[d]]):a.isArray(c[d])&&2===c[d].length?xa.payload+=E(c[d][0],b[c[d][1]]):"object"==typeof c[d]&&void 0!==c[d].sendNull?xa.payload+=void 0===b[c[d].name]||0===b[c[d].name].length?"":E(c[d].name,b[c[d].name]):x(b.operation,"paramArray["+d+"]: "+c[d],"Invalid paramArray element passed to addToPayload()")}function C(b){var c,d=RegExp('FieldName="'+b.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")+'"',"gi");return a("td.ms-formbody, td.ms-formbodysurvey").each(function(){return d.test(a(this).html())?(c=a(this),!1):void 0}),c}function D(a,b){var c=b.substring(8);return a.opheader=a.opheader.replace(b,c),a.opfooter=a.opfooter.replace(b,c),a}function E(a,b){var c="undefined"!=typeof b?b:"";return"<"+a+">"+c+"</"+a+">"}function F(){return Math.round(Math.random())-.5}function G(a){return 0===a.indexOf("http")||0===a.indexOf(O)?"<a href='"+a+"'>"+a+"</a>":a}function H(a){return a.substring(a.lastIndexOf(O)+1,a.length)}function I(a){return a.replace(/([\&"<>])/g,function(a,b){return za[b]})}function J(a){return"string"==typeof a?a.replace(/&(?![a-zA-Z]{1,8};)/g,"&amp;"):a}function K(a){return a.replace(/&/g,"%26")}function L(a){var b=a.split(P);this.id=b[0],this.value=b[1]}function M(a){return 10>a?"0"+a:a}var N="2014.02",O="/",P=";#",Q="Column not found on page",R="http://schemas.microsoft.com/sharepoint",S="MultiLookupPicker",T="MultiLookup",U={simple:"S",complex:"C",multiSelect:"M"},V=["Integer","Text","Note","DateTime","Counter","Choice","Lookup","Boolean","Number","Currency","URL","MultiChoice","Calculated","File","Attachments","User","ModStat","ContentTypeId","WorkflowStatus","RelatedItems","UserMulti","LookupMulti","datetime","float","Calc"],W={},X="Alerts",Y="Authentication",Z="Copy",$="Forms",_="Lists",aa="Meetings",ba="OfficialFile",ca="People",da="Permissions",ea="PublishedLinksService",fa="Search",ga="SharePointDiagnostics",ha="SiteData",ia="Sites",ja="SocialDataService",ka="SpellCheck",la="TaxonomyClientService",ma="usergroup",na="UserProfileService",oa="Versions",pa="Views",qa="WebPartPages",ra="Webs",sa="Workflow",ta=new t,ua=0,va=["listName","description"],wa=[];wa.GetAlerts=[X,!1],wa.DeleteAlerts=[X,!0],wa.Mode=[Y,!1],wa.Login=[Y,!1],wa.CopyIntoItems=[Z,!0],wa.CopyIntoItemsLocal=[Z,!0],wa.GetItem=[Z,!1],wa.GetForm=[$,!1],wa.GetFormCollection=[$,!1],wa.AddAttachment=[_,!0],wa.AddDiscussionBoardItem=[_,!0],wa.AddList=[_,!0],wa.AddListFromFeature=[_,!0],wa.ApplyContentTypeToList=[_,!0],wa.CheckInFile=[_,!0],wa.CheckOutFile=[_,!0],wa.CreateContentType=[_,!0],wa.DeleteAttachment=[_,!0],wa.DeleteContentType=[_,!0],wa.DeleteContentTypeXmlDocument=[_,!0],wa.DeleteList=[_,!0],wa.GetAttachmentCollection=[_,!1],wa.GetList=[_,!1],wa.GetListAndView=[_,!1],wa.GetListCollection=[_,!1],wa.GetListContentType=[_,!1],wa.GetListContentTypes=[_,!1],wa.GetListItemChanges=[_,!1],wa.GetListItemChangesSinceToken=[_,!1],wa.GetListItems=[_,!1],wa.GetVersionCollection=[_,!1],wa.UndoCheckOut=[_,!0],wa.UpdateContentType=[_,!0],wa.UpdateContentTypesXmlDocument=[_,!0],wa.UpdateContentTypeXmlDocument=[_,!0],wa.UpdateList=[_,!0],wa.UpdateListItems=[_,!0],wa.AddMeeting=[aa,!0],wa.CreateWorkspace=[aa,!0],wa.RemoveMeeting=[aa,!0],wa.SetWorkSpaceTitle=[aa,!0],wa.GetRecordRouting=[ba,!1],wa.GetRecordRoutingCollection=[ba,!1],wa.GetServerInfo=[ba,!1],wa.SubmitFile=[ba,!0],wa.ResolvePrincipals=[ca,!0],wa.SearchPrincipals=[ca,!1],wa.AddPermission=[da,!0],wa.AddPermissionCollection=[da,!0],wa.GetPermissionCollection=[da,!0],wa.RemovePermission=[da,!0],wa.RemovePermissionCollection=[da,!0],wa.UpdatePermission=[da,!0],wa.GetLinks=[ea,!0],wa.GetPortalSearchInfo=[fa,!1],wa.GetQuerySuggestions=[fa,!1],wa.GetSearchMetadata=[fa,!1],wa.Query=[fa,!1],wa.QueryEx=[fa,!1],wa.Registration=[fa,!1],wa.Status=[fa,!1],wa.SendClientScriptErrorReport=[ga,!0],wa.GetAttachments=[ha,!1],wa.EnumerateFolder=[ha,!1],wa.SiteDataGetList=[ha,!1],wa.SiteDataGetListCollection=[ha,!1],wa.SiteDataGetSite=[ha,!1],wa.SiteDataGetSiteUrl=[ha,!1],wa.SiteDataGetWeb=[ha,!1],wa.CreateWeb=[ia,!0],wa.DeleteWeb=[ia,!0],wa.GetSite=[ia,!1],wa.GetSiteTemplates=[ia,!1],wa.AddComment=[ja,!0],wa.AddTag=[ja,!0],wa.AddTagByKeyword=[ja,!0],wa.CountCommentsOfUser=[ja,!1],wa.CountCommentsOfUserOnUrl=[ja,!1],wa.CountCommentsOnUrl=[ja,!1],wa.CountRatingsOnUrl=[ja,!1],wa.CountTagsOfUser=[ja,!1],wa.DeleteComment=[ja,!0],wa.DeleteRating=[ja,!0],wa.DeleteTag=[ja,!0],wa.DeleteTagByKeyword=[ja,!0],wa.DeleteTags=[ja,!0],wa.GetAllTagTerms=[ja,!1],wa.GetAllTagTermsForUrlFolder=[ja,!1],wa.GetAllTagUrls=[ja,!1],wa.GetAllTagUrlsByKeyword=[ja,!1],wa.GetCommentsOfUser=[ja,!1],wa.GetCommentsOfUserOnUrl=[ja,!1],wa.GetCommentsOnUrl=[ja,!1],wa.GetRatingAverageOnUrl=[ja,!1],wa.GetRatingOfUserOnUrl=[ja,!1],wa.GetRatingOnUrl=[ja,!1],wa.GetRatingsOfUser=[ja,!1],wa.GetRatingsOnUrl=[ja,!1],wa.GetSocialDataForFullReplication=[ja,!1],wa.GetTags=[ja,!0],wa.GetTagsOfUser=[ja,!0],wa.GetTagTerms=[ja,!0],wa.GetTagTermsOfUser=[ja,!0],wa.GetTagTermsOnUrl=[ja,!0],wa.GetTagUrlsOfUser=[ja,!0],wa.GetTagUrlsOfUserByKeyword=[ja,!0],wa.GetTagUrls=[ja,!0],wa.GetTagUrlsByKeyword=[ja,!0],wa.SetRating=[ja,!0],wa.UpdateComment=[ja,!0],wa.SpellCheck=[ka,!1],wa.AddTerms=[la,!0],wa.GetChildTermsInTerm=[la,!1],wa.GetChildTermsInTermSet=[la,!1],wa.GetKeywordTermsByGuids=[la,!1],wa.GetTermsByLabel=[la,!1],wa.GetTermSets=[la,!1],wa.AddGroup=[ma,!0],wa.AddGroupToRole=[ma,!0],wa.AddRole=[ma,!0],wa.AddRoleDef=[ma,!0],wa.AddUserCollectionToGroup=[ma,!0],wa.AddUserCollectionToRole=[ma,!0],wa.AddUserToGroup=[ma,!0],wa.AddUserToRole=[ma,!0],wa.GetAllUserCollectionFromWeb=[ma,!1],wa.GetGroupCollection=[ma,!1],wa.GetGroupCollectionFromRole=[ma,!1],wa.GetGroupCollectionFromSite=[ma,!1],wa.GetGroupCollectionFromUser=[ma,!1],wa.GetGroupCollectionFromWeb=[ma,!1],wa.GetGroupInfo=[ma,!1],wa.GetRoleCollection=[ma,!1],wa.GetRoleCollectionFromGroup=[ma,!1],wa.GetRoleCollectionFromUser=[ma,!1],wa.GetRoleCollectionFromWeb=[ma,!1],wa.GetRoleInfo=[ma,!1],wa.GetRolesAndPermissionsForCurrentUser=[ma,!1],wa.GetRolesAndPermissionsForSite=[ma,!1],wa.GetUserCollection=[ma,!1],wa.GetUserCollectionFromGroup=[ma,!1],wa.GetUserCollectionFromRole=[ma,!1],wa.GetUserCollectionFromSite=[ma,!1],wa.GetUserCollectionFromWeb=[ma,!1],wa.GetUserInfo=[ma,!1],wa.GetUserLoginFromEmail=[ma,!1],wa.RemoveGroup=[ma,!0],wa.RemoveGroupFromRole=[ma,!0],wa.RemoveRole=[ma,!0],wa.RemoveUserCollectionFromGroup=[ma,!0],wa.RemoveUserCollectionFromRole=[ma,!0],wa.RemoveUserCollectionFromSite=[ma,!0],wa.RemoveUserFromGroup=[ma,!0],wa.RemoveUserFromRole=[ma,!0],wa.RemoveUserFromSite=[ma,!0],wa.RemoveUserFromWeb=[ma,!0],wa.UpdateGroupInfo=[ma,!0],wa.UpdateRoleDefInfo=[ma,!0],wa.UpdateRoleInfo=[ma,!0],wa.UpdateUserInfo=[ma,!0],wa.AddColleague=[na,!0],wa.AddLink=[na,!0],wa.AddMembership=[na,!0],wa.AddPinnedLink=[na,!0],wa.CreateMemberGroup=[na,!0],wa.CreateUserProfileByAccountName=[na,!0],wa.GetCommonColleagues=[na,!1],wa.GetCommonManager=[na,!1],wa.GetCommonMemberships=[na,!1],wa.GetInCommon=[na,!1],wa.GetPropertyChoiceList=[na,!1],wa.GetUserColleagues=[na,!1],wa.GetUserLinks=[na,!1],wa.GetUserMemberships=[na,!1],wa.GetUserPinnedLinks=[na,!1],wa.GetUserProfileByGuid=[na,!1],wa.GetUserProfileByIndex=[na,!1],wa.GetUserProfileByName=[na,!1],wa.GetUserProfileCount=[na,!1],wa.GetUserProfileSchema=[na,!1],wa.GetUserPropertyByAccountName=[na,!1],wa.ModifyUserPropertyByAccountName=[na,!0],wa.RemoveAllColleagues=[na,!0],wa.RemoveAllLinks=[na,!0],wa.RemoveAllMemberships=[na,!0],wa.RemoveAllPinnedLinks=[na,!0],wa.RemoveColleague=[na,!0],wa.RemoveLink=[na,!0],wa.RemoveMembership=[na,!0],wa.RemovePinnedLink=[na,!0],wa.UpdateColleaguePrivacy=[na,!0],wa.UpdateLink=[na,!0],wa.UpdateMembershipPrivacy=[na,!0],wa.UpdatePinnedLink=[na,!0],wa.DeleteAllVersions=[oa,!0],wa.DeleteVersion=[oa,!0],wa.GetVersions=[oa,!1],wa.RestoreVersion=[oa,!0],wa.AddView=[pa,!0],wa.DeleteView=[pa,!0],wa.GetView=[pa,!1],wa.GetViewHtml=[pa,!1],wa.GetViewCollection=[pa,!1],wa.UpdateView=[pa,!0],wa.UpdateViewHtml=[pa,!0],wa.AddWebPart=[qa,!0],wa.AddWebPartToZone=[qa,!0],wa.DeleteWebPart=[qa,!0],wa.GetWebPart2=[qa,!1],wa.GetWebPartPage=[qa,!1],wa.GetWebPartProperties=[qa,!1],wa.GetWebPartProperties2=[qa,!1],wa.SaveWebPart2=[qa,!0],wa.CreateContentType=[ra,!0],wa.GetColumns=[ra,!1],wa.GetContentType=[ra,!1],wa.GetContentTypes=[ra,!1],wa.GetCustomizedPageStatus=[ra,!1],wa.GetListTemplates=[ra,!1],wa.GetObjectIdFromUrl=[ra,!1],wa.GetWeb=[ra,!1],wa.GetWebCollection=[ra,!1],wa.GetAllSubWebCollection=[ra,!1],wa.UpdateColumns=[ra,!0],wa.UpdateContentType=[ra,!0],wa.WebUrlFromPageUrl=[ra,!1],wa.AlterToDo=[sa,!0],wa.ClaimReleaseTask=[sa,!0],wa.GetTemplatesForItem=[sa,!1],wa.GetToDosForItem=[sa,!1],wa.GetWorkflowDataForItem=[sa,!1],wa.GetWorkflowTaskData=[sa,!1],wa.StartWorkflow=[sa,!0];var xa={};xa.header="<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body>",xa.footer="</soap:Body></soap:Envelope>",xa.payload="";var ya;a.fn.SPServices=function(b){for(var c=a.extend({},a.fn.SPServices.defaults,b),d=0;d<va.length;d++)"string"==typeof c[va[d]]&&(c[va[d]]=I(c[va[d]]));switch(xa.opheader="<"+c.operation+" ",wa[c.operation][0]){case X:xa.opheader+="xmlns='"+R+"/soap/2002/1/alerts/' >",ya=R+"/soap/2002/1/alerts/";break;case aa:xa.opheader+="xmlns='"+R+"/soap/meetings/' >",ya=R+"/soap/meetings/";break;case ba:xa.opheader+="xmlns='"+R+"/soap/recordsrepository/' >",ya=R+"/soap/recordsrepository/";break;case da:xa.opheader+="xmlns='"+R+"/soap/directory/' >",ya=R+"/soap/directory/";break;case ea:xa.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/' >",ya="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/";break;case fa:xa.opheader+="xmlns='urn:Microsoft.Search' >",ya="urn:Microsoft.Search/";break;case ga:xa.opheader+="xmlns='"+R+"/diagnostics/' >",ya="http://schemas.microsoft.com/sharepoint/diagnostics/";break;case ja:xa.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/SocialDataService' >",ya="http://microsoft.com/webservices/SharePointPortalServer/SocialDataService/";break;case ka:xa.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/publishing/spelling/' >",ya="http://schemas.microsoft.com/sharepoint/publishing/spelling/SpellCheck";break;case la:xa.opheader+="xmlns='"+R+"/taxonomy/soap/' >",ya=R+"/taxonomy/soap/";break;case ma:xa.opheader+="xmlns='"+R+"/soap/directory/' >",ya=R+"/soap/directory/";break;case na:xa.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/UserProfileService' >",ya="http://microsoft.com/webservices/SharePointPortalServer/UserProfileService/";break;case qa:xa.opheader+="xmlns='http://microsoft.com/sharepoint/webpartpages' >",ya="http://microsoft.com/sharepoint/webpartpages/";break;case sa:xa.opheader+="xmlns='"+R+"/soap/workflow/' >",ya=R+"/soap/workflow/";break;default:xa.opheader+="xmlns='"+R+"/soap/'>",ya=R+"/soap/"}ya+=c.operation,xa.opfooter="</"+c.operation+">";var e="_vti_bin/"+wa[c.operation][0]+".asmx",f=void 0!==c.webURL?c.webURL:c.webUrl;if(f.charAt(f.length-1)===O)e=f+e;else if(f.length>0)e=f+O+e;else{var g=a().SPServices.SPGetCurrentSite();e=g+(g.charAt(g.length-1)===O?e:O+e)}switch(xa.payload="",c.operation){case"GetAlerts":break;case"DeleteAlerts":for(xa.payload+="<IDs>",d=0;d<c.IDs.length;d++)xa.payload+=E("string",c.IDs[d]);xa.payload+="</IDs>";break;case"Mode":break;case"Login":B(c,["username","password"]);break;case"CopyIntoItems":for(B(c,["SourceUrl"]),xa.payload+="<DestinationUrls>",d=0;d<c.DestinationUrls.length;d++)xa.payload+=E("string",c.DestinationUrls[d]);xa.payload+="</DestinationUrls>",B(c,["Fields","Stream","Results"]);break;case"CopyIntoItemsLocal":for(B(c,["SourceUrl"]),xa.payload+="<DestinationUrls>",d=0;d<c.DestinationUrls.length;d++)xa.payload+=E("string",c.DestinationUrls[d]);xa.payload+="</DestinationUrls>";break;case"GetItem":B(c,["Url","Fields","Stream"]);break;case"GetForm":B(c,["listName","formUrl"]);break;case"GetFormCollection":B(c,["listName"]);break;case"AddAttachment":B(c,["listName","listItemID","fileName","attachment"]);break;case"AddDiscussionBoardItem":B(c,["listName","message"]);break;case"AddList":B(c,["listName","description","templateID"]);break;case"AddListFromFeature":B(c,["listName","description","featureID","templateID"]);break;case"ApplyContentTypeToList":B(c,["webUrl","contentTypeId","listName"]);break;case"CheckInFile":B(c,["pageUrl","comment","CheckinType"]);break;case"CheckOutFile":B(c,["pageUrl","checkoutToLocal","lastmodified"]);break;case"CreateContentType":B(c,["listName","displayName","parentType","fields","contentTypeProperties","addToView"]);break;case"DeleteAttachment":B(c,["listName","listItemID","url"]);break;case"DeleteContentType":B(c,["listName","contentTypeId"]);break;case"DeleteContentTypeXmlDocument":B(c,["listName","contentTypeId","documentUri"]);break;case"DeleteList":B(c,["listName"]);break;case"GetAttachmentCollection":B(c,["listName",["listItemID","ID"]]);break;case"GetList":B(c,["listName"]);break;case"GetListAndView":B(c,["listName","viewName"]);break;case"GetListCollection":break;case"GetListContentType":B(c,["listName","contentTypeId"]);break;case"GetListContentTypes":B(c,["listName"]);break;case"GetListItems":B(c,["listName","viewName",["query","CAMLQuery"],["viewFields","CAMLViewFields"],["rowLimit","CAMLRowLimit"],["queryOptions","CAMLQueryOptions"]]);break;case"GetListItemChanges":B(c,["listName","viewFields","since","contains"]);break;case"GetListItemChangesSinceToken":B(c,["listName","viewName",["query","CAMLQuery"],["viewFields","CAMLViewFields"],["rowLimit","CAMLRowLimit"],["queryOptions","CAMLQueryOptions"],{name:"changeToken",sendNull:!1},{name:"contains",sendNull:!1}]);break;case"GetVersionCollection":B(c,["strlistID","strlistItemID","strFieldName"]);break;case"UndoCheckOut":B(c,["pageUrl"]);break;case"UpdateContentType":B(c,["listName","contentTypeId","contentTypeProperties","newFields","updateFields","deleteFields","addToView"]);break;case"UpdateContentTypesXmlDocument":B(c,["listName","newDocument"]);break;case"UpdateContentTypeXmlDocument":B(c,["listName","contentTypeId","newDocument"]);break;case"UpdateList":B(c,["listName","listProperties","newFields","updateFields","deleteFields","listVersion"]);break;case"UpdateListItems":if(B(c,["listName"]),"undefined"!=typeof c.updates&&c.updates.length>0)B(c,["updates"]);else{for(xa.payload+="<updates><Batch OnError='Continue'><Method ID='1' Cmd='"+c.batchCmd+"'>",d=0;d<c.valuepairs.length;d++)xa.payload+="<Field Name='"+c.valuepairs[d][0]+"'>"+J(c.valuepairs[d][1])+"</Field>";"New"!==c.batchCmd&&(xa.payload+="<Field Name='ID'>"+c.ID+"</Field>"),xa.payload+="</Method></Batch></updates>"}break;case"AddMeeting":B(c,["organizerEmail","uid","sequence","utcDateStamp","title","location","utcDateStart","utcDateEnd","nonGregorian"]);break;case"CreateWorkspace":B(c,["title","templateName","lcid","timeZoneInformation"]);break;case"RemoveMeeting":B(c,["recurrenceId","uid","sequence","utcDateStamp","cancelMeeting"]);break;case"SetWorkspaceTitle":B(c,["title"]);break;case"GetRecordRouting":B(c,["recordRouting"]);break;case"GetRecordRoutingCollection":break;case"GetServerInfo":break;case"SubmitFile":B(c,["fileToSubmit"],["properties"],["recordRouting"],["sourceUrl"],["userName"]);break;case"ResolvePrincipals":B(c,["principalKeys","principalType","addToUserInfoList"]);break;case"SearchPrincipals":B(c,["searchText","maxResults","principalType"]);break;case"AddPermission":B(c,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"AddPermissionCollection":B(c,["objectName","objectType","permissionsInfoXml"]);break;case"GetPermissionCollection":B(c,["objectName","objectType"]);break;case"RemovePermission":B(c,["objectName","objectType","permissionIdentifier","permissionType"]);break;case"RemovePermissionCollection":B(c,["objectName","objectType","memberIdsXml"]);break;case"UpdatePermission":B(c,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"GetLinks":break;case"GetPortalSearchInfo":xa.opheader="<"+c.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",ya="http://microsoft.com/webservices/OfficeServer/QueryService/"+c.operation;break;case"GetQuerySuggestions":xa.opheader="<"+c.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",ya="http://microsoft.com/webservices/OfficeServer/QueryService/"+c.operation,xa.payload+=E("queryXml",I(c.queryXml));break;case"GetSearchMetadata":xa.opheader="<"+c.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",ya="http://microsoft.com/webservices/OfficeServer/QueryService/"+c.operation;break;case"Query":xa.payload+=E("queryXml",I(c.queryXml));break;case"QueryEx":xa.opheader="<"+c.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",ya="http://microsoft.com/webservices/OfficeServer/QueryService/"+c.operation,xa.payload+=E("queryXml",I(c.queryXml));break;case"Registration":xa.payload+=E("registrationXml",I(c.registrationXml));break;case"Status":break;case"SendClientScriptErrorReport":B(c,["message","file","line","client","stack","team","originalFile"]);break;case"EnumerateFolder":B(c,["strFolderUrl"]);break;case"GetAttachments":B(c,["strListName","strItemId"]);break;case"SiteDataGetList":B(c,["strListName"]),xa=D(xa,c.operation);break;case"SiteDataGetListCollection":xa=D(xa,c.operation);break;case"SiteDataGetSite":xa=D(xa,c.operation);break;case"SiteDataGetSiteUrl":B(c,["Url"]),xa=D(xa,c.operation);break;case"SiteDataGetWeb":xa=D(xa,c.operation);break;case"CreateWeb":B(c,["url","title","description","templateName","language","languageSpecified","locale","localeSpecified","collationLocale","collationLocaleSpecified","uniquePermissions","uniquePermissionsSpecified","anonymous","anonymousSpecified","presence","presenceSpecified"]);break;case"DeleteWeb":B(c,["url"]);break;case"GetSite":B(c,["SiteUrl"]);break;case"GetSiteTemplates":B(c,["LCID","TemplateList"]);break;case"AddComment":B(c,["url","comment","isHighPriority","title"]);break;case"AddTag":B(c,["url","termID","title","isPrivate"]);break;case"AddTagByKeyword":B(c,["url","keyword","title","isPrivate"]);break;case"CountCommentsOfUser":B(c,["userAccountName"]);break;case"CountCommentsOfUserOnUrl":B(c,["userAccountName","url"]);break;case"CountCommentsOnUrl":B(c,["url"]);break;case"CountRatingsOnUrl":B(c,["url"]);break;case"CountTagsOfUser":B(c,["userAccountName"]);break;case"DeleteComment":B(c,["url","lastModifiedTime"]);break;case"DeleteRating":B(c,["url"]);break;case"DeleteTag":B(c,["url","termID"]);break;case"DeleteTagByKeyword":B(c,["url","keyword"]);break;case"DeleteTags":B(c,["url"]);break;case"GetAllTagTerms":B(c,["maximumItemsToReturn"]);break;case"GetAllTagTermsForUrlFolder":B(c,["urlFolder","maximumItemsToReturn"]);break;case"GetAllTagUrls":B(c,["termID"]);break;case"GetAllTagUrlsByKeyword":B(c,["keyword"]);break;case"GetCommentsOfUser":B(c,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetCommentsOfUserOnUrl":B(c,["userAccountName","url"]);break;case"GetCommentsOnUrl":B(c,["url","maximumItemsToReturn","startIndex"]),"undefined"!=typeof c.excludeItemsTime&&c.excludeItemsTime.length>0&&(xa.payload+=E("excludeItemsTime",c.excludeItemsTime));break;case"GetRatingAverageOnUrl":B(c,["url"]);break;case"GetRatingOfUserOnUrl":B(c,["userAccountName","url"]);break;case"GetRatingOnUrl":B(c,["url"]);break;case"GetRatingsOfUser":B(c,["userAccountName"]);break;case"GetRatingsOnUrl":B(c,["url"]);break;case"GetSocialDataForFullReplication":B(c,["userAccountName"]);break;case"GetTags":B(c,["url"]);break;case"GetTagsOfUser":B(c,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetTagTerms":B(c,["maximumItemsToReturn"]);break;case"GetTagTermsOfUser":B(c,["userAccountName","maximumItemsToReturn"]);break;case"GetTagTermsOnUrl":B(c,["url","maximumItemsToReturn"]);break;case"GetTagUrls":B(c,["termID"]);break;case"GetTagUrlsByKeyword":B(c,["keyword"]);break;case"GetTagUrlsOfUser":B(c,["termID","userAccountName"]);break;case"GetTagUrlsOfUserByKeyword":B(c,["keyword","userAccountName"]);break;case"SetRating":B(c,["url","rating","title","analysisDataEntry"]);break;case"UpdateComment":B(c,["url","lastModifiedTime","comment","isHighPriority"]);break;case"SpellCheck":B(c,["chunksToSpell","declaredLanguage","useLad"]);break;case"AddTerms":B(c,["sharedServiceId","termSetId","lcid","newTerms"]);break;case"GetChildTermsInTerm":B(c,["sspId","lcid","termId","termSetId"]);break;case"GetChildTermsInTermSet":B(c,["sspId","lcid","termSetId"]);break;case"GetKeywordTermsByGuids":B(c,["termIds","lcid"]);break;case"GetTermsByLabel":B(c,["label","lcid","matchOption","resultCollectionSize","termIds","addIfNotFound"]);break;case"GetTermSets":B(c,["sharedServiceIds","termSetIds","lcid","clientTimeStamps","clientVersions"]);break;case"AddGroup":B(c,["groupName","ownerIdentifier","ownerType","defaultUserLoginName","description"]);break;case"AddGroupToRole":B(c,["groupName","roleName"]);break;case"AddRole":B(c,["roleName","description","permissionMask"]);break;case"AddRoleDef":B(c,["roleName","description","permissionMask"]);break;case"AddUserCollectionToGroup":B(c,["groupName","usersInfoXml"]);break;case"AddUserCollectionToRole":B(c,["roleName","usersInfoXml"]);break;case"AddUserToGroup":
B(c,["groupName","userName","userLoginName","userEmail","userNotes"]);break;case"AddUserToRole":B(c,["roleName","userName","userLoginName","userEmail","userNotes"]);break;case"GetAllUserCollectionFromWeb":break;case"GetGroupCollection":B(c,["groupNamesXml"]);break;case"GetGroupCollectionFromRole":B(c,["roleName"]);break;case"GetGroupCollectionFromSite":break;case"GetGroupCollectionFromUser":B(c,["userLoginName"]);break;case"GetGroupCollectionFromWeb":break;case"GetGroupInfo":B(c,["groupName"]);break;case"GetRoleCollection":B(c,["roleNamesXml"]);break;case"GetRoleCollectionFromGroup":B(c,["groupName"]);break;case"GetRoleCollectionFromUser":B(c,["userLoginName"]);break;case"GetRoleCollectionFromWeb":break;case"GetRoleInfo":B(c,["roleName"]);break;case"GetRolesAndPermissionsForCurrentUser":break;case"GetRolesAndPermissionsForSite":break;case"GetUserCollection":B(c,["userLoginNamesXml"]);break;case"GetUserCollectionFromGroup":B(c,["groupName"]);break;case"GetUserCollectionFromRole":B(c,["roleName"]);break;case"GetUserCollectionFromSite":break;case"GetUserCollectionFromWeb":break;case"GetUserInfo":B(c,["userLoginName"]);break;case"GetUserLoginFromEmail":B(c,["emailXml"]);break;case"RemoveGroup":B(c,["groupName"]);break;case"RemoveGroupFromRole":B(c,["roleName","groupName"]);break;case"RemoveRole":B(c,["roleName"]);break;case"RemoveUserCollectionFromGroup":B(c,["groupName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromRole":B(c,["roleName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromSite":B(c,["userLoginNamesXml"]);break;case"RemoveUserFromGroup":B(c,["groupName","userLoginName"]);break;case"RemoveUserFromRole":B(c,["roleName","userLoginName"]);break;case"RemoveUserFromSite":B(c,["userLoginName"]);break;case"RemoveUserFromWeb":B(c,["userLoginName"]);break;case"UpdateGroupInfo":B(c,["oldGroupName","groupName","ownerIdentifier","ownerType","description"]);break;case"UpdateRoleDefInfo":B(c,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateRoleInfo":B(c,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateUserInfo":B(c,["userLoginName","userName","userEmail","userNotes"]);break;case"AddColleague":B(c,["accountName","colleagueAccountName","group","privacy","isInWorkGroup"]);break;case"AddLink":B(c,["accountName","name","url","group","privacy"]);break;case"AddMembership":B(c,["accountName","membershipInfo","group","privacy"]);break;case"AddPinnedLink":B(c,["accountName","name","url"]);break;case"CreateMemberGroup":B(c,["membershipInfo"]);break;case"CreateUserProfileByAccountName":B(c,["accountName"]);break;case"GetCommonColleagues":B(c,["accountName"]);break;case"GetCommonManager":B(c,["accountName"]);break;case"GetCommonMemberships":B(c,["accountName"]);break;case"GetInCommon":B(c,["accountName"]);break;case"GetPropertyChoiceList":B(c,["propertyName"]);break;case"GetUserColleagues":B(c,["accountName"]);break;case"GetUserLinks":B(c,["accountName"]);break;case"GetUserMemberships":B(c,["accountName"]);break;case"GetUserPinnedLinks":B(c,["accountName"]);break;case"GetUserProfileByGuid":B(c,["guid"]);break;case"GetUserProfileByIndex":B(c,["index"]);break;case"GetUserProfileByName":"undefined"!=typeof c.accountName&&c.accountName.length>0?B(c,[["AccountName","accountName"]]):B(c,["AccountName"]);break;case"GetUserProfileCount":break;case"GetUserProfileSchema":break;case"GetUserPropertyByAccountName":B(c,["accountName","propertyName"]);break;case"ModifyUserPropertyByAccountName":B(c,["accountName","newData"]);break;case"RemoveAllColleagues":B(c,["accountName"]);break;case"RemoveAllLinks":B(c,["accountName"]);break;case"RemoveAllMemberships":B(c,["accountName"]);break;case"RemoveAllPinnedLinks":B(c,["accountName"]);break;case"RemoveColleague":B(c,["accountName","colleagueAccountName"]);break;case"RemoveLink":B(c,["accountName","id"]);break;case"RemoveMembership":B(c,["accountName","sourceInternal","sourceReference"]);break;case"RemovePinnedLink":B(c,["accountName","id"]);break;case"UpdateColleaguePrivacy":B(c,["accountName","colleagueAccountName","newPrivacy"]);break;case"UpdateLink":B(c,["accountName","data"]);break;case"UpdateMembershipPrivacy":B(c,["accountName","sourceInternal","sourceReference","newPrivacy"]);break;case"UpdatePinnedLink ":B(c,["accountName","data"]);break;case"DeleteAllVersions":B(c,["fileName"]);break;case"DeleteVersion":B(c,["fileName","fileVersion"]);break;case"GetVersions":B(c,["fileName"]);break;case"RestoreVersion":B(c,["fileName","fileVersion"]);break;case"AddView":B(c,["listName","viewName","viewFields","query","rowLimit","rowLimit","type","makeViewDefault"]);break;case"DeleteView":B(c,["listName","viewName"]);break;case"GetView":B(c,["listName","viewName"]);break;case"GetViewCollection":B(c,["listName"]);break;case"GetViewHtml":B(c,["listName","viewName"]);break;case"UpdateView":B(c,["listName","viewName","viewProperties","query","viewFields","aggregations","formats","rowLimit"]);break;case"UpdateViewHtml":B(c,["listName","viewName","viewProperties","toolbar","viewHeader","viewBody","viewFooter","viewEmpty","rowLimitExceeded","query","viewFields","aggregations","formats","rowLimit"]);break;case"AddWebPart":B(c,["pageUrl","webPartXml","storage"]);break;case"AddWebPartToZone":B(c,["pageUrl","webPartXml","storage","zoneId","zoneIndex"]);break;case"DeleteWebPart":B(c,["pageUrl","storageKey","storage"]);break;case"GetWebPart2":B(c,["pageUrl","storageKey","storage","behavior"]);break;case"GetWebPartPage":B(c,["documentName","behavior"]);break;case"GetWebPartProperties":B(c,["pageUrl","storage"]);break;case"GetWebPartProperties2":B(c,["pageUrl","storage","behavior"]);break;case"SaveWebPart2":B(c,["pageUrl","storageKey","webPartXml","storage","allowTypeChange"]);break;case"Webs.CreateContentType":B(c,["displayName","parentType","newFields","contentTypeProperties"]);break;case"GetColumns":B(c,["webUrl"]);break;case"GetContentType":B(c,["contentTypeId"]);break;case"GetContentTypes":break;case"GetCustomizedPageStatus":B(c,["fileUrl"]);break;case"GetListTemplates":break;case"GetObjectIdFromUrl":B(c,["objectUrl"]);break;case"GetWeb":B(c,[["webUrl","webURL"]]);break;case"GetWebCollection":break;case"GetAllSubWebCollection":break;case"UpdateColumns":B(c,["newFields","updateFields","deleteFields"]);break;case"Webs.UpdateContentType":B(c,["contentTypeId","contentTypeProperties","newFields","updateFields","deleteFields"]);break;case"WebUrlFromPageUrl":B(c,[["pageUrl","pageURL"]]);break;case"AlterToDo":B(c,["item","todoId","todoListId","taskData"]);break;case"ClaimReleaseTask":B(c,["item","taskId","listId","fClaim"]);break;case"GetTemplatesForItem":B(c,["item"]);break;case"GetToDosForItem":B(c,["item"]);break;case"GetWorkflowDataForItem":B(c,["item"]);break;case"GetWorkflowTaskData":B(c,["item","listId","taskId"]);break;case"StartWorkflow":B(c,["item","templateId","workflowParameters"])}var h,i=xa.header+xa.opheader+xa.payload+xa.opfooter+xa.footer;if(c.cacheXML&&(h=W[i]),"undefined"==typeof h){var j=a.ajax({url:e,async:c.async,beforeSend:function(a){wa[c.operation][1]&&a.setRequestHeader("SOAPAction",ya)},type:"POST",data:i,dataType:"xml",contentType:"text/xml;charset='utf-8'",complete:function(b,d){a.isFunction(c.completefunc)&&c.completefunc(b,d)}});return c.cacheXML&&(W[i]=j),j}return a.isFunction(c.completefunc)&&h.done(function(a,b,d){c.completefunc(d,b)}),h},a.fn.SPServices.defaults={cacheXML:!1,operation:"",webURL:"",makeViewDefault:!1,viewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:0,CAMLQueryOptions:"<QueryOptions></QueryOptions>",batchCmd:"Update",valuepairs:[],DestinationUrls:[],behavior:"Version3",storage:"Shared",objectType:"List",cancelMeeting:!0,nonGregorian:!1,fClaim:!1,recurrenceId:0,sequence:0,maximumItemsToReturn:0,startIndex:0,isHighPriority:!1,isPrivate:!1,rating:1,maxResults:10,principalType:"User",async:!0,completefunc:null},a.fn.SPServices.SPGetCurrentSite=function(){if(ta.thisSite.length>0)return ta.thisSite;var b=xa.header+"<WebUrlFromPageUrl xmlns='"+R+"/soap/' ><pageUrl>"+(location.href.indexOf("?")>0?location.href.substr(0,location.href.indexOf("?")):location.href)+"</pageUrl></WebUrlFromPageUrl>"+xa.footer;return a.ajax({async:!1,url:"/_vti_bin/Webs.asmx",type:"POST",data:b,dataType:"xml",contentType:'text/xml;charset="utf-8"',complete:function(b){ta.thisSite=a(b.responseXML).find("WebUrlFromPageUrlResult").text()}}),ta.thisSite},a.fn.SPServices.SPComplexToSimpleDropdown=function(b){var c=a.extend({},{listName:a().SPServices.SPListNameFromUrl(),columnName:"",completefunc:null,debug:!1},b),d=a().SPServices.SPDropdownCtl({displayName:c.columnName});if(null===d.Obj.html()&&c.debug)return void x("SPServices.SPComplexToSimpleDropdown","columnName: "+c.columnName,Q);if(d.Type===U.complex){var e=a(d.Obj).attr("choices").split("|"),f=d.optHid.val(),g=z("SPComplexToSimpleDropdown",d.Obj.attr("title"),c.listName),h="<select id='"+g+"' title='"+c.columnName+"'>";for(ua=0;ua<e.length;ua+=2){var i=e[ua+1]===f?" selected='selected' ":" ";h+="<option"+i+"value='"+e[ua+1]+"'>"+e[ua]+"</option>"}h+="</select>",d.Obj.closest("td").prepend(h);var j=a("#"+g);d.Obj.closest("span").find("img").remove(),d.Obj.closest("span").find("input").hide(),j.change(function(){var b=a(this).val();d.optHid.val(b),a(d.Obj).val(a(this).find("option[value='"+("0"!==b?b:"")+"']").html())}),j.trigger("change"),null!==c.completefunc&&c.completefunc()}},a.fn.SPServices.SPDisplayRelatedInfo=function(c){var d,e,f=a.extend({},{listName:a().SPServices.SPListNameFromUrl(),columnName:"",relatedWebURL:"",relatedList:"",relatedListColumn:"",relatedColumns:[],displayFormat:"table",headerCSSClass:"ms-vh2",rowCSSClass:"ms-vb",CAMLQuery:"",numChars:0,matchType:"Eq",matchOnId:!1,completefunc:null,debug:!1},c),g=[],h="SPServices.SPDisplayRelatedInfo",i=a().SPServices.SPDropdownCtl({displayName:f.columnName});if(null===i.Obj.html()&&f.debug)return void x(h,"columnName: "+f.columnName,Q);switch(d=z("SPDisplayRelatedInfo",f.columnName,f.listName),a().SPServices({operation:"GetList",async:!1,cacheXML:!0,webURL:f.relatedWebURL,listName:f.relatedList,completefunc:function(b){for(a(b.responseXML).find("faultcode").each(function(){f.debug&&x(h,"relatedList: "+f.relatedList,"List not found")}),e=a(b.responseXML).find("List"),ua=0;ua<f.relatedColumns.length;ua++)g[f.relatedColumns[ua]]=a(b.responseXML).find("Fields > Field[Name='"+f.relatedColumns[ua]+"']");g[f.relatedListColumn]=a(b.responseXML).find("Fields > Field[Name='"+f.relatedListColumn+"']")}}),i.Type){case U.simple:i.Obj.bind("change",function(){b(f,d,e,g)});break;case U.complex:i.optHid.bind("propertychange",function(){b(f,d,e,g)});break;case U.multiSelect:f.debug&&x(h,"columnName: "+f.columnName,"Multi-select columns not supported by this function")}b(f,d,e,g)},a.fn.SPServices.SPFilterDropdown=function(b){var c,d,e=a.extend({},{relationshipWebURL:"",relationshipList:"",relationshipListColumn:"",relationshipListSortColumn:"",relationshipListSortAscending:!0,columnName:"",listName:a().SPServices.SPListNameFromUrl(),promptText:"",noneText:"(None)",CAMLQuery:"",CAMLQueryOptions:"<QueryOptions><IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns><ViewAttributes Scope='RecursiveAll'/></QueryOptions>",completefunc:null,debug:!1},b),f="",g=null,h="SPServices.SPFilterDropdown",i=a().SPServices.SPDropdownCtl({displayName:e.columnName});if(null===i.Obj.html()&&e.debug)return void x(h,"columnName: "+e.columnName,Q);g=w(i,!0);var j=e.relationshipListSortColumn.length>0?e.relationshipListSortColumn:e.relationshipListColumn,k=e.relationshipListSortAscending===!0?"":"Ascending='FALSE'",l="<Query><OrderBy><FieldRef Name='"+j+"' "+k+"/></OrderBy><Where>";e.CAMLQuery.length>0&&(l+=e.CAMLQuery),l+="</Where></Query>",a().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:e.listName,completefunc:function(b){a(b.responseXML).find("Fields").each(function(){a(this).find("Field[DisplayName='"+e.columnName+"']").each(function(){return d="TRUE"===a(this).attr("Required"),!1})})}}),a().SPServices({operation:"GetListItems",async:!1,webURL:e.relationshipWebURL,listName:e.relationshipList,CAMLQuery:l,CAMLViewFields:"<ViewFields><FieldRef Name='"+e.relationshipListColumn+"' /></ViewFields>",CAMLRowLimit:0,CAMLQueryOptions:e.CAMLQueryOptions,completefunc:function(b){switch(a(b.responseXML).find("errorstring").each(function(){var b=a(this).text();e.debug&&"One or more field types are not installed properly. Go to the list settings page to delete these fields."===b?x(h,"relationshipListColumn: "+e.relationshipListColumn,"Not found in relationshipList "+e.relationshipList):e.debug&&"Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)."===b&&x(h,"relationshipList: "+e.relationshipList,"List not found")}),i.Type){case U.simple:a(i.Obj).find("option").remove(),!d&&e.promptText.length>0?i.Obj.append("<option value='0'>"+e.promptText.replace(/\{0\}/g,e.columnName)+"</option>"):d||i.Obj.append("<option value='0'>"+e.noneText+"</option>");break;case U.complex:f=d?"":e.noneText+"|0",i.Obj.val("");break;case U.multiSelect:a(i.master.candidateControl).find("option").remove(),c=""}switch(a(b.responseXML).SPFilterNode("z:row").each(function(){var b={},d=a(this).attr("ows_"+e.relationshipListColumn);switch("undefined"!=typeof d&&d.indexOf(P)>0?b=new L(d):(b.id=a(this).attr("ows_ID"),b.value=d),isNaN(b.id)&&(b.id=a(this).attr("ows_ID")),i.Type){case U.simple:var h=a(this).attr("ows_ID")===g[0]?" selected='selected'":"";i.Obj.append("<option"+h+" value='"+b.id+"'>"+b.value+"</option>");break;case U.complex:b.id===g[0]&&i.Obj.val(b.value),f=f+(f.length>0?"|":"")+b.value+"|"+b.id;break;case U.multiSelect:a(i.master.candidateControl).append("<option value='"+b.id+"'>"+b.value+"</option>"),c+=b.id+"|t"+b.value+"|t |t |t"}}),i.Type){case U.simple:i.Obj.trigger("change");break;case U.complex:i.Obj.attr("choices",f),i.Obj.trigger("propertychange");break;case U.multiSelect:i.master.data="",i.MultiLookupPickerdata.val(c),a(i.master.resultControl).find("option").each(function(){var b=a(this);a(this).attr("selected","selected"),a(i.master.candidateControl).find("option").each(function(){a(this).html()===b.html()&&b.removeAttr("selected")})}),GipRemoveSelectedItems(i.master),a(i.master.candidateControl).find("option").each(function(){var b=a(this);a(i.master.resultControl).find("option").each(function(){a(this).html()===b.html()&&b.remove()})}),GipAddSelectedItems(i.master),i.master.data=GipGetGroupData(c),a(i.master.candidateControl).trigger("dblclick")}}}),null!==e.completefunc&&e.completefunc()},a.fn.SPServices.SPDebugXMLHttpResult=function(b){var c,d=a.extend({},{node:null,indent:0},b),e=3,f=4,g="";if(g+="<table class='ms-vb' style='margin-left:"+3*d.indent+"px;' width='100%'>","DisplayPattern"===d.node.nodeName)g+="<tr><td width='100px' style='font-weight:bold;'>"+d.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+d.node.xml+"</textarea></td></tr>";else if(d.node.hasChildNodes())if(d.node.hasChildNodes()&&d.node.firstChild.nodeType===f)g+="<tr><td width='100px' style='font-weight:bold;'>"+d.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+d.node.parentNode.text+"</textarea></td></tr>";else if(d.node.hasChildNodes()&&d.node.firstChild.nodeType===e)g+="<tr><td width='100px' style='font-weight:bold;'>"+d.node.nodeName+"</td><td>"+G(d.node.firstChild.nodeValue)+"</td></tr>";else{for(g+="<tr><td width='100px' style='font-weight:bold;' colspan='99'>"+d.node.nodeName+"</td></tr>",d.node.attributes&&(g+="<tr><td colspan='99'>"+v(d.node)+"</td></tr>"),g+="<tr><td>",c=0;c<d.node.childNodes.length;c++)g+=a().SPServices.SPDebugXMLHttpResult({node:d.node.childNodes.item(c),indent:d.indent+1});g+="</td></tr>"}else g+="<tr><td width='100px' style='font-weight:bold;'>"+d.node.nodeName+"</td><td>"+(null!==d.node.nodeValue?G(d.node.nodeValue):"&nbsp;")+"</td></tr>",d.node.attributes&&(g+="<tr><td colspan='99'>"+v(d.node)+"</td></tr>");return g+="</table>"},a.fn.SPServices.SPGetCurrentUser=function(b){var c=a.extend({},{webURL:"",fieldName:"Name",fieldNames:{},debug:!1},b);if("ID"===c.fieldName&&"undefined"!=typeof ta.thisUserId)return ta.thisUserId;var d,e="",f={},g=c.fieldNames.length>0?c.fieldNames.length:1,h=c.webURL.length>0?c.webURL:a().SPServices.SPGetCurrentSite();for(a.ajax({async:!1,url:("/"===h?"":h)+"/_layouts/userdisp.aspx?Force=True&"+(new Date).getTime(),complete:function(a){d=a}}),ua=0;g>ua;ua++){if("ID"===c.fieldNames[ua])e=ta.thisUserId;else{var i;i=g>1?RegExp('FieldInternalName="'+c.fieldNames[ua]+'"',"gi"):RegExp('FieldInternalName="'+c.fieldName+'"',"gi"),a(d.responseText).find("table.ms-formtable td[id^='SPField']").each(function(){if(i.test(a(this).html())){switch(a(this).attr("id")){case"SPFieldText":e=a(this).text();break;case"SPFieldNote":e=a(this).find("div").html();break;case"SPFieldURL":e=a(this).find("img").attr("src");break;default:e=a(this).text()}return!1}})}"ID"!==c.fieldNames[ua]&&(e="undefined"!=typeof e?e.replace(/(^[\s\xA0]+|[\s\xA0]+$)/g,""):null),g>1&&(f[c.fieldNames[ua]]=e)}return g>1?f:e},a.fn.SPServices.SPLookupAddNew=function(b){var c=a.extend({},{lookupColumn:"",promptText:"Add new {0}",newWindow:!1,ContentTypeID:"",completefunc:null,debug:!1},b),d="SPServices.SPLookupAddNew",e=a().SPServices.SPDropdownCtl({displayName:c.lookupColumn});if(null===e.Obj.html()&&c.debug)return void x(d,"lookupColumn: "+c.lookupColumn,Q);var f="",g="",h="";if(a().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:a().SPServices.SPListNameFromUrl(),completefunc:function(b){a(b.responseXML).find("Field[DisplayName='"+c.lookupColumn+"']").each(function(){return h=a(this).attr("StaticName"),a().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:a(this).attr("List"),completefunc:function(b){a(b.responseXML).find("List").each(function(){g=a(this).attr("WebFullUrl"),g=g!==O?g+O:g})}}),f=A(a(this).attr("List"),"NewForm"),!1})}}),0===g.length&&c.debug)return void x(d,"lookupColumn: "+c.lookupColumn,"This column does not appear to be a lookup column");if(f.length>0){var i=g+f;i+=c.newWindow?(c.ContentTypeID.length>0?"?ContentTypeID="+c.ContentTypeID:"")+"' target='_blank'":"?"+(c.ContentTypeID.length>0?"ContentTypeID="+c.ContentTypeID+"&":"")+"Source="+K(location.href)+"'";var j="<div id='SPLookupAddNew_"+h+"'><a href='"+i+">"+c.promptText.replace(/\{0\}/g,c.lookupColumn)+"</a></div>";a(e.Obj).parents("td.ms-formbody").append(j)}else if(c.debug)return void x(d,"lookupColumn: "+c.lookupColumn,"NewForm cannot be found");null!==c.completefunc&&c.completefunc()},a.fn.SPServices.SPGetLastItemId=function(b){var c,d=a.extend({},{webURL:"",listName:"",userAccount:"",CAMLQuery:""},b),e=0;a().SPServices({operation:"GetUserInfo",webURL:d.webURL,async:!1,userLoginName:""!==d.userAccount?d.userAccount:a().SPServices.SPGetCurrentUser(),completefunc:function(b){a(b.responseXML).find("User").each(function(){c=a(this).attr("ID")})}});var f="<Query><Where>";return d.CAMLQuery.length>0&&(f+="<And>"),f+="<Eq><FieldRef Name='Author' LookupId='TRUE'/><Value Type='Integer'>"+c+"</Value></Eq>",d.CAMLQuery.length>0&&(f+=d.CAMLQuery+"</And>"),f+="</Where><OrderBy><FieldRef Name='Created_x0020_Date' Ascending='FALSE'/></OrderBy></Query>",a().SPServices({operation:"GetListItems",async:!1,webURL:d.webURL,listName:d.listName,CAMLQuery:f,CAMLViewFields:"<ViewFields><FieldRef Name='ID'/></ViewFields>",CAMLRowLimit:1,CAMLQueryOptions:"<QueryOptions><ViewAttributes Scope='Recursive' /></QueryOptions>",completefunc:function(b){a(b.responseXML).SPFilterNode("z:row").each(function(){e=a(this).attr("ows_ID")})}}),e},a.fn.SPServices.SPRequireUnique=function(b){var c=a.extend({},{columnStaticName:"Title",duplicateAction:0,ignoreCase:!1,initMsg:"This value must be unique.",initMsgCSSClass:"ms-vb",errMsg:"This value is not unique.",errMsgCSSClass:"ms-formvalidation",showDupes:!1,completefunc:null},b),d=a().SPServices.SPGetQueryString(),e=d.ID;ta.thisList=a().SPServices.SPListNameFromUrl();var f="<span id='SPRequireUnique"+c.columnStaticName+"' class='{0}'>{1}</span><br/>",g=f.replace(/\{0\}/g,c.initMsgCSSClass).replace(/\{1\}/g,c.initMsg),h=a().SPServices.SPGetDisplayFromStatic({listName:ta.thisList,columnStaticName:c.columnStaticName}),i=C(h).find("input[Title^='"+h+"']");i.parent().append(g),i.blur(function(){var b=[],d=a(this).val();if(0===d.length)return!1;a().SPServices({operation:"GetListItems",async:!1,listName:ta.thisList,CAMLQuery:"<Query><Where><IsNotNull><FieldRef Name='"+c.columnStaticName+"'/></IsNotNull></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='ID' /><FieldRef Name='"+c.columnStaticName+"' /></ViewFields>",CAMLRowLimit:0,completefunc:function(f){var g=c.ignoreCase?d.toUpperCase():d;a(f.responseXML).SPFilterNode("z:row").each(function(){var d=c.ignoreCase?a(this).attr("ows_"+c.columnStaticName).toUpperCase():a(this).attr("ows_"+c.columnStaticName);g===d&&a(this).attr("ows_ID")!==e&&b.push([a(this).attr("ows_ID"),a(this).attr("ows_"+c.columnStaticName)])})}});var f=c.initMsg,g=a("#SPRequireUnique"+c.columnStaticName);if(g.html(f).attr("class",c.initMsgCSSClass),a("input[value='OK']:disabled, input[value='Save']:disabled").removeAttr("disabled"),b.length>0&&(f=c.errMsg,g.html(f).attr("class",c.errMsgCSSClass),1===c.duplicateAction&&(i.focus(),a("input[value='OK'], input[value='Save']").attr("disabled","disabled")),c.showDupes)){var h=" "+b.length+" duplicate item"+(b.length>1?"s":"")+": ";for(ua=0;ua<b.length;ua++)h+="<a href='DispForm.aspx?ID="+b[ua][0]+"&Source="+location.href+"'>"+b[ua][1]+"</a> ";a("span#SPRequireUnique"+c.columnStaticName).append(h)}}),null!==c.completefunc&&c.completefunc()},a.fn.SPServices.SPGetDisplayFromStatic=function(b){var c=a.extend({},{webURL:"",listName:"",columnStaticName:"",columnStaticNames:{}},b),d="",e={},f=c.columnStaticNames.length>0?c.columnStaticNames.length:1;return a().SPServices({operation:"GetList",async:!1,cacheXML:!0,webURL:c.webURL,listName:c.listName,completefunc:function(b){if(f>1)for(ua=0;f>ua;ua++)e[c.columnStaticNames[ua]]=a(b.responseXML).find("Field[StaticName='"+c.columnStaticNames[ua]+"']").attr("DisplayName");else d=a(b.responseXML).find("Field[StaticName='"+c.columnStaticName+"']").attr("DisplayName")}}),f>1?e:d},a.fn.SPServices.SPGetStaticFromDisplay=function(b){var c=a.extend({},{webURL:"",listName:"",columnDisplayName:"",columnDisplayNames:{}},b),d="",e={},f=c.columnDisplayNames.length>0?c.columnDisplayNames.length:1;return a().SPServices({operation:"GetList",async:!1,cacheXML:!0,webURL:c.webURL,listName:c.listName,completefunc:function(b){if(f>1)for(ua=0;f>ua;ua++)e[c.columnDisplayNames[ua]]=a(b.responseXML).find("Field[DisplayName='"+c.columnDisplayNames[ua]+"']").attr("StaticName");else d=a(b.responseXML).find("Field[DisplayName='"+c.columnDisplayName+"']").attr("StaticName")}}),f>1?e:d},a.fn.SPServices.SPRedirectWithID=function(b){var c=a.extend({},{redirectUrl:"",qsParamName:"ID"},b);ta.thisList=a().SPServices.SPListNameFromUrl();var d=a().SPServices.SPGetQueryString(),e=d.ID,f=d.List,g=d.RootFolder,h=d.ContentTypeId;if("undefined"==typeof d.ID)e=a().SPServices.SPGetLastItemId({listName:ta.thisList}),a("form[id='aspnetForm']").each(function(){var a=location.href.indexOf("?")>0?location.href.substring(0,location.href.indexOf("?")):location.href,b="string"==typeof d.Source?"Source="+d.Source.replace(/\//g,"%2f").replace(/:/g,"%3a"):"",c=[];"undefined"!=typeof f&&c.push("List="+f),"undefined"!=typeof g&&c.push("RootFolder="+g),"undefined"!=typeof h&&c.push("ContentTypeId="+h);var i=a+(c.length>0?"?"+c.join("&")+"&":"?")+"Source="+a+"?ID="+e+(b.length>0?"%26RealSource="+d.Source:"")+("string"==typeof d.RedirectURL?"%26RedirectURL="+d.RedirectURL:"");setTimeout(function(){document.forms.aspnetForm.action=i},0)});else{for(;d.ID===e;)e=a().SPServices.SPGetLastItemId({listName:ta.thisList});var i="string"==typeof d.RedirectURL?d.RedirectURL:c.redirectUrl;location.href=i+"?"+c.qsParamName+"="+e+("string"==typeof d.RealSource?"&Source="+d.RealSource:"")}},a.fn.SPServices.SPSetMultiSelectSizes=function(b){var c=a.extend({},{listName:a().SPServices.SPListNameFromUrl(),multiSelectColumn:"",minWidth:0,maxWidth:0,debug:!1},b),d="SPServices.SPSetMultiSelectSizes",e=a().SPServices.SPDropdownCtl({displayName:c.multiSelectColumn});if(null===e.Obj.html()&&c.debug)return void x(d,"multiSelectColumn: "+c.multiSelectColumn,Q);if(e.Type!==U.multiSelect&&c.debug)return void x(d,"multiSelectColumn: "+c.multiSelectColumn,"Column is not multi-select.");var f=z("SPSetMultiSelectSizes",c.multiSelectColumn,c.listName),g=a("<select id='"+f+"' ></select>").appendTo(e.container);g.css({width:"auto",height:0,visibility:"hidden"}),a(e.master.candidateControl).find("option").each(function(){g.append("<option value='"+a(this).html()+"'>"+a(this).html()+"</option>")}),a(e.master.resultControl).find("option").each(function(){g.append("<option value='"+a(this).val()+"'>"+a(this).html()+"</option>")});var h=g.width()+5,i=h;(c.minWidth>0||c.maxWidth>0)&&(h<c.minWidth&&(h=c.minWidth),i<c.minWidth&&(i=c.minWidth),i>c.maxWidth&&(i=c.maxWidth));var j=h;a(e.master.candidateControl).css("width",j+"px").parent().css("width",i+"px"),a(e.master.resultControl).css("width",j+"px").parent().css("width",i+"px"),g.remove()},a.fn.SPServices.SPScriptAudit=function(b){var d,e=a.extend({},{webURL:"",listName:"",outputId:"",auditForms:!0,auditViews:!0,auditPages:!0,auditPagesListName:"Pages",showHiddenLists:!1,showNoScript:!1,showSrc:!0},b),f=[["New","NewForm.aspx",!1],["Display","DispForm.aspx",!1],["Edit","EditForm.aspx",!1]];a("#"+e.outputId).append("<table id='SPScriptAudit' width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1><tr><th></th><th>List</th><th>Page Class</th><th>Page Type</th><th>Page</th>"+(e.showSrc?"<th>Script References</th>":"")+"</tr></table>");var g=a("#SPScriptAudit");g.find("th").attr("class","ms-vh2-nofilter"),(e.auditForms||e.auditViews)&&a().SPServices({operation:"GetListCollection",webURL:e.webURL,async:!1,completefunc:function(b){a(b.responseXML).find("List").each(function(){d=a(this),(0===e.listName.length||d.attr("Title")===e.listName)&&(e.showHiddenLists&&"False"===d.attr("Hidden")||!e.showHiddenLists)&&(e.auditForms&&a().SPServices({operation:"GetListContentTypes",webURL:e.webURL,listName:d.attr("ID"),async:!1,completefunc:function(b){a(b.responseXML).find("ContentType").each(function(){if("0x0120"!==a(this).attr("ID").substring(0,6)){var b=a(this).find("FormUrls");for(ua=0;ua<f.length;ua++)if(a(b).find(f[ua][0]).each(function(){c(e,d,"Form",this.nodeName,(e.webURL.length>0?e.webURL:a().SPServices.SPGetCurrentSite())+O+a(this).text()),f[ua][2]=!0}),!f[ua][2]){var g=d.attr("DefaultViewUrl");c(e,d,"Form",f[ua][0],g.substring(0,g.lastIndexOf(O)+1)+f[ua][1])}for(ua=0;ua<f.length;ua++)f[ua][2]=!1}})}}),e.auditViews&&a().SPServices({operation:"GetViewCollection",webURL:e.webURL,listName:d.attr("ID"),async:!1,completefunc:function(b){a(b.responseXML).find("View").each(function(){c(e,d,"View",a(this).attr("DisplayName"),a(this).attr("Url"))})}}))})}});var h=0,i=[];if("string"==typeof e.auditPagesListName?(h=1,i.push(e.auditPagesListName)):(h=e.auditPagesListName.length,i=e.auditPagesListName),e.auditPages)for(ua=0;h>ua;ua++)a().SPServices({operation:"GetList",async:!1,cacheXML:!0,webURL:e.webURL,listName:i[ua],completefunc:function(b){a(b.responseXML).find("List").each(function(){d=a(this)})}}),a().SPServices({operation:"GetListItems",async:!1,webURL:e.webURL,listName:i[ua],CAMLQuery:"<Query><Where><Neq><FieldRef Name='ContentType'/><Value Type='Text'>Folder</Value></Neq></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='Title'/><FieldRef Name='FileRef'/></ViewFields>",CAMLRowLimit:0,completefunc:function(b){a(b.responseXML).SPFilterNode("z:row").each(function(){var b=a(this).attr("ows_FileRef").split(P)[1],f=a(this).attr("ows_Title"),g="undefined"!=typeof f?f:"";b.indexOf(".aspx")>0&&c(e,d,"Page",g,O+b)})}});g.find("tr[class='ms-alternating']:even").removeAttr("class")},a.fn.SPServices.SPArrangeChoices=function(b){var c=a.extend({},{listName:a().SPServices.SPListNameFromUrl(),columnName:"",perRow:99,randomize:!1},b),d=!1,e=[],f=a().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:c.listName});f.done(function(){a(f.responseXML).find("Field[DisplayName='"+c.columnName+"']").each(function(){return d="TRUE"===a(this).attr("FillInChoice"),!1});var b,g,h=C(c.columnName),i=a(h).find("tr").length;a(h).find("tr").each(function(c){d&&c===i-2?b=a(this).find("td"):d&&c===i-1?g=a(this).find("td"):e.push(a(this).find("td"))}),c.randomize&&e.sort(F);var j=a("<table cellpadding='0' cellspacing='1'></table>");for(ua=0;ua<e.length;ua++)(ua+1)%c.perRow===0&&j.append("<tr></tr>"),j.find("tr:last").append(e[ua]);if(d){var k=a("<tr><td colspan='99'><table cellpadding='0' cellspacing='1'><tr></tr></table></td></tr>");k.find("tr").append(b),k.find("tr").append(g),j.append(k)}var l=a(h).find("table:first");l.before(j),l.hide()})},a.fn.SPServices.SPAutocomplete=function(b){var c,d=a.extend({},{webURL:"",sourceList:"",sourceColumn:"",columnName:"",listName:a().SPServices.SPListNameFromUrl(),CAMLQuery:"",CAMLQueryOptions:"<QueryOptions></QueryOptions>",CAMLRowLimit:0,filterType:"BeginsWith",numChars:0,ignoreCase:!1,highlightClass:"",uniqueVals:!1,maxHeight:99999,slideDownSpeed:"fast",processingIndicator:"_layouts/images/REFRESH.GIF",debug:!1},b),e=C(d.columnName).find("input[Title^='"+d.columnName+"']");e.css("position","");var f=e.css("color"),g=e.css("width");if(null===e.html()&&d.debug)return void x("SPServices.SPAutocomplete","columnName: "+d.columnName,"Column is not an input control or is not found on page");e.closest("span").find("br").remove(),e.wrap("<div>");var h=z("SPAutocomplete",d.columnName,d.listName);e.after("<div><ul id='"+h+"' style='width:"+g+";display:none;padding:2px;border:1px solid #2A1FAA;background-color:#FFF;position:absolute;z-index:40;margin:0'></div>");var i=a("#"+h);i.css("width",g),a(e).keyup(function(){var b=a(this).val();if(i.hide(),b.length<d.numChars)return!1;e.css({"background-image":"url("+d.processingIndicator+")","background-position":"right","background-repeat":"no-repeat"});var g=[],j="<Query><OrderBy><FieldRef Name='"+d.sourceColumn+"'/></OrderBy><Where>";d.CAMLQuery.length>0&&(j+="<And>"),j+="<"+d.filterType+"><FieldRef Name='"+d.sourceColumn+"'/><Value Type='Text'>"+b+"</Value></"+d.filterType+">",d.CAMLQuery.length>0&&(j+=d.CAMLQuery+"</And>"),j+="</Where></Query>",a().SPServices({operation:"GetListItems",async:!1,webURL:d.WebURL,listName:d.sourceList,CAMLQuery:j,CAMLQueryOptions:d.CAMLQueryOptions,CAMLViewFields:"<ViewFields><FieldRef Name='"+d.sourceColumn+"' /></ViewFields>",CAMLRowLimit:d.CAMLRowLimit,completefunc:function(c){var e=d.ignoreCase?b.toUpperCase():b;a(c.responseXML).SPFilterNode("z:row").each(function(){var b=a(this).attr("ows_"+d.sourceColumn),c=d.ignoreCase?a(this).attr("ows_"+d.sourceColumn).toUpperCase():a(this).attr("ows_"+d.sourceColumn);if("Contains"===d.filterType){var f=c.indexOf(e);f>=0&&(!d.uniqueVals||-1===a.inArray(b,g))&&g.push(a(this).attr("ows_"+d.sourceColumn))}else e!==c.substr(0,e.length)||d.uniqueVals&&-1!==a.inArray(b,g)||g.push(a(this).attr("ows_"+d.sourceColumn))})}});var k="";for(ua=0;ua<g.length;ua++){if(d.highlightClass.length>0){var l=new RegExp(b,d.ignoreCase?"gi":"g"),m=g[ua].match(l),n=0;for(c=0;c<m.length;c++){var o=g[ua].indexOf(m[c],n),p=o+m[c].length,q="<span class='"+d.highlightClass+"'>"+m[c]+"</span>";g[ua]=g[ua].substr(0,o)+q+g[ua].substr(p),n=o+q.length}}k+="<li style='display: block;position: relative;cursor: pointer;'>"+g[ua]+"</li>"}i.html(k),a("#"+h+" li").click(function(){a("#"+h).fadeOut(d.slideUpSpeed),e.val(a(this).text())}).mouseover(function(){var b={cursor:"hand",color:"#ffffff",background:"#3399ff"};a(this).css(b)}).mouseout(function(){var b={cursor:"inherit",color:f,background:"transparent"};a(this).css(b)}),g.length>0&&a("#"+h).slideDown(d.slideDownSpeed),e.css("background-image","");

})},a.fn.SPServices.SPGetQueryString=function(b){for(var c=a.extend({},{lowercase:!1},b),d={},e=location.search.slice(1).split("&"),f=0;f<e.length;f++){var g=e[f].split("="),h=c.lowercase?g[0].toLowerCase():g[0];d[h]=decodeURIComponent(g[1]||"")}return d},a.fn.SPServices.SPListNameFromUrl=function(b){var c=a.extend({},{listName:""},b);if(c.listName.length>0)return ta.thisList=c.listName,ta.thisList;if(void 0!==ta.thisList&&ta.thisList.length>0)return ta.thisList;var d=location.href,e=d.substring(0,d.indexOf(".aspx")),f=decodeURIComponent(e.substring(0,e.lastIndexOf(O)+1)).toUpperCase();return a().SPServices({operation:"GetListCollection",async:!1,completefunc:function(b){a(b.responseXML).find("List").each(function(){var b=a(this).attr("DefaultViewUrl"),c=b.substring(0,b.lastIndexOf(O)+1).toUpperCase();return f.indexOf(c)>0?(ta.thisList=a(this).attr("ID"),!1):void 0})}}),ta.thisList},a.fn.SPServices.SPUpdateMultipleListItems=function(b){var c,d=a.extend({},{webURL:"",listName:"",CAMLQuery:"",batchCmd:"Update",valuepairs:[],completefunc:null,debug:!1},b),e=[],f=[];a().SPServices({operation:"GetListItems",async:!1,webURL:d.webURL,listName:d.listName,CAMLQuery:d.CAMLQuery,CAMLQueryOptions:"<QueryOptions><ViewAttributes Scope='Recursive' /></QueryOptions>",completefunc:function(b){a(b.responseXML).SPFilterNode("z:row").each(function(){e.push(a(this).attr("ows_ID"));var b=a(this).attr("ows_FileRef");b="/"+b.substring(b.indexOf(P)+2),f.push(b)})}});var g,h="<Batch OnError='Continue'>";for(c=0;c<e.length;c++){for(h+="<Method ID='"+c+"' Cmd='"+d.batchCmd+"'>",g=0;g<d.valuepairs.length;g++)h+="<Field Name='"+d.valuepairs[g][0]+"'>"+J(d.valuepairs[g][1])+"</Field>";h+="<Field Name='ID'>"+e[c]+"</Field>",f[c].length>0&&(h+="<Field Name='FileRef'>"+f[c]+"</Field>"),h+="</Method>"}h+="</Batch>",a().SPServices({operation:"UpdateListItems",async:!1,webURL:d.webURL,listName:d.listName,updates:h,completefunc:function(a){null!==d.completefunc&&d.completefunc(a)}})},a.fn.SPServices.SPGetListItemsJson=function(b){var c,d=a.extend({},{webURL:"",listName:"",viewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:"",CAMLQueryOptions:"",changeToken:"",contains:"",mapping:null,mappingOverrides:null,debug:!1},a().SPServices.defaults,b),e={},f=[],g=a.Deferred(),h=a().SPServices({operation:"GetListItemChangesSinceToken",webURL:d.webURL,listName:d.listName,viewName:d.viewName,CAMLQuery:d.CAMLQuery,CAMLViewFields:d.CAMLViewFields,CAMLRowLimit:d.CAMLRowLimit,CAMLQueryOptions:d.CAMLQueryOptions,changeToken:d.changeToken,contains:d.contains});return h.done(function(){var b="SPGetListItemsJson"+d.webURL+d.listName,i=a(h.responseXML);if(c=i.find("Changes").attr("LastChangeToken"),i.find("listitems Changes Id[ChangeType='Delete']").each(function(){f.push(a(this).text())}),null===d.mapping?i.find("List > Fields > Field").each(function(){var b=a(this),c=b.attr("Type");a.inArray(c,V)>=0&&(e["ows_"+b.attr("Name")]={mappedName:b.attr("Name"),objectType:b.attr("Type")})}):e=d.mapping,null!==d.mappingOverrides)for(var j in d.mappingOverrides)e[j]=d.mappingOverrides[j];a.isEmptyObject(e)?e=a(document).data(b):a(document).data(b,e);var k=i.SPFilterNode("z:row").SPXmlToJson({mapping:e,sparse:!0}),l={changeToken:c,mapping:e,data:k,deletedIds:f};g.resolveWith(l)}),g.promise()},a.fn.SPServices.SPConvertDateToISO=function(b){var c=a.extend({},{dateToConvert:new Date,dateOffset:"-05:00"},b),d="",e=c.dateToConvert;return d+=e.getFullYear()+"-",d+=M(e.getMonth()+1)+"-",d+=M(e.getDate()),d+="T"+M(e.getHours())+":",d+=M(e.getMinutes())+":",d+=M(e.getSeconds())+"Z"+c.dateOffset},a.fn.SPFilterNode=function(a){return this.find("*").filter(function(){return this.nodeName===a})},a.fn.SPXmlToJson=function(b){var c,d=a.extend({},{mapping:{},includeAllAttrs:!1,removeOws:!0,sparse:!1},b),e=[];return this.each(function(){var b={},g=this.attributes;for(d.sparse||a.each(d.mapping,function(){b[this.mappedName]=""}),c=0;c<g.length;c++){var h=g[c].name,i=d.mapping[h],j="undefined"!=typeof i?i.mappedName:d.removeOws?h.split("ows_")[1]:h,k="undefined"!=typeof i?i.objectType:void 0;(d.includeAllAttrs||void 0!==i)&&(b[j]=f(g[c].value,k))}e.push(b)}),e},a.fn.SPServices.SPFindPeoplePicker=function(b){var c=a.extend({},{peoplePickerDisplayName:"",valueToSet:"",checkNames:!0,checkNamesPhrase:"Check Names"},b),d=a("nobr").filter(function(){return a(this).contents().eq(0).text()===c.peoplePickerDisplayName}).closest("tr"),e=d.find("div[name='upLevelDiv']"),f=d.find("img[Title='"+c.checkNamesPhrase+"']:first");c.valueToSet.length>0&&e.html(c.valueToSet),c.checkNames&&f.click();var g=a.trim(e.text()),h=[];return e.children("span").each(function(){var b=a(this).find("div[data]").attr("data"),c={};if("undefined"!=typeof b){var d=a.parseXML(b),e=a(d);e.find("DictionaryEntry").each(function(){var b=a(this).find("Key").text();c[b]=a(this).find("Value").text()}),h.push(c)}else a().SPServices({operation:"GetUserInfo",async:!1,cacheXML:!0,userLoginName:a(this).attr("title"),completefunc:function(b){a(b.responseXML).find("User").each(function(){a.each(this.attributes,function(a,b){c[b.name]=b.value}),h.push(c)})}})}),{row:d,contents:e,currentValue:g,checkNames:f,dictionaryEntries:h}},a.fn.SPFindPeoplePicker=function(b){return a().SPServices.SPFindPeoplePicker(b)},a.fn.SPServices.SPFindMMSPicker=function(b){for(var c=a.extend({},{MMSDisplayName:""},b),d=[],e=a("div[title='"+c.MMSDisplayName+"']"),f=e.closest("td").find("input[type='hidden']"),g=f.val().split(";"),h=0;h<g.length;h++){var i=g[h].split("|");d.push({value:i[0],guid:i[1]})}return{terms:d}},a.fn.SPServices.Version=function(){return N},a.fn.SPServices.SPDropdownCtl=function(b){var c=a.extend({},{displayName:""},b),d={};if(1===(d.Obj=a("select[Title='"+c.displayName+"']")).length?d.Type=U.simple:1===(d.Obj=a("input[Title='"+c.displayName+"']")).length?d.Type=U.complex:1===(d.Obj=a("select[ID$='SelectCandidate'][Title^='"+c.displayName+" ']")).length?d.Type=U.multiSelect:1===(d.Obj=a("select[ID$='SelectCandidate'][Title$=': "+c.displayName+"']")).length?d.Type=U.multiSelect:1===(d.Obj=a("select[ID$='SelectCandidate'][Title$='\""+c.displayName+"\".']")).length?d.Type=U.multiSelect:1===(d.Obj=a("select[ID$='SelectCandidate'][Title$=' "+c.displayName+"']")).length?d.Type=U.multiSelect:d.Type=null,null===d.Type){var e=C(c.displayName);if(void 0!==e){var f=e.find("select[title^='"+c.displayName+" '][id$='_Lookup']"),g=e.find("select[title^='"+c.displayName+" '][id$='LookupField']"),h=f.length>0?f:g;h&&1===h.length&&(d.Type=U.simple,d.Obj=h)}}if(d.Type===U.complex)d.optHid=a("input[id='"+d.Obj.attr("optHid")+"']");else if(d.Type===U.multiSelect){d.container=d.Obj.closest("span"),d.MultiLookupPickerdata=d.container.find("input[id$='"+S+"_data'], input[id$='"+T+"_data']");var i=d.container.find("[id$='AddButton']").attr("id");d.master=window[i.replace(/AddButton/,S+"_m")]||window[i.replace(/AddButton/,T+"_m")]}return d};var za={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"}});