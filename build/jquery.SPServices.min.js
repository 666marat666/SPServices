/*
* SPServices - Work with SharePoint's Web Services using jQuery
* Version 2.0.0
* @requires jQuery v1.8 or greater - jQuery 1.10.x+ recommended
*
* Copyright (c) 2009-2015 Sympraxis Consulting LLC
* Examples and docs at:
* http://spservices.codeplex.com/
* Licensed under the MIT license:
* http://www.opensource.org/licenses/mit-license.php
*/
/*
* @description SPServices is a jQuery library which abstracts SharePoint's Web Services and makes them easier to use. It also includes functions which use the various Web Service operations to provide more useful (and cool) capabilities. It works entirely client side and requires no server install.
* @type jQuery
* @name SPServices
* @category Plugins/SPServices
* @author Sympraxis Consulting LLC/marc.anderson@sympraxisconsulting.com
* @build SPServices 2.0.0 2015-05-27 04:44:53
*/
!function(){var a,b,c,d;!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(e){var f=jQuery;a=function(){var a={VERSION:"2.0.0",spDelim:";#",SLASH:"/",TXTColumnNotFound:"Column not found on page",SCHEMASharePoint:"http://schemas.microsoft.com/sharepoint",multiLookupPrefix:"MultiLookupPicker",multiLookupPrefix2013:"MultiLookup",SOAPEnvelope:{header:"<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body>",footer:"</soap:Body></soap:Envelope>",payload:""},dropdownType:{simple:"S",complex:"C",multiSelect:"M"},spListFieldTypes:["Integer","Text","Note","DateTime","Counter","Choice","Lookup","Boolean","Number","Currency","URL","MultiChoice","Calculated","File","Attachments","User","ModStat","ContentTypeId","WorkflowStatus","RelatedItems","UserMulti","LookupMulti","datetime","float","Calc"]};return a}(),b=function(a,b){var c={SPServicesContext:function(){var a=location.protocol+"//"+location.host;"undefined"!=typeof _spPageContextInfo?(this.thisSite=a+_spPageContextInfo.webServerRelativeUrl,this.thisList=_spPageContextInfo.pageListId,this.thisUserId=_spPageContextInfo.userId):(this.thisSite="undefined"!=typeof L_Menu_BaseUrl?a+L_Menu_BaseUrl:"",this.thisList="",this.thisUserId="undefined"!=typeof _spUserId?_spUserId:void 0)},currentContext:new c.SPServicesContext,wrapNode:function(a,b){var c="undefined"!=typeof b?b:"";return"<"+a+">"+c+"</"+a+">"},randOrd:function(){return Math.round(Math.random())-.5},checkLink:function(a){return 0===a.indexOf("http")||0===a.indexOf("/")?"<a href='"+a+"'>"+a+"</a>":a},fileName:function(a){return a.substring(a.lastIndexOf("/")+1,a.length)},xml_special_to_escaped_one_map:{"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"},encodeXml:function(a){return a.replace(/([\&"<>])/g,function(a,b){return this.xml_special_to_escaped_one_map[b]})},escapeColumnValue:function(a){return"string"==typeof a?a.replace(/&(?![a-zA-Z]{1,8};)/g,"&amp;"):a},escapeUrl:function(a){return a.replace(/&/g,"%26")},SplitIndex:function(a){var c=a.split(b.spDelim);this.id=c[0],this.value=c[1]},pad:function(a){return 10>a?"0"+a:a},errBox:function(a,b,c){var e="<b>Error in function</b><br/>"+a+"<br/><b>Parameter</b><br/>"+b+"<br/><b>Message</b><br/>"+c+"<br/><br/><span onmouseover='this.style.cursor=\"hand\";' onmouseout='this.style.cursor=\"inherit\";' style='width=100%;text-align:right;'>Click to continue</span></div>";d(e)},findFormField:function(b){var c,d=RegExp('FieldName="'+b.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")+'"',"gi");return a("td.ms-formbody, td.ms-formbodysurvey").each(function(){return d.test(a(this).html())?(c=a(this),!1):void 0}),c},showAttrs:function(a){var b,d="<table class='ms-vb' width='100%'>";for(b=0;b<a.attributes.length;b++)d+="<tr><td width='10px' style='font-weight:bold;'>"+b+"</td><td width='100px'>"+a.attributes.item(b).nodeName+"</td><td>"+c.checkLink(a.attributes.item(b).nodeValue)+"</td></tr>";return d+="</table>"}},d=function(b){var c="position:absolute;width:300px;height:150px;padding:10px;background-color:#000000;color:#ffffff;z-index:30;font-family:'Arial';font-size:12px;display:none;";a("#aspnetForm").parent().append("<div id='SPServices_msgBox' style="+c+">"+b);var d=a("#SPServices_msgBox"),e=d.height(),f=d.width(),g=a(window).width()/2-f/2+"px",h=a(window).height()/2-e/2-100+"px";d.css({border:"5px #C02000 solid",left:g,top:h}).show().fadeTo("slow",.75).click(function(){a(this).fadeOut("3000",function(){a(this).remove()})})};return c}(f,a),c=function(a,b,c){function d(c,d){var e;for(e=0;e<d.length;e++)"string"==typeof d[e]?b.SOAPEnvelope.payload+=b.wrapNode(d[e],c[d[e]]):a.isArray(d[e])&&2===d[e].length?b.SOAPEnvelope.payload+=b.wrapNode(d[e][0],c[d[e][1]]):"object"==typeof d[e]&&void 0!==d[e].sendNull?b.SOAPEnvelope.payload+=void 0===c[d[e].name]||0===c[d[e].name].length?"":b.wrapNode(d[e].name,c[d[e].name]):b.errBox(c.operation,"paramArray["+e+"]: "+d[e],"Invalid paramArray element passed to addToPayload()")}function e(a,b){var c=b.substring(8);return a.opheader=a.opheader.replace(b,c),a.opfooter=a.opfooter.replace(b,c),a}var f={},g="Alerts",h="Authentication",i="Copy",j="Forms",k="Lists",l="Meetings",m="OfficialFile",n="People",o="Permissions",p="PublishedLinksService",q="Search",r="SharePointDiagnostics",s="SiteData",t="Sites",u="SocialDataService",v="SpellCheck",w="TaxonomyClientService",x="usergroup",y="UserProfileService",z="Versions",A="Views",B="WebPartPages",C="Webs",D="Workflow",E=["listName","description"],F=[];F.GetAlerts=[g,!1],F.DeleteAlerts=[g,!0],F.Mode=[h,!1],F.Login=[h,!1],F.CopyIntoItems=[i,!0],F.CopyIntoItemsLocal=[i,!0],F.GetItem=[i,!1],F.GetForm=[j,!1],F.GetFormCollection=[j,!1],F.AddAttachment=[k,!0],F.AddDiscussionBoardItem=[k,!0],F.AddList=[k,!0],F.AddListFromFeature=[k,!0],F.ApplyContentTypeToList=[k,!0],F.CheckInFile=[k,!0],F.CheckOutFile=[k,!0],F.CreateContentType=[k,!0],F.DeleteAttachment=[k,!0],F.DeleteContentType=[k,!0],F.DeleteContentTypeXmlDocument=[k,!0],F.DeleteList=[k,!0],F.GetAttachmentCollection=[k,!1],F.GetList=[k,!1],F.GetListAndView=[k,!1],F.GetListCollection=[k,!1],F.GetListContentType=[k,!1],F.GetListContentTypes=[k,!1],F.GetListItemChanges=[k,!1],F.GetListItemChangesSinceToken=[k,!1],F.GetListItems=[k,!1],F.GetVersionCollection=[k,!1],F.UndoCheckOut=[k,!0],F.UpdateContentType=[k,!0],F.UpdateContentTypesXmlDocument=[k,!0],F.UpdateContentTypeXmlDocument=[k,!0],F.UpdateList=[k,!0],F.UpdateListItems=[k,!0],F.AddMeeting=[l,!0],F.CreateWorkspace=[l,!0],F.RemoveMeeting=[l,!0],F.SetWorkSpaceTitle=[l,!0],F.GetRecordRouting=[m,!1],F.GetRecordRoutingCollection=[m,!1],F.GetServerInfo=[m,!1],F.SubmitFile=[m,!0],F.ResolvePrincipals=[n,!0],F.SearchPrincipals=[n,!1],F.AddPermission=[o,!0],F.AddPermissionCollection=[o,!0],F.GetPermissionCollection=[o,!0],F.RemovePermission=[o,!0],F.RemovePermissionCollection=[o,!0],F.UpdatePermission=[o,!0],F.GetLinks=[p,!0],F.GetPortalSearchInfo=[q,!1],F.GetQuerySuggestions=[q,!1],F.GetSearchMetadata=[q,!1],F.Query=[q,!1],F.QueryEx=[q,!1],F.Registration=[q,!1],F.Status=[q,!1],F.SendClientScriptErrorReport=[r,!0],F.GetAttachments=[s,!1],F.EnumerateFolder=[s,!1],F.SiteDataGetList=[s,!1],F.SiteDataGetListCollection=[s,!1],F.SiteDataGetSite=[s,!1],F.SiteDataGetSiteUrl=[s,!1],F.SiteDataGetWeb=[s,!1],F.CreateWeb=[t,!0],F.DeleteWeb=[t,!0],F.GetSite=[t,!1],F.GetSiteTemplates=[t,!1],F.AddComment=[u,!0],F.AddTag=[u,!0],F.AddTagByKeyword=[u,!0],F.CountCommentsOfUser=[u,!1],F.CountCommentsOfUserOnUrl=[u,!1],F.CountCommentsOnUrl=[u,!1],F.CountRatingsOnUrl=[u,!1],F.CountTagsOfUser=[u,!1],F.DeleteComment=[u,!0],F.DeleteRating=[u,!0],F.DeleteTag=[u,!0],F.DeleteTagByKeyword=[u,!0],F.DeleteTags=[u,!0],F.GetAllTagTerms=[u,!1],F.GetAllTagTermsForUrlFolder=[u,!1],F.GetAllTagUrls=[u,!1],F.GetAllTagUrlsByKeyword=[u,!1],F.GetCommentsOfUser=[u,!1],F.GetCommentsOfUserOnUrl=[u,!1],F.GetCommentsOnUrl=[u,!1],F.GetRatingAverageOnUrl=[u,!1],F.GetRatingOfUserOnUrl=[u,!1],F.GetRatingOnUrl=[u,!1],F.GetRatingsOfUser=[u,!1],F.GetRatingsOnUrl=[u,!1],F.GetSocialDataForFullReplication=[u,!1],F.GetTags=[u,!0],F.GetTagsOfUser=[u,!0],F.GetTagTerms=[u,!0],F.GetTagTermsOfUser=[u,!0],F.GetTagTermsOnUrl=[u,!0],F.GetTagUrlsOfUser=[u,!0],F.GetTagUrlsOfUserByKeyword=[u,!0],F.GetTagUrls=[u,!0],F.GetTagUrlsByKeyword=[u,!0],F.SetRating=[u,!0],F.UpdateComment=[u,!0],F.SpellCheck=[v,!1],F.AddTerms=[w,!0],F.GetChildTermsInTerm=[w,!1],F.GetChildTermsInTermSet=[w,!1],F.GetKeywordTermsByGuids=[w,!1],F.GetTermsByLabel=[w,!1],F.GetTermSets=[w,!1],F.AddGroup=[x,!0],F.AddGroupToRole=[x,!0],F.AddRole=[x,!0],F.AddRoleDef=[x,!0],F.AddUserCollectionToGroup=[x,!0],F.AddUserCollectionToRole=[x,!0],F.AddUserToGroup=[x,!0],F.AddUserToRole=[x,!0],F.GetAllUserCollectionFromWeb=[x,!1],F.GetGroupCollection=[x,!1],F.GetGroupCollectionFromRole=[x,!1],F.GetGroupCollectionFromSite=[x,!1],F.GetGroupCollectionFromUser=[x,!1],F.GetGroupCollectionFromWeb=[x,!1],F.GetGroupInfo=[x,!1],F.GetRoleCollection=[x,!1],F.GetRoleCollectionFromGroup=[x,!1],F.GetRoleCollectionFromUser=[x,!1],F.GetRoleCollectionFromWeb=[x,!1],F.GetRoleInfo=[x,!1],F.GetRolesAndPermissionsForCurrentUser=[x,!1],F.GetRolesAndPermissionsForSite=[x,!1],F.GetUserCollection=[x,!1],F.GetUserCollectionFromGroup=[x,!1],F.GetUserCollectionFromRole=[x,!1],F.GetUserCollectionFromSite=[x,!1],F.GetUserCollectionFromWeb=[x,!1],F.GetUserInfo=[x,!1],F.GetUserLoginFromEmail=[x,!1],F.RemoveGroup=[x,!0],F.RemoveGroupFromRole=[x,!0],F.RemoveRole=[x,!0],F.RemoveUserCollectionFromGroup=[x,!0],F.RemoveUserCollectionFromRole=[x,!0],F.RemoveUserCollectionFromSite=[x,!0],F.RemoveUserFromGroup=[x,!0],F.RemoveUserFromRole=[x,!0],F.RemoveUserFromSite=[x,!0],F.RemoveUserFromWeb=[x,!0],F.UpdateGroupInfo=[x,!0],F.UpdateRoleDefInfo=[x,!0],F.UpdateRoleInfo=[x,!0],F.UpdateUserInfo=[x,!0],F.AddColleague=[y,!0],F.AddLink=[y,!0],F.AddMembership=[y,!0],F.AddPinnedLink=[y,!0],F.CreateMemberGroup=[y,!0],F.CreateUserProfileByAccountName=[y,!0],F.GetCommonColleagues=[y,!1],F.GetCommonManager=[y,!1],F.GetCommonMemberships=[y,!1],F.GetInCommon=[y,!1],F.GetPropertyChoiceList=[y,!1],F.GetUserColleagues=[y,!1],F.GetUserLinks=[y,!1],F.GetUserMemberships=[y,!1],F.GetUserPinnedLinks=[y,!1],F.GetUserProfileByGuid=[y,!1],F.GetUserProfileByIndex=[y,!1],F.GetUserProfileByName=[y,!1],F.GetUserProfileCount=[y,!1],F.GetUserProfileSchema=[y,!1],F.GetUserPropertyByAccountName=[y,!1],F.ModifyUserPropertyByAccountName=[y,!0],F.RemoveAllColleagues=[y,!0],F.RemoveAllLinks=[y,!0],F.RemoveAllMemberships=[y,!0],F.RemoveAllPinnedLinks=[y,!0],F.RemoveColleague=[y,!0],F.RemoveLink=[y,!0],F.RemoveMembership=[y,!0],F.RemovePinnedLink=[y,!0],F.UpdateColleaguePrivacy=[y,!0],F.UpdateLink=[y,!0],F.UpdateMembershipPrivacy=[y,!0],F.UpdatePinnedLink=[y,!0],F.DeleteAllVersions=[z,!0],F.DeleteVersion=[z,!0],F.GetVersions=[z,!1],F.RestoreVersion=[z,!0],F.AddView=[A,!0],F.DeleteView=[A,!0],F.GetView=[A,!1],F.GetViewHtml=[A,!1],F.GetViewCollection=[A,!1],F.UpdateView=[A,!0],F.UpdateViewHtml=[A,!0],F.AddWebPart=[B,!0],F.AddWebPartToZone=[B,!0],F.DeleteWebPart=[B,!0],F.GetWebPart2=[B,!1],F.GetWebPartPage=[B,!1],F.GetWebPartProperties=[B,!1],F.GetWebPartProperties2=[B,!1],F.SaveWebPart2=[B,!0],F.CreateContentType=[C,!0],F.GetColumns=[C,!1],F.GetContentType=[C,!1],F.GetContentTypes=[C,!1],F.GetCustomizedPageStatus=[C,!1],F.GetListTemplates=[C,!1],F.GetObjectIdFromUrl=[C,!1],F.GetWeb=[C,!1],F.GetWebCollection=[C,!1],F.GetAllSubWebCollection=[C,!1],F.UpdateColumns=[C,!0],F.UpdateContentType=[C,!0],F.WebUrlFromPageUrl=[C,!1],F.AlterToDo=[D,!0],F.ClaimReleaseTask=[D,!0],F.GetTemplatesForItem=[D,!1],F.GetToDosForItem=[D,!1],F.GetWorkflowDataForItem=[D,!1],F.GetWorkflowTaskData=[D,!1],F.StartWorkflow=[D,!0];var G;a.fn.SPServices=function(h){for(var i=a.extend({},a.fn.SPServices.defaults,h),j=0;j<E.length;j++)"string"==typeof i[E[j]]&&(i[E[j]]=b.encodeXml(i[E[j]]));switch(b.utils.SOAPEnvelope.opheader="<"+i.operation+" ",F[i.operation][0]){case g:b.utils.SOAPEnvelope.opheader+="xmlns='"+c.SCHEMASharePoint+"/soap/2002/1/alerts/' >",G=c.SCHEMASharePoint+"/soap/2002/1/alerts/";break;case l:b.utils.SOAPEnvelope.opheader+="xmlns='"+c.SCHEMASharePoint+"/soap/meetings/' >",G=c.SCHEMASharePoint+"/soap/meetings/";break;case m:b.utils.SOAPEnvelope.opheader+="xmlns='"+c.SCHEMASharePoint+"/soap/recordsrepository/' >",G=c.SCHEMASharePoint+"/soap/recordsrepository/";break;case o:b.utils.SOAPEnvelope.opheader+="xmlns='"+c.SCHEMASharePoint+"/soap/directory/' >",G=c.SCHEMASharePoint+"/soap/directory/";break;case p:b.utils.SOAPEnvelope.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/' >",G="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/";break;case q:b.utils.SOAPEnvelope.opheader+="xmlns='urn:Microsoft.Search' >",G="urn:Microsoft.Search/";break;case r:b.utils.SOAPEnvelope.opheader+="xmlns='"+c.SCHEMASharePoint+"/diagnostics/' >",G="http://schemas.microsoft.com/sharepoint/diagnostics/";break;case u:b.utils.SOAPEnvelope.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/SocialDataService' >",G="http://microsoft.com/webservices/SharePointPortalServer/SocialDataService/";break;case v:b.utils.SOAPEnvelope.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/publishing/spelling/' >",G="http://schemas.microsoft.com/sharepoint/publishing/spelling/SpellCheck";break;case w:b.utils.SOAPEnvelope.opheader+="xmlns='"+c.SCHEMASharePoint+"/taxonomy/soap/' >",G=c.SCHEMASharePoint+"/taxonomy/soap/";break;case x:b.utils.SOAPEnvelope.opheader+="xmlns='"+c.SCHEMASharePoint+"/soap/directory/' >",G=c.SCHEMASharePoint+"/soap/directory/";break;case y:b.utils.SOAPEnvelope.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/UserProfileService' >",G="http://microsoft.com/webservices/SharePointPortalServer/UserProfileService/";break;case B:b.utils.SOAPEnvelope.opheader+="xmlns='http://microsoft.com/sharepoint/webpartpages' >",G="http://microsoft.com/sharepoint/webpartpages/";break;case D:b.utils.SOAPEnvelope.opheader+="xmlns='"+c.SCHEMASharePoint+"/soap/workflow/' >",G=c.SCHEMASharePoint+"/soap/workflow/";break;default:b.utils.SOAPEnvelope.opheader+="xmlns='"+c.SCHEMASharePoint+"/soap/'>",G=c.SCHEMASharePoint+"/soap/"}G+=i.operation,b.utils.SOAPEnvelope.opfooter="</"+i.operation+">";var k="_vti_bin/"+F[i.operation][0]+".asmx",n=void 0!==i.webURL?i.webURL:i.webUrl;if(n.charAt(n.length-1)===c.SLASH)k=n+k;else if(n.length>0)k=n+c.SLASH+k;else{var s=a().SPServices.SPGetCurrentSite();k=s+(s.charAt(s.length-1)===c.SLASH?k:c.SLASH+k)}switch(b.utils.SOAPEnvelope.payload="",i.operation){case"GetAlerts":break;case"DeleteAlerts":for(b.utils.SOAPEnvelope.payload+="<IDs>",j=0;j<i.IDs.length;j++)b.utils.SOAPEnvelope.payload+=b.wrapNode("string",i.IDs[j]);b.utils.SOAPEnvelope.payload+="</IDs>";break;case"Mode":break;case"Login":d(i,["username","password"]);break;case"CopyIntoItems":for(d(i,["SourceUrl"]),b.utils.SOAPEnvelope.payload+="<DestinationUrls>",j=0;j<i.DestinationUrls.length;j++)b.utils.SOAPEnvelope.payload+=b.wrapNode("string",i.DestinationUrls[j]);b.utils.SOAPEnvelope.payload+="</DestinationUrls>",d(i,["Fields","Stream","Results"]);break;case"CopyIntoItemsLocal":for(d(i,["SourceUrl"]),b.utils.SOAPEnvelope.payload+="<DestinationUrls>",j=0;j<i.DestinationUrls.length;j++)b.utils.SOAPEnvelope.payload+=b.wrapNode("string",i.DestinationUrls[j]);b.utils.SOAPEnvelope.payload+="</DestinationUrls>";break;case"GetItem":d(i,["Url","Fields","Stream"]);break;case"GetForm":d(i,["listName","formUrl"]);break;case"GetFormCollection":d(i,["listName"]);break;case"AddAttachment":d(i,["listName","listItemID","fileName","attachment"]);break;case"AddDiscussionBoardItem":d(i,["listName","message"]);break;case"AddList":d(i,["listName","description","templateID"]);break;case"AddListFromFeature":d(i,["listName","description","featureID","templateID"]);break;case"ApplyContentTypeToList":d(i,["webUrl","contentTypeId","listName"]);break;case"CheckInFile":d(i,["pageUrl","comment","CheckinType"]);break;case"CheckOutFile":d(i,["pageUrl","checkoutToLocal","lastmodified"]);break;case"CreateContentType":d(i,["listName","displayName","parentType","fields","contentTypeProperties","addToView"]);break;case"DeleteAttachment":d(i,["listName","listItemID","url"]);break;case"DeleteContentType":d(i,["listName","contentTypeId"]);break;case"DeleteContentTypeXmlDocument":d(i,["listName","contentTypeId","documentUri"]);break;case"DeleteList":d(i,["listName"]);break;case"GetAttachmentCollection":d(i,["listName",["listItemID","ID"]]);break;case"GetList":d(i,["listName"]);break;case"GetListAndView":d(i,["listName","viewName"]);break;case"GetListCollection":break;case"GetListContentType":d(i,["listName","contentTypeId"]);break;case"GetListContentTypes":d(i,["listName"]);break;case"GetListItems":d(i,["listName","viewName",["query","CAMLQuery"],["viewFields","CAMLViewFields"],["rowLimit","CAMLRowLimit"],["queryOptions","CAMLQueryOptions"]]);break;case"GetListItemChanges":d(i,["listName","viewFields","since","contains"]);break;case"GetListItemChangesSinceToken":d(i,["listName","viewName",["query","CAMLQuery"],["viewFields","CAMLViewFields"],["rowLimit","CAMLRowLimit"],["queryOptions","CAMLQueryOptions"],{name:"changeToken",sendNull:!1},{name:"contains",sendNull:!1}]);break;case"GetVersionCollection":d(i,["strlistID","strlistItemID","strFieldName"]);break;case"UndoCheckOut":d(i,["pageUrl"]);break;case"UpdateContentType":d(i,["listName","contentTypeId","contentTypeProperties","newFields","updateFields","deleteFields","addToView"]);break;case"UpdateContentTypesXmlDocument":d(i,["listName","newDocument"]);break;case"UpdateContentTypeXmlDocument":d(i,["listName","contentTypeId","newDocument"]);break;case"UpdateList":d(i,["listName","listProperties","newFields","updateFields","deleteFields","listVersion"]);break;case"UpdateListItems":if(d(i,["listName"]),"undefined"!=typeof i.updates&&i.updates.length>0)d(i,["updates"]);else{for(b.utils.SOAPEnvelope.payload+="<updates><Batch OnError='Continue'><Method ID='1' Cmd='"+i.batchCmd+"'>",j=0;j<i.valuepairs.length;j++)b.utils.SOAPEnvelope.payload+="<Field Name='"+i.valuepairs[j][0]+"'>"+b.escapeColumnValue(i.valuepairs[j][1])+"</Field>";"New"!==i.batchCmd&&(b.utils.SOAPEnvelope.payload+="<Field Name='ID'>"+i.ID+"</Field>"),b.utils.SOAPEnvelope.payload+="</Method></Batch></updates>"}break;case"AddMeeting":d(i,["organizerEmail","uid","sequence","utcDateStamp","title","location","utcDateStart","utcDateEnd","nonGregorian"]);break;case"CreateWorkspace":d(i,["title","templateName","lcid","timeZoneInformation"]);break;case"RemoveMeeting":d(i,["recurrenceId","uid","sequence","utcDateStamp","cancelMeeting"]);break;case"SetWorkspaceTitle":d(i,["title"]);break;case"GetRecordRouting":d(i,["recordRouting"]);break;case"GetRecordRoutingCollection":break;case"GetServerInfo":break;case"SubmitFile":d(i,["fileToSubmit"],["properties"],["recordRouting"],["sourceUrl"],["userName"]);break;case"ResolvePrincipals":d(i,["principalKeys","principalType","addToUserInfoList"]);break;case"SearchPrincipals":d(i,["searchText","maxResults","principalType"]);break;case"AddPermission":d(i,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"AddPermissionCollection":d(i,["objectName","objectType","permissionsInfoXml"]);break;case"GetPermissionCollection":d(i,["objectName","objectType"]);break;case"RemovePermission":d(i,["objectName","objectType","permissionIdentifier","permissionType"]);break;case"RemovePermissionCollection":d(i,["objectName","objectType","memberIdsXml"]);break;case"UpdatePermission":d(i,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"GetLinks":break;case"GetPortalSearchInfo":b.utils.SOAPEnvelope.opheader="<"+i.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",G="http://microsoft.com/webservices/OfficeServer/QueryService/"+i.operation;break;case"GetQuerySuggestions":b.utils.SOAPEnvelope.opheader="<"+i.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",G="http://microsoft.com/webservices/OfficeServer/QueryService/"+i.operation,b.utils.SOAPEnvelope.payload+=b.wrapNode("queryXml",b.encodeXml(i.queryXml));break;case"GetSearchMetadata":b.SOAPEnvelope.opheader="<"+i.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",G="http://microsoft.com/webservices/OfficeServer/QueryService/"+i.operation;break;case"Query":b.SOAPEnvelope.payload+=b.wrapNode("queryXml",b.encodeXml(i.queryXml));break;case"QueryEx":b.SOAPEnvelope.opheader="<"+i.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",G="http://microsoft.com/webservices/OfficeServer/QueryService/"+i.operation,b.SOAPEnvelope.payload+=b.wrapNode("queryXml",b.encodeXml(i.queryXml));break;case"Registration":b.SOAPEnvelope.payload+=b.wrapNode("registrationXml",b.encodeXml(i.registrationXml));break;case"Status":break;case"SendClientScriptErrorReport":d(i,["message","file","line","client","stack","team","originalFile"]);break;case"EnumerateFolder":d(i,["strFolderUrl"]);break;case"GetAttachments":d(i,["strListName","strItemId"]);break;case"SiteDataGetList":d(i,["strListName"]),b.SOAPEnvelope=e(b.SOAPEnvelope,i.operation);break;case"SiteDataGetListCollection":b.SOAPEnvelope=e(b.SOAPEnvelope,i.operation);break;case"SiteDataGetSite":b.SOAPEnvelope=e(b.SOAPEnvelope,i.operation);break;case"SiteDataGetSiteUrl":d(i,["Url"]),b.SOAPEnvelope=e(b.SOAPEnvelope,i.operation);break;case"SiteDataGetWeb":b.SOAPEnvelope=e(b.SOAPEnvelope,i.operation);break;case"CreateWeb":d(i,["url","title","description","templateName","language","languageSpecified","locale","localeSpecified","collationLocale","collationLocaleSpecified","uniquePermissions","uniquePermissionsSpecified","anonymous","anonymousSpecified","presence","presenceSpecified"]);break;case"DeleteWeb":d(i,["url"]);break;case"GetSite":d(i,["SiteUrl"]);break;case"GetSiteTemplates":d(i,["LCID","TemplateList"]);break;case"AddComment":d(i,["url","comment","isHighPriority","title"]);break;case"AddTag":d(i,["url","termID","title","isPrivate"]);break;case"AddTagByKeyword":d(i,["url","keyword","title","isPrivate"]);break;case"CountCommentsOfUser":d(i,["userAccountName"]);break;case"CountCommentsOfUserOnUrl":d(i,["userAccountName","url"]);break;case"CountCommentsOnUrl":d(i,["url"]);break;case"CountRatingsOnUrl":d(i,["url"]);break;case"CountTagsOfUser":d(i,["userAccountName"]);break;case"DeleteComment":d(i,["url","lastModifiedTime"]);break;case"DeleteRating":d(i,["url"]);break;case"DeleteTag":d(i,["url","termID"]);break;case"DeleteTagByKeyword":d(i,["url","keyword"]);break;case"DeleteTags":d(i,["url"]);break;case"GetAllTagTerms":d(i,["maximumItemsToReturn"]);break;case"GetAllTagTermsForUrlFolder":d(i,["urlFolder","maximumItemsToReturn"]);break;case"GetAllTagUrls":d(i,["termID"]);break;case"GetAllTagUrlsByKeyword":d(i,["keyword"]);break;case"GetCommentsOfUser":d(i,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetCommentsOfUserOnUrl":d(i,["userAccountName","url"]);break;case"GetCommentsOnUrl":d(i,["url","maximumItemsToReturn","startIndex"]),"undefined"!=typeof i.excludeItemsTime&&i.excludeItemsTime.length>0&&(b.SOAPEnvelope.payload+=b.wrapNode("excludeItemsTime",i.excludeItemsTime));break;case"GetRatingAverageOnUrl":d(i,["url"]);break;case"GetRatingOfUserOnUrl":d(i,["userAccountName","url"]);break;case"GetRatingOnUrl":d(i,["url"]);break;case"GetRatingsOfUser":d(i,["userAccountName"]);break;case"GetRatingsOnUrl":d(i,["url"]);break;case"GetSocialDataForFullReplication":d(i,["userAccountName"]);break;case"GetTags":d(i,["url"]);break;case"GetTagsOfUser":d(i,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetTagTerms":d(i,["maximumItemsToReturn"]);break;case"GetTagTermsOfUser":d(i,["userAccountName","maximumItemsToReturn"]);break;case"GetTagTermsOnUrl":d(i,["url","maximumItemsToReturn"]);break;case"GetTagUrls":d(i,["termID"]);break;case"GetTagUrlsByKeyword":d(i,["keyword"]);break;case"GetTagUrlsOfUser":d(i,["termID","userAccountName"]);break;case"GetTagUrlsOfUserByKeyword":d(i,["keyword","userAccountName"]);break;case"SetRating":d(i,["url","rating","title","analysisDataEntry"]);break;case"UpdateComment":d(i,["url","lastModifiedTime","comment","isHighPriority"]);break;case"SpellCheck":d(i,["chunksToSpell","declaredLanguage","useLad"]);break;case"AddTerms":d(i,["sharedServiceId","termSetId","lcid","newTerms"]);break;case"GetChildTermsInTerm":d(i,["sspId","lcid","termId","termSetId"]);break;case"GetChildTermsInTermSet":d(i,["sspId","lcid","termSetId"]);break;case"GetKeywordTermsByGuids":d(i,["termIds","lcid"]);break;case"GetTermsByLabel":d(i,["label","lcid","matchOption","resultCollectionSize","termIds","addIfNotFound"]);break;case"GetTermSets":d(i,["sharedServiceIds","termSetIds","lcid","clientTimeStamps","clientVersions"]);break;case"AddGroup":d(i,["groupName","ownerIdentifier","ownerType","defaultUserLoginName","description"]);break;case"AddGroupToRole":d(i,["groupName","roleName"]);break;case"AddRole":d(i,["roleName","description","permissionMask"]);break;case"AddRoleDef":d(i,["roleName","description","permissionMask"]);break;case"AddUserCollectionToGroup":d(i,["groupName","usersInfoXml"]);break;case"AddUserCollectionToRole":d(i,["roleName","usersInfoXml"]);break;case"AddUserToGroup":d(i,["groupName","userName","userLoginName","userEmail","userNotes"]);break;case"AddUserToRole":d(i,["roleName","userName","userLoginName","userEmail","userNotes"]);break;case"GetAllUserCollectionFromWeb":break;case"GetGroupCollection":d(i,["groupNamesXml"]);break;case"GetGroupCollectionFromRole":d(i,["roleName"]);break;case"GetGroupCollectionFromSite":break;case"GetGroupCollectionFromUser":d(i,["userLoginName"]);break;case"GetGroupCollectionFromWeb":break;case"GetGroupInfo":d(i,["groupName"]);break;case"GetRoleCollection":d(i,["roleNamesXml"]);break;case"GetRoleCollectionFromGroup":d(i,["groupName"]);break;case"GetRoleCollectionFromUser":d(i,["userLoginName"]);break;case"GetRoleCollectionFromWeb":break;case"GetRoleInfo":d(i,["roleName"]);break;case"GetRolesAndPermissionsForCurrentUser":break;case"GetRolesAndPermissionsForSite":break;case"GetUserCollection":d(i,["userLoginNamesXml"]);break;case"GetUserCollectionFromGroup":d(i,["groupName"]);break;case"GetUserCollectionFromRole":d(i,["roleName"]);break;case"GetUserCollectionFromSite":break;case"GetUserCollectionFromWeb":break;case"GetUserInfo":d(i,["userLoginName"]);break;case"GetUserLoginFromEmail":d(i,["emailXml"]);break;case"RemoveGroup":d(i,["groupName"]);break;case"RemoveGroupFromRole":d(i,["roleName","groupName"]);break;case"RemoveRole":d(i,["roleName"]);break;case"RemoveUserCollectionFromGroup":d(i,["groupName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromRole":d(i,["roleName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromSite":d(i,["userLoginNamesXml"]);break;case"RemoveUserFromGroup":d(i,["groupName","userLoginName"]);break;case"RemoveUserFromRole":d(i,["roleName","userLoginName"]);break;case"RemoveUserFromSite":d(i,["userLoginName"]);break;case"RemoveUserFromWeb":d(i,["userLoginName"]);break;case"UpdateGroupInfo":d(i,["oldGroupName","groupName","ownerIdentifier","ownerType","description"]);break;case"UpdateRoleDefInfo":d(i,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateRoleInfo":d(i,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateUserInfo":d(i,["userLoginName","userName","userEmail","userNotes"]);break;case"AddColleague":d(i,["accountName","colleagueAccountName","group","privacy","isInWorkGroup"]);break;case"AddLink":d(i,["accountName","name","url","group","privacy"]);break;case"AddMembership":d(i,["accountName","membershipInfo","group","privacy"]);break;case"AddPinnedLink":d(i,["accountName","name","url"]);break;case"CreateMemberGroup":d(i,["membershipInfo"]);break;case"CreateUserProfileByAccountName":d(i,["accountName"]);break;case"GetCommonColleagues":d(i,["accountName"]);break;case"GetCommonManager":d(i,["accountName"]);break;case"GetCommonMemberships":d(i,["accountName"]);break;case"GetInCommon":d(i,["accountName"]);break;case"GetPropertyChoiceList":d(i,["propertyName"]);break;case"GetUserColleagues":d(i,["accountName"]);break;case"GetUserLinks":d(i,["accountName"]);break;case"GetUserMemberships":d(i,["accountName"]);break;case"GetUserPinnedLinks":d(i,["accountName"]);break;case"GetUserProfileByGuid":d(i,["guid"]);break;case"GetUserProfileByIndex":d(i,["index"]);break;case"GetUserProfileByName":"undefined"!=typeof i.accountName&&i.accountName.length>0?d(i,[["AccountName","accountName"]]):d(i,["AccountName"]);break;case"GetUserProfileCount":break;case"GetUserProfileSchema":break;case"GetUserPropertyByAccountName":d(i,["accountName","propertyName"]);break;case"ModifyUserPropertyByAccountName":d(i,["accountName","newData"]);break;case"RemoveAllColleagues":d(i,["accountName"]);break;case"RemoveAllLinks":d(i,["accountName"]);break;case"RemoveAllMemberships":d(i,["accountName"]);break;case"RemoveAllPinnedLinks":d(i,["accountName"]);break;case"RemoveColleague":d(i,["accountName","colleagueAccountName"]);break;case"RemoveLink":d(i,["accountName","id"]);break;case"RemoveMembership":d(i,["accountName","sourceInternal","sourceReference"]);break;case"RemovePinnedLink":d(i,["accountName","id"]);break;case"UpdateColleaguePrivacy":d(i,["accountName","colleagueAccountName","newPrivacy"]);break;case"UpdateLink":d(i,["accountName","data"]);break;case"UpdateMembershipPrivacy":d(i,["accountName","sourceInternal","sourceReference","newPrivacy"]);break;case"UpdatePinnedLink ":d(i,["accountName","data"]);break;case"DeleteAllVersions":d(i,["fileName"]);break;case"DeleteVersion":d(i,["fileName","fileVersion"]);break;case"GetVersions":d(i,["fileName"]);break;case"RestoreVersion":d(i,["fileName","fileVersion"]);break;case"AddView":d(i,["listName","viewName","viewFields","query","rowLimit","rowLimit","type","makeViewDefault"]);break;case"DeleteView":d(i,["listName","viewName"]);break;case"GetView":d(i,["listName","viewName"]);break;case"GetViewCollection":d(i,["listName"]);break;case"GetViewHtml":d(i,["listName","viewName"]);break;case"UpdateView":d(i,["listName","viewName","viewProperties","query","viewFields","aggregations","formats","rowLimit"]);break;case"UpdateViewHtml":d(i,["listName","viewName","viewProperties","toolbar","viewHeader","viewBody","viewFooter","viewEmpty","rowLimitExceeded","query","viewFields","aggregations","formats","rowLimit"]);break;case"AddWebPart":d(i,["pageUrl","webPartXml","storage"]);break;case"AddWebPartToZone":d(i,["pageUrl","webPartXml","storage","zoneId","zoneIndex"]);break;case"DeleteWebPart":d(i,["pageUrl","storageKey","storage"]);break;case"GetWebPart2":d(i,["pageUrl","storageKey","storage","behavior"]);break;case"GetWebPartPage":d(i,["documentName","behavior"]);break;case"GetWebPartProperties":d(i,["pageUrl","storage"]);break;case"GetWebPartProperties2":d(i,["pageUrl","storage","behavior"]);break;case"SaveWebPart2":d(i,["pageUrl","storageKey","webPartXml","storage","allowTypeChange"]);break;case"Webs.CreateContentType":d(i,["displayName","parentType","newFields","contentTypeProperties"]);break;case"GetColumns":d(i,["webUrl"]);break;case"GetContentType":d(i,["contentTypeId"]);break;case"GetContentTypes":break;case"GetCustomizedPageStatus":d(i,["fileUrl"]);break;case"GetListTemplates":break;case"GetObjectIdFromUrl":d(i,["objectUrl"]);break;case"GetWeb":d(i,[["webUrl","webURL"]]);break;case"GetWebCollection":break;case"GetAllSubWebCollection":break;case"UpdateColumns":d(i,["newFields","updateFields","deleteFields"]);break;case"Webs.UpdateContentType":d(i,["contentTypeId","contentTypeProperties","newFields","updateFields","deleteFields"]);break;case"WebUrlFromPageUrl":d(i,[["pageUrl","pageURL"]]);break;case"AlterToDo":d(i,["item","todoId","todoListId","taskData"]);break;case"ClaimReleaseTask":d(i,["item","taskId","listId","fClaim"]);break;case"GetTemplatesForItem":d(i,["item"]);break;case"GetToDosForItem":d(i,["item"]);break;case"GetWorkflowDataForItem":d(i,["item"]);break;case"GetWorkflowTaskData":d(i,["item","listId","taskId"]);break;case"StartWorkflow":d(i,["item","templateId","workflowParameters"])}var t,z=b.SOAPEnvelope.header+b.SOAPEnvelope.opheader+b.SOAPEnvelope.payload+b.SOAPEnvelope.opfooter+b.SOAPEnvelope.footer;if(i.cacheXML&&(t=f[z]),"undefined"==typeof t){var A=a.ajax({url:k,async:i.async,beforeSend:function(a){F[i.operation][1]&&a.setRequestHeader("SOAPAction",G)},type:"POST",data:z,dataType:"xml",contentType:"text/xml;charset='utf-8'",complete:function(b,c){a.isFunction(i.completefunc)&&i.completefunc(b,c)}});return i.cacheXML&&(f[z]=A),A}return a.isFunction(i.completefunc)&&t.done(function(a,b,c){i.completefunc(c,b)}),t},a.fn.SPServices.defaults={cacheXML:!1,operation:"",webURL:"",makeViewDefault:!1,viewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:0,
CAMLQueryOptions:"<QueryOptions></QueryOptions>",batchCmd:"Update",valuepairs:[],DestinationUrls:[],behavior:"Version3",storage:"Shared",objectType:"List",cancelMeeting:!0,nonGregorian:!1,fClaim:!1,recurrenceId:0,sequence:0,maximumItemsToReturn:0,startIndex:0,isHighPriority:!1,isPrivate:!1,rating:1,maxResults:10,principalType:"User",async:!0,completefunc:null}}(f,b,a),d=function(a){return a}(f)})}();